<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey M. Dick" />

<meta name="date" content="2021-04-08" />

<title>An Introduction to CHNOSZ</title>

<style type="text/css">body {
background-color: #fffff8;
}
</style>
<style type="text/css">
@charset "UTF-8";

html { font-size: 15px; }
body { width: 87.5%;
margin-left: auto;
margin-right: auto;
padding-left: 12.5%;
color: #111;
max-width: 1400px;
counter-reset: sidenote-counter; }
h1.title { font-weight: 400;
font-style: normal;
margin-top: 4rem;
margin-bottom: 1.5rem;
font-size: 3.2rem;
line-height: 1; }
h1 {
font-weight: 400;
margin-top: 2.1rem;
margin-bottom: 0;
font-size: 2.2rem;
line-height: 1; }
h2 {
font-weight: 400;
font-size: 1.7rem;
margin-top: 2rem;
margin-bottom: 0;
line-height: 1; }
h3.subtitle {
font-weight: 400;
margin-top: 1rem;
margin-bottom: 1rem;
font-size: 1.8rem;
display: block;
line-height: 1; }
h4.author, h4.date {
font-size: 1.4rem;
font-weight: 400;
margin: 1rem auto;
line-height: 1;
}
.danger { color: red; }
article { position: relative;
padding: 5rem 0rem; }
section { padding-top: 1rem;
padding-bottom: 1rem; }
p, ol, ul { font-size: 1.4rem; }
p { line-height: 2rem;
margin-top: 1.4rem;
margin-bottom: 1.4rem;
padding-right: 0;
vertical-align: baseline; }
blockquote { font-size: 1.4rem; }
blockquote p { width: 50%; }
blockquote footer { width: 50%;
font-size: 1.1rem;
text-align: right; }
ol, ul { width: 45%;
-webkit-padding-start: 5%;
-webkit-padding-end: 5%; }
li { padding: 0.5rem 0; }
table {
border-top: 2px solid #111;
border-bottom: 2px solid #111;
font-size: 1.1rem;
}
th {
border-bottom: 1px solid #111;
}
div.figure {
padding: 0;
border: 0;
font-size: 100%;
font: inherit;
vertical-align: baseline;
max-width: 55%;
-webkit-margin-start: 0;
-webkit-margin-end: 0;
margin: 0 0 3em 0;
}

a:link, a:visited { color: inherit; }
a:link { text-decoration: none;
background: -webkit-linear-gradient(#fffff8, #fffff8), -webkit-linear-gradient(#fffff8, #fffff8), -webkit-linear-gradient(#333, #333);
background: linear-gradient(#fffff8, #fffff8), linear-gradient(#fffff8, #fffff8), linear-gradient(#333, #333);
-webkit-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;
-moz-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;
background-size: 0.05em 1px, 0.05em 1px, 1px 1px;
background-repeat: no-repeat, no-repeat, repeat-x;
text-shadow: 0.03em 0 #fffff8, -0.03em 0 #fffff8, 0 0.03em #fffff8, 0 -0.03em #fffff8, 0.06em 0 #fffff8, -0.06em 0 #fffff8, 0.09em 0 #fffff8, -0.09em 0 #fffff8, 0.12em 0 #fffff8, -0.12em 0 #fffff8, 0.15em 0 #fffff8, -0.15em 0 #fffff8;
background-position: 0% 93%, 100% 93%, 0% 93%; }
@media screen and (-webkit-min-device-pixel-ratio: 0) { a:link { background-position-y: 87%, 87%, 87%; } }
a:link::selection { text-shadow: 0.03em 0 #b4d5fe, -0.03em 0 #b4d5fe, 0 0.03em #b4d5fe, 0 -0.03em #b4d5fe, 0.06em 0 #b4d5fe, -0.06em 0 #b4d5fe, 0.09em 0 #b4d5fe, -0.09em 0 #b4d5fe, 0.12em 0 #b4d5fe, -0.12em 0 #b4d5fe, 0.15em 0 #b4d5fe, -0.15em 0 #b4d5fe;
background: #b4d5fe; }
a:link::-moz-selection { text-shadow: 0.03em 0 #b4d5fe, -0.03em 0 #b4d5fe, 0 0.03em #b4d5fe, 0 -0.03em #b4d5fe, 0.06em 0 #b4d5fe, -0.06em 0 #b4d5fe, 0.09em 0 #b4d5fe, -0.09em 0 #b4d5fe, 0.12em 0 #b4d5fe, -0.12em 0 #b4d5fe, 0.15em 0 #b4d5fe, -0.15em 0 #b4d5fe;
background: #b4d5fe; }

img {max-width: 100%;}
.marginnote img { display: block; }
.sidenote, .marginnote { float: right;
clear: right;
margin-right: -60%;
width: 50%;
margin-top: 0;
margin-bottom: 1rem;
font-size: 1.1rem;
line-height: 1.3;
vertical-align: baseline;
position: relative; }
.sidenote-number {
position: relative;
vertical-align: baseline; }
.sidenote-number { font-size: 1rem;
top: -0.5rem;
left: 0.1rem; }
p, footer, table, hr { width: 55%; }
hr { margin-left: 0; }
table table, li p, li pre { width: auto; }
li p, li pre {margin-top: auto; }
div.fullwidth, table.fullwidth { max-width: 90%; }
div.fullwidth > * { width: auto; }
#TOC, h1.title { max-width: 90%; }
#TOC ol, #TOC ul { width: auto; }
div.fullwidth p.caption {
margin-right: 0;
max-width: 33%;
}
p.caption { text-align: left; }
@media screen and (max-width: 760px) { p, footer, ol, ul, table, hr { width: 90%; }
pre { width: 87.5%; }
ul { width: 85%; }
figure { max-width: 90%; }
div.fullwidth p.caption { max-width: none; }
blockquote p, blockquote footer { width: 90%; }}
.sans { font-family: "Gill Sans", "Gill Sans MT", Calibri, sans-serif;
letter-spacing: .03em; }
code { font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 1.125rem;
line-height: 1.6; }
pre code { font-size: 1rem; }
p code { white-space: inherit; }
h1 code, h2 code, h3 code { font-size: 0.80em; }
.marginnote code, .sidenote code { font-size: 1rem; }
pre { width: 52.5%;
overflow-x: auto; }
.fullwidth { max-width: 90%;
clear:both; }
span.newthought { font-variant: small-caps;
font-size: 1.2em; }
input.margin-toggle { display: none; }
label.sidenote-number { display: inline; }
label.margin-toggle:not(.sidenote-number) { display: none; }
@media (max-width: 760px) { label.margin-toggle:not(.sidenote-number) { display: inline; }
.sidenote, .marginnote { display: none; }
.shownote,
.margin-toggle:checked + .sidenote,
.margin-toggle:checked + .marginnote {
display: block;
float: left;
left: 1rem;
clear: both;
width: 95%;
margin: 1rem 2.5%;
vertical-align: baseline;
position: relative;
}
label { cursor: pointer; }
div.figure { max-width: 90%; }
pre { width: 90%;
padding: 0; }
}
</style>
<style type="text/css">.hljs-literal {
color: #990073;
}
.hljs-number {
color: #099;
}
.hljs-comment {
color: #998;
font-style: italic;
}
.hljs-keyword {
color: #900;
font-weight: bold;
}
.hljs-string {
color: #d14;
}
</style>
<script src="data:application/javascript;base64,LyohIGhpZ2hsaWdodC5qcyB2OS4xMi4wIHwgQlNEMyBMaWNlbnNlIHwgZ2l0LmlvL2hsanNsaWNlbnNlICovCiFmdW5jdGlvbihlKXt2YXIgbj0ib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyYmd2luZG93fHwib2JqZWN0Ij09dHlwZW9mIHNlbGYmJnNlbGY7InVuZGVmaW5lZCIhPXR5cGVvZiBleHBvcnRzP2UoZXhwb3J0cyk6biYmKG4uaGxqcz1lKHt9KSwiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUoW10sZnVuY3Rpb24oKXtyZXR1cm4gbi5obGpzfSkpfShmdW5jdGlvbihlKXtmdW5jdGlvbiBuKGUpe3JldHVybiBlLnJlcGxhY2UoLyYvZywiJmFtcDsiKS5yZXBsYWNlKC88L2csIiZsdDsiKS5yZXBsYWNlKC8+L2csIiZndDsiKX1mdW5jdGlvbiB0KGUpe3JldHVybiBlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gcihlLG4pe3ZhciB0PWUmJmUuZXhlYyhuKTtyZXR1cm4gdCYmMD09PXQuaW5kZXh9ZnVuY3Rpb24gYShlKXtyZXR1cm4gay50ZXN0KGUpfWZ1bmN0aW9uIGkoZSl7dmFyIG4sdCxyLGksbz1lLmNsYXNzTmFtZSsiICI7aWYobys9ZS5wYXJlbnROb2RlP2UucGFyZW50Tm9kZS5jbGFzc05hbWU6IiIsdD1CLmV4ZWMobykpcmV0dXJuIHcodFsxXSk/dFsxXToibm8taGlnaGxpZ2h0Ijtmb3Iobz1vLnNwbGl0KC9ccysvKSxuPTAscj1vLmxlbmd0aDtyPm47bisrKWlmKGk9b1tuXSxhKGkpfHx3KGkpKXJldHVybiBpfWZ1bmN0aW9uIG8oZSl7dmFyIG4sdD17fSxyPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtmb3IobiBpbiBlKXRbbl09ZVtuXTtyZXR1cm4gci5mb3JFYWNoKGZ1bmN0aW9uKGUpe2ZvcihuIGluIGUpdFtuXT1lW25dfSksdH1mdW5jdGlvbiB1KGUpe3ZhciBuPVtdO3JldHVybiBmdW5jdGlvbiByKGUsYSl7Zm9yKHZhciBpPWUuZmlyc3RDaGlsZDtpO2k9aS5uZXh0U2libGluZykzPT09aS5ub2RlVHlwZT9hKz1pLm5vZGVWYWx1ZS5sZW5ndGg6MT09PWkubm9kZVR5cGUmJihuLnB1c2goe2V2ZW50OiJzdGFydCIsb2Zmc2V0OmEsbm9kZTppfSksYT1yKGksYSksdChpKS5tYXRjaCgvYnJ8aHJ8aW1nfGlucHV0Lyl8fG4ucHVzaCh7ZXZlbnQ6InN0b3AiLG9mZnNldDphLG5vZGU6aX0pKTtyZXR1cm4gYX0oZSwwKSxufWZ1bmN0aW9uIGMoZSxyLGEpe2Z1bmN0aW9uIGkoKXtyZXR1cm4gZS5sZW5ndGgmJnIubGVuZ3RoP2VbMF0ub2Zmc2V0IT09clswXS5vZmZzZXQ/ZVswXS5vZmZzZXQ8clswXS5vZmZzZXQ/ZTpyOiJzdGFydCI9PT1yWzBdLmV2ZW50P2U6cjplLmxlbmd0aD9lOnJ9ZnVuY3Rpb24gbyhlKXtmdW5jdGlvbiByKGUpe3JldHVybiIgIitlLm5vZGVOYW1lKyc9IicrbihlLnZhbHVlKS5yZXBsYWNlKCciJywiJnF1b3Q7IikrJyInfXMrPSI8Iit0KGUpK0UubWFwLmNhbGwoZS5hdHRyaWJ1dGVzLHIpLmpvaW4oIiIpKyI+In1mdW5jdGlvbiB1KGUpe3MrPSI8LyIrdChlKSsiPiJ9ZnVuY3Rpb24gYyhlKXsoInN0YXJ0Ij09PWUuZXZlbnQ/bzp1KShlLm5vZGUpfWZvcih2YXIgbD0wLHM9IiIsZj1bXTtlLmxlbmd0aHx8ci5sZW5ndGg7KXt2YXIgZz1pKCk7aWYocys9bihhLnN1YnN0cmluZyhsLGdbMF0ub2Zmc2V0KSksbD1nWzBdLm9mZnNldCxnPT09ZSl7Zi5yZXZlcnNlKCkuZm9yRWFjaCh1KTtkbyBjKGcuc3BsaWNlKDAsMSlbMF0pLGc9aSgpO3doaWxlKGc9PT1lJiZnLmxlbmd0aCYmZ1swXS5vZmZzZXQ9PT1sKTtmLnJldmVyc2UoKS5mb3JFYWNoKG8pfWVsc2Uic3RhcnQiPT09Z1swXS5ldmVudD9mLnB1c2goZ1swXS5ub2RlKTpmLnBvcCgpLGMoZy5zcGxpY2UoMCwxKVswXSl9cmV0dXJuIHMrbihhLnN1YnN0cihsKSl9ZnVuY3Rpb24gbChlKXtyZXR1cm4gZS52JiYhZS5jYWNoZWRfdmFyaWFudHMmJihlLmNhY2hlZF92YXJpYW50cz1lLnYubWFwKGZ1bmN0aW9uKG4pe3JldHVybiBvKGUse3Y6bnVsbH0sbil9KSksZS5jYWNoZWRfdmFyaWFudHN8fGUuZVcmJltvKGUpXXx8W2VdfWZ1bmN0aW9uIHMoZSl7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5zb3VyY2V8fGV9ZnVuY3Rpb24gdCh0LHIpe3JldHVybiBuZXcgUmVnRXhwKG4odCksIm0iKyhlLmNJPyJpIjoiIikrKHI/ImciOiIiKSl9ZnVuY3Rpb24gcihhLGkpe2lmKCFhLmNvbXBpbGVkKXtpZihhLmNvbXBpbGVkPSEwLGEuaz1hLmt8fGEuYkssYS5rKXt2YXIgbz17fSx1PWZ1bmN0aW9uKG4sdCl7ZS5jSSYmKHQ9dC50b0xvd2VyQ2FzZSgpKSx0LnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KCJ8Iik7b1t0WzBdXT1bbix0WzFdP051bWJlcih0WzFdKToxXX0pfTsic3RyaW5nIj09dHlwZW9mIGEuaz91KCJrZXl3b3JkIixhLmspOngoYS5rKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3UoZSxhLmtbZV0pfSksYS5rPW99YS5sUj10KGEubHx8L1x3Ky8sITApLGkmJihhLmJLJiYoYS5iPSJcXGIoIithLmJLLnNwbGl0KCIgIikuam9pbigifCIpKyIpXFxiIiksYS5ifHwoYS5iPS9cQnxcYi8pLGEuYlI9dChhLmIpLGEuZXx8YS5lV3x8KGEuZT0vXEJ8XGIvKSxhLmUmJihhLmVSPXQoYS5lKSksYS50RT1uKGEuZSl8fCIiLGEuZVcmJmkudEUmJihhLnRFKz0oYS5lPyJ8IjoiIikraS50RSkpLGEuaSYmKGEuaVI9dChhLmkpKSxudWxsPT1hLnImJihhLnI9MSksYS5jfHwoYS5jPVtdKSxhLmM9QXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSxhLmMubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBsKCJzZWxmIj09PWU/YTplKX0pKSxhLmMuZm9yRWFjaChmdW5jdGlvbihlKXtyKGUsYSl9KSxhLnN0YXJ0cyYmcihhLnN0YXJ0cyxpKTt2YXIgYz1hLmMubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLmJLPyJcXC4/KCIrZS5iKyIpXFwuPyI6ZS5ifSkuY29uY2F0KFthLnRFLGEuaV0pLm1hcChuKS5maWx0ZXIoQm9vbGVhbik7YS50PWMubGVuZ3RoP3QoYy5qb2luKCJ8IiksITApOntleGVjOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9fX19cihlKX1mdW5jdGlvbiBmKGUsdCxhLGkpe2Z1bmN0aW9uIG8oZSxuKXt2YXIgdCxhO2Zvcih0PTAsYT1uLmMubGVuZ3RoO2E+dDt0KyspaWYocihuLmNbdF0uYlIsZSkpcmV0dXJuIG4uY1t0XX1mdW5jdGlvbiB1KGUsbil7aWYocihlLmVSLG4pKXtmb3IoO2UuZW5kc1BhcmVudCYmZS5wYXJlbnQ7KWU9ZS5wYXJlbnQ7cmV0dXJuIGV9cmV0dXJuIGUuZVc/dShlLnBhcmVudCxuKTp2b2lkIDB9ZnVuY3Rpb24gYyhlLG4pe3JldHVybiFhJiZyKG4uaVIsZSl9ZnVuY3Rpb24gbChlLG4pe3ZhciB0PU4uY0k/blswXS50b0xvd2VyQ2FzZSgpOm5bMF07cmV0dXJuIGUuay5oYXNPd25Qcm9wZXJ0eSh0KSYmZS5rW3RdfWZ1bmN0aW9uIHAoZSxuLHQscil7dmFyIGE9cj8iIjpJLmNsYXNzUHJlZml4LGk9JzxzcGFuIGNsYXNzPSInK2Esbz10PyIiOkM7cmV0dXJuIGkrPWUrJyI+JyxpK24rb31mdW5jdGlvbiBoKCl7dmFyIGUsdCxyLGE7aWYoIUUuaylyZXR1cm4gbihrKTtmb3IoYT0iIix0PTAsRS5sUi5sYXN0SW5kZXg9MCxyPUUubFIuZXhlYyhrKTtyOylhKz1uKGsuc3Vic3RyaW5nKHQsci5pbmRleCkpLGU9bChFLHIpLGU/KEIrPWVbMV0sYSs9cChlWzBdLG4oclswXSkpKTphKz1uKHJbMF0pLHQ9RS5sUi5sYXN0SW5kZXgscj1FLmxSLmV4ZWMoayk7cmV0dXJuIGErbihrLnN1YnN0cih0KSl9ZnVuY3Rpb24gZCgpe3ZhciBlPSJzdHJpbmciPT10eXBlb2YgRS5zTDtpZihlJiYheVtFLnNMXSlyZXR1cm4gbihrKTt2YXIgdD1lP2YoRS5zTCxrLCEwLHhbRS5zTF0pOmcoayxFLnNMLmxlbmd0aD9FLnNMOnZvaWQgMCk7cmV0dXJuIEUucj4wJiYoQis9dC5yKSxlJiYoeFtFLnNMXT10LnRvcCkscCh0Lmxhbmd1YWdlLHQudmFsdWUsITEsITApfWZ1bmN0aW9uIGIoKXtMKz1udWxsIT1FLnNMP2QoKTpoKCksaz0iIn1mdW5jdGlvbiB2KGUpe0wrPWUuY04/cChlLmNOLCIiLCEwKToiIixFPU9iamVjdC5jcmVhdGUoZSx7cGFyZW50Ont2YWx1ZTpFfX0pfWZ1bmN0aW9uIG0oZSxuKXtpZihrKz1lLG51bGw9PW4pcmV0dXJuIGIoKSwwO3ZhciB0PW8obixFKTtpZih0KXJldHVybiB0LnNraXA/ays9bjoodC5lQiYmKGsrPW4pLGIoKSx0LnJCfHx0LmVCfHwoaz1uKSksdih0LG4pLHQuckI/MDpuLmxlbmd0aDt2YXIgcj11KEUsbik7aWYocil7dmFyIGE9RTthLnNraXA/ays9bjooYS5yRXx8YS5lRXx8KGsrPW4pLGIoKSxhLmVFJiYoaz1uKSk7ZG8gRS5jTiYmKEwrPUMpLEUuc2tpcHx8KEIrPUUuciksRT1FLnBhcmVudDt3aGlsZShFIT09ci5wYXJlbnQpO3JldHVybiByLnN0YXJ0cyYmdihyLnN0YXJ0cywiIiksYS5yRT8wOm4ubGVuZ3RofWlmKGMobixFKSl0aHJvdyBuZXcgRXJyb3IoJ0lsbGVnYWwgbGV4ZW1lICInK24rJyIgZm9yIG1vZGUgIicrKEUuY058fCI8dW5uYW1lZD4iKSsnIicpO3JldHVybiBrKz1uLG4ubGVuZ3RofHwxfXZhciBOPXcoZSk7aWYoIU4pdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGxhbmd1YWdlOiAiJytlKyciJyk7cyhOKTt2YXIgUixFPWl8fE4seD17fSxMPSIiO2ZvcihSPUU7UiE9PU47Uj1SLnBhcmVudClSLmNOJiYoTD1wKFIuY04sIiIsITApK0wpO3ZhciBrPSIiLEI9MDt0cnl7Zm9yKHZhciBNLGosTz0wOzspe2lmKEUudC5sYXN0SW5kZXg9TyxNPUUudC5leGVjKHQpLCFNKWJyZWFrO2o9bSh0LnN1YnN0cmluZyhPLE0uaW5kZXgpLE1bMF0pLE89TS5pbmRleCtqfWZvcihtKHQuc3Vic3RyKE8pKSxSPUU7Ui5wYXJlbnQ7Uj1SLnBhcmVudClSLmNOJiYoTCs9Qyk7cmV0dXJue3I6Qix2YWx1ZTpMLGxhbmd1YWdlOmUsdG9wOkV9fWNhdGNoKFQpe2lmKFQubWVzc2FnZSYmLTEhPT1ULm1lc3NhZ2UuaW5kZXhPZigiSWxsZWdhbCIpKXJldHVybntyOjAsdmFsdWU6bih0KX07dGhyb3cgVH19ZnVuY3Rpb24gZyhlLHQpe3Q9dHx8SS5sYW5ndWFnZXN8fHgoeSk7dmFyIHI9e3I6MCx2YWx1ZTpuKGUpfSxhPXI7cmV0dXJuIHQuZmlsdGVyKHcpLmZvckVhY2goZnVuY3Rpb24obil7dmFyIHQ9ZihuLGUsITEpO3QubGFuZ3VhZ2U9bix0LnI+YS5yJiYoYT10KSx0LnI+ci5yJiYoYT1yLHI9dCl9KSxhLmxhbmd1YWdlJiYoci5zZWNvbmRfYmVzdD1hKSxyfWZ1bmN0aW9uIHAoZSl7cmV0dXJuIEkudGFiUmVwbGFjZXx8SS51c2VCUj9lLnJlcGxhY2UoTSxmdW5jdGlvbihlLG4pe3JldHVybiBJLnVzZUJSJiYiXG4iPT09ZT8iPGJyPiI6SS50YWJSZXBsYWNlP24ucmVwbGFjZSgvXHQvZyxJLnRhYlJlcGxhY2UpOiIifSk6ZX1mdW5jdGlvbiBoKGUsbix0KXt2YXIgcj1uP0xbbl06dCxhPVtlLnRyaW0oKV07cmV0dXJuIGUubWF0Y2goL1xiaGxqc1xiLyl8fGEucHVzaCgiaGxqcyIpLC0xPT09ZS5pbmRleE9mKHIpJiZhLnB1c2gociksYS5qb2luKCIgIikudHJpbSgpfWZ1bmN0aW9uIGQoZSl7dmFyIG4sdCxyLG8sbCxzPWkoZSk7YShzKXx8KEkudXNlQlI/KG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiwiZGl2Iiksbi5pbm5lckhUTUw9ZS5pbm5lckhUTUwucmVwbGFjZSgvXG4vZywiIikucmVwbGFjZSgvPGJyWyBcL10qPi9nLCJcbiIpKTpuPWUsbD1uLnRleHRDb250ZW50LHI9cz9mKHMsbCwhMCk6ZyhsKSx0PXUobiksdC5sZW5ndGgmJihvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIsImRpdiIpLG8uaW5uZXJIVE1MPXIudmFsdWUsci52YWx1ZT1jKHQsdShvKSxsKSksci52YWx1ZT1wKHIudmFsdWUpLGUuaW5uZXJIVE1MPXIudmFsdWUsZS5jbGFzc05hbWU9aChlLmNsYXNzTmFtZSxzLHIubGFuZ3VhZ2UpLGUucmVzdWx0PXtsYW5ndWFnZTpyLmxhbmd1YWdlLHJlOnIucn0sci5zZWNvbmRfYmVzdCYmKGUuc2Vjb25kX2Jlc3Q9e2xhbmd1YWdlOnIuc2Vjb25kX2Jlc3QubGFuZ3VhZ2UscmU6ci5zZWNvbmRfYmVzdC5yfSkpfWZ1bmN0aW9uIGIoZSl7ST1vKEksZSl9ZnVuY3Rpb24gdigpe2lmKCF2LmNhbGxlZCl7di5jYWxsZWQ9ITA7dmFyIGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgicHJlIGNvZGUiKTtFLmZvckVhY2guY2FsbChlLGQpfX1mdW5jdGlvbiBtKCl7YWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsdiwhMSksYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsdiwhMSl9ZnVuY3Rpb24gTihuLHQpe3ZhciByPXlbbl09dChlKTtyLmFsaWFzZXMmJnIuYWxpYXNlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe0xbZV09bn0pfWZ1bmN0aW9uIFIoKXtyZXR1cm4geCh5KX1mdW5jdGlvbiB3KGUpe3JldHVybiBlPShlfHwiIikudG9Mb3dlckNhc2UoKSx5W2VdfHx5W0xbZV1dfXZhciBFPVtdLHg9T2JqZWN0LmtleXMseT17fSxMPXt9LGs9L14obm8tP2hpZ2hsaWdodHxwbGFpbnx0ZXh0KSQvaSxCPS9cYmxhbmcoPzp1YWdlKT8tKFtcdy1dKylcYi9pLE09LygoXig8W14+XSs+fFx0fCkrfCg/OlxuKSkpL2dtLEM9Ijwvc3Bhbj4iLEk9e2NsYXNzUHJlZml4OiJobGpzLSIsdGFiUmVwbGFjZTpudWxsLHVzZUJSOiExLGxhbmd1YWdlczp2b2lkIDB9O3JldHVybiBlLmhpZ2hsaWdodD1mLGUuaGlnaGxpZ2h0QXV0bz1nLGUuZml4TWFya3VwPXAsZS5oaWdobGlnaHRCbG9jaz1kLGUuY29uZmlndXJlPWIsZS5pbml0SGlnaGxpZ2h0aW5nPXYsZS5pbml0SGlnaGxpZ2h0aW5nT25Mb2FkPW0sZS5yZWdpc3Rlckxhbmd1YWdlPU4sZS5saXN0TGFuZ3VhZ2VzPVIsZS5nZXRMYW5ndWFnZT13LGUuaW5oZXJpdD1vLGUuSVI9IlthLXpBLVpdXFx3KiIsZS5VSVI9IlthLXpBLVpfXVxcdyoiLGUuTlI9IlxcYlxcZCsoXFwuXFxkKyk/IixlLkNOUj0iKC0/KShcXGIwW3hYXVthLWZBLUYwLTldK3woXFxiXFxkKyhcXC5cXGQqKT98XFwuXFxkKykoW2VFXVstK10/XFxkKyk/KSIsZS5CTlI9IlxcYigwYlswMV0rKSIsZS5SU1I9IiF8IT18IT09fCV8JT18JnwmJnwmPXxcXCp8XFwqPXxcXCt8XFwrPXwsfC18LT18Lz18L3w6fDt8PDx8PDw9fDw9fDx8PT09fD09fD18Pj4+PXw+Pj18Pj18Pj4+fD4+fD58XFw/fFxcW3xcXHt8XFwofFxcXnxcXF49fFxcfHxcXHw9fFxcfFxcfHx+IixlLkJFPXtiOiJcXFxcW1xcc1xcU10iLHI6MH0sZS5BU009e2NOOiJzdHJpbmciLGI6IiciLGU6IiciLGk6IlxcbiIsYzpbZS5CRV19LGUuUVNNPXtjTjoic3RyaW5nIixiOiciJyxlOiciJyxpOiJcXG4iLGM6W2UuQkVdfSxlLlBXTT17YjovXGIoYXxhbnx0aGV8YXJlfEknbXxpc24ndHxkb24ndHxkb2Vzbid0fHdvbid0fGJ1dHxqdXN0fHNob3VsZHxwcmV0dHl8c2ltcGx5fGVub3VnaHxnb25uYXxnb2luZ3x3dGZ8c298c3VjaHx3aWxsfHlvdXx5b3VyfHRoZXl8bGlrZXxtb3JlKVxiL30sZS5DPWZ1bmN0aW9uKG4sdCxyKXt2YXIgYT1lLmluaGVyaXQoe2NOOiJjb21tZW50IixiOm4sZTp0LGM6W119LHJ8fHt9KTtyZXR1cm4gYS5jLnB1c2goZS5QV00pLGEuYy5wdXNoKHtjTjoiZG9jdGFnIixiOiIoPzpUT0RPfEZJWE1FfE5PVEV8QlVHfFhYWCk6IixyOjB9KSxhfSxlLkNMQ009ZS5DKCIvLyIsIiQiKSxlLkNCQ009ZS5DKCIvXFwqIiwiXFwqLyIpLGUuSENNPWUuQygiIyIsIiQiKSxlLk5NPXtjTjoibnVtYmVyIixiOmUuTlIscjowfSxlLkNOTT17Y046Im51bWJlciIsYjplLkNOUixyOjB9LGUuQk5NPXtjTjoibnVtYmVyIixiOmUuQk5SLHI6MH0sZS5DU1NOTT17Y046Im51bWJlciIsYjplLk5SKyIoJXxlbXxleHxjaHxyZW18dnd8dmh8dm1pbnx2bWF4fGNtfG1tfGlufHB0fHBjfHB4fGRlZ3xncmFkfHJhZHx0dXJufHN8bXN8SHp8a0h6fGRwaXxkcGNtfGRwcHgpPyIscjowfSxlLlJNPXtjTjoicmVnZXhwIixiOi9cLy8sZTovXC9bZ2ltdXldKi8saTovXG4vLGM6W2UuQkUse2I6L1xbLyxlOi9cXS8scjowLGM6W2UuQkVdfV19LGUuVE09e2NOOiJ0aXRsZSIsYjplLklSLHI6MH0sZS5VVE09e2NOOiJ0aXRsZSIsYjplLlVJUixyOjB9LGUuTUVUSE9EX0dVQVJEPXtiOiJcXC5cXHMqIitlLlVJUixyOjB9LGV9KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoInNxbCIsZnVuY3Rpb24oZSl7dmFyIHQ9ZS5DKCItLSIsIiQiKTtyZXR1cm57Y0k6ITAsaTovWzw+e30qI10vLGM6W3tiSzoiYmVnaW4gZW5kIHN0YXJ0IGNvbW1pdCByb2xsYmFjayBzYXZlcG9pbnQgbG9jayBhbHRlciBjcmVhdGUgZHJvcCByZW5hbWUgY2FsbCBkZWxldGUgZG8gaGFuZGxlciBpbnNlcnQgbG9hZCByZXBsYWNlIHNlbGVjdCB0cnVuY2F0ZSB1cGRhdGUgc2V0IHNob3cgcHJhZ21hIGdyYW50IG1lcmdlIGRlc2NyaWJlIHVzZSBleHBsYWluIGhlbHAgZGVjbGFyZSBwcmVwYXJlIGV4ZWN1dGUgZGVhbGxvY2F0ZSByZWxlYXNlIHVubG9jayBwdXJnZSByZXNldCBjaGFuZ2Ugc3RvcCBhbmFseXplIGNhY2hlIGZsdXNoIG9wdGltaXplIHJlcGFpciBraWxsIGluc3RhbGwgdW5pbnN0YWxsIGNoZWNrc3VtIHJlc3RvcmUgY2hlY2sgYmFja3VwIHJldm9rZSBjb21tZW50IixlOi87LyxlVzohMCxsOi9bXHdcLl0rLyxrOntrZXl3b3JkOiJhYm9ydCBhYnMgYWJzb2x1dGUgYWNjIGFjY2UgYWNjZXAgYWNjZXB0IGFjY2VzcyBhY2Nlc3NlZCBhY2Nlc3NpYmxlIGFjY291bnQgYWNvcyBhY3Rpb24gYWN0aXZhdGUgYWRkIGFkZHRpbWUgYWRtaW4gYWRtaW5pc3RlciBhZHZhbmNlZCBhZHZpc2UgYWVzX2RlY3J5cHQgYWVzX2VuY3J5cHQgYWZ0ZXIgYWdlbnQgYWdncmVnYXRlIGFsaSBhbGlhIGFsaWFzIGFsbG9jYXRlIGFsbG93IGFsdGVyIGFsd2F5cyBhbmFseXplIGFuY2lsbGFyeSBhbmQgYW55IGFueWRhdGEgYW55ZGF0YXNldCBhbnlzY2hlbWEgYW55dHlwZSBhcHBseSBhcmNoaXZlIGFyY2hpdmVkIGFyY2hpdmVsb2cgYXJlIGFzIGFzYyBhc2NpaSBhc2luIGFzc2VtYmx5IGFzc2VydGlvbiBhc3NvY2lhdGUgYXN5bmNocm9ub3VzIGF0IGF0YW4gYXRuMiBhdHRyIGF0dHJpIGF0dHJpYiBhdHRyaWJ1IGF0dHJpYnV0IGF0dHJpYnV0ZSBhdHRyaWJ1dGVzIGF1ZGl0IGF1dGhlbnRpY2F0ZWQgYXV0aGVudGljYXRpb24gYXV0aGlkIGF1dGhvcnMgYXV0byBhdXRvYWxsb2NhdGUgYXV0b2RibGluayBhdXRvZXh0ZW5kIGF1dG9tYXRpYyBhdmFpbGFiaWxpdHkgYXZnIGJhY2t1cCBiYWRmaWxlIGJhc2ljZmlsZSBiZWZvcmUgYmVnaW4gYmVnaW5uaW5nIGJlbmNobWFyayBiZXR3ZWVuIGJmaWxlIGJmaWxlX2Jhc2UgYmlnIGJpZ2ZpbGUgYmluIGJpbmFyeV9kb3VibGUgYmluYXJ5X2Zsb2F0IGJpbmxvZyBiaXRfYW5kIGJpdF9jb3VudCBiaXRfbGVuZ3RoIGJpdF9vciBiaXRfeG9yIGJpdG1hcCBibG9iX2Jhc2UgYmxvY2sgYmxvY2tzaXplIGJvZHkgYm90aCBib3VuZCBidWZmZXJfY2FjaGUgYnVmZmVyX3Bvb2wgYnVpbGQgYnVsayBieSBieXRlIGJ5dGVvcmRlcm1hcmsgYnl0ZXMgY2FjaGUgY2FjaGluZyBjYWxsIGNhbGxpbmcgY2FuY2VsIGNhcGFjaXR5IGNhc2NhZGUgY2FzY2FkZWQgY2FzZSBjYXN0IGNhdGFsb2cgY2F0ZWdvcnkgY2VpbCBjZWlsaW5nIGNoYWluIGNoYW5nZSBjaGFuZ2VkIGNoYXJfYmFzZSBjaGFyX2xlbmd0aCBjaGFyYWN0ZXJfbGVuZ3RoIGNoYXJhY3RlcnMgY2hhcmFjdGVyc2V0IGNoYXJpbmRleCBjaGFyc2V0IGNoYXJzZXRmb3JtIGNoYXJzZXRpZCBjaGVjayBjaGVja3N1bSBjaGVja3N1bV9hZ2cgY2hpbGQgY2hvb3NlIGNociBjaHVuayBjbGFzcyBjbGVhbnVwIGNsZWFyIGNsaWVudCBjbG9iIGNsb2JfYmFzZSBjbG9uZSBjbG9zZSBjbHVzdGVyX2lkIGNsdXN0ZXJfcHJvYmFiaWxpdHkgY2x1c3Rlcl9zZXQgY2x1c3RlcmluZyBjb2FsZXNjZSBjb2VyY2liaWxpdHkgY29sIGNvbGxhdGUgY29sbGF0aW9uIGNvbGxlY3QgY29sdSBjb2x1bSBjb2x1bW4gY29sdW1uX3ZhbHVlIGNvbHVtbnMgY29sdW1uc191cGRhdGVkIGNvbW1lbnQgY29tbWl0IGNvbXBhY3QgY29tcGF0aWJpbGl0eSBjb21waWxlZCBjb21wbGV0ZSBjb21wb3NpdGVfbGltaXQgY29tcG91bmQgY29tcHJlc3MgY29tcHV0ZSBjb25jYXQgY29uY2F0X3dzIGNvbmN1cnJlbnQgY29uZmlybSBjb25uIGNvbm5lYyBjb25uZWN0IGNvbm5lY3RfYnlfaXNjeWNsZSBjb25uZWN0X2J5X2lzbGVhZiBjb25uZWN0X2J5X3Jvb3QgY29ubmVjdF90aW1lIGNvbm5lY3Rpb24gY29uc2lkZXIgY29uc2lzdGVudCBjb25zdGFudCBjb25zdHJhaW50IGNvbnN0cmFpbnRzIGNvbnN0cnVjdG9yIGNvbnRhaW5lciBjb250ZW50IGNvbnRlbnRzIGNvbnRleHQgY29udHJpYnV0b3JzIGNvbnRyb2xmaWxlIGNvbnYgY29udmVydCBjb252ZXJ0X3R6IGNvcnIgY29ycl9rIGNvcnJfcyBjb3JyZXNwb25kaW5nIGNvcnJ1cHRpb24gY29zIGNvc3QgY291bnQgY291bnRfYmlnIGNvdW50ZWQgY292YXJfcG9wIGNvdmFyX3NhbXAgY3B1X3Blcl9jYWxsIGNwdV9wZXJfc2Vzc2lvbiBjcmMzMiBjcmVhdGUgY3JlYXRpb24gY3JpdGljYWwgY3Jvc3MgY3ViZSBjdW1lX2Rpc3QgY3VyZGF0ZSBjdXJyZW50IGN1cnJlbnRfZGF0ZSBjdXJyZW50X3RpbWUgY3VycmVudF90aW1lc3RhbXAgY3VycmVudF91c2VyIGN1cnNvciBjdXJ0aW1lIGN1c3RvbWRhdHVtIGN5Y2xlIGRhdGEgZGF0YWJhc2UgZGF0YWJhc2VzIGRhdGFmaWxlIGRhdGFmaWxlcyBkYXRhbGVuZ3RoIGRhdGVfYWRkIGRhdGVfY2FjaGUgZGF0ZV9mb3JtYXQgZGF0ZV9zdWIgZGF0ZWFkZCBkYXRlZGlmZiBkYXRlZnJvbXBhcnRzIGRhdGVuYW1lIGRhdGVwYXJ0IGRhdGV0aW1lMmZyb21wYXJ0cyBkYXkgZGF5X3RvX3NlY29uZCBkYXluYW1lIGRheW9mbW9udGggZGF5b2Z3ZWVrIGRheW9meWVhciBkYXlzIGRiX3JvbGVfY2hhbmdlIGRidGltZXpvbmUgZGRsIGRlYWxsb2NhdGUgZGVjbGFyZSBkZWNvZGUgZGVjb21wb3NlIGRlY3JlbWVudCBkZWNyeXB0IGRlZHVwbGljYXRlIGRlZiBkZWZhIGRlZmF1IGRlZmF1bCBkZWZhdWx0IGRlZmF1bHRzIGRlZmVycmVkIGRlZmkgZGVmaW4gZGVmaW5lIGRlZ3JlZXMgZGVsYXllZCBkZWxlZ2F0ZSBkZWxldGUgZGVsZXRlX2FsbCBkZWxpbWl0ZWQgZGVtYW5kIGRlbnNlX3JhbmsgZGVwdGggZGVxdWV1ZSBkZXNfZGVjcnlwdCBkZXNfZW5jcnlwdCBkZXNfa2V5X2ZpbGUgZGVzYyBkZXNjciBkZXNjcmkgZGVzY3JpYiBkZXNjcmliZSBkZXNjcmlwdG9yIGRldGVybWluaXN0aWMgZGlhZ25vc3RpY3MgZGlmZmVyZW5jZSBkaW1lbnNpb24gZGlyZWN0X2xvYWQgZGlyZWN0b3J5IGRpc2FibGUgZGlzYWJsZV9hbGwgZGlzYWxsb3cgZGlzYXNzb2NpYXRlIGRpc2NhcmRmaWxlIGRpc2Nvbm5lY3QgZGlza2dyb3VwIGRpc3RpbmN0IGRpc3RpbmN0cm93IGRpc3RyaWJ1dGUgZGlzdHJpYnV0ZWQgZGl2IGRvIGRvY3VtZW50IGRvbWFpbiBkb3RuZXQgZG91YmxlIGRvd25ncmFkZSBkcm9wIGR1bXBmaWxlIGR1cGxpY2F0ZSBkdXJhdGlvbiBlYWNoIGVkaXRpb24gZWRpdGlvbmFibGUgZWRpdGlvbnMgZWxlbWVudCBlbGxpcHNpcyBlbHNlIGVsc2lmIGVsdCBlbXB0eSBlbmFibGUgZW5hYmxlX2FsbCBlbmNsb3NlZCBlbmNvZGUgZW5jb2RpbmcgZW5jcnlwdCBlbmQgZW5kLWV4ZWMgZW5kaWFuIGVuZm9yY2VkIGVuZ2luZSBlbmdpbmVzIGVucXVldWUgZW50ZXJwcmlzZSBlbnRpdHllc2NhcGluZyBlb21vbnRoIGVycm9yIGVycm9ycyBlc2NhcGVkIGV2YWxuYW1lIGV2YWx1YXRlIGV2ZW50IGV2ZW50ZGF0YSBldmVudHMgZXhjZXB0IGV4Y2VwdGlvbiBleGNlcHRpb25zIGV4Y2hhbmdlIGV4Y2x1ZGUgZXhjbHVkaW5nIGV4ZWN1IGV4ZWN1dCBleGVjdXRlIGV4ZW1wdCBleGlzdHMgZXhpdCBleHAgZXhwaXJlIGV4cGxhaW4gZXhwb3J0IGV4cG9ydF9zZXQgZXh0ZW5kZWQgZXh0ZW50IGV4dGVybmFsIGV4dGVybmFsXzEgZXh0ZXJuYWxfMiBleHRlcm5hbGx5IGV4dHJhY3QgZmFpbGVkIGZhaWxlZF9sb2dpbl9hdHRlbXB0cyBmYWlsb3ZlciBmYWlsdXJlIGZhciBmYXN0IGZlYXR1cmVfc2V0IGZlYXR1cmVfdmFsdWUgZmV0Y2ggZmllbGQgZmllbGRzIGZpbGUgZmlsZV9uYW1lX2NvbnZlcnQgZmlsZXN5c3RlbV9saWtlX2xvZ2dpbmcgZmluYWwgZmluaXNoIGZpcnN0IGZpcnN0X3ZhbHVlIGZpeGVkIGZsYXNoX2NhY2hlIGZsYXNoYmFjayBmbG9vciBmbHVzaCBmb2xsb3dpbmcgZm9sbG93cyBmb3IgZm9yYWxsIGZvcmNlIGZvcm0gZm9ybWEgZm9ybWF0IGZvdW5kIGZvdW5kX3Jvd3MgZnJlZWxpc3QgZnJlZWxpc3RzIGZyZWVwb29scyBmcmVzaCBmcm9tIGZyb21fYmFzZTY0IGZyb21fZGF5cyBmdHAgZnVsbCBmdW5jdGlvbiBnZW5lcmFsIGdlbmVyYXRlZCBnZXQgZ2V0X2Zvcm1hdCBnZXRfbG9jayBnZXRkYXRlIGdldHV0Y2RhdGUgZ2xvYmFsIGdsb2JhbF9uYW1lIGdsb2JhbGx5IGdvIGdvdG8gZ3JhbnQgZ3JhbnRzIGdyZWF0ZXN0IGdyb3VwIGdyb3VwX2NvbmNhdCBncm91cF9pZCBncm91cGluZyBncm91cGluZ19pZCBncm91cHMgZ3RpZF9zdWJ0cmFjdCBndWFyYW50ZWUgZ3VhcmQgaGFuZGxlciBoYXNoIGhhc2hrZXlzIGhhdmluZyBoZWEgaGVhZCBoZWFkaSBoZWFkaW4gaGVhZGluZyBoZWFwIGhlbHAgaGV4IGhpZXJhcmNoeSBoaWdoIGhpZ2hfcHJpb3JpdHkgaG9zdHMgaG91ciBodHRwIGlkIGlkZW50X2N1cnJlbnQgaWRlbnRfaW5jciBpZGVudF9zZWVkIGlkZW50aWZpZWQgaWRlbnRpdHkgaWRsZV90aW1lIGlmIGlmbnVsbCBpZ25vcmUgaWlmIGlsaWtlIGlsbSBpbW1lZGlhdGUgaW1wb3J0IGluIGluY2x1ZGUgaW5jbHVkaW5nIGluY3JlbWVudCBpbmRleCBpbmRleGVzIGluZGV4aW5nIGluZGV4dHlwZSBpbmRpY2F0b3IgaW5kaWNlcyBpbmV0Nl9hdG9uIGluZXQ2X250b2EgaW5ldF9hdG9uIGluZXRfbnRvYSBpbmZpbGUgaW5pdGlhbCBpbml0aWFsaXplZCBpbml0aWFsbHkgaW5pdHJhbnMgaW5tZW1vcnkgaW5uZXIgaW5ub2RiIGlucHV0IGluc2VydCBpbnN0YWxsIGluc3RhbmNlIGluc3RhbnRpYWJsZSBpbnN0ciBpbnRlcmZhY2UgaW50ZXJsZWF2ZWQgaW50ZXJzZWN0IGludG8gaW52YWxpZGF0ZSBpbnZpc2libGUgaXMgaXNfZnJlZV9sb2NrIGlzX2lwdjQgaXNfaXB2NF9jb21wYXQgaXNfbm90IGlzX25vdF9udWxsIGlzX3VzZWRfbG9jayBpc2RhdGUgaXNudWxsIGlzb2xhdGlvbiBpdGVyYXRlIGphdmEgam9pbiBqc29uIGpzb25fZXhpc3RzIGtlZXAga2VlcF9kdXBsaWNhdGVzIGtleSBrZXlzIGtpbGwgbGFuZ3VhZ2UgbGFyZ2UgbGFzdCBsYXN0X2RheSBsYXN0X2luc2VydF9pZCBsYXN0X3ZhbHVlIGxheCBsY2FzZSBsZWFkIGxlYWRpbmcgbGVhc3QgbGVhdmVzIGxlZnQgbGVuIGxlbmdodCBsZW5ndGggbGVzcyBsZXZlbCBsZXZlbHMgbGlicmFyeSBsaWtlIGxpa2UyIGxpa2U0IGxpa2VjIGxpbWl0IGxpbmVzIGxpbmsgbGlzdCBsaXN0YWdnIGxpdHRsZSBsbiBsb2FkIGxvYWRfZmlsZSBsb2IgbG9icyBsb2NhbCBsb2NhbHRpbWUgbG9jYWx0aW1lc3RhbXAgbG9jYXRlIGxvY2F0b3IgbG9jayBsb2NrZWQgbG9nIGxvZzEwIGxvZzIgbG9nZmlsZSBsb2dmaWxlcyBsb2dnaW5nIGxvZ2ljYWwgbG9naWNhbF9yZWFkc19wZXJfY2FsbCBsb2dvZmYgbG9nb24gbG9ncyBsb25nIGxvb3AgbG93IGxvd19wcmlvcml0eSBsb3dlciBscGFkIGxydHJpbSBsdHJpbSBtYWluIG1ha2Vfc2V0IG1ha2VkYXRlIG1ha2V0aW1lIG1hbmFnZWQgbWFuYWdlbWVudCBtYW51YWwgbWFwIG1hcHBpbmcgbWFzayBtYXN0ZXIgbWFzdGVyX3Bvc193YWl0IG1hdGNoIG1hdGNoZWQgbWF0ZXJpYWxpemVkIG1heCBtYXhleHRlbnRzIG1heGltaXplIG1heGluc3RhbmNlcyBtYXhsZW4gbWF4bG9nZmlsZXMgbWF4bG9naGlzdG9yeSBtYXhsb2dtZW1iZXJzIG1heHNpemUgbWF4dHJhbnMgbWQ1IG1lYXN1cmVzIG1lZGlhbiBtZWRpdW0gbWVtYmVyIG1lbWNvbXByZXNzIG1lbW9yeSBtZXJnZSBtaWNyb3NlY29uZCBtaWQgbWlncmF0aW9uIG1pbiBtaW5leHRlbnRzIG1pbmltdW0gbWluaW5nIG1pbnVzIG1pbnV0ZSBtaW52YWx1ZSBtaXNzaW5nIG1vZCBtb2RlIG1vZGVsIG1vZGlmaWNhdGlvbiBtb2RpZnkgbW9kdWxlIG1vbml0b3JpbmcgbW9udGggbW9udGhzIG1vdW50IG1vdmUgbW92ZW1lbnQgbXVsdGlzZXQgbXV0ZXggbmFtZSBuYW1lX2NvbnN0IG5hbWVzIG5hbiBuYXRpb25hbCBuYXRpdmUgbmF0dXJhbCBuYXYgbmNoYXIgbmNsb2IgbmVzdGVkIG5ldmVyIG5ldyBuZXdsaW5lIG5leHQgbmV4dHZhbCBubyBub193cml0ZV90b19iaW5sb2cgbm9hcmNoaXZlbG9nIG5vYXVkaXQgbm9iYWRmaWxlIG5vY2hlY2sgbm9jb21wcmVzcyBub2NvcHkgbm9jeWNsZSBub2RlbGF5IG5vZGlzY2FyZGZpbGUgbm9lbnRpdHllc2NhcGluZyBub2d1YXJhbnRlZSBub2tlZXAgbm9sb2dmaWxlIG5vbWFwcGluZyBub21heHZhbHVlIG5vbWluaW1pemUgbm9taW52YWx1ZSBub21vbml0b3Jpbmcgbm9uZSBub25lZGl0aW9uYWJsZSBub25zY2hlbWEgbm9vcmRlciBub3ByIG5vcHJvIG5vcHJvbSBub3Byb21wIG5vcHJvbXB0IG5vcmVseSBub3Jlc2V0bG9ncyBub3JldmVyc2Ugbm9ybWFsIG5vcm93ZGVwZW5kZW5jaWVzIG5vc2NoZW1hY2hlY2sgbm9zd2l0Y2ggbm90IG5vdGhpbmcgbm90aWNlIG5vdHJpbSBub3ZhbGlkYXRlIG5vdyBub3dhaXQgbnRoX3ZhbHVlIG51bGxpZiBudWxscyBudW0gbnVtYiBudW1iZSBudmFyY2hhciBudmFyY2hhcjIgb2JqZWN0IG9jaWNvbGwgb2NpZGF0ZSBvY2lkYXRldGltZSBvY2lkdXJhdGlvbiBvY2lpbnRlcnZhbCBvY2lsb2Jsb2NhdG9yIG9jaW51bWJlciBvY2lyZWYgb2NpcmVmY3Vyc29yIG9jaXJvd2lkIG9jaXN0cmluZyBvY2l0eXBlIG9jdCBvY3RldF9sZW5ndGggb2Ygb2ZmIG9mZmxpbmUgb2Zmc2V0IG9pZCBvaWRpbmRleCBvbGQgb24gb25saW5lIG9ubHkgb3BhcXVlIG9wZW4gb3BlcmF0aW9ucyBvcGVyYXRvciBvcHRpbWFsIG9wdGltaXplIG9wdGlvbiBvcHRpb25hbGx5IG9yIG9yYWNsZSBvcmFjbGVfZGF0ZSBvcmFkYXRhIG9yZCBvcmRhdWRpbyBvcmRkaWNvbSBvcmRkb2Mgb3JkZXIgb3JkaW1hZ2Ugb3JkaW5hbGl0eSBvcmR2aWRlbyBvcmdhbml6YXRpb24gb3JsYW55IG9ybHZhcnkgb3V0IG91dGVyIG91dGZpbGUgb3V0bGluZSBvdXRwdXQgb3ZlciBvdmVyZmxvdyBvdmVycmlkaW5nIHBhY2thZ2UgcGFkIHBhcmFsbGVsIHBhcmFsbGVsX2VuYWJsZSBwYXJhbWV0ZXJzIHBhcmVudCBwYXJzZSBwYXJ0aWFsIHBhcnRpdGlvbiBwYXJ0aXRpb25zIHBhc2NhbCBwYXNzaW5nIHBhc3N3b3JkIHBhc3N3b3JkX2dyYWNlX3RpbWUgcGFzc3dvcmRfbG9ja190aW1lIHBhc3N3b3JkX3JldXNlX21heCBwYXNzd29yZF9yZXVzZV90aW1lIHBhc3N3b3JkX3ZlcmlmeV9mdW5jdGlvbiBwYXRjaCBwYXRoIHBhdGluZGV4IHBjdGluY3JlYXNlIHBjdHRocmVzaG9sZCBwY3R1c2VkIHBjdHZlcnNpb24gcGVyY2VudCBwZXJjZW50X3JhbmsgcGVyY2VudGlsZV9jb250IHBlcmNlbnRpbGVfZGlzYyBwZXJmb3JtYW5jZSBwZXJpb2QgcGVyaW9kX2FkZCBwZXJpb2RfZGlmZiBwZXJtYW5lbnQgcGh5c2ljYWwgcGkgcGlwZSBwaXBlbGluZWQgcGl2b3QgcGx1Z2dhYmxlIHBsdWdpbiBwb2xpY3kgcG9zaXRpb24gcG9zdF90cmFuc2FjdGlvbiBwb3cgcG93ZXIgcHJhZ21hIHByZWJ1aWx0IHByZWNlZGVzIHByZWNlZGluZyBwcmVjaXNpb24gcHJlZGljdGlvbiBwcmVkaWN0aW9uX2Nvc3QgcHJlZGljdGlvbl9kZXRhaWxzIHByZWRpY3Rpb25fcHJvYmFiaWxpdHkgcHJlZGljdGlvbl9zZXQgcHJlcGFyZSBwcmVzZW50IHByZXNlcnZlIHByaW9yIHByaW9yaXR5IHByaXZhdGUgcHJpdmF0ZV9zZ2EgcHJpdmlsZWdlcyBwcm9jZWR1cmFsIHByb2NlZHVyZSBwcm9jZWR1cmVfYW5hbHl6ZSBwcm9jZXNzbGlzdCBwcm9maWxlcyBwcm9qZWN0IHByb21wdCBwcm90ZWN0aW9uIHB1YmxpYyBwdWJsaXNoaW5nc2VydmVybmFtZSBwdXJnZSBxdWFydGVyIHF1ZXJ5IHF1aWNrIHF1aWVzY2UgcXVvdGEgcXVvdGVuYW1lIHJhZGlhbnMgcmFpc2UgcmFuZCByYW5nZSByYW5rIHJhdyByZWFkIHJlYWRzIHJlYWRzaXplIHJlYnVpbGQgcmVjb3JkIHJlY29yZHMgcmVjb3ZlciByZWNvdmVyeSByZWN1cnNpdmUgcmVjeWNsZSByZWRvIHJlZHVjZWQgcmVmIHJlZmVyZW5jZSByZWZlcmVuY2VkIHJlZmVyZW5jZXMgcmVmZXJlbmNpbmcgcmVmcmVzaCByZWdleHBfbGlrZSByZWdpc3RlciByZWdyX2F2Z3ggcmVncl9hdmd5IHJlZ3JfY291bnQgcmVncl9pbnRlcmNlcHQgcmVncl9yMiByZWdyX3Nsb3BlIHJlZ3Jfc3h4IHJlZ3Jfc3h5IHJlamVjdCByZWtleSByZWxhdGlvbmFsIHJlbGF0aXZlIHJlbGF5bG9nIHJlbGVhc2UgcmVsZWFzZV9sb2NrIHJlbGllc19vbiByZWxvY2F0ZSByZWx5IHJlbSByZW1haW5kZXIgcmVuYW1lIHJlcGFpciByZXBlYXQgcmVwbGFjZSByZXBsaWNhdGUgcmVwbGljYXRpb24gcmVxdWlyZWQgcmVzZXQgcmVzZXRsb2dzIHJlc2l6ZSByZXNvdXJjZSByZXNwZWN0IHJlc3RvcmUgcmVzdHJpY3RlZCByZXN1bHQgcmVzdWx0X2NhY2hlIHJlc3VtYWJsZSByZXN1bWUgcmV0ZW50aW9uIHJldHVybiByZXR1cm5pbmcgcmV0dXJucyByZXVzZSByZXZlcnNlIHJldm9rZSByaWdodCBybGlrZSByb2xlIHJvbGVzIHJvbGxiYWNrIHJvbGxpbmcgcm9sbHVwIHJvdW5kIHJvdyByb3dfY291bnQgcm93ZGVwZW5kZW5jaWVzIHJvd2lkIHJvd251bSByb3dzIHJ0cmltIHJ1bGVzIHNhZmUgc2FsdCBzYW1wbGUgc2F2ZSBzYXZlcG9pbnQgc2IxIHNiMiBzYjQgc2NhbiBzY2hlbWEgc2NoZW1hY2hlY2sgc2NuIHNjb3BlIHNjcm9sbCBzZG9fZ2VvcmFzdGVyIHNkb190b3BvX2dlb21ldHJ5IHNlYXJjaCBzZWNfdG9fdGltZSBzZWNvbmQgc2VjdGlvbiBzZWN1cmVmaWxlIHNlY3VyaXR5IHNlZWQgc2VnbWVudCBzZWxlY3Qgc2VsZiBzZXF1ZW5jZSBzZXF1ZW50aWFsIHNlcmlhbGl6YWJsZSBzZXJ2ZXIgc2VydmVyZXJyb3Igc2Vzc2lvbiBzZXNzaW9uX3VzZXIgc2Vzc2lvbnNfcGVyX3VzZXIgc2V0IHNldHMgc2V0dGluZ3Mgc2hhIHNoYTEgc2hhMiBzaGFyZSBzaGFyZWQgc2hhcmVkX3Bvb2wgc2hvcnQgc2hvdyBzaHJpbmsgc2h1dGRvd24gc2lfYXZlcmFnZWNvbG9yIHNpX2NvbG9yaGlzdG9ncmFtIHNpX2ZlYXR1cmVsaXN0IHNpX3Bvc2l0aW9uYWxjb2xvciBzaV9zdGlsbGltYWdlIHNpX3RleHR1cmUgc2libGluZ3Mgc2lkIHNpZ24gc2luIHNpemUgc2l6ZV90IHNpemVzIHNraXAgc2xhdmUgc2xlZXAgc21hbGxkYXRldGltZWZyb21wYXJ0cyBzbWFsbGZpbGUgc25hcHNob3Qgc29tZSBzb25hbWUgc29ydCBzb3VuZGV4IHNvdXJjZSBzcGFjZSBzcGFyc2Ugc3BmaWxlIHNwbGl0IHNxbCBzcWxfYmlnX3Jlc3VsdCBzcWxfYnVmZmVyX3Jlc3VsdCBzcWxfY2FjaGUgc3FsX2NhbGNfZm91bmRfcm93cyBzcWxfc21hbGxfcmVzdWx0IHNxbF92YXJpYW50X3Byb3BlcnR5IHNxbGNvZGUgc3FsZGF0YSBzcWxlcnJvciBzcWxuYW1lIHNxbHN0YXRlIHNxcnQgc3F1YXJlIHN0YW5kYWxvbmUgc3RhbmRieSBzdGFydCBzdGFydGluZyBzdGFydHVwIHN0YXRlbWVudCBzdGF0aWMgc3RhdGlzdGljcyBzdGF0c19iaW5vbWlhbF90ZXN0IHN0YXRzX2Nyb3NzdGFiIHN0YXRzX2tzX3Rlc3Qgc3RhdHNfbW9kZSBzdGF0c19td190ZXN0IHN0YXRzX29uZV93YXlfYW5vdmEgc3RhdHNfdF90ZXN0XyBzdGF0c190X3Rlc3RfaW5kZXAgc3RhdHNfdF90ZXN0X29uZSBzdGF0c190X3Rlc3RfcGFpcmVkIHN0YXRzX3dzcl90ZXN0IHN0YXR1cyBzdGQgc3RkZGV2IHN0ZGRldl9wb3Agc3RkZGV2X3NhbXAgc3RkZXYgc3RvcCBzdG9yYWdlIHN0b3JlIHN0b3JlZCBzdHIgc3RyX3RvX2RhdGUgc3RyYWlnaHRfam9pbiBzdHJjbXAgc3RyaWN0IHN0cmluZyBzdHJ1Y3Qgc3R1ZmYgc3R5bGUgc3ViZGF0ZSBzdWJwYXJ0aXRpb24gc3VicGFydGl0aW9ucyBzdWJzdGl0dXRhYmxlIHN1YnN0ciBzdWJzdHJpbmcgc3VidGltZSBzdWJ0cmluZ19pbmRleCBzdWJ0eXBlIHN1Y2Nlc3Mgc3VtIHN1c3BlbmQgc3dpdGNoIHN3aXRjaG9mZnNldCBzd2l0Y2hvdmVyIHN5bmMgc3luY2hyb25vdXMgc3lub255bSBzeXMgc3lzX3htbGFnZyBzeXNhc20gc3lzYXV4IHN5c2RhdGUgc3lzZGF0ZXRpbWVvZmZzZXQgc3lzZGJhIHN5c29wZXIgc3lzdGVtIHN5c3RlbV91c2VyIHN5c3V0Y2RhdGV0aW1lIHRhYmxlIHRhYmxlcyB0YWJsZXNwYWNlIHRhbiB0ZG8gdGVtcGxhdGUgdGVtcG9yYXJ5IHRlcm1pbmF0ZWQgdGVydGlhcnlfd2VpZ2h0cyB0ZXN0IHRoYW4gdGhlbiB0aHJlYWQgdGhyb3VnaCB0aWVyIHRpZXMgdGltZSB0aW1lX2Zvcm1hdCB0aW1lX3pvbmUgdGltZWRpZmYgdGltZWZyb21wYXJ0cyB0aW1lb3V0IHRpbWVzdGFtcCB0aW1lc3RhbXBhZGQgdGltZXN0YW1wZGlmZiB0aW1lem9uZV9hYmJyIHRpbWV6b25lX21pbnV0ZSB0aW1lem9uZV9yZWdpb24gdG8gdG9fYmFzZTY0IHRvX2RhdGUgdG9fZGF5cyB0b19zZWNvbmRzIHRvZGF0ZXRpbWVvZmZzZXQgdHJhY2UgdHJhY2tpbmcgdHJhbnNhY3Rpb24gdHJhbnNhY3Rpb25hbCB0cmFuc2xhdGUgdHJhbnNsYXRpb24gdHJlYXQgdHJpZ2dlciB0cmlnZ2VyX25lc3RsZXZlbCB0cmlnZ2VycyB0cmltIHRydW5jYXRlIHRyeV9jYXN0IHRyeV9jb252ZXJ0IHRyeV9wYXJzZSB0eXBlIHViMSB1YjIgdWI0IHVjYXNlIHVuYXJjaGl2ZWQgdW5ib3VuZGVkIHVuY29tcHJlc3MgdW5kZXIgdW5kbyB1bmhleCB1bmljb2RlIHVuaWZvcm0gdW5pbnN0YWxsIHVuaW9uIHVuaXF1ZSB1bml4X3RpbWVzdGFtcCB1bmtub3duIHVubGltaXRlZCB1bmxvY2sgdW5waXZvdCB1bnJlY292ZXJhYmxlIHVuc2FmZSB1bnNpZ25lZCB1bnRpbCB1bnRydXN0ZWQgdW51c2FibGUgdW51c2VkIHVwZGF0ZSB1cGRhdGVkIHVwZ3JhZGUgdXBwZWQgdXBwZXIgdXBzZXJ0IHVybCB1cm93aWQgdXNhYmxlIHVzYWdlIHVzZSB1c2Vfc3RvcmVkX291dGxpbmVzIHVzZXIgdXNlcl9kYXRhIHVzZXJfcmVzb3VyY2VzIHVzZXJzIHVzaW5nIHV0Y19kYXRlIHV0Y190aW1lc3RhbXAgdXVpZCB1dWlkX3Nob3J0IHZhbGlkYXRlIHZhbGlkYXRlX3Bhc3N3b3JkX3N0cmVuZ3RoIHZhbGlkYXRpb24gdmFsaXN0IHZhbHVlIHZhbHVlcyB2YXIgdmFyX3NhbXAgdmFyY2hhcmMgdmFyaSB2YXJpYSB2YXJpYWIgdmFyaWFibCB2YXJpYWJsZSB2YXJpYWJsZXMgdmFyaWFuY2UgdmFycCB2YXJyYXcgdmFycmF3YyB2YXJyYXkgdmVyaWZ5IHZlcnNpb24gdmVyc2lvbnMgdmlldyB2aXJ0dWFsIHZpc2libGUgdm9pZCB3YWl0IHdhbGxldCB3YXJuaW5nIHdhcm5pbmdzIHdlZWsgd2Vla2RheSB3ZWVrb2Z5ZWFyIHdlbGxmb3JtZWQgd2hlbiB3aGVuZSB3aGVuZXYgd2hlbmV2ZSB3aGVuZXZlciB3aGVyZSB3aGlsZSB3aGl0ZXNwYWNlIHdpdGggd2l0aGluIHdpdGhvdXQgd29yayB3cmFwcGVkIHhkYiB4bWwgeG1sYWdnIHhtbGF0dHJpYnV0ZXMgeG1sY2FzdCB4bWxjb2xhdHR2YWwgeG1sZWxlbWVudCB4bWxleGlzdHMgeG1sZm9yZXN0IHhtbGluZGV4IHhtbG5hbWVzcGFjZXMgeG1scGkgeG1scXVlcnkgeG1scm9vdCB4bWxzY2hlbWEgeG1sc2VyaWFsaXplIHhtbHRhYmxlIHhtbHR5cGUgeG9yIHllYXIgeWVhcl90b19tb250aCB5ZWFycyB5ZWFyd2VlayIsbGl0ZXJhbDoidHJ1ZSBmYWxzZSBudWxsIixidWlsdF9pbjoiYXJyYXkgYmlnaW50IGJpbmFyeSBiaXQgYmxvYiBib29sZWFuIGNoYXIgY2hhcmFjdGVyIGRhdGUgZGVjIGRlY2ltYWwgZmxvYXQgaW50IGludDggaW50ZWdlciBpbnRlcnZhbCBudW1iZXIgbnVtZXJpYyByZWFsIHJlY29yZCBzZXJpYWwgc2VyaWFsOCBzbWFsbGludCB0ZXh0IHZhcmNoYXIgdmFyeWluZyB2b2lkIn0sYzpbe2NOOiJzdHJpbmciLGI6IiciLGU6IiciLGM6W2UuQkUse2I6IicnIn1dfSx7Y046InN0cmluZyIsYjonIicsZTonIicsYzpbZS5CRSx7YjonIiInfV19LHtjTjoic3RyaW5nIixiOiJgIixlOiJgIixjOltlLkJFXX0sZS5DTk0sZS5DQkNNLHRdfSxlLkNCQ00sdF19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJyIixmdW5jdGlvbihlKXt2YXIgcj0iKFthLXpBLVpdfFxcLlthLXpBLVouXSlbYS16QS1aMC05Ll9dKiI7cmV0dXJue2M6W2UuSENNLHtiOnIsbDpyLGs6e2tleXdvcmQ6ImZ1bmN0aW9uIGlmIGluIGJyZWFrIG5leHQgcmVwZWF0IGVsc2UgZm9yIHJldHVybiBzd2l0Y2ggd2hpbGUgdHJ5IHRyeUNhdGNoIHN0b3Agd2FybmluZyByZXF1aXJlIGxpYnJhcnkgYXR0YWNoIGRldGFjaCBzb3VyY2Ugc2V0TWV0aG9kIHNldEdlbmVyaWMgc2V0R3JvdXBHZW5lcmljIHNldENsYXNzIC4uLiIsbGl0ZXJhbDoiTlVMTCBOQSBUUlVFIEZBTFNFIFQgRiBJbmYgTmFOIE5BX2ludGVnZXJffDEwIE5BX3JlYWxffDEwIE5BX2NoYXJhY3Rlcl98MTAgTkFfY29tcGxleF98MTAifSxyOjB9LHtjTjoibnVtYmVyIixiOiIwW3hYXVswLTlhLWZBLUZdK1tMaV0/XFxiIixyOjB9LHtjTjoibnVtYmVyIixiOiJcXGQrKD86W2VFXVsrXFwtXT9cXGQqKT9MXFxiIixyOjB9LHtjTjoibnVtYmVyIixiOiJcXGQrXFwuKD8hXFxkKSg/OmlcXGIpPyIscjowfSx7Y046Im51bWJlciIsYjoiXFxkKyg/OlxcLlxcZCopPyg/OltlRV1bK1xcLV0/XFxkKik/aT9cXGIiLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcLlxcZCsoPzpbZUVdWytcXC1dP1xcZCopP2k/XFxiIixyOjB9LHtiOiJgIixlOiJgIixyOjB9LHtjTjoic3RyaW5nIixjOltlLkJFXSx2Olt7YjonIicsZTonIid9LHtiOiInIixlOiInIn1dfV19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJwZXJsIixmdW5jdGlvbihlKXt2YXIgdD0iZ2V0cHdlbnQgZ2V0c2VydmVudCBxdW90ZW1ldGEgbXNncmN2IHNjYWxhciBraWxsIGRibWNsb3NlIHVuZGVmIGxjIG1hIHN5c3dyaXRlIHRyIHNlbmQgdW1hc2sgc3lzb3BlbiBzaG13cml0ZSB2ZWMgcXggdXRpbWUgbG9jYWwgb2N0IHNlbWN0bCBsb2NhbHRpbWUgcmVhZHBpcGUgZG8gcmV0dXJuIGZvcm1hdCByZWFkIHNwcmludGYgZGJtb3BlbiBwb3AgZ2V0cGdycCBub3QgZ2V0cHduYW0gcmV3aW5kZGlyIHFxZmlsZW5vIHF3IGVuZHByb3RvZW50IHdhaXQgc2V0aG9zdGVudCBibGVzcyBzfDAgb3BlbmRpciBjb250aW51ZSBlYWNoIHNsZWVwIGVuZGdyZW50IHNodXRkb3duIGR1bXAgY2hvbXAgY29ubmVjdCBnZXRzb2NrbmFtZSBkaWUgc29ja2V0cGFpciBjbG9zZSBmbG9jayBleGlzdHMgaW5kZXggc2htZ2V0c3ViIGZvciBlbmRwd2VudCByZWRvIGxzdGF0IG1zZ2N0bCBzZXRwZ3JwIGFicyBleGl0IHNlbGVjdCBwcmludCByZWYgZ2V0aG9zdGJ5YWRkciB1bnNoaWZ0IGZjbnRsIHN5c2NhbGwgZ290byBnZXRuZXRieWFkZHIgam9pbiBnbXRpbWUgc3ltbGluayBzZW1nZXQgc3BsaWNlIHh8MCBnZXRwZWVybmFtZSByZWN2IGxvZyBzZXRzb2Nrb3B0IGNvcyBsYXN0IHJldmVyc2UgZ2V0aG9zdGJ5bmFtZSBnZXRncm5hbSBzdHVkeSBmb3JtbGluZSBlbmRob3N0ZW50IHRpbWVzIGNob3AgbGVuZ3RoIGdldGhvc3RlbnQgZ2V0bmV0ZW50IHBhY2sgZ2V0cHJvdG9lbnQgZ2V0c2VydmJ5bmFtZSByYW5kIG1rZGlyIHBvcyBjaG1vZCB5fDAgc3Vic3RyIGVuZG5ldGVudCBwcmludGYgbmV4dCBvcGVuIG1zZ3NuZCByZWFkZGlyIHVzZSB1bmxpbmsgZ2V0c29ja29wdCBnZXRwcmlvcml0eSByaW5kZXggd2FudGFycmF5IGhleCBzeXN0ZW0gZ2V0c2VydmJ5cG9ydCBlbmRzZXJ2ZW50IGludCBjaHIgdW50aWUgcm1kaXIgcHJvdG90eXBlIHRlbGwgbGlzdGVuIGZvcmsgc2htcmVhZCB1Y2ZpcnN0IHNldHByb3RvZW50IGVsc2Ugc3lzc2VlayBsaW5rIGdldGdyZ2lkIHNobWN0bCB3YWl0cGlkIHVucGFjayBnZXRuZXRieW5hbWUgcmVzZXQgY2hkaXIgZ3JlcCBzcGxpdCByZXF1aXJlIGNhbGxlciBsY2ZpcnN0IHVudGlsIHdhcm4gd2hpbGUgdmFsdWVzIHNoaWZ0IHRlbGxkaXIgZ2V0cHd1aWQgbXkgZ2V0cHJvdG9ieW51bWJlciBkZWxldGUgYW5kIHNvcnQgdWMgZGVmaW5lZCBzcmFuZCBhY2NlcHQgcGFja2FnZSBzZWVrZGlyIGdldHByb3RvYnluYW1lIHNlbW9wIG91ciByZW5hbWUgc2VlayBpZiBxfDAgY2hyb290IHN5c3JlYWQgc2V0cHdlbnQgbm8gY3J5cHQgZ2V0YyBjaG93biBzcXJ0IHdyaXRlIHNldG5ldGVudCBzZXRwcmlvcml0eSBmb3JlYWNoIHRpZSBzaW4gbXNnZ2V0IG1hcCBzdGF0IGdldGxvZ2luIHVubGVzcyBlbHNpZiB0cnVuY2F0ZSBleGVjIGtleXMgZ2xvYiB0aWVkIGNsb3NlZGlyaW9jdGwgc29ja2V0IHJlYWRsaW5rIGV2YWwgeG9yIHJlYWRsaW5lIGJpbm1vZGUgc2V0c2VydmVudCBlb2Ygb3JkIGJpbmQgYWxhcm0gcGlwZSBhdGFuMiBnZXRncmVudCBleHAgdGltZSBwdXNoIHNldGdyZW50IGd0IGx0IG9yIG5lIG18MCBicmVhayBnaXZlbiBzYXkgc3RhdGUgd2hlbiIscj17Y046InN1YnN0IixiOiJbJEBdXFx7IixlOiJcXH0iLGs6dH0scz17YjoiLT57IixlOiJ9In0sbj17djpbe2I6L1wkXGQvfSx7YjovW1wkJUBdKFxeXHdcYnwjXHcrKDo6XHcrKSp8e1x3K318XHcrKDo6XHcqKSopL30se2I6L1tcJCVAXVteXHNcd3tdLyxyOjB9XX0saT1bZS5CRSxyLG5dLG89W24sZS5IQ00sZS5DKCJeXFw9XFx3IiwiXFw9Y3V0Iix7ZVc6ITB9KSxzLHtjTjoic3RyaW5nIixjOmksdjpbe2I6InFbcXd4cl0/XFxzKlxcKCIsZToiXFwpIixyOjV9LHtiOiJxW3F3eHJdP1xccypcXFsiLGU6IlxcXSIscjo1fSx7YjoicVtxd3hyXT9cXHMqXFx7IixlOiJcXH0iLHI6NX0se2I6InFbcXd4cl0/XFxzKlxcfCIsZToiXFx8IixyOjV9LHtiOiJxW3F3eHJdP1xccypcXDwiLGU6IlxcPiIscjo1fSx7YjoicXdcXHMrcSIsZToicSIscjo1fSx7YjoiJyIsZToiJyIsYzpbZS5CRV19LHtiOiciJyxlOiciJ30se2I6ImAiLGU6ImAiLGM6W2UuQkVdfSx7Yjoie1xcdyt9IixjOltdLHI6MH0se2I6Ii0/XFx3K1xccypcXD1cXD4iLGM6W10scjowfV19LHtjTjoibnVtYmVyIixiOiIoXFxiMFswLTdfXSspfChcXGIweFswLTlhLWZBLUZfXSspfChcXGJbMS05XVswLTlfXSooXFwuWzAtOV9dKyk/KXxbMF9dXFxiIixyOjB9LHtiOiIoXFwvXFwvfCIrZS5SU1IrInxcXGIoc3BsaXR8cmV0dXJufHByaW50fHJldmVyc2V8Z3JlcClcXGIpXFxzKiIsazoic3BsaXQgcmV0dXJuIHByaW50IHJldmVyc2UgZ3JlcCIscjowLGM6W2UuSENNLHtjTjoicmVnZXhwIixiOiIoc3x0cnx5KS8oXFxcXC58W14vXSkqLyhcXFxcLnxbXi9dKSovW2Etel0qIixyOjEwfSx7Y046InJlZ2V4cCIsYjoiKG18cXIpPy8iLGU6Ii9bYS16XSoiLGM6W2UuQkVdLHI6MH1dfSx7Y046ImZ1bmN0aW9uIixiSzoic3ViIixlOiIoXFxzKlxcKC4qP1xcKSk/Wzt7XSIsZUU6ITAscjo1LGM6W2UuVE1dfSx7YjoiLVxcd1xcYiIscjowfSx7YjoiXl9fREFUQV9fJCIsZToiXl9fRU5EX18kIixzTDoibW9qb2xpY2lvdXMiLGM6W3tiOiJeQEAuKiIsZToiJCIsY046ImNvbW1lbnQifV19XTtyZXR1cm4gci5jPW8scy5jPW8se2FsaWFzZXM6WyJwbCIsInBtIl0sbDovW1x3XC5dKy8sazp0LGM6b319KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoImluaSIsZnVuY3Rpb24oZSl7dmFyIGI9e2NOOiJzdHJpbmciLGM6W2UuQkVdLHY6W3tiOiInJyciLGU6IicnJyIscjoxMH0se2I6JyIiIicsZTonIiIiJyxyOjEwfSx7YjonIicsZTonIid9LHtiOiInIixlOiInIn1dfTtyZXR1cm57YWxpYXNlczpbInRvbWwiXSxjSTohMCxpOi9cUy8sYzpbZS5DKCI7IiwiJCIpLGUuSENNLHtjTjoic2VjdGlvbiIsYjovXlxzKlxbKy8sZTovXF0rL30se2I6L15bYS16MC05XFtcXV8tXStccyo9XHMqLyxlOiIkIixyQjohMCxjOlt7Y046ImF0dHIiLGI6L1thLXowLTlcW1xdXy1dKy99LHtiOi89LyxlVzohMCxyOjAsYzpbe2NOOiJsaXRlcmFsIixiOi9cYm9ufG9mZnx0cnVlfGZhbHNlfHllc3xub1xiL30se2NOOiJ2YXJpYWJsZSIsdjpbe2I6L1wkW1x3XGQiXVtcd1xkX10qL30se2I6L1wkXHsoLio/KX0vfV19LGIse2NOOiJudW1iZXIiLGI6LyhbXCtcLV0rKT9bXGRdK19bXGRfXSsvfSxlLk5NXX1dfV19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJkaWZmIixmdW5jdGlvbihlKXtyZXR1cm57YWxpYXNlczpbInBhdGNoIl0sYzpbe2NOOiJtZXRhIixyOjEwLHY6W3tiOi9eQEAgK1wtXGQrLFxkKyArXCtcZCssXGQrICtAQCQvfSx7YjovXlwqXCpcKiArXGQrLFxkKyArXCpcKlwqXCokL30se2I6L15cLVwtXC0gK1xkKyxcZCsgK1wtXC1cLVwtJC99XX0se2NOOiJjb21tZW50Iix2Olt7YjovSW5kZXg6IC8sZTovJC99LHtiOi89ezMsfS8sZTovJC99LHtiOi9eXC17M30vLGU6LyQvfSx7YjovXlwqezN9IC8sZTovJC99LHtiOi9eXCt7M30vLGU6LyQvfSx7YjovXCp7NX0vLGU6L1wqezV9JC99XX0se2NOOiJhZGRpdGlvbiIsYjoiXlxcKyIsZToiJCJ9LHtjTjoiZGVsZXRpb24iLGI6Il5cXC0iLGU6IiQifSx7Y046ImFkZGl0aW9uIixiOiJeXFwhIixlOiIkIn1dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgiZ28iLGZ1bmN0aW9uKGUpe3ZhciB0PXtrZXl3b3JkOiJicmVhayBkZWZhdWx0IGZ1bmMgaW50ZXJmYWNlIHNlbGVjdCBjYXNlIG1hcCBzdHJ1Y3QgY2hhbiBlbHNlIGdvdG8gcGFja2FnZSBzd2l0Y2ggY29uc3QgZmFsbHRocm91Z2ggaWYgcmFuZ2UgdHlwZSBjb250aW51ZSBmb3IgaW1wb3J0IHJldHVybiB2YXIgZ28gZGVmZXIgYm9vbCBieXRlIGNvbXBsZXg2NCBjb21wbGV4MTI4IGZsb2F0MzIgZmxvYXQ2NCBpbnQ4IGludDE2IGludDMyIGludDY0IHN0cmluZyB1aW50OCB1aW50MTYgdWludDMyIHVpbnQ2NCBpbnQgdWludCB1aW50cHRyIHJ1bmUiLGxpdGVyYWw6InRydWUgZmFsc2UgaW90YSBuaWwiLGJ1aWx0X2luOiJhcHBlbmQgY2FwIGNsb3NlIGNvbXBsZXggY29weSBpbWFnIGxlbiBtYWtlIG5ldyBwYW5pYyBwcmludCBwcmludGxuIHJlYWwgcmVjb3ZlciBkZWxldGUifTtyZXR1cm57YWxpYXNlczpbImdvbGFuZyJdLGs6dCxpOiI8LyIsYzpbZS5DTENNLGUuQ0JDTSx7Y046InN0cmluZyIsdjpbZS5RU00se2I6IiciLGU6IlteXFxcXF0nIn0se2I6ImAiLGU6ImAifV19LHtjTjoibnVtYmVyIix2Olt7YjplLkNOUisiW2RmbHNpXSIscjoxfSxlLkNOTV19LHtiOi86PS99LHtjTjoiZnVuY3Rpb24iLGJLOiJmdW5jIixlOi9ccypcey8sZUU6ITAsYzpbZS5UTSx7Y046InBhcmFtcyIsYjovXCgvLGU6L1wpLyxrOnQsaTovWyInXS99XX1dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgiYmFzaCIsZnVuY3Rpb24oZSl7dmFyIHQ9e2NOOiJ2YXJpYWJsZSIsdjpbe2I6L1wkW1x3XGQjQF1bXHdcZF9dKi99LHtiOi9cJFx7KC4qPyl9L31dfSxzPXtjTjoic3RyaW5nIixiOi8iLyxlOi8iLyxjOltlLkJFLHQse2NOOiJ2YXJpYWJsZSIsYjovXCRcKC8sZTovXCkvLGM6W2UuQkVdfV19LGE9e2NOOiJzdHJpbmciLGI6LycvLGU6LycvfTtyZXR1cm57YWxpYXNlczpbInNoIiwienNoIl0sbDovXGItP1thLXpcLl9dK1xiLyxrOntrZXl3b3JkOiJpZiB0aGVuIGVsc2UgZWxpZiBmaSBmb3Igd2hpbGUgaW4gZG8gZG9uZSBjYXNlIGVzYWMgZnVuY3Rpb24iLGxpdGVyYWw6InRydWUgZmFsc2UiLGJ1aWx0X2luOiJicmVhayBjZCBjb250aW51ZSBldmFsIGV4ZWMgZXhpdCBleHBvcnQgZ2V0b3B0cyBoYXNoIHB3ZCByZWFkb25seSByZXR1cm4gc2hpZnQgdGVzdCB0aW1lcyB0cmFwIHVtYXNrIHVuc2V0IGFsaWFzIGJpbmQgYnVpbHRpbiBjYWxsZXIgY29tbWFuZCBkZWNsYXJlIGVjaG8gZW5hYmxlIGhlbHAgbGV0IGxvY2FsIGxvZ291dCBtYXBmaWxlIHByaW50ZiByZWFkIHJlYWRhcnJheSBzb3VyY2UgdHlwZSB0eXBlc2V0IHVsaW1pdCB1bmFsaWFzIHNldCBzaG9wdCBhdXRvbG9hZCBiZyBiaW5ka2V5IGJ5ZSBjYXAgY2hkaXIgY2xvbmUgY29tcGFyZ3VtZW50cyBjb21wY2FsbCBjb21wY3RsIGNvbXBkZXNjcmliZSBjb21wZmlsZXMgY29tcGdyb3VwcyBjb21wcXVvdGUgY29tcHRhZ3MgY29tcHRyeSBjb21wdmFsdWVzIGRpcnMgZGlzYWJsZSBkaXNvd24gZWNob3RjIGVjaG90aSBlbXVsYXRlIGZjIGZnIGZsb2F0IGZ1bmN0aW9ucyBnZXRjYXAgZ2V0bG4gaGlzdG9yeSBpbnRlZ2VyIGpvYnMga2lsbCBsaW1pdCBsb2cgbm9nbG9iIHBvcGQgcHJpbnQgcHVzaGQgcHVzaGxuIHJlaGFzaCBzY2hlZCBzZXRjYXAgc2V0b3B0IHN0YXQgc3VzcGVuZCB0dHljdGwgdW5mdW5jdGlvbiB1bmhhc2ggdW5saW1pdCB1bnNldG9wdCB2YXJlZCB3YWl0IHdoZW5jZSB3aGVyZSB3aGljaCB6Y29tcGlsZSB6Zm9ybWF0IHpmdHAgemxlIHptb2Rsb2FkIHpwYXJzZW9wdHMgenByb2YgenB0eSB6cmVnZXhwYXJzZSB6c29ja2V0IHpzdHlsZSB6dGNwIixfOiItbmUgLWVxIC1sdCAtZ3QgLWYgLWQgLWUgLXMgLWwgLWEifSxjOlt7Y046Im1ldGEiLGI6L14jIVteXG5dK3NoXHMqJC8scjoxMH0se2NOOiJmdW5jdGlvbiIsYjovXHdbXHdcZF9dKlxzKlwoXHMqXClccypcey8sckI6ITAsYzpbZS5pbmhlcml0KGUuVE0se2I6L1x3W1x3XGRfXSovfSldLHI6MH0sZS5IQ00scyxhLHRdfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgicHl0aG9uIixmdW5jdGlvbihlKXt2YXIgcj17a2V5d29yZDoiYW5kIGVsaWYgaXMgZ2xvYmFsIGFzIGluIGlmIGZyb20gcmFpc2UgZm9yIGV4Y2VwdCBmaW5hbGx5IHByaW50IGltcG9ydCBwYXNzIHJldHVybiBleGVjIGVsc2UgYnJlYWsgbm90IHdpdGggY2xhc3MgYXNzZXJ0IHlpZWxkIHRyeSB3aGlsZSBjb250aW51ZSBkZWwgb3IgZGVmIGxhbWJkYSBhc3luYyBhd2FpdCBub25sb2NhbHwxMCBOb25lIFRydWUgRmFsc2UiLGJ1aWx0X2luOiJFbGxpcHNpcyBOb3RJbXBsZW1lbnRlZCJ9LGI9e2NOOiJtZXRhIixiOi9eKD4+PnxcLlwuXC4pIC99LGM9e2NOOiJzdWJzdCIsYjovXHsvLGU6L1x9LyxrOnIsaTovIy99LGE9e2NOOiJzdHJpbmciLGM6W2UuQkVdLHY6W3tiOi8odXxiKT9yPycnJy8sZTovJycnLyxjOltiXSxyOjEwfSx7YjovKHV8Yik/cj8iIiIvLGU6LyIiIi8sYzpbYl0scjoxMH0se2I6LyhmcnxyZnxmKScnJy8sZTovJycnLyxjOltiLGNdfSx7YjovKGZyfHJmfGYpIiIiLyxlOi8iIiIvLGM6W2IsY119LHtiOi8odXxyfHVyKScvLGU6LycvLHI6MTB9LHtiOi8odXxyfHVyKSIvLGU6LyIvLHI6MTB9LHtiOi8oYnxiciknLyxlOi8nL30se2I6LyhifGJyKSIvLGU6LyIvfSx7YjovKGZyfHJmfGYpJy8sZTovJy8sYzpbY119LHtiOi8oZnJ8cmZ8ZikiLyxlOi8iLyxjOltjXX0sZS5BU00sZS5RU01dfSxzPXtjTjoibnVtYmVyIixyOjAsdjpbe2I6ZS5CTlIrIltsTGpKXT8ifSx7YjoiXFxiKDBvWzAtN10rKVtsTGpKXT8ifSx7YjplLkNOUisiW2xMakpdPyJ9XX0saT17Y046InBhcmFtcyIsYjovXCgvLGU6L1wpLyxjOlsic2VsZiIsYixzLGFdfTtyZXR1cm4gYy5jPVthLHMsYl0se2FsaWFzZXM6WyJweSIsImd5cCJdLGs6cixpOi8oPFwvfC0+fFw/KXw9Pi8sYzpbYixzLGEsZS5IQ00se3Y6W3tjTjoiZnVuY3Rpb24iLGJLOiJkZWYifSx7Y046ImNsYXNzIixiSzoiY2xhc3MifV0sZTovOi8saTovWyR7PTtcbixdLyxjOltlLlVUTSxpLHtiOi8tPi8sZVc6ITAsazoiTm9uZSJ9XX0se2NOOiJtZXRhIixiOi9eW1x0IF0qQC8sZTovJC99LHtiOi9cYihwcmludHxleGVjKVwoL31dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgianVsaWEiLGZ1bmN0aW9uKGUpe3ZhciByPXtrZXl3b3JkOiJpbiBpc2Egd2hlcmUgYmFyZW1vZHVsZSBiZWdpbiBicmVhayBjYXRjaCBjY2FsbCBjb25zdCBjb250aW51ZSBkbyBlbHNlIGVsc2VpZiBlbmQgZXhwb3J0IGZhbHNlIGZpbmFsbHkgZm9yIGZ1bmN0aW9uIGdsb2JhbCBpZiBpbXBvcnQgaW1wb3J0YWxsIGxldCBsb2NhbCBtYWNybyBtb2R1bGUgcXVvdGUgcmV0dXJuIHRydWUgdHJ5IHVzaW5nIHdoaWxlIHR5cGUgaW1tdXRhYmxlIGFic3RyYWN0IGJpdHN0eXBlIHR5cGVhbGlhcyAiLGxpdGVyYWw6InRydWUgZmFsc2UgQVJHUyBDX05VTEwgRGV2TnVsbCBFTkRJQU5fQk9NIEVOViBJIEluZiBJbmYxNiBJbmYzMiBJbmY2NCBJbnNlcnRpb25Tb3J0IEpVTElBX0hPTUUgTE9BRF9QQVRIIE1lcmdlU29ydCBOYU4gTmFOMTYgTmFOMzIgTmFONjQgUFJPR1JBTV9GSUxFIFF1aWNrU29ydCBSb3VuZERvd24gUm91bmRGcm9tWmVybyBSb3VuZE5lYXJlc3QgUm91bmROZWFyZXN0VGllc0F3YXkgUm91bmROZWFyZXN0VGllc1VwIFJvdW5kVG9aZXJvIFJvdW5kVXAgU1RERVJSIFNURElOIFNURE9VVCBWRVJTSU9OIGNhdGFsYW4gZXwwIGV1fDAgZXVsZXJnYW1tYSBnb2xkZW4gaW0gbm90aGluZyBwaSDOsyDPgCDPhiAiLGJ1aWx0X2luOiJBTlkgQWJzdHJhY3RBcnJheSBBYnN0cmFjdENoYW5uZWwgQWJzdHJhY3RGbG9hdCBBYnN0cmFjdE1hdHJpeCBBYnN0cmFjdFJORyBBYnN0cmFjdFNlcmlhbGl6ZXIgQWJzdHJhY3RTZXQgQWJzdHJhY3RTcGFyc2VBcnJheSBBYnN0cmFjdFNwYXJzZU1hdHJpeCBBYnN0cmFjdFNwYXJzZVZlY3RvciBBYnN0cmFjdFN0cmluZyBBYnN0cmFjdFVuaXRSYW5nZSBBYnN0cmFjdFZlY09yTWF0IEFic3RyYWN0VmVjdG9yIEFueSBBcmd1bWVudEVycm9yIEFycmF5IEFzc2VydGlvbkVycm9yIEFzc29jaWF0aXZlIEJhc2U2NERlY29kZVBpcGUgQmFzZTY0RW5jb2RlUGlwZSBCaWRpYWdvbmFsIEJpZ0Zsb2F0IEJpZ0ludCBCaXRBcnJheSBCaXRNYXRyaXggQml0VmVjdG9yIEJvb2wgQm91bmRzRXJyb3IgQnVmZmVyU3RyZWFtIENhY2hpbmdQb29sIENhcHR1cmVkRXhjZXB0aW9uIENhcnRlc2lhbkluZGV4IENhcnRlc2lhblJhbmdlIENjaGFyIENkb3VibGUgQ2Zsb2F0IENoYW5uZWwgQ2hhciBDaW50IENpbnRtYXhfdCBDbG9uZyBDbG9uZ2xvbmcgQ2x1c3Rlck1hbmFnZXIgQ21kIENvZGVJbmZvIENvbG9uIENvbXBsZXggQ29tcGxleDEyOCBDb21wbGV4MzIgQ29tcGxleDY0IENvbXBvc2l0ZUV4Y2VwdGlvbiBDb25kaXRpb24gQ29uakFycmF5IENvbmpNYXRyaXggQ29ualZlY3RvciBDcHRyZGlmZl90IENzaG9ydCBDc2l6ZV90IENzc2l6ZV90IENzdHJpbmcgQ3VjaGFyIEN1aW50IEN1aW50bWF4X3QgQ3Vsb25nIEN1bG9uZ2xvbmcgQ3VzaG9ydCBDd2NoYXJfdCBDd3N0cmluZyBEYXRhVHlwZSBEYXRlIERhdGVGb3JtYXQgRGF0ZVRpbWUgRGVuc2VBcnJheSBEZW5zZU1hdHJpeCBEZW5zZVZlY09yTWF0IERlbnNlVmVjdG9yIERpYWdvbmFsIERpY3QgRGltZW5zaW9uTWlzbWF0Y2ggRGltcyBEaXJlY3RJbmRleFN0cmluZyBEaXNwbGF5IERpdmlkZUVycm9yIERvbWFpbkVycm9yIEVPRkVycm9yIEVhY2hMaW5lIEVudW0gRW51bWVyYXRlIEVycm9yRXhjZXB0aW9uIEV4Y2VwdGlvbiBFeHBvbmVudGlhbEJhY2tPZmYgRXhwciBGYWN0b3JpemF0aW9uIEZpbGVNb25pdG9yIEZsb2F0MTYgRmxvYXQzMiBGbG9hdDY0IEZ1bmN0aW9uIEZ1dHVyZSBHbG9iYWxSZWYgR290b05vZGUgSFRNTCBIZXJtaXRpYW4gSU8gSU9CdWZmZXIgSU9Db250ZXh0IElPU3RyZWFtIElQQWRkciBJUHY0IElQdjYgSW5kZXhDYXJ0ZXNpYW4gSW5kZXhMaW5lYXIgSW5kZXhTdHlsZSBJbmV4YWN0RXJyb3IgSW5pdEVycm9yIEludCBJbnQxMjggSW50MTYgSW50MzIgSW50NjQgSW50OCBJbnRTZXQgSW50ZWdlciBJbnRlcnJ1cHRFeGNlcHRpb24gSW52YWxpZFN0YXRlRXhjZXB0aW9uIElycmF0aW9uYWwgS2V5RXJyb3IgTGFiZWxOb2RlIExpblNwYWNlIExpbmVOdW1iZXJOb2RlIExvYWRFcnJvciBMb3dlclRyaWFuZ3VsYXIgTUlNRSBNYXRyaXggTWVyc2VubmVUd2lzdGVyIE1ldGhvZCBNZXRob2RFcnJvciBNZXRob2RUYWJsZSBNb2R1bGUgTlR1cGxlIE5ld3Zhck5vZGUgTnVsbEV4Y2VwdGlvbiBOdWxsYWJsZSBOdW1iZXIgT2JqZWN0SWREaWN0IE9yZGluYWxSYW5nZSBPdXRPZk1lbW9yeUVycm9yIE92ZXJmbG93RXJyb3IgUGFpciBQYXJzZUVycm9yIFBhcnRpYWxRdWlja1NvcnQgUGVybXV0ZWREaW1zQXJyYXkgUGlwZSBQb2xsaW5nRmlsZVdhdGNoZXIgUHJvY2Vzc0V4aXRlZEV4Y2VwdGlvbiBQdHIgUXVvdGVOb2RlIFJhbmRvbURldmljZSBSYW5nZSBSYW5nZUluZGV4IFJhdGlvbmFsIFJhd0ZEIFJlYWRPbmx5TWVtb3J5RXJyb3IgUmVhbCBSZWVudHJhbnRMb2NrIFJlZiBSZWdleCBSZWdleE1hdGNoIFJlbW90ZUNoYW5uZWwgUmVtb3RlRXhjZXB0aW9uIFJldlN0cmluZyBSb3VuZGluZ01vZGUgUm93VmVjdG9yIFNTQVZhbHVlIFNlZ21lbnRhdGlvbkZhdWx0IFNlcmlhbGl6YXRpb25TdGF0ZSBTZXQgU2hhcmVkQXJyYXkgU2hhcmVkTWF0cml4IFNoYXJlZFZlY3RvciBTaWduZWQgU2ltcGxlVmVjdG9yIFNsb3QgU2xvdE51bWJlciBTcGFyc2VNYXRyaXhDU0MgU3BhcnNlVmVjdG9yIFN0YWNrRnJhbWUgU3RhY2tPdmVyZmxvd0Vycm9yIFN0YWNrVHJhY2UgU3RlcFJhbmdlIFN0ZXBSYW5nZUxlbiBTdHJpZGVkQXJyYXkgU3RyaWRlZE1hdHJpeCBTdHJpZGVkVmVjT3JNYXQgU3RyaWRlZFZlY3RvciBTdHJpbmcgU3ViQXJyYXkgU3ViU3RyaW5nIFN5bVRyaWRpYWdvbmFsIFN5bWJvbCBTeW1tZXRyaWMgU3lzdGVtRXJyb3IgVENQU29ja2V0IFRhc2sgVGV4dCBUZXh0RGlzcGxheSBUaW1lciBUcmlkaWFnb25hbCBUdXBsZSBUeXBlIFR5cGVFcnJvciBUeXBlTWFwRW50cnkgVHlwZU1hcExldmVsIFR5cGVOYW1lIFR5cGVWYXIgVHlwZWRTbG90IFVEUFNvY2tldCBVSW50IFVJbnQxMjggVUludDE2IFVJbnQzMiBVSW50NjQgVUludDggVW5kZWZSZWZFcnJvciBVbmRlZlZhckVycm9yIFVuaWNvZGVFcnJvciBVbmlmb3JtU2NhbGluZyBVbmlvbiBVbmlvbkFsbCBVbml0UmFuZ2UgVW5zaWduZWQgVXBwZXJUcmlhbmd1bGFyIFZhbCBWYXJhcmcgVmVjRWxlbWVudCBWZWNPck1hdCBWZWN0b3IgVmVyc2lvbk51bWJlciBWb2lkIFdlYWtLZXlEaWN0IFdlYWtSZWYgV29ya2VyQ29uZmlnIFdvcmtlclBvb2wgIn0sdD0iW0EtWmEtel9cXHUwMEExLVxcdUZGRkZdW0EtWmEtel8wLTlcXHUwMEExLVxcdUZGRkZdKiIsYT17bDp0LGs6cixpOi88XC8vfSxuPXtjTjoibnVtYmVyIixiOi8oXGIweFtcZF9dKihcLltcZF9dKik/fDB4XC5cZFtcZF9dKilwWy0rXT9cZCt8XGIwW2JveF1bYS1mQS1GMC05XVthLWZBLUYwLTlfXSp8KFxiXGRbXGRfXSooXC5bXGRfXSopP3xcLlxkW1xkX10qKShbZUVmRl1bLStdP1xkKyk/LyxyOjB9LG89e2NOOiJzdHJpbmciLGI6LycoLnxcXFt4WHVVXVthLXpBLVowLTldKyknL30saT17Y046InN1YnN0IixiOi9cJFwoLyxlOi9cKS8sazpyfSxsPXtjTjoidmFyaWFibGUiLGI6IlxcJCIrdH0sYz17Y046InN0cmluZyIsYzpbZS5CRSxpLGxdLHY6W3tiOi9cdyoiIiIvLGU6LyIiIlx3Ki8scjoxMH0se2I6L1x3KiIvLGU6LyJcdyovfV19LHM9e2NOOiJzdHJpbmciLGM6W2UuQkUsaSxsXSxiOiJgIixlOiJgIn0sZD17Y046Im1ldGEiLGI6IkAiK3R9LHU9e2NOOiJjb21tZW50Iix2Olt7YjoiIz0iLGU6Ij0jIixyOjEwfSx7YjoiIyIsZToiJCJ9XX07cmV0dXJuIGEuYz1bbixvLGMscyxkLHUsZS5IQ00se2NOOiJrZXl3b3JkIixiOiJcXGIoKChhYnN0cmFjdHxwcmltaXRpdmUpXFxzKyl0eXBlfChtdXRhYmxlXFxzKyk/c3RydWN0KVxcYiJ9LHtiOi88Oi99XSxpLmM9YS5jLGF9KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoImNvZmZlZXNjcmlwdCIsZnVuY3Rpb24oZSl7dmFyIGM9e2tleXdvcmQ6ImluIGlmIGZvciB3aGlsZSBmaW5hbGx5IG5ldyBkbyByZXR1cm4gZWxzZSBicmVhayBjYXRjaCBpbnN0YW5jZW9mIHRocm93IHRyeSB0aGlzIHN3aXRjaCBjb250aW51ZSB0eXBlb2YgZGVsZXRlIGRlYnVnZ2VyIHN1cGVyIHlpZWxkIGltcG9ydCBleHBvcnQgZnJvbSBhcyBkZWZhdWx0IGF3YWl0IHRoZW4gdW5sZXNzIHVudGlsIGxvb3Agb2YgYnkgd2hlbiBhbmQgb3IgaXMgaXNudCBub3QiLGxpdGVyYWw6InRydWUgZmFsc2UgbnVsbCB1bmRlZmluZWQgeWVzIG5vIG9uIG9mZiIsYnVpbHRfaW46Im5wbSByZXF1aXJlIGNvbnNvbGUgcHJpbnQgbW9kdWxlIGdsb2JhbCB3aW5kb3cgZG9jdW1lbnQifSxuPSJbQS1aYS16JF9dWzAtOUEtWmEteiRfXSoiLHI9e2NOOiJzdWJzdCIsYjovI1x7LyxlOi99LyxrOmN9LGk9W2UuQk5NLGUuaW5oZXJpdChlLkNOTSx7c3RhcnRzOntlOiIoXFxzKi8pPyIscjowfX0pLHtjTjoic3RyaW5nIix2Olt7YjovJycnLyxlOi8nJycvLGM6W2UuQkVdfSx7YjovJy8sZTovJy8sYzpbZS5CRV19LHtiOi8iIiIvLGU6LyIiIi8sYzpbZS5CRSxyXX0se2I6LyIvLGU6LyIvLGM6W2UuQkUscl19XX0se2NOOiJyZWdleHAiLHY6W3tiOiIvLy8iLGU6Ii8vLyIsYzpbcixlLkhDTV19LHtiOiIvL1tnaW1dKiIscjowfSx7YjovXC8oPyFbICpdKShcXFwvfC4pKj9cL1tnaW1dKig/PVxXfCQpL31dfSx7YjoiQCIrbn0se3NMOiJqYXZhc2NyaXB0IixlQjohMCxlRTohMCx2Olt7YjoiYGBgIixlOiJgYGAifSx7YjoiYCIsZToiYCJ9XX1dO3IuYz1pO3ZhciBzPWUuaW5oZXJpdChlLlRNLHtiOm59KSx0PSIoXFwoLipcXCkpP1xccypcXEJbLT1dPiIsbz17Y046InBhcmFtcyIsYjoiXFwoW15cXChdIixyQjohMCxjOlt7YjovXCgvLGU6L1wpLyxrOmMsYzpbInNlbGYiXS5jb25jYXQoaSl9XX07cmV0dXJue2FsaWFzZXM6WyJjb2ZmZWUiLCJjc29uIiwiaWNlZCJdLGs6YyxpOi9cL1wqLyxjOmkuY29uY2F0KFtlLkMoIiMjIyIsIiMjIyIpLGUuSENNLHtjTjoiZnVuY3Rpb24iLGI6Il5cXHMqIituKyJcXHMqPVxccyoiK3QsZToiWy09XT4iLHJCOiEwLGM6W3Msb119LHtiOi9bOlwoLD1dXHMqLyxyOjAsYzpbe2NOOiJmdW5jdGlvbiIsYjp0LGU6IlstPV0+IixyQjohMCxjOltvXX1dfSx7Y046ImNsYXNzIixiSzoiY2xhc3MiLGU6IiQiLGk6L1s6PSJcW1xdXS8sYzpbe2JLOiJleHRlbmRzIixlVzohMCxpOi9bOj0iXFtcXV0vLGM6W3NdfSxzXX0se2I6bisiOiIsZToiOiIsckI6ITAsckU6ITAscjowfV0pfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgiY3BwIixmdW5jdGlvbih0KXt2YXIgZT17Y046ImtleXdvcmQiLGI6IlxcYlthLXpcXGRfXSpfdFxcYiJ9LHI9e2NOOiJzdHJpbmciLHY6W3tiOicodTg/fFUpP0w/IicsZTonIicsaToiXFxuIixjOlt0LkJFXX0se2I6Jyh1OD98VSk/UiInLGU6JyInLGM6W3QuQkVdfSx7YjoiJ1xcXFw/LiIsZToiJyIsaToiLiJ9XX0scz17Y046Im51bWJlciIsdjpbe2I6IlxcYigwYlswMSddKykifSx7YjoiKC0/KVxcYihbXFxkJ10rKFxcLltcXGQnXSopP3xcXC5bXFxkJ10rKSh1fFV8bHxMfHVsfFVMfGZ8RnxifEIpIn0se2I6IigtPykoXFxiMFt4WF1bYS1mQS1GMC05J10rfChcXGJbXFxkJ10rKFxcLltcXGQnXSopP3xcXC5bXFxkJ10rKShbZUVdWy0rXT9bXFxkJ10rKT8pIn1dLHI6MH0saT17Y046Im1ldGEiLGI6LyNccypbYS16XStcYi8sZTovJC8sazp7Im1ldGEta2V5d29yZCI6ImlmIGVsc2UgZWxpZiBlbmRpZiBkZWZpbmUgdW5kZWYgd2FybmluZyBlcnJvciBsaW5lIHByYWdtYSBpZmRlZiBpZm5kZWYgaW5jbHVkZSJ9LGM6W3tiOi9cXFxuLyxyOjB9LHQuaW5oZXJpdChyLHtjTjoibWV0YS1zdHJpbmcifSkse2NOOiJtZXRhLXN0cmluZyIsYjovPFteXG4+XSo+LyxlOi8kLyxpOiJcXG4ifSx0LkNMQ00sdC5DQkNNXX0sYT10LklSKyJcXHMqXFwoIixjPXtrZXl3b3JkOiJpbnQgZmxvYXQgd2hpbGUgcHJpdmF0ZSBjaGFyIGNhdGNoIGltcG9ydCBtb2R1bGUgZXhwb3J0IHZpcnR1YWwgb3BlcmF0b3Igc2l6ZW9mIGR5bmFtaWNfY2FzdHwxMCB0eXBlZGVmIGNvbnN0X2Nhc3R8MTAgY29uc3QgZm9yIHN0YXRpY19jYXN0fDEwIHVuaW9uIG5hbWVzcGFjZSB1bnNpZ25lZCBsb25nIHZvbGF0aWxlIHN0YXRpYyBwcm90ZWN0ZWQgYm9vbCB0ZW1wbGF0ZSBtdXRhYmxlIGlmIHB1YmxpYyBmcmllbmQgZG8gZ290byBhdXRvIHZvaWQgZW51bSBlbHNlIGJyZWFrIGV4dGVybiB1c2luZyBhc20gY2FzZSB0eXBlaWQgc2hvcnQgcmVpbnRlcnByZXRfY2FzdHwxMCBkZWZhdWx0IGRvdWJsZSByZWdpc3RlciBleHBsaWNpdCBzaWduZWQgdHlwZW5hbWUgdHJ5IHRoaXMgc3dpdGNoIGNvbnRpbnVlIGlubGluZSBkZWxldGUgYWxpZ25vZiBjb25zdGV4cHIgZGVjbHR5cGUgbm9leGNlcHQgc3RhdGljX2Fzc2VydCB0aHJlYWRfbG9jYWwgcmVzdHJpY3QgX0Jvb2wgY29tcGxleCBfQ29tcGxleCBfSW1hZ2luYXJ5IGF0b21pY19ib29sIGF0b21pY19jaGFyIGF0b21pY19zY2hhciBhdG9taWNfdWNoYXIgYXRvbWljX3Nob3J0IGF0b21pY191c2hvcnQgYXRvbWljX2ludCBhdG9taWNfdWludCBhdG9taWNfbG9uZyBhdG9taWNfdWxvbmcgYXRvbWljX2xsb25nIGF0b21pY191bGxvbmcgbmV3IHRocm93IHJldHVybiBhbmQgb3Igbm90IixidWlsdF9pbjoic3RkIHN0cmluZyBjaW4gY291dCBjZXJyIGNsb2cgc3RkaW4gc3Rkb3V0IHN0ZGVyciBzdHJpbmdzdHJlYW0gaXN0cmluZ3N0cmVhbSBvc3RyaW5nc3RyZWFtIGF1dG9fcHRyIGRlcXVlIGxpc3QgcXVldWUgc3RhY2sgdmVjdG9yIG1hcCBzZXQgYml0c2V0IG11bHRpc2V0IG11bHRpbWFwIHVub3JkZXJlZF9zZXQgdW5vcmRlcmVkX21hcCB1bm9yZGVyZWRfbXVsdGlzZXQgdW5vcmRlcmVkX211bHRpbWFwIGFycmF5IHNoYXJlZF9wdHIgYWJvcnQgYWJzIGFjb3MgYXNpbiBhdGFuMiBhdGFuIGNhbGxvYyBjZWlsIGNvc2ggY29zIGV4aXQgZXhwIGZhYnMgZmxvb3IgZm1vZCBmcHJpbnRmIGZwdXRzIGZyZWUgZnJleHAgZnNjYW5mIGlzYWxudW0gaXNhbHBoYSBpc2NudHJsIGlzZGlnaXQgaXNncmFwaCBpc2xvd2VyIGlzcHJpbnQgaXNwdW5jdCBpc3NwYWNlIGlzdXBwZXIgaXN4ZGlnaXQgdG9sb3dlciB0b3VwcGVyIGxhYnMgbGRleHAgbG9nMTAgbG9nIG1hbGxvYyByZWFsbG9jIG1lbWNociBtZW1jbXAgbWVtY3B5IG1lbXNldCBtb2RmIHBvdyBwcmludGYgcHV0Y2hhciBwdXRzIHNjYW5mIHNpbmggc2luIHNucHJpbnRmIHNwcmludGYgc3FydCBzc2NhbmYgc3RyY2F0IHN0cmNociBzdHJjbXAgc3RyY3B5IHN0cmNzcG4gc3RybGVuIHN0cm5jYXQgc3RybmNtcCBzdHJuY3B5IHN0cnBicmsgc3RycmNociBzdHJzcG4gc3Ryc3RyIHRhbmggdGFuIHZmcHJpbnRmIHZwcmludGYgdnNwcmludGYgZW5kbCBpbml0aWFsaXplcl9saXN0IHVuaXF1ZV9wdHIiLGxpdGVyYWw6InRydWUgZmFsc2UgbnVsbHB0ciBOVUxMIn0sbj1bZSx0LkNMQ00sdC5DQkNNLHMscl07cmV0dXJue2FsaWFzZXM6WyJjIiwiY2MiLCJoIiwiYysrIiwiaCsrIiwiaHBwIl0sazpjLGk6IjwvIixjOm4uY29uY2F0KFtpLHtiOiJcXGIoZGVxdWV8bGlzdHxxdWV1ZXxzdGFja3x2ZWN0b3J8bWFwfHNldHxiaXRzZXR8bXVsdGlzZXR8bXVsdGltYXB8dW5vcmRlcmVkX21hcHx1bm9yZGVyZWRfc2V0fHVub3JkZXJlZF9tdWx0aXNldHx1bm9yZGVyZWRfbXVsdGltYXB8YXJyYXkpXFxzKjwiLGU6Ij4iLGs6YyxjOlsic2VsZiIsZV19LHtiOnQuSVIrIjo6IixrOmN9LHt2Olt7YjovPS8sZTovOy99LHtiOi9cKC8sZTovXCkvfSx7Yks6Im5ldyB0aHJvdyByZXR1cm4gZWxzZSIsZTovOy99XSxrOmMsYzpuLmNvbmNhdChbe2I6L1woLyxlOi9cKS8sazpjLGM6bi5jb25jYXQoWyJzZWxmIl0pLHI6MH1dKSxyOjB9LHtjTjoiZnVuY3Rpb24iLGI6IigiK3QuSVIrIltcXComXFxzXSspKyIrYSxyQjohMCxlOi9bezs9XS8sZUU6ITAsazpjLGk6L1teXHdcc1wqJl0vLGM6W3tiOmEsckI6ITAsYzpbdC5UTV0scjowfSx7Y046InBhcmFtcyIsYjovXCgvLGU6L1wpLyxrOmMscjowLGM6W3QuQ0xDTSx0LkNCQ00scixzLGVdfSx0LkNMQ00sdC5DQkNNLGldfSx7Y046ImNsYXNzIixiSzoiY2xhc3Mgc3RydWN0IixlOi9bezs6XS8sYzpbe2I6LzwvLGU6Lz4vLGM6WyJzZWxmIl19LHQuVE1dfV0pLGV4cG9ydHM6e3ByZXByb2Nlc3NvcjppLHN0cmluZ3M6cixrOmN9fX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgicnVieSIsZnVuY3Rpb24oZSl7dmFyIGI9IlthLXpBLVpfXVxcdypbIT89XT98Wy0rfl1cXEB8PDx8Pj58PX58PT09P3w8PT58Wzw+XT0/fFxcKlxcKnxbLS8rJV4mKn5gfF18XFxbXFxdPT8iLHI9e2tleXdvcmQ6ImFuZCB0aGVuIGRlZmluZWQgbW9kdWxlIGluIHJldHVybiByZWRvIGlmIEJFR0lOIHJldHJ5IGVuZCBmb3Igc2VsZiB3aGVuIG5leHQgdW50aWwgZG8gYmVnaW4gdW5sZXNzIEVORCByZXNjdWUgZWxzZSBicmVhayB1bmRlZiBub3Qgc3VwZXIgY2xhc3MgY2FzZSByZXF1aXJlIHlpZWxkIGFsaWFzIHdoaWxlIGVuc3VyZSBlbHNpZiBvciBpbmNsdWRlIGF0dHJfcmVhZGVyIGF0dHJfd3JpdGVyIGF0dHJfYWNjZXNzb3IiLGxpdGVyYWw6InRydWUgZmFsc2UgbmlsIn0sYz17Y046ImRvY3RhZyIsYjoiQFtBLVphLXpdKyJ9LGE9e2I6IiM8IixlOiI+In0scz1bZS5DKCIjIiwiJCIse2M6W2NdfSksZS5DKCJeXFw9YmVnaW4iLCJeXFw9ZW5kIix7YzpbY10scjoxMH0pLGUuQygiXl9fRU5EX18iLCJcXG4kIildLG49e2NOOiJzdWJzdCIsYjoiI1xceyIsZToifSIsazpyfSx0PXtjTjoic3RyaW5nIixjOltlLkJFLG5dLHY6W3tiOi8nLyxlOi8nL30se2I6LyIvLGU6LyIvfSx7YjovYC8sZTovYC99LHtiOiIlW3FRd1d4XT9cXCgiLGU6IlxcKSJ9LHtiOiIlW3FRd1d4XT9cXFsiLGU6IlxcXSJ9LHtiOiIlW3FRd1d4XT97IixlOiJ9In0se2I6IiVbcVF3V3hdPzwiLGU6Ij4ifSx7YjoiJVtxUXdXeF0/LyIsZToiLyJ9LHtiOiIlW3FRd1d4XT8lIixlOiIlIn0se2I6IiVbcVF3V3hdPy0iLGU6Ii0ifSx7YjoiJVtxUXdXeF0/XFx8IixlOiJcXHwifSx7YjovXEJcPyhcXFxkezEsM318XFx4W0EtRmEtZjAtOV17MSwyfXxcXHVbQS1GYS1mMC05XXs0fXxcXD9cUylcYi99LHtiOi88PCgtPylcdyskLyxlOi9eXHMqXHcrJC99XX0saT17Y046InBhcmFtcyIsYjoiXFwoIixlOiJcXCkiLGVuZHNQYXJlbnQ6ITAsazpyfSxkPVt0LGEse2NOOiJjbGFzcyIsYks6ImNsYXNzIG1vZHVsZSIsZToiJHw7IixpOi89LyxjOltlLmluaGVyaXQoZS5UTSx7YjoiW0EtWmEtel9dXFx3Kig6OlxcdyspKihcXD98XFwhKT8ifSkse2I6IjxcXHMqIixjOlt7YjoiKCIrZS5JUisiOjopPyIrZS5JUn1dfV0uY29uY2F0KHMpfSx7Y046ImZ1bmN0aW9uIixiSzoiZGVmIixlOiIkfDsiLGM6W2UuaW5oZXJpdChlLlRNLHtiOmJ9KSxpXS5jb25jYXQocyl9LHtiOmUuSVIrIjo6In0se2NOOiJzeW1ib2wiLGI6ZS5VSVIrIihcXCF8XFw/KT86IixyOjB9LHtjTjoic3ltYm9sIixiOiI6KD8hXFxzKSIsYzpbdCx7YjpifV0scjowfSx7Y046Im51bWJlciIsYjoiKFxcYjBbMC03X10rKXwoXFxiMHhbMC05YS1mQS1GX10rKXwoXFxiWzEtOV1bMC05X10qKFxcLlswLTlfXSspPyl8WzBfXVxcYiIscjowfSx7YjoiKFxcJFxcVyl8KChcXCR8XFxAXFxAPykoXFx3KykpIn0se2NOOiJwYXJhbXMiLGI6L1x8LyxlOi9cfC8sazpyfSx7YjoiKCIrZS5SU1IrInx1bmxlc3MpXFxzKiIsazoidW5sZXNzIixjOlthLHtjTjoicmVnZXhwIixjOltlLkJFLG5dLGk6L1xuLyx2Olt7YjoiLyIsZToiL1thLXpdKiJ9LHtiOiIlcnsiLGU6In1bYS16XSoifSx7YjoiJXJcXCgiLGU6IlxcKVthLXpdKiJ9LHtiOiIlciEiLGU6IiFbYS16XSoifSx7YjoiJXJcXFsiLGU6IlxcXVthLXpdKiJ9XX1dLmNvbmNhdChzKSxyOjB9XS5jb25jYXQocyk7bi5jPWQsaS5jPWQ7dmFyIGw9Ils+P10+IixvPSJbXFx3I10rXFwoXFx3K1xcKTpcXGQrOlxcZCs+Iix1PSIoXFx3Ky0pP1xcZCtcXC5cXGQrXFwuXFxkKHBcXGQrKT9bXj5dKz4iLHc9W3tiOi9eXHMqPT4vLHN0YXJ0czp7ZToiJCIsYzpkfX0se2NOOiJtZXRhIixiOiJeKCIrbCsifCIrbysifCIrdSsiKSIsc3RhcnRzOntlOiIkIixjOmR9fV07cmV0dXJue2FsaWFzZXM6WyJyYiIsImdlbXNwZWMiLCJwb2RzcGVjIiwidGhvciIsImlyYiJdLGs6cixpOi9cL1wqLyxjOnMuY29uY2F0KHcpLmNvbmNhdChkKX19KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoInlhbWwiLGZ1bmN0aW9uKGUpe3ZhciBiPSJ0cnVlIGZhbHNlIHllcyBubyBudWxsIixhPSJeWyBcXC1dKiIscj0iW2EtekEtWl9dW1xcd1xcLV0qIix0PXtjTjoiYXR0ciIsdjpbe2I6YStyKyI6In0se2I6YSsnIicrcisnIjonfSx7YjphKyInIityKyInOiJ9XX0sYz17Y046InRlbXBsYXRlLXZhcmlhYmxlIix2Olt7Yjoie3siLGU6In19In0se2I6IiV7IixlOiJ9In1dfSxsPXtjTjoic3RyaW5nIixyOjAsdjpbe2I6LycvLGU6LycvfSx7YjovIi8sZTovIi99LHtiOi9cUysvfV0sYzpbZS5CRSxjXX07cmV0dXJue2NJOiEwLGFsaWFzZXM6WyJ5bWwiLCJZQU1MIiwieWFtbCJdLGM6W3Qse2NOOiJtZXRhIixiOiJeLS0tcyokIixyOjEwfSx7Y046InN0cmluZyIsYjoiW1xcfD5dICokIixyRTohMCxjOmwuYyxlOnQudlswXS5ifSx7YjoiPCVbJT0tXT8iLGU6IlslLV0/JT4iLHNMOiJydWJ5IixlQjohMCxlRTohMCxyOjB9LHtjTjoidHlwZSIsYjoiISEiK2UuVUlSfSx7Y046Im1ldGEiLGI6IiYiK2UuVUlSKyIkIn0se2NOOiJtZXRhIixiOiJcXCoiK2UuVUlSKyIkIn0se2NOOiJidWxsZXQiLGI6Il4gKi0iLHI6MH0sZS5IQ00se2JLOmIsazp7bGl0ZXJhbDpifX0sZS5DTk0sbF19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJjc3MiLGZ1bmN0aW9uKGUpe3ZhciBjPSJbYS16QS1aLV1bYS16QS1aMC05Xy1dKiIsdD17YjovW0EtWlxfXC5cLV0rXHMqOi8sckI6ITAsZToiOyIsZVc6ITAsYzpbe2NOOiJhdHRyaWJ1dGUiLGI6L1xTLyxlOiI6IixlRTohMCxzdGFydHM6e2VXOiEwLGVFOiEwLGM6W3tiOi9bXHctXStcKC8sckI6ITAsYzpbe2NOOiJidWlsdF9pbiIsYjovW1x3LV0rL30se2I6L1woLyxlOi9cKS8sYzpbZS5BU00sZS5RU01dfV19LGUuQ1NTTk0sZS5RU00sZS5BU00sZS5DQkNNLHtjTjoibnVtYmVyIixiOiIjWzAtOUEtRmEtZl0rIn0se2NOOiJtZXRhIixiOiIhaW1wb3J0YW50In1dfX1dfTtyZXR1cm57Y0k6ITAsaTovWz1cL3wnXCRdLyxjOltlLkNCQ00se2NOOiJzZWxlY3Rvci1pZCIsYjovI1tBLVphLXowLTlfLV0rL30se2NOOiJzZWxlY3Rvci1jbGFzcyIsYjovXC5bQS1aYS16MC05Xy1dKy99LHtjTjoic2VsZWN0b3ItYXR0ciIsYjovXFsvLGU6L1xdLyxpOiIkIn0se2NOOiJzZWxlY3Rvci1wc2V1ZG8iLGI6LzooOik/W2EtekEtWjAtOVxfXC1cK1woXCkiJy5dKy99LHtiOiJAKGZvbnQtZmFjZXxwYWdlKSIsbDoiW2Etei1dKyIsazoiZm9udC1mYWNlIHBhZ2UifSx7YjoiQCIsZToiW3s7XSIsaTovOi8sYzpbe2NOOiJrZXl3b3JkIixiOi9cdysvfSx7YjovXHMvLGVXOiEwLGVFOiEwLHI6MCxjOltlLkFTTSxlLlFTTSxlLkNTU05NXX1dfSx7Y046InNlbGVjdG9yLXRhZyIsYjpjLHI6MH0se2I6InsiLGU6In0iLGk6L1xTLyxjOltlLkNCQ00sdF19XX19KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoImZvcnRyYW4iLGZ1bmN0aW9uKGUpe3ZhciB0PXtjTjoicGFyYW1zIixiOiJcXCgiLGU6IlxcKSJ9LG49e2xpdGVyYWw6Ii5GYWxzZS4gLlRydWUuIixrZXl3b3JkOiJraW5kIGRvIHdoaWxlIHByaXZhdGUgY2FsbCBpbnRyaW5zaWMgd2hlcmUgZWxzZXdoZXJlIHR5cGUgZW5kdHlwZSBlbmRtb2R1bGUgZW5kc2VsZWN0IGVuZGludGVyZmFjZSBlbmQgZW5kZG8gZW5kaWYgaWYgZm9yYWxsIGVuZGZvcmFsbCBvbmx5IGNvbnRhaW5zIGRlZmF1bHQgcmV0dXJuIHN0b3AgdGhlbiBwdWJsaWMgc3Vicm91dGluZXwxMCBmdW5jdGlvbiBwcm9ncmFtIC5hbmQuIC5vci4gLm5vdC4gLmxlLiAuZXEuIC5nZS4gLmd0LiAubHQuIGdvdG8gc2F2ZSBlbHNlIHVzZSBtb2R1bGUgc2VsZWN0IGNhc2UgYWNjZXNzIGJsYW5rIGRpcmVjdCBleGlzdCBmaWxlIGZtdCBmb3JtIGZvcm1hdHRlZCBpb3N0YXQgbmFtZSBuYW1lZCBuZXh0cmVjIG51bWJlciBvcGVuZWQgcmVjIHJlY2wgc2VxdWVudGlhbCBzdGF0dXMgdW5mb3JtYXR0ZWQgdW5pdCBjb250aW51ZSBmb3JtYXQgcGF1c2UgY3ljbGUgZXhpdCBjX251bGxfY2hhciBjX2FsZXJ0IGNfYmFja3NwYWNlIGNfZm9ybV9mZWVkIGZsdXNoIHdhaXQgZGVjaW1hbCByb3VuZCBpb21zZyBzeW5jaHJvbm91cyBub3Bhc3Mgbm9uX292ZXJyaWRhYmxlIHBhc3MgcHJvdGVjdGVkIHZvbGF0aWxlIGFic3RyYWN0IGV4dGVuZHMgaW1wb3J0IG5vbl9pbnRyaW5zaWMgdmFsdWUgZGVmZXJyZWQgZ2VuZXJpYyBmaW5hbCBlbnVtZXJhdG9yIGNsYXNzIGFzc29jaWF0ZSBiaW5kIGVudW0gY19pbnQgY19zaG9ydCBjX2xvbmcgY19sb25nX2xvbmcgY19zaWduZWRfY2hhciBjX3NpemVfdCBjX2ludDhfdCBjX2ludDE2X3QgY19pbnQzMl90IGNfaW50NjRfdCBjX2ludF9sZWFzdDhfdCBjX2ludF9sZWFzdDE2X3QgY19pbnRfbGVhc3QzMl90IGNfaW50X2xlYXN0NjRfdCBjX2ludF9mYXN0OF90IGNfaW50X2Zhc3QxNl90IGNfaW50X2Zhc3QzMl90IGNfaW50X2Zhc3Q2NF90IGNfaW50bWF4X3QgQ19pbnRwdHJfdCBjX2Zsb2F0IGNfZG91YmxlIGNfbG9uZ19kb3VibGUgY19mbG9hdF9jb21wbGV4IGNfZG91YmxlX2NvbXBsZXggY19sb25nX2RvdWJsZV9jb21wbGV4IGNfYm9vbCBjX2NoYXIgY19udWxsX3B0ciBjX251bGxfZnVucHRyIGNfbmV3X2xpbmUgY19jYXJyaWFnZV9yZXR1cm4gY19ob3Jpem9udGFsX3RhYiBjX3ZlcnRpY2FsX3RhYiBpc29fY19iaW5kaW5nIGNfbG9jIGNfZnVubG9jIGNfYXNzb2NpYXRlZCAgY19mX3BvaW50ZXIgY19wdHIgY19mdW5wdHIgaXNvX2ZvcnRyYW5fZW52IGNoYXJhY3Rlcl9zdG9yYWdlX3NpemUgZXJyb3JfdW5pdCBmaWxlX3N0b3JhZ2Vfc2l6ZSBpbnB1dF91bml0IGlvc3RhdF9lbmQgaW9zdGF0X2VvciBudW1lcmljX3N0b3JhZ2Vfc2l6ZSBvdXRwdXRfdW5pdCBjX2ZfcHJvY3BvaW50ZXIgaWVlZV9hcml0aG1ldGljIGllZWVfc3VwcG9ydF91bmRlcmZsb3dfY29udHJvbCBpZWVlX2dldF91bmRlcmZsb3dfbW9kZSBpZWVlX3NldF91bmRlcmZsb3dfbW9kZSBuZXd1bml0IGNvbnRpZ3VvdXMgcmVjdXJzaXZlIHBhZCBwb3NpdGlvbiBhY3Rpb24gZGVsaW0gcmVhZHdyaXRlIGVvciBhZHZhbmNlIG5tbCBpbnRlcmZhY2UgcHJvY2VkdXJlIG5hbWVsaXN0IGluY2x1ZGUgc2VxdWVuY2UgZWxlbWVudGFsIHB1cmUgaW50ZWdlciByZWFsIGNoYXJhY3RlciBjb21wbGV4IGxvZ2ljYWwgZGltZW5zaW9uIGFsbG9jYXRhYmxlfDEwIHBhcmFtZXRlciBleHRlcm5hbCBpbXBsaWNpdHwxMCBub25lIGRvdWJsZSBwcmVjaXNpb24gYXNzaWduIGludGVudCBvcHRpb25hbCBwb2ludGVyIHRhcmdldCBpbiBvdXQgY29tbW9uIGVxdWl2YWxlbmNlIGRhdGEiLGJ1aWx0X2luOiJhbG9nIGFsb2cxMCBhbWF4MCBhbWF4MSBhbWluMCBhbWluMSBhbW9kIGNhYnMgY2NvcyBjZXhwIGNsb2cgY3NpbiBjc3FydCBkYWJzIGRhY29zIGRhc2luIGRhdGFuIGRhdGFuMiBkY29zIGRjb3NoIGRkaW0gZGV4cCBkaW50IGRsb2cgZGxvZzEwIGRtYXgxIGRtaW4xIGRtb2QgZG5pbnQgZHNpZ24gZHNpbiBkc2luaCBkc3FydCBkdGFuIGR0YW5oIGZsb2F0IGlhYnMgaWRpbSBpZGludCBpZG5pbnQgaWZpeCBpc2lnbiBtYXgwIG1heDEgbWluMCBtaW4xIHNuZ2wgYWxnYW1hIGNkYWJzIGNkY29zIGNkZXhwIGNkbG9nIGNkc2luIGNkc3FydCBjcWFicyBjcWNvcyBjcWV4cCBjcWxvZyBjcXNpbiBjcXNxcnQgZGNtcGx4IGRjb25qZyBkZXJmIGRlcmZjIGRmbG9hdCBkZ2FtbWEgZGltYWcgZGxnYW1hIGlxaW50IHFhYnMgcWFjb3MgcWFzaW4gcWF0YW4gcWF0YW4yIHFjbXBseCBxY29uamcgcWNvcyBxY29zaCBxZGltIHFlcmYgcWVyZmMgcWV4cCBxZ2FtbWEgcWltYWcgcWxnYW1hIHFsb2cgcWxvZzEwIHFtYXgxIHFtaW4xIHFtb2QgcW5pbnQgcXNpZ24gcXNpbiBxc2luaCBxc3FydCBxdGFuIHF0YW5oIGFicyBhY29zIGFpbWFnIGFpbnQgYW5pbnQgYXNpbiBhdGFuIGF0YW4yIGNoYXIgY21wbHggY29uamcgY29zIGNvc2ggZXhwIGljaGFyIGluZGV4IGludCBsb2cgbG9nMTAgbWF4IG1pbiBuaW50IHNpZ24gc2luIHNpbmggc3FydCB0YW4gdGFuaCBwcmludCB3cml0ZSBkaW0gbGdlIGxndCBsbGUgbGx0IG1vZCBudWxsaWZ5IGFsbG9jYXRlIGRlYWxsb2NhdGUgYWRqdXN0bCBhZGp1c3RyIGFsbCBhbGxvY2F0ZWQgYW55IGFzc29jaWF0ZWQgYml0X3NpemUgYnRlc3QgY2VpbGluZyBjb3VudCBjc2hpZnQgZGF0ZV9hbmRfdGltZSBkaWdpdHMgZG90X3Byb2R1Y3QgZW9zaGlmdCBlcHNpbG9uIGV4cG9uZW50IGZsb29yIGZyYWN0aW9uIGh1Z2UgaWFuZCBpYmNsciBpYml0cyBpYnNldCBpZW9yIGlvciBpc2hmdCBpc2hmdGMgbGJvdW5kIGxlbl90cmltIG1hdG11bCBtYXhleHBvbmVudCBtYXhsb2MgbWF4dmFsIG1lcmdlIG1pbmV4cG9uZW50IG1pbmxvYyBtaW52YWwgbW9kdWxvIG12Yml0cyBuZWFyZXN0IHBhY2sgcHJlc2VudCBwcm9kdWN0IHJhZGl4IHJhbmRvbV9udW1iZXIgcmFuZG9tX3NlZWQgcmFuZ2UgcmVwZWF0IHJlc2hhcGUgcnJzcGFjaW5nIHNjYWxlIHNjYW4gc2VsZWN0ZWRfaW50X2tpbmQgc2VsZWN0ZWRfcmVhbF9raW5kIHNldF9leHBvbmVudCBzaGFwZSBzaXplIHNwYWNpbmcgc3ByZWFkIHN1bSBzeXN0ZW1fY2xvY2sgdGlueSB0cmFuc3Bvc2UgdHJpbSB1Ym91bmQgdW5wYWNrIHZlcmlmeSBhY2hhciBpYWNoYXIgdHJhbnNmZXIgZGJsZSBlbnRyeSBkcHJvZCBjcHVfdGltZSBjb21tYW5kX2FyZ3VtZW50X2NvdW50IGdldF9jb21tYW5kIGdldF9jb21tYW5kX2FyZ3VtZW50IGdldF9lbnZpcm9ubWVudF92YXJpYWJsZSBpc19pb3N0YXRfZW5kIGllZWVfYXJpdGhtZXRpYyBpZWVlX3N1cHBvcnRfdW5kZXJmbG93X2NvbnRyb2wgaWVlZV9nZXRfdW5kZXJmbG93X21vZGUgaWVlZV9zZXRfdW5kZXJmbG93X21vZGUgaXNfaW9zdGF0X2VvciBtb3ZlX2FsbG9jIG5ld19saW5lIHNlbGVjdGVkX2NoYXJfa2luZCBzYW1lX3R5cGVfYXMgZXh0ZW5kc190eXBlX29mYWNvc2ggYXNpbmggYXRhbmggYmVzc2VsX2owIGJlc3NlbF9qMSBiZXNzZWxfam4gYmVzc2VsX3kwIGJlc3NlbF95MSBiZXNzZWxfeW4gZXJmIGVyZmMgZXJmY19zY2FsZWQgZ2FtbWEgbG9nX2dhbW1hIGh5cG90IG5vcm0yIGF0b21pY19kZWZpbmUgYXRvbWljX3JlZiBleGVjdXRlX2NvbW1hbmRfbGluZSBsZWFkeiB0cmFpbHogc3RvcmFnZV9zaXplIG1lcmdlX2JpdHMgYmdlIGJndCBibGUgYmx0IGRzaGlmdGwgZHNoaWZ0ciBmaW5kbG9jIGlhbGwgaWFueSBpcGFyaXR5IGltYWdlX2luZGV4IGxjb2JvdW5kIHVjb2JvdW5kIG1hc2tsIG1hc2tyIG51bV9pbWFnZXMgcGFyaXR5IHBvcGNudCBwb3BwYXIgc2hpZnRhIHNoaWZ0bCBzaGlmdHIgdGhpc19pbWFnZSJ9O3JldHVybntjSTohMCxhbGlhc2VzOlsiZjkwIiwiZjk1Il0sazpuLGk6L1wvXCovLGM6W2UuaW5oZXJpdChlLkFTTSx7Y046InN0cmluZyIscjowfSksZS5pbmhlcml0KGUuUVNNLHtjTjoic3RyaW5nIixyOjB9KSx7Y046ImZ1bmN0aW9uIixiSzoic3Vicm91dGluZSBmdW5jdGlvbiBwcm9ncmFtIixpOiJbJHs9XFxuXSIsYzpbZS5VVE0sdF19LGUuQygiISIsIiQiLHtyOjB9KSx7Y046Im51bWJlciIsYjoiKD89XFxifFxcK3xcXC18XFwuKSg/PVxcLlxcZHxcXGQpKD86XFxkKyk/KD86XFwuP1xcZCopKD86W2RlXVsrLV0/XFxkKyk/XFxiXFwuPyIscjowfV19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJhd2siLGZ1bmN0aW9uKGUpe3ZhciByPXtjTjoidmFyaWFibGUiLHY6W3tiOi9cJFtcd1xkI0BdW1x3XGRfXSovfSx7YjovXCRceyguKj8pfS99XX0sYj0iQkVHSU4gRU5EIGlmIGVsc2Ugd2hpbGUgZG8gZm9yIGluIGJyZWFrIGNvbnRpbnVlIGRlbGV0ZSBuZXh0IG5leHRmaWxlIGZ1bmN0aW9uIGZ1bmMgZXhpdHwxMCIsbj17Y046InN0cmluZyIsYzpbZS5CRV0sdjpbe2I6Lyh1fGIpP3I/JycnLyxlOi8nJycvLHI6MTB9LHtiOi8odXxiKT9yPyIiIi8sZTovIiIiLyxyOjEwfSx7YjovKHV8cnx1ciknLyxlOi8nLyxyOjEwfSx7YjovKHV8cnx1cikiLyxlOi8iLyxyOjEwfSx7YjovKGJ8YnIpJy8sZTovJy99LHtiOi8oYnxicikiLyxlOi8iL30sZS5BU00sZS5RU01dfTtyZXR1cm57azp7a2V5d29yZDpifSxjOltyLG4sZS5STSxlLkhDTSxlLk5NXX19KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoIm1ha2VmaWxlIixmdW5jdGlvbihlKXt2YXIgaT17Y046InZhcmlhYmxlIix2Olt7YjoiXFwkXFwoIitlLlVJUisiXFwpIixjOltlLkJFXX0se2I6L1wkW0AlPD9cXlwrXCpdL31dfSxyPXtjTjoic3RyaW5nIixiOi8iLyxlOi8iLyxjOltlLkJFLGldfSxhPXtjTjoidmFyaWFibGUiLGI6L1wkXChbXHctXStccy8sZTovXCkvLGs6e2J1aWx0X2luOiJzdWJzdCBwYXRzdWJzdCBzdHJpcCBmaW5kc3RyaW5nIGZpbHRlciBmaWx0ZXItb3V0IHNvcnQgd29yZCB3b3JkbGlzdCBmaXJzdHdvcmQgbGFzdHdvcmQgZGlyIG5vdGRpciBzdWZmaXggYmFzZW5hbWUgYWRkc3VmZml4IGFkZHByZWZpeCBqb2luIHdpbGRjYXJkIHJlYWxwYXRoIGFic3BhdGggZXJyb3Igd2FybmluZyBzaGVsbCBvcmlnaW4gZmxhdm9yIGZvcmVhY2ggaWYgb3IgYW5kIGNhbGwgZXZhbCBmaWxlIHZhbHVlIn0sYzpbaV19LG49e2I6Il4iK2UuVUlSKyJcXHMqWzorP10/PSIsaToiXFxuIixyQjohMCxjOlt7YjoiXiIrZS5VSVIsZToiWzorP10/PSIsZUU6ITB9XX0sdD17Y046Im1ldGEiLGI6L15cLlBIT05ZOi8sZTovJC8sazp7Im1ldGEta2V5d29yZCI6Ii5QSE9OWSJ9LGw6L1tcLlx3XSsvfSxsPXtjTjoic2VjdGlvbiIsYjovXlteXHNdKzovLGU6LyQvLGM6W2ldfTtyZXR1cm57YWxpYXNlczpbIm1rIiwibWFrIl0sazoiZGVmaW5lIGVuZGVmIHVuZGVmaW5lIGlmZGVmIGlmbmRlZiBpZmVxIGlmbmVxIGVsc2UgZW5kaWYgaW5jbHVkZSAtaW5jbHVkZSBzaW5jbHVkZSBvdmVycmlkZSBleHBvcnQgdW5leHBvcnQgcHJpdmF0ZSB2cGF0aCIsbDovW1x3LV0rLyxjOltlLkhDTSxpLHIsYSxuLHQsbF19fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJqYXZhIixmdW5jdGlvbihlKXt2YXIgYT0iW8OALcq4YS16QS1aXyRdW8OALcq4YS16QS1aXyQwLTldKiIsdD1hKyIoPCIrYSsiKFxccyosXFxzKiIrYSsiKSo+KT8iLHI9ImZhbHNlIHN5bmNocm9uaXplZCBpbnQgYWJzdHJhY3QgZmxvYXQgcHJpdmF0ZSBjaGFyIGJvb2xlYW4gc3RhdGljIG51bGwgaWYgY29uc3QgZm9yIHRydWUgd2hpbGUgbG9uZyBzdHJpY3RmcCBmaW5hbGx5IHByb3RlY3RlZCBpbXBvcnQgbmF0aXZlIGZpbmFsIHZvaWQgZW51bSBlbHNlIGJyZWFrIHRyYW5zaWVudCBjYXRjaCBpbnN0YW5jZW9mIGJ5dGUgc3VwZXIgdm9sYXRpbGUgY2FzZSBhc3NlcnQgc2hvcnQgcGFja2FnZSBkZWZhdWx0IGRvdWJsZSBwdWJsaWMgdHJ5IHRoaXMgc3dpdGNoIGNvbnRpbnVlIHRocm93cyBwcm90ZWN0ZWQgcHVibGljIHByaXZhdGUgbW9kdWxlIHJlcXVpcmVzIGV4cG9ydHMgZG8iLHM9IlxcYigwW2JCXShbMDFdK1swMV9dK1swMV0rfFswMV0rKXwwW3hYXShbYS1mQS1GMC05XStbYS1mQS1GMC05X10rW2EtZkEtRjAtOV0rfFthLWZBLUYwLTldKyl8KChbXFxkXStbXFxkX10rW1xcZF0rfFtcXGRdKykoXFwuKFtcXGRdK1tcXGRfXStbXFxkXSt8W1xcZF0rKSk/fFxcLihbXFxkXStbXFxkX10rW1xcZF0rfFtcXGRdKykpKFtlRV1bLStdP1xcZCspPylbbExmRl0/IixjPXtjTjoibnVtYmVyIixiOnMscjowfTtyZXR1cm57YWxpYXNlczpbImpzcCJdLGs6cixpOi88XC98Iy8sYzpbZS5DKCIvXFwqXFwqIiwiXFwqLyIse3I6MCxjOlt7YjovXHcrQC8scjowfSx7Y046ImRvY3RhZyIsYjoiQFtBLVphLXpdKyJ9XX0pLGUuQ0xDTSxlLkNCQ00sZS5BU00sZS5RU00se2NOOiJjbGFzcyIsYks6ImNsYXNzIGludGVyZmFjZSIsZTovW3s7PV0vLGVFOiEwLGs6ImNsYXNzIGludGVyZmFjZSIsaTovWzoiXFtcXV0vLGM6W3tiSzoiZXh0ZW5kcyBpbXBsZW1lbnRzIn0sZS5VVE1dfSx7Yks6Im5ldyB0aHJvdyByZXR1cm4gZWxzZSIscjowfSx7Y046ImZ1bmN0aW9uIixiOiIoIit0KyJcXHMrKSsiK2UuVUlSKyJcXHMqXFwoIixyQjohMCxlOi9bezs9XS8sZUU6ITAsazpyLGM6W3tiOmUuVUlSKyJcXHMqXFwoIixyQjohMCxyOjAsYzpbZS5VVE1dfSx7Y046InBhcmFtcyIsYjovXCgvLGU6L1wpLyxrOnIscjowLGM6W2UuQVNNLGUuUVNNLGUuQ05NLGUuQ0JDTV19LGUuQ0xDTSxlLkNCQ01dfSxjLHtjTjoibWV0YSIsYjoiQFtBLVphLXpdKyJ9XX19KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoInN0YW4iLGZ1bmN0aW9uKGUpe3JldHVybntjOltlLkhDTSxlLkNMQ00sZS5DQkNNLHtiOmUuVUlSLGw6ZS5VSVIsazp7bmFtZToiZm9yIGluIHdoaWxlIHJlcGVhdCB1bnRpbCBpZiB0aGVuIGVsc2UiLHN5bWJvbDoiYmVybm91bGxpIGJlcm5vdWxsaV9sb2dpdCBiaW5vbWlhbCBiaW5vbWlhbF9sb2dpdCBiZXRhX2Jpbm9taWFsIGh5cGVyZ2VvbWV0cmljIGNhdGVnb3JpY2FsIGNhdGVnb3JpY2FsX2xvZ2l0IG9yZGVyZWRfbG9naXN0aWMgbmVnX2Jpbm9taWFsIG5lZ19iaW5vbWlhbF8yIG5lZ19iaW5vbWlhbF8yX2xvZyBwb2lzc29uIHBvaXNzb25fbG9nIG11bHRpbm9taWFsIG5vcm1hbCBleHBfbW9kX25vcm1hbCBza2V3X25vcm1hbCBzdHVkZW50X3QgY2F1Y2h5IGRvdWJsZV9leHBvbmVudGlhbCBsb2dpc3RpYyBndW1iZWwgbG9nbm9ybWFsIGNoaV9zcXVhcmUgaW52X2NoaV9zcXVhcmUgc2NhbGVkX2ludl9jaGlfc3F1YXJlIGV4cG9uZW50aWFsIGludl9nYW1tYSB3ZWlidWxsIGZyZWNoZXQgcmF5bGVpZ2ggd2llbmVyIHBhcmV0byBwYXJldG9fdHlwZV8yIHZvbl9taXNlcyB1bmlmb3JtIG11bHRpX25vcm1hbCBtdWx0aV9ub3JtYWxfcHJlYyBtdWx0aV9ub3JtYWxfY2hvbGVza3kgbXVsdGlfZ3AgbXVsdGlfZ3BfY2hvbGVza3kgbXVsdGlfc3R1ZGVudF90IGdhdXNzaWFuX2RsbV9vYnMgZGlyaWNobGV0IGxral9jb3JyIGxral9jb3JyX2Nob2xlc2t5IHdpc2hhcnQgaW52X3dpc2hhcnQiLCJzZWxlY3Rvci10YWciOiJpbnQgcmVhbCB2ZWN0b3Igc2ltcGxleCB1bml0X3ZlY3RvciBvcmRlcmVkIHBvc2l0aXZlX29yZGVyZWQgcm93X3ZlY3RvciBtYXRyaXggY2hvbGVza3lfZmFjdG9yX2NvcnIgY2hvbGVza3lfZmFjdG9yX2NvdiBjb3JyX21hdHJpeCBjb3ZfbWF0cml4Iix0aXRsZToiZnVuY3Rpb25zIG1vZGVsIGRhdGEgcGFyYW1ldGVycyBxdWFudGl0aWVzIHRyYW5zZm9ybWVkIGdlbmVyYXRlZCIsbGl0ZXJhbDoidHJ1ZSBmYWxzZSJ9LHI6MH0se2NOOiJudW1iZXIiLGI6IjBbeFhdWzAtOWEtZkEtRl0rW0xpXT9cXGIiLHI6MH0se2NOOiJudW1iZXIiLGI6IjBbeFhdWzAtOWEtZkEtRl0rW0xpXT9cXGIiLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcZCsoPzpbZUVdWytcXC1dP1xcZCopP0xcXGIiLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcZCtcXC4oPyFcXGQpKD86aVxcYik/IixyOjB9LHtjTjoibnVtYmVyIixiOiJcXGQrKD86XFwuXFxkKik/KD86W2VFXVsrXFwtXT9cXGQqKT9pP1xcYiIscjowfSx7Y046Im51bWJlciIsYjoiXFwuXFxkKyg/OltlRV1bK1xcLV0/XFxkKik/aT9cXGIiLHI6MH1dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgiamF2YXNjcmlwdCIsZnVuY3Rpb24oZSl7dmFyIHI9IltBLVphLXokX11bMC05QS1aYS16JF9dKiIsdD17a2V5d29yZDoiaW4gb2YgaWYgZm9yIHdoaWxlIGZpbmFsbHkgdmFyIG5ldyBmdW5jdGlvbiBkbyByZXR1cm4gdm9pZCBlbHNlIGJyZWFrIGNhdGNoIGluc3RhbmNlb2Ygd2l0aCB0aHJvdyBjYXNlIGRlZmF1bHQgdHJ5IHRoaXMgc3dpdGNoIGNvbnRpbnVlIHR5cGVvZiBkZWxldGUgbGV0IHlpZWxkIGNvbnN0IGV4cG9ydCBzdXBlciBkZWJ1Z2dlciBhcyBhc3luYyBhd2FpdCBzdGF0aWMgaW1wb3J0IGZyb20gYXMiLGxpdGVyYWw6InRydWUgZmFsc2UgbnVsbCB1bmRlZmluZWQgTmFOIEluZmluaXR5IixidWlsdF9pbjoiZXZhbCBpc0Zpbml0ZSBpc05hTiBwYXJzZUZsb2F0IHBhcnNlSW50IGRlY29kZVVSSSBkZWNvZGVVUklDb21wb25lbnQgZW5jb2RlVVJJIGVuY29kZVVSSUNvbXBvbmVudCBlc2NhcGUgdW5lc2NhcGUgT2JqZWN0IEZ1bmN0aW9uIEJvb2xlYW4gRXJyb3IgRXZhbEVycm9yIEludGVybmFsRXJyb3IgUmFuZ2VFcnJvciBSZWZlcmVuY2VFcnJvciBTdG9wSXRlcmF0aW9uIFN5bnRheEVycm9yIFR5cGVFcnJvciBVUklFcnJvciBOdW1iZXIgTWF0aCBEYXRlIFN0cmluZyBSZWdFeHAgQXJyYXkgRmxvYXQzMkFycmF5IEZsb2F0NjRBcnJheSBJbnQxNkFycmF5IEludDMyQXJyYXkgSW50OEFycmF5IFVpbnQxNkFycmF5IFVpbnQzMkFycmF5IFVpbnQ4QXJyYXkgVWludDhDbGFtcGVkQXJyYXkgQXJyYXlCdWZmZXIgRGF0YVZpZXcgSlNPTiBJbnRsIGFyZ3VtZW50cyByZXF1aXJlIG1vZHVsZSBjb25zb2xlIHdpbmRvdyBkb2N1bWVudCBTeW1ib2wgU2V0IE1hcCBXZWFrU2V0IFdlYWtNYXAgUHJveHkgUmVmbGVjdCBQcm9taXNlIn0sYT17Y046Im51bWJlciIsdjpbe2I6IlxcYigwW2JCXVswMV0rKSJ9LHtiOiJcXGIoMFtvT11bMC03XSspIn0se2I6ZS5DTlJ9XSxyOjB9LG49e2NOOiJzdWJzdCIsYjoiXFwkXFx7IixlOiJcXH0iLGs6dCxjOltdfSxjPXtjTjoic3RyaW5nIixiOiJgIixlOiJgIixjOltlLkJFLG5dfTtuLmM9W2UuQVNNLGUuUVNNLGMsYSxlLlJNXTt2YXIgcz1uLmMuY29uY2F0KFtlLkNCQ00sZS5DTENNXSk7cmV0dXJue2FsaWFzZXM6WyJqcyIsImpzeCJdLGs6dCxjOlt7Y046Im1ldGEiLHI6MTAsYjovXlxzKlsnIl11c2UgKHN0cmljdHxhc20pWyciXS99LHtjTjoibWV0YSIsYjovXiMhLyxlOi8kL30sZS5BU00sZS5RU00sYyxlLkNMQ00sZS5DQkNNLGEse2I6L1t7LF1ccyovLHI6MCxjOlt7YjpyKyJcXHMqOiIsckI6ITAscjowLGM6W3tjTjoiYXR0ciIsYjpyLHI6MH1dfV19LHtiOiIoIitlLlJTUisifFxcYihjYXNlfHJldHVybnx0aHJvdylcXGIpXFxzKiIsazoicmV0dXJuIHRocm93IGNhc2UiLGM6W2UuQ0xDTSxlLkNCQ00sZS5STSx7Y046ImZ1bmN0aW9uIixiOiIoXFwoLio/XFwpfCIrcisiKVxccyo9PiIsckI6ITAsZToiXFxzKj0+IixjOlt7Y046InBhcmFtcyIsdjpbe2I6cn0se2I6L1woXHMqXCkvfSx7YjovXCgvLGU6L1wpLyxlQjohMCxlRTohMCxrOnQsYzpzfV19XX0se2I6LzwvLGU6LyhcL1x3K3xcdytcLyk+LyxzTDoieG1sIixjOlt7YjovPFx3K1xzKlwvPi8sc2tpcDohMH0se2I6LzxcdysvLGU6LyhcL1x3K3xcdytcLyk+Lyxza2lwOiEwLGM6W3tiOi88XHcrXHMqXC8+Lyxza2lwOiEwfSwic2VsZiJdfV19XSxyOjB9LHtjTjoiZnVuY3Rpb24iLGJLOiJmdW5jdGlvbiIsZTovXHsvLGVFOiEwLGM6W2UuaW5oZXJpdChlLlRNLHtiOnJ9KSx7Y046InBhcmFtcyIsYjovXCgvLGU6L1wpLyxlQjohMCxlRTohMCxjOnN9XSxpOi9cW3wlL30se2I6L1wkWyguXS99LGUuTUVUSE9EX0dVQVJELHtjTjoiY2xhc3MiLGJLOiJjbGFzcyIsZTovW3s7PV0vLGVFOiEwLGk6L1s6IlxbXF1dLyxjOlt7Yks6ImV4dGVuZHMifSxlLlVUTV19LHtiSzoiY29uc3RydWN0b3IiLGU6L1x7LyxlRTohMH1dLGk6LyMoPyEhKS99fSk7aGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJ0ZXgiLGZ1bmN0aW9uKGMpe3ZhciBlPXtjTjoidGFnIixiOi9cXC8scjowLGM6W3tjTjoibmFtZSIsdjpbe2I6L1thLXpBLVrQsC3Rj9CQLdGPXStbKl0/L30se2I6L1teYS16QS1a0LAt0Y/QkC3RjzAtOV0vfV0sc3RhcnRzOntlVzohMCxyOjAsYzpbe2NOOiJzdHJpbmciLHY6W3tiOi9cWy8sZTovXF0vfSx7YjovXHsvLGU6L1x9L31dfSx7YjovXHMqPVxzKi8sZVc6ITAscjowLGM6W3tjTjoibnVtYmVyIixiOi8tP1xkKlwuP1xkKyhwdHxwY3xtbXxjbXxpbnxkZHxjY3xleHxlbSk/L31dfV19fV19O3JldHVybntjOltlLHtjTjoiZm9ybXVsYSIsYzpbZV0scjowLHY6W3tiOi9cJFwkLyxlOi9cJFwkL30se2I6L1wkLyxlOi9cJC99XX0sYy5DKCIlIiwiJCIse3I6MH0pXX19KTtobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoInhtbCIsZnVuY3Rpb24ocyl7dmFyIGU9IltBLVphLXowLTlcXC5fOi1dKyIsdD17ZVc6ITAsaTovPC8scjowLGM6W3tjTjoiYXR0ciIsYjplLHI6MH0se2I6Lz1ccyovLHI6MCxjOlt7Y046InN0cmluZyIsZW5kc1BhcmVudDohMCx2Olt7YjovIi8sZTovIi99LHtiOi8nLyxlOi8nL30se2I6L1teXHMiJz08PmBdKy99XX1dfV19O3JldHVybnthbGlhc2VzOlsiaHRtbCIsInhodG1sIiwicnNzIiwiYXRvbSIsInhqYiIsInhzZCIsInhzbCIsInBsaXN0Il0sY0k6ITAsYzpbe2NOOiJtZXRhIixiOiI8IURPQ1RZUEUiLGU6Ij4iLHI6MTAsYzpbe2I6IlxcWyIsZToiXFxdIn1dfSxzLkMoIjwhLS0iLCItLT4iLHtyOjEwfSkse2I6IjxcXCFcXFtDREFUQVxcWyIsZToiXFxdXFxdPiIscjoxMH0se2I6LzxcPyhwaHApPy8sZTovXD8+LyxzTDoicGhwIixjOlt7YjoiL1xcKiIsZToiXFwqLyIsc2tpcDohMH1dfSx7Y046InRhZyIsYjoiPHN0eWxlKD89XFxzfD58JCkiLGU6Ij4iLGs6e25hbWU6InN0eWxlIn0sYzpbdF0sc3RhcnRzOntlOiI8L3N0eWxlPiIsckU6ITAsc0w6WyJjc3MiLCJ4bWwiXX19LHtjTjoidGFnIixiOiI8c2NyaXB0KD89XFxzfD58JCkiLGU6Ij4iLGs6e25hbWU6InNjcmlwdCJ9LGM6W3RdLHN0YXJ0czp7ZToiPC9zY3JpcHQ+IixyRTohMCxzTDpbImFjdGlvbnNjcmlwdCIsImphdmFzY3JpcHQiLCJoYW5kbGViYXJzIiwieG1sIl19fSx7Y046Im1ldGEiLHY6W3tiOi88XD94bWwvLGU6L1w/Pi8scjoxMH0se2I6LzxcP1x3Ky8sZTovXD8+L31dfSx7Y046InRhZyIsYjoiPC8/IixlOiIvPz4iLGM6W3tjTjoibmFtZSIsYjovW15cLz48XHNdKy8scjowfSx0XX1dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgibWFya2Rvd24iLGZ1bmN0aW9uKGUpe3JldHVybnthbGlhc2VzOlsibWQiLCJta2Rvd24iLCJta2QiXSxjOlt7Y046InNlY3Rpb24iLHY6W3tiOiJeI3sxLDZ9IixlOiIkIn0se2I6Il4uKz9cXG5bPS1dezIsfSQifV19LHtiOiI8IixlOiI+IixzTDoieG1sIixyOjB9LHtjTjoiYnVsbGV0IixiOiJeKFsqKy1dfChcXGQrXFwuKSlcXHMrIn0se2NOOiJzdHJvbmciLGI6IlsqX117Mn0uKz9bKl9dezJ9In0se2NOOiJlbXBoYXNpcyIsdjpbe2I6IlxcKi4rP1xcKiJ9LHtiOiJfLis/XyIscjowfV19LHtjTjoicXVvdGUiLGI6Il4+XFxzKyIsZToiJCJ9LHtjTjoiY29kZSIsdjpbe2I6Il5gYGB3KnMqJCIsZToiXmBgYHMqJCJ9LHtiOiJgLis/YCJ9LHtiOiJeKCB7NH18CSkiLGU6IiQiLHI6MH1dfSx7YjoiXlstXFwqXXszLH0iLGU6IiQifSx7YjoiXFxbLis/XFxdW1xcKFxcW10uKj9bXFwpXFxdXSIsckI6ITAsYzpbe2NOOiJzdHJpbmciLGI6IlxcWyIsZToiXFxdIixlQjohMCxyRTohMCxyOjB9LHtjTjoibGluayIsYjoiXFxdXFwoIixlOiJcXCkiLGVCOiEwLGVFOiEwfSx7Y046InN5bWJvbCIsYjoiXFxdXFxbIixlOiJcXF0iLGVCOiEwLGVFOiEwfV0scjoxMH0se2I6L15cW1teXG5dK1xdOi8sckI6ITAsYzpbe2NOOiJzeW1ib2wiLGI6L1xbLyxlOi9cXS8sZUI6ITAsZUU6ITB9LHtjTjoibGluayIsYjovOlxzKi8sZTovJC8sZUI6ITB9XX1dfX0pO2hsanMucmVnaXN0ZXJMYW5ndWFnZSgianNvbiIsZnVuY3Rpb24oZSl7dmFyIGk9e2xpdGVyYWw6InRydWUgZmFsc2UgbnVsbCJ9LG49W2UuUVNNLGUuQ05NXSxyPXtlOiIsIixlVzohMCxlRTohMCxjOm4sazppfSx0PXtiOiJ7IixlOiJ9IixjOlt7Y046ImF0dHIiLGI6LyIvLGU6LyIvLGM6W2UuQkVdLGk6IlxcbiJ9LGUuaW5oZXJpdChyLHtiOi86L30pXSxpOiJcXFMifSxjPXtiOiJcXFsiLGU6IlxcXSIsYzpbZS5pbmhlcml0KHIpXSxpOiJcXFMifTtyZXR1cm4gbi5zcGxpY2Uobi5sZW5ndGgsMCx0LGMpLHtjOm4sazppLGk6IlxcUyJ9fSk7"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








</head>

<body>




<h1 class="title toc-ignore">An Introduction to CHNOSZ</h1>
<h4 class="author">Jeffrey M. Dick</h4>
<h4 class="date">2021-04-08</h4>


<div id="TOC">
<ul>
<li><a href="#overview">Overview</a><ul>
<li><a href="#installing-and-loading-chnosz">Installing and loading CHNOSZ</a></li>
<li><a href="#getting-help">Getting help</a></li>
<li><a href="#organization-of-major-functions">Organization of major functions</a></li>
</ul></li>
<li><a href="#thermodynamic-database">Thermodynamic database</a><ul>
<li><a href="#the-info-function">The <span style="color:green"><code>info()</code></span> function</a></li>
<li><a href="#fuzzy-searches">Fuzzy searches</a></li>
<li><a href="#counting-elements-chemical-formulas-zc">Counting elements, chemical formulas, <span style="color:green"><code>ZC()</code></span></a></li>
</ul></li>
<li><a href="#calculating-thermodynamic-properties">Calculating thermodynamic properties</a><ul>
<li><a href="#changing-units">Changing units</a></li>
</ul></li>
<li><a href="#properties-of-reactions">Properties of reactions</a><ul>
<li><a href="#reaction-definitions">Reaction definitions</a></li>
<li><a href="#unbalanced-reactions">Unbalanced reactions</a></li>
<li><a href="#setting-the-basis-species">Setting the basis species</a></li>
<li><a href="#automatically-balancing-reactions">Automatically balancing reactions</a></li>
<li><a href="#chemical-affinity">Chemical affinity</a></li>
</ul></li>
<li><a href="#using-affinity">Using <span style="color:green"><code>affinity()</code></span></a><ul>
<li><a href="#from-affinity-to-diagrams">From affinity to diagrams</a></li>
<li><a href="#retrieving-species-in-a-chemical-system">Retrieving species in a chemical system</a></li>
<li><a href="#mosaic-diagrams">Mosaic diagrams</a></li>
<li><a href="#t-p-activity-transects"><em>T</em>, <em>P</em>, activity transects</a></li>
<li><a href="#buffers">Buffers</a></li>
</ul></li>
<li><a href="#equilibration">Equilibration</a><ul>
<li><a href="#getting-from-affinity-to-equilibrium">Getting from affinity to equilibrium</a></li>
<li><a href="#complete-equilibrium-solubility">Complete equilibrium: Solubility</a></li>
</ul></li>
<li><a href="#activity-coefficients">Activity coefficients</a><ul>
<li><a href="#transformation-of-variables">Transformation of variables</a></li>
<li><a href="#biochemical-example">Biochemical example</a></li>
</ul></li>
<li><a href="#proteins">Proteins</a><ul>
<li><a href="#group-additivity-and-ionization">Group additivity and ionization</a></li>
<li><a href="#compositional-analysis">Compositional analysis</a></li>
<li><a href="#normalization-to-residues">Normalization to residues</a></li>
<li><a href="#getting-amino-acid-compositions">Getting amino acid compositions</a></li>
</ul></li>
<li><a href="#thermodynamic-data">Thermodynamic data</a><ul>
<li><a href="#viewing-data-sources-thermo.refs">Viewing data sources: <span style="color:green"><code>thermo.refs()</code></span></a></li>
<li><a href="#optional-data">Optional data</a></li>
<li><a href="#adding-data">Adding data</a></li>
<li><a href="#modifying-data">Modifying data</a><ul>
<li><a href="#aqueous-species">Aqueous species</a></li>
<li><a href="#solids">Solids</a></li>
</ul></li>
<li><a href="#cross-checking-data-entries">Cross-checking data entries</a></li>
<li><a href="#water-supcrt92-or-iapws-95-or-dew">Water: SUPCRT92 or IAPWS-95 or DEW</a></li>
</ul></li>
<li><a href="#functions-outside-the-main-workflow">Functions outside the main workflow</a></li>
<li><a href="#citation-and-contact-information">Citation and contact information</a></li>
<li><a href="#document-history">Document history</a></li>
</ul>
</div>

<style>
html { 
  font-size: 14px;
}
body {
  font-family: ‘Times New Roman’, Times, serif;
}
li {
  padding: 0.25rem 0;
}
/* zero margin around pre blocks (looks more like R console output) */
pre {
  margin-top: 0;
  margin-bottom: 0;
}
</style>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This vignette was made for version 1.4.1 of CHNOSZ, a package for the <a href="https://www.r-project.org/">R software environment</a>. For more information on R, see “<a href="https://cran.r-project.org/manuals.html">An Introduction to R</a>” and the <a href="https://cran.r-project.org/other-docs.html">contributed documentation</a> for R.</p>
<p>CHNOSZ has been developed since 2006 as a tool for thermodynamic calculations in geochemistry and compositional biology. The package provides functions and a thermodynamic database that can be used to calculate the stoichiometric and energetic properties of reactions involving minerals and inorganic and/or organic aqueous species. These functions also enable calculations of chemical affinities and metastable equilibrium distributions of proteins. A major feature of the package is the production of diagrams to visualize the effects of changing temperature, pressure, and activities of basis species on the potential for reactions among various species.</p>
<div id="installing-and-loading-chnosz" class="section level2">
<h2>Installing and loading CHNOSZ</h2>
<p>After starting R, install CHNOSZ by selecting the “Install packages from CRAN” or similar menu item in the R GUI or by using the following command:</p>
<pre class="r"><code>install.packages(&quot;CHNOSZ&quot;)</code></pre>
<p>Then load the CHNOSZ package to make its data and functions available in your R session:</p>
<pre class="r"><code>library(CHNOSZ)</code></pre>
<p>CHNOSZ is now ready to go with the default thermodynamic database and an empty system definition. After running some calculations, you may want to “start over” with the default values. To clear the system settings and restore the default thermodynamic database, use <span style="color:red"><code>reset()</code></span>.</p>
<pre class="r"><code>reset()</code></pre>
<pre style="color:blue">## reset: resetting &quot;thermo&quot; object
</pre>
<pre style="color:blue">## OBIGT: loading default database with 1903 aqueous, 3443 total species
</pre>
<p>Note: Throughout this document, syntax highlighting is applied to the <em>input</em> of the code chunks. Double hash marks (<code>##</code>) precede the <em>output</em>, where black text denotes <em>results</em> and blue text is used for <em>messages</em>.</p>
</div>
<div id="getting-help" class="section level2">
<h2>Getting help</h2>
<p>After CHNOSZ is installed, type <span style="color:blue"><code>help.start()</code></span> to browse the R help documents, then choose “Packages” followed by “CHNOSZ”. That shows an index of the <em>manual</em> (help pages) for each function; many of the help pages include examples. There are also links to the <em>demos</em> (longer examples) and <em>vignettes</em> (more in-depth documentation; this document is a vignette).</p>
<p>Suggestions for accessing the documentation are indicated here with <span style="color:blue">blue text</span>. For example, read <span style="color:blue"><code>?`CHNOSZ-package`</code></span> to get an overview of the package and a list of features. <label for="tufte-mn-1" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-1" class="margin-toggle"><span class="marginnote"><span style="display: block;">“<code>?</code>” is a shortcut to R’s <code>help()</code> function. The command here is equivalent to <span style="color:blue"><code>help(“CHNOSZ-package”)</code></span>.</span></span></p>
</div>
<div id="organization-of-major-functions" class="section level2">
<h2>Organization of major functions</h2>
<p>CHNOSZ is made up of a set of functions and supporting datasets. The major components of the package are shown in the figure below, which is an updated version of the diagram in <span class="citation">Dick (<label for="tufte-mn-2" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-2" class="margin-toggle">2008<span class="marginnote">Dick JM. 2008. Calculation of the relative metastabilities of proteins using the CHNOSZ software package. <em>Geochemical Transactions</em> <strong>9</strong>: 10. doi: <a href="https://doi.org/10.1186/1467-4866-9-10">10.1186/1467-4866-9-10</a></span>)</span>. Rectangles and ellipses represent functions and datasets; bold text indicates primary functions.</p>
<!-- https://stackoverflow.com/questions/14675913/how-to-change-image-size-markdown -->
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsMAAAFgCAMAAABpMoStAAADAFBMVEX////FxcXp6elgYWHMzMyxsbEODg4AAACIiIgxMTG4uLg+Pj6WlpYEAQHGxsadnZ22trYKAwJWVlVZWVn///4aGhqgoKD6+vrc3NwTAgEACFpDQ0P/q1f9/v4AAhwJCAoAAQjAwMD6//80MzQtLCwARZnQ0NBSUlImJib///HJycn//+r0///4+Pez///o/v8AAA8eBADvm0ezs7MDNonRfio/lOdQUFDd/v9KSkoAE2U3NzcwAgBtbGv///onAAAAASkBPJBmFADKdiLv///Dw8Pj//+YQwKmpqb//9+9aRdYCQD//88ABUA6AwC8/v/+0n8ZbMAjd8r4qVWNOAAAAzasrKy7u7uLi4vx8fHt7e0xIBP//sFKAwBBKxmvWglwxP/8sl0whdhzIQAMFyYHDReu+/8/UlsgHx8ABVD/5JP/8Z8lFg4IHTsGECIAIHN2d3cRY7c8PDxSpvSQkZF7fH/hjTr86cT/2oYUFBSALAH//rekpKRmZ2b/+63Y9P/09PRXQiuY6/8SIS9juP5csPr+9NNJnfB6Wjz+vGgLLWz/yXUBLH8PXbHnlkKG2P+Cg4KV5P9+0v8CTaAxSWXY2NcHVKhqTDPH//8eNVApPVD+3Y3SqoO0Yh//+eErEgPj4+P95LLzoEsdWKjSkkc5VnRtc3LR/v+iTgheVENGHgmj1fVTYWrU1NQgKzm88v/ntnG85PqN3v9EY4h5y/9cXF2JuOHm5+ZUh7vmqlpdIQOj9P/f399CjtMSSJKr4P7kwZgEHFJrZFWpqqrv0Kb/86tukLZTd6MZK0K9eDfClGWcUBlqOA8zc7jF7P4OQnuVaUSSxOd5oMmXc1Nwt/GBOg86Ojqs9P9QSzyjyt6meFISYJGQQhBerOJWndzI9/8kVJnHm3P4x3ZLNCBYd35or+3vxYu/gUihg2WLUDCOo7k7LF1+yfKnZy/4/eusil+3t7Zsqd67q5MrO36IfmfD2ueatsju/ODN0YaV3fXKtoLUwq+TmWLB+aWz7Jjd1YJ+zdU2AAAgAElEQVR42uyce1BU1x3Hb83Eo1NvndU7cVazj1JI3O4aWActWtxFsDI8pPhgmhkeBmGD8lKqgqNVhqJWDBJTGREUjBpfaIypxhhT46OgiOKjMYm2JtZHNDH1DxvHtNP+0d855+7uPZddZGHZZPX8hpnLPfu7371793N+53d+5+4VBG5BZIOGBsye68n5/RwFzoZxHILShgYOkQmcYW59w/AzgwNiQ3rKcOiowBhnOHgZHhyYN3q5xwwH5vx0nGHOMGeYG2eYM8yNM8wZ5gxzhrlxhjnD3DjDnGFunGHOMGeYM8yNM8wZ5sYZ5gxz4wxzhjnDnGFunGHOMDfOMGeYG2f4SWM41e6+Z39dSG/VposTw/vsVPtUnDMcvAxPFx0jQ2U72nOZjNgSvIlDU/vgHPtUnDMc9AzHofUh/ugKmrHkQw/T9UU/60txznCwM2yKR2P9IGOOj3ilz86xT8V/8Az/ecf7nOHHDNP6gwzTm+rSNcW1h0hsrtKElX3df40FtisvFjrqDwmmG1mGysMkK7UdX5VuyK09ZIH/x5B0+g9ClXbuTlYDDv2uPcuQe+BdxZs4dUGjrtCYW3spRC2IRSoKHftOl3clzqrDK4UaOOR8QBgeo+77yoY4/D9piOsyRHQrDr9omPB+1wxni2j4S4LwPCKbp47h/JThryp2V54V9XlLK7QRRzEjNejv14oHHsXbT4qGZIlT/nOmOK9Ca8Rfi+0trbF+KPbUCdKmVWLRjoXHhFKcmDAacOjZ4rwrVhQZ5X4Xp675jEaf94zsqRSEE7mGHA1XNqPV73QhzqibG8XivB0nm+GQ753ht0Z+KTeQ/8wzSnrB8NsiUlHMGWY/viZskiIKN6LVENJsH1jT/gS7iWjfP8rJ1tERLiRcQw3fnhekUnEiHLIoWv95iCB9oB3/awHaSFYtzUSzVBqJqD+WuGkngrLJurYx4gXwlPZbp7yhEpRFynJAUPAqzqin2k8cg6ams5WXv3eGVQ1LknrDsDAEhiGDMqPwwvCWBQvuRT2FDI9xV9ZgpL5JaBKEhBn4+ptnoLnXBbKdGEVGSPLqa9ZqGNP3Z23D8BdkTvm9zBcctjhiOavhlFgSq3entM7GjSnj35H356sEU+1UpLSyQ+dVnFXPFidODmA+7AvDi6J7xfALImIp9sLwU5oP22ai3JHUZneE2BJRCS1SzMRlrCVJxvk0jAA9BNSpOhK6XWVaSZcajXMRwpcgLMtMe4PVAIkV+P9lSTGvu97UqRtH2CSeY1WCLhGhC3FWHeL44fA+YBgn5pCzkwS8qf2W1lBJsm9CaCKk6aRXr7PghjsV/R0Nh3TqfHgXRjDyk4gVdDKgdfe1btYlhtAgY1j6poph041b2uLaPapcwnS8Ll3rqD8V7nRx1F7aGI3mfCgIoxGa+N19KxnqFF64OXzTrf6VMP9oqSt01O4JIoaTc2L+qJzgUSYwrtNw+MAfG29JzgwsraDxBZdpy76qKNTgK1sdhfmSI/T4DawGSHwmS7gDhaybnOMeA+azgsk5sggh1Js4qw75NMo9cNXib4ZrNEW3157crP8CrsBZVL9wQJ0GJy0eGN5bWDuvThtzWc3w8Yto9aBHNeJ6fG6SfIwvDL8typdJzoudDJvOkAsW85BhGCYG1PujKOxCdmLWWtEc+BKnw+W9S7wZL9zcrsV7U7c04w1Jy4KE4YLMOYopXUEKHsfhOpvJUO1cF6NbaVkSedW2C38J+6NR0d6FAxacQyXkS5y7gXTnMAur4ZaIdA/0cmNBJkzoqO09xgoWQMx1uXsVV6lLLausCNVf8ivDUsJiknkXZMK0sUYDOZUEafx6iyeG9TB9s5VqIMyq6hLP48/UmkR6bkYsDQwyw+/9xWm/GzRo0GAvfz9zdXbDhDfdDN+Ez7v63r/OGZCS4Wwt0h9+od2OIuYrXADcV4lLUXPEwG9eYr1wc/r2k5sRSqso2nEO3mdW8DD8mhbntk5LtctFimVJOH11rovJW5ml5Bz9QfhCjB3hpHRL0oDRaJ2FTLGmqTRUEoJyZ1E0HtJkYwUX2RVdy6t4Z/WmTedE5eTRD3E4OYeMAtIwnH6TpEZozQQMPTBMOhTp6Z4YtlHnKusai4Lh3yoezyd6e24f8wJQLDMMimg4DEQZOUqGpbuhs6G/QahBa4gL7jNLYl0uaDWOsYwXaV4zCXONpzx4gAwLHoZrmHskUu1yjMjGxQFTPP2GnFvKklSQAgP4dJHmBhBLX5H5kudmjIZaQlDuLLIr8gtWMNWqeMmbuOBBXWfeRbz9F4eBghP3zst5PBkFIDRDL/bA8DSavZOu25lh8IIILSXSfuCJ4e6aYQBlOHkxkKejE3N1bc02CugNsxCXENLNnS50LiJJCi/cjJcJliVRb3CuDh6GE5lvvDWTLngkxOPmjFiaKzu3iXSAqdJCwlpK0mDBlEh6OS0sQGeHqRWj4ZZQrKQ4Gwsy6Twv4evTasH8FBpNa9oeeBdn1E3t33wmuLN1P+bDK+9rkbHt9Lv4hCkipnjjco9zOteLHhlOxllJRiwZzHrD8LifyHF4SZI85k9nGMYLRyRPRmGTXC5bXS40G2O8cDO+7DgAY+9ShOYGDcMJMxTxEa7/TPRRuYCXHnDRKz+FDOiSvAySMIPOp0px38/WpAF/TWcGkmquPAUjUytGwy1BJ1+CvEMSAgiZ2LPpvrgtXCUI5wVttv0pAKlXcUYdwuU2PJRvOULjjP8Y1unKbtRZkf5zF8Pm+IieMAxXbha4TmNqa+NGgP1iSBf23tKlS0PdBI/4kSsfxmFzLC3yK3MJmNsiR+gvN2M6PbjQi894OenHDI8lo3MQMUzTSrdtOQITq5NZ4ok95GPTtTXYTia+JDbaSCEMxqjivN2bI/8dHbH9EEau6MqX8hRLqeGWqI5SLKvIa3b5zagIRNCF82pB4WY0qhyXJeq/CPEuzqqTVybstqJtUf5lGL7JEF1TO2Q3ci4hdMolskUmlzjoheGCzOqdiYoaY7frEv0MLoJ/pahLeAiysGmFVnwNEr3EYdoPGa+gZjjVLo8sTiv7OF3jqD9VTkflEkGxTbWTKVjyYnwDjrTyYrqh7XCU+W7ovsuCcKfZUHnQOYwrNNwSa5S1f7niryu7mK4pbjiFe4iOFRRaVhUaKrdfxdmeN3GVetnHWVpjbu1fJ/m3tqYrK6fhNeZ1iL8rKIswMCnuhpDGIMIwWfGEOd2HXhg27Yp5FBs52XeGd8gEf/obpj7szIelOCWgVVqEUyyYHMMJYSo7u5CMUOEV1Ax7MZrwd+3yOL9uaAg6XwR9FfcTw6l2XECFPBZ6+1ZNJABtisMLLYTQGhQGg8PGZhqHY/4JZ1ajgSYVw9kivb81W9ugHev7Op0chmkMVjAMQyI6ATla6xEVw3hwvWnH6xbYBadxirqEi2G315PI8NNuCoZ15kax7fbaCc3GDotrjQPfVUQILcg01s7bXXg7mjCcN/v2y6usmGQVwxuj9XtP78QdASmKw91meB4m+Mc/dTc468NVnYq/QGJ+CjQ+99XmSiuacqlc6aJkmPXiDD/JDAuS+UZFIb4ldJK81hzRdrrcudYs3KnQOuoP5afAeByHVuC9hktCJ4ZNdwsd324gB623+Mxwv/7uLIJl2NxIisdp/9OSmRol0dRIovaJq3gZdJaZ7qU91LAMs16c4SebYZ2uU/ai85wS6R73MxMpLmKF4DPD89Cnz7ItrvslmvDN09v3pNoRJOFOQJv+lk7uqL5TMXvfA8FMXbJVDEuMF2f4iWbYn9aapCwOd5PhfiOeVTf59DsO2vlGA5YbfD5hzjBnmDVzo1F1e2Z3GB7VuckHhlsentx+HZdEEF2x5wxzhntuW+ZViJE7fWdY6BXD+NELFx7996IW6ZcLnGHOcK+sylp84LoQaIZNd7VIxPcMRXRYOMOcYf9bAH6bb2tZla41VG6/1JMnMHCGOcM/AIZ1zNSOM8wZDj6Ge2WcYc4wZ5gbZ5gz3H2TWuqsxhLf837mh3JdufntkZUBePolZzgoGV4Si9pefOD7cd18FqUfH1kZgKdfcoaDkuGtYvXOHhxmikfd+tmEHx9ZGYCnX3KGg5FhKdH5vBLfLCOW+V0Cz4f/z965R1Vx3HF8RWQwcHmYK0rJ5YKg8pADRKkiCBIFGx4aNQIJMaYiDbF6gi1XRYuPkIelaq2VmGgS3+jxVHvaHEOs1pgajSemx2hbekyTtiaatvknL80fnv7ReexjZu8i7L13l93t/P6QdWbv3Lm7n/3t7zcz+13O8GBZJV6IV5YrC1Kq1SX9ZS+J7S6eevvDhnhR1pJRrqRlKLFkpYYuJV00H7z4PF5LReoZSUxFBFNUv2SqQyd4yRm2LcOZ1/+Qn3yj5Q1ZkNJPXdJP9lJOsDrfX4KEJ5HuGaNcychQItU/DV1KpqgA/K0RN4WDGkYSUxHBlAQE6eoQCl5yhm0cSyAhKMEjCVL6qUv6y17KCVYKerJw92z0NDGjXEnLUGLVPw1dSrqoZBFI+WMFLCtGjzEzkpi0CCYREGSqQyh4yRm2McNICErRkfRTl/SXvZRTOlwF/85VKVfSMpRY9U9Dl5Iuqm4EY9F/srF0BCOJSYtgEgFBpjqEgpecYRszTLRSREFKP3XJvmQvkWjqs8qOJDsUlSspGUo3kqzU0qWki0TFINTUPJUkJi2CiZtiq0MoeMkZti/DopaOKEjppy6pIXspp3RYMs19BEHFSGHSMpQ4UtHQpWT2SSTPGZSgphhJTEYEEzfFKmaGUPCSM2xfhtcSeWBR4FJTXZKVvZRTOvJwwINrYCErhen2KDKUJFLx16Wk99kqvp+peg3EkpHEZEQwcVOsYmYIBS85w/ZlWJQHFqfAtNUladlLJaUjPvn8wunbVVKYyCQZSlnVTUOXUr0PJPbnrCQmI4JZSe4MVHVfDTua4YzR5piNGCauVtKP1FaXpGUvlZRunryjSgqTXMdYhlKMVJQC9lrHRTB9JCHu/Hh4qdCSmG5aBJM0xShm9tlwMAw3F5lizYEybJ7ZhmHiTyUdSW11SVr2Uk7piF4C5Geuh1GuZGQokWSlhi4lU7SuimiMkmEJRhKTFsHE6pdMdUgFL2WGTbOAGB430jyzzRwHcbWSIKVaXdJf9lIOQVKQqk3mwUQYKjPKlYwMJYpUNHQpmaKHSr0LSFNPvaWSxKRFMEnQQ1eHVPBStK7aaF97oS/VBButp185PcfqEiKnjehNj5is/1e1bxAcbKI8sCxIqVaX9JO9VEKQS8k7hn7qmv6xWrmSlqHEkYqGLiVdtB+cuZT8JPzO6TdRFS2JSYtgigsv6eoQCl56esp/sq09KQPrm0U8asahH8AjQjkQ3PruE0npbZSM9mnd33TM1epkhqEDPiVQgpRa6pKM7KUcgix+Hq2WOIRYVylXUjKU4kto/HUpqaIZYJ7SFCuJSYtgigEDUx0CwctHKXYls8wZ90RH+IUg9fqbGQHaHO2I+/ARbl17uvV9hh2gVq/h9Jj6Szf4vGpKMiwUCIadUHUuXX/nulwARArcDBygHuw1nKPHqzCJs9TxSU1nOlceWJ7a9ggnzTjbXWzMiy71YDKceemFxQ7QqEjqTjE0gDQVv1tpGyfNOBMTx8GNO2OVpMnVZbUj5ImU3/DVFqb/4yQaMSdP/T+1AuMfkuvfegqDG7Y10sYVKW44OoBQSbwAuCN2tHlilfS/zWL+akM39ZrFogDy3aHiZ7kjdrJRTthC42rEJjaTAAeD7ArX38Bp+RLw2e/M7I3j5mcbNA7UOeKE011WG1eDV5c4shbV1RxomNMuX50RYbZjeFwkNz8L68sJu1pGYUy+tFKII85wtEV7BBQTjwxgfGwvNabRwhl2JMOSE4Z36SiLjatJudwJ1OnJcONcAI1Mo1/2HMYZdh7DihMmyY/rmHVyOR8JZDPqpJAgKZBghJmE7OYMO45hyglD81npJIu5nNcnvpPDB7xdQbph2FoPZ9hZDJ9OopwwtATrjKspuZxUEh3QsAJ2wyNRWpd2r8uKY98DYjg2hhu2ehXDUsI0XBqvcqcGMoNgdC4n2bCMnABa6oaNROZMRFeDMLrdBbx77chwLR/+JdbKMqx2wqjIIuNqTC4nWdbEAFoKi2iL3CAIcbCxH6EfOM07jTPsFIZlJzyO2mNUnSVyuRYml5M7F0hb9ZF4PPxL2FwvuUyn9XCGncGwhhO2ig1T5XJBmfjz7kGz1LY8aZzhPhjWdMJWzeVCYXWcYYcxbF0nrJXLhYrhNM6wYxi2sBPWzOVCYamcYScxHG5ZJ9xHLhcqhodzhh3C8HjihIuOWa57Ic3lOMOOZbglg3AS6bFa53pGGJHLSVaO5tM5w05geDxZ/1JkveflpFwuwZj2h3CGnWE+yzphOZczarVGDGfYCeaJJk44zXJOWM7lUg37CqSVmcEZtrlJY8KFllsFLudyBg6UcIad4IRJvNncHWkxhqVcLsnQ20M4Z9gxTljzebpBtFGt5NoamWDs93CGneOELcZweJrBuZxMAvr59mS4Htkw7oTJcEQWXgmfY5mOSblceozxJNiWYW6KE7bemLAZuZxkxzjDNjai0+Stt9yYcIsosXnajC9DDI/kMNjUhrgs6YTh7d1lQi4nWZczGO4eboK16+1Vu+FdagOuXr1O+IQZx6pIby43Pogvy4AWTGetwfBkM15WFaW3V0lm9Eq3dE+aGb0aUagzl8sAg2dWYXjbEIOtNRCG643u1bZAGI42ulc+cK/eXmWAhCGDYuXWYfh7Rn/FPYEwPNHoXtUGwnCq0b2KDYThQXryZBRnmDPMGeYMc4Y5w5xhzjBnmDPMGeYMO4Ph7PceT2zq/Ku8cR8A/u/W0yzkDHOGrcHw1ngAQM0peeOuDC+d3ff7TznDnOHBYbhkEQCd3w6pkDf2tbZ+PkW9l1S4FXCGOcNWYzhzFgDzmI27WPbDnGHOsCUYzjy7syGx6eULuYJQSSZea07JG2LYcD8AZblnd+Y37XrDI8YSJUfIPnNfBWDzYdTQfhd46hRnmDNsOsPZr5KV6ilnpvTN8HzI6Z1SVDT9z2qGP8kn7hgVvDiBM8wZNp3h7yeC5DfHvVcK8n4srEp9H4B/lmflyhsiw/DP8oaXW3bCRG9SBWHY3XWnGCRfLb9dvQaAxbChdVUg7zkeS3CGTWfY/a/05klTsBPdIofBHo8UDysMg7IpQiaMG2C4QArdS2cTB7wSgy38NBFMncMZ5gyb74fdeDwiB0YPYyf453QKw8lPCJhTiK1YKDEM/y74LQ6m53o4w5xh8xkuObtzWTyObMfOvBvDaNBYWF0Mpm9XM5wJffh3hepGgjlnmDNsdixxMBGApvSiPf0xLM5qaDCMQuqy3NWl4OnDnGHOsPkMn68C4MAUHAkEzPBjD4CaZ7aSzI4zzBk2m2EU4W4XhOxZQTAszAApLxzBQTFnmDM8GAyjMPaTUjSLoZthMQKGYfLlKlBWwRm2PcP1qVZkODLmbgxDEEFnwr/3dOSDmivrdTG8DoYhl89d8+BZ5xQXzOt0MLwtizM8MIYHskpw4Hv2x3A46K0LKcN4ijdYhutAb2rfDKMhX2hvX2uE/y7WxTCKPwD4JZqau98FqHnmgTAcB5KygmV4BrpsCtA/yhZnOMhYohCoKbYAw0IUUFNMj6299mGDd8nrvxE+29h8/CtdDAv7/pPv7XhzjJgZKvPMA4olioCaYt0MH8y4KZKrbPVt2Q+vcDjDmosM9TKchZV2y0PFsGdVbe21MUEzXIc1KGL6YDgkdn4hPc88IIbjcK/Cg44lFHL7YXhtldMZDk1OVwhUFAcfD7uDz+migIriUDNcMgOAp1/Sx7BA3tFBUWwww6uLbczwKxsjmnZcwdOg1DpDeBe9vnFZ/JJdF9bTtDOFuhkOF2Vj5IhCYdj92hefRng7Dl1BjnUlAFvQTbzjXfw9Je9sWuZdcoj08Z1NDfFNu67mUrEEVc80M0CG66RepRrBcMkr9ZsS0YohnQzHib2SIwqW4ezr8HdexMfHsw/+/ItXl86eVCFUghdQ7c/yYRzuHw9/Bk81Xh5aAJ472DB1jrDqT49HeI+jVvAyO3g0qXZtw/DU/yai3iffFJR1huAMDBuqPxIPYudbCsNsof6xtUJJ/Ej0xQrDj60hFXm/H4OegACXP5J7UnIwH28nfwwZPVkqdvGwzDBdzzQz0LG1KFnVKib0DJPU7kCuXoZFR6z4YoZheKqW37i10dX5axjn/S5lR+Sto0+WwoNxV4Z/tWxHy85EtDy0ANwo7vhmzqrGlB2+W0fBpMPC2Q9AZ/S3E+h2bcNwXsTrtV/sgfe6f7DrDIWtLvD25zFf/wVmIzNlhtlCP4aLYvsxnyLhhSmWGfZA13vm9uk7R/FUAIQzZfnV8g8SQQo8JQ+VggVfPXL2KKj5hbB7Nsh7N+brozCl8kgM0/VMMyLDSf31qoXSZssKNcOZl+LzLl5Qp56xoLC/XnVTvQpXMew+Gb8ZnrDMSnQYCsCWmYhk0B/DyFGVrIwvq4CHqePv8CI/uewA/GR1IwrW7wMrVO3ahmGwAubLJ+HN7lnVOsNFAMdP56s6vnlJZpgt9GM4XZcQHaRYZth9BOQ9gcKDJcdvYobhZeTOhj0Zm4ueXZtHBqgWl6A531zBPd/bBjtAGKbr2WZEhvVJAEKK00BLgsE2FPTq61U4w3D2LHi+oP1w4dQ5D64hUykF/TKMA691VTXPQIY3H6YH4RaLDNPt2odhNJMqrH1Amc2X1hnCPGT5hdtj2OyPLQySYQAmK7FEJXrIcr0yaPadH8C/+2GsM+d/7J1tcBPHGccvftHKsS8CW7LkaI6zLccYgwOGJtQYuSSBJgYCZQBjqeApBRdNMRmFWlAVRE1KKBCgbsFJwTSYtkBDYpo0cZwQtQ2QCZk2AUoaOtMPbTNm0oQJE4bSMpNMO92Xk7SrF+tdrOzbT9aetF6tfvfs8zz7373lq0A5Cup7Z4IHbq0C5Eeicmv09clMMwkxDEBxRs69vBzn+wdohjchEGGZ/72lv9kyj6Sed46NxjBOC2LkN4BF1BBtQFcww3S72cMw/v7N0It8PEhnCGdoIIqrj16lYzq2MkmGNc6cAMM7kU9b/s4VnCyDcO5GmbynysCjT6xd4f/EjP+uAMRQUAzT1xcyzSTEsMZltwBzcZqLJU6GNd02muHAdx73jbUrSG7pqfpoDN9PUtvl2yC12GTp39rR5pZF4GeYbjeLYrqFOL8NHdwgnaH+xRPk26z7NMCwxFSGMGwZH6U0iDTBdEwnvX4YP39ryj++j+G8Zzb+KcDSH6PlXnjjoHL3/xbQg0sYpq/f20Q3ozB8OZ5euewZOufHHK1XZoZg1h9eu2LWlW5ctC8lwfDr9eOOaot0n1AMB9rNIjv8Lb8dZnWG8Nt+cXMrMmt3/4XKJNOV8eclrAzBTH5YevbGzSE0C3wTw/klZId3Qjv8xlrK9q4Nb4epOoFqJta8RC5DMC9nVQ0wBLMMb3qQzPkCdnCJL7FSDDC8UhzOl3hFYXj+KpyOIleILxFoN4tiOuQP6zfNQ785qzMk6wcTDi0A8L6lVkOoyrgZHiTPTAaydTDcGockbL82Fm0+m6rMD1MVf9jvA6O/7w/1hykfmW4mRoa9su++sqdpnS4Rhk1iUK9ohic8HEg4zycxnX4uGgxMq6C/D4RjGP+qMKZ7Q2FYseDNS/wM0+1mUV5iUSXOS8BxYHSGyy+24RzhhIdxxEQYDqqMm2ErbYMZhpfvaPsdipqhYwAtMMpLPEnupn2zUd5hHxz9xe6Trxl/hvMScK7U7LqXykv4rm9kmomR4VzaBnPDcAltg0Pyw4vLUA5M6G17bzYkFGWfexegwdiLh6f3RFg7PAs6gPq9Y+E7CMObHkSR24R/dqAIb6X4dCXbbtYwXN5+bgzKD+8+zuoMB38FxAv/qa34K3zxhI/hiWxlvAxjM0wRHGBYDz3yKef+7f3iExHZhKnI475Ue42sb8FAcsp71Z+fQHfYd2fCv2tvnAJgzyQqP+y7zjYTG8PY4FEE88Fwj8gSzDIs4bWI7h31s/4s6I/MAwecZzpe+Ap2rMr3O5/ruDIzHMNrHFda4Uc+Rdl4xHDTXHDadXNo1+f1p6+e75057oVzx6l2s4ThxXCuvogzEegWZXWGR04BMpuN+5vk9yXYyngZtlJeRLAv0YuDRVEEyNBDOC98gP/TL76K1uHKlLW3Sf41OXDhPLVOF7jONBMbw7nUfJ1qhiMKUqIyXBLSK8YOSxM/3KqRf/Dy8zi78Ey9/M6lryGGhY+2lrUfePXbC+6ZHczwQ+BJdPHgn3A2DYcL2/F6/vnma2XrfgLNcfu/fipQ7WYHwyiHdfzDobLHjuKxYHSGwsaPhzSifJJ8Hd+PwVTGyfCgHEQwk5fY+H5bmdh+8O0vK47uLTS+r2GHoOlNooeoJOmgjhC9ROA600xMDHvlIFa4YLhHDOlVOM2PPiB5kgjDQfEYUyRfPSOU0ofUMO1mwz6OJtRdvRRZ/6XXx1gZjWFnMMFsXkISgoK14H9Dv5CkCH0KuRCNYasz5ClxqWM4omQ1GsOe0F5F061RDKe2qHuRAqUrtCqC9jImcXuMJRrDYXrFgT8cpldRGNarDGeAYYFLhoXhGMYdOTSkQSLQt57paN+v+FDbkcJz9f5LpJOMIJXRr/pdMOjhTDn58kvx5IdVO6wynAqG0YGWf0ARo/j4ERwtnsaa04+U1UocWbKCVPqcTD/DL87EdWIg2k89w6odVhkOyzA+0PLomcMAPLp13bF3leW/I6cgzG+3vF8PwNOTgwSpjH5VYRipEHZdvfEutTFU3Zs/0hlOZUmWYSTOhWAicfL8VWQF8z78Sq9HS0OvsIJUVr+qMPwQADN+jZYUNIbvqAyrDGecYfOfsf0AACAASURBVEQpOipiTyWWnu4+jtUl6JVPshoqSPXpVwnD6ATiRUG5FZVhleHMMYymf2SAkROxAaCD/xDRWJWA5H57ggSpjH6VMOx7fzx5CZVhleHUMYy3ESpSo72YYeTeKjJGAPZVMipVVr9KPo/e/0OVYZVhjhjeMk9RdjYTO0wLUoP0q6odVhnmkmHkD+NTezb5YA4IUoP0q8QfXoV3yQgTl7QbfqsyrDLMAcNKXgLJGMHSH7GCVPacTOXxMnPJlgG0J3ubyrDKMA8M4/zw1esoP7xoEhKkAr8glT0nU/k8rryKBKM+UbPKsMrw7WXYv05Xjnbt6WlBKqtf9a/THSbvCJwsozIcQ2l1OAos5obiXI/TqW0tKm1QGU4dw8L2j4c05av3v4rPstTTglRWv+o/AvPi18e2H6BO+FIZjqWclZnTCVQ7nAjDUQorQNVH1q9WBl9XGY6pVDsCCFvqVIbTwHDiRWU4tmL3n1Dg7lP9YZXhrIzpjMpxDvIcNaZTGc4Uw3V9tfmPFBVpYeks0rVU9NgT/9fegVzl/E+dmpdQGU4/w115m13FVZrQg7Zkh9nTeac37n/cL5hE2Y5P1rUKKsMqw+ll2FRqLfCd+OWuMheXeDxOp9WTWzy90eFLLrinayu64rDnBWKfUGQS0HF5hUbCsKxJc5ETYTgDvUqA4Qz0KgGGNbepRGG4K9+D0wdizXSn7o4+Y8gbbP0t2txGbKBlc2dPLF/W1gpDODd+XEAVAA5yJMn0TJxHmgDDGShxMpyj02SiVwkwfPvKMABvbsAn3zR0L7MN33+pX5eLD0atcUbHuAQ4hcE6/KcDyMpDSWw5GShxe+/26hatp1DLT69MrYUiMGdirGxxj1US/yxPU5NUZyNhWZGL7vcC1x1SjF9iUDcefcLSOcyP0jPgEuasH+N76U6/F5yok9Xf0j1gwRbPbeOkT3kucoByqTDSigkYUt9ona4K4zgY5y+/bABabtljCn9bmIQ5wF1H1Wic/I1nzhyds6EmcOQvaOXinlpm9a0JyTaV4RiyEN0GaH6c/Ql9trQQus/Ta8NMNlUam6Bl8G6QeAO4xB3saxnqbnuvuloGqG4VjziEhR7gSG2DUikkuKazK+EGqj3QGDewttjeahMa3UHPz5b4syh1ncEQ6zjoVH4xpS7JVxmOVsZAL8IyLTkD2XdMBvIxGxPhtwreumwYT5uLiftrjHz0qtT3RAO3UWU4SnTpgbNnUfJTfJ9HBAbFYvSXdAot65dlzYjmWCmr18JNt6oNuFuekYew0A9qUtdYvgHI3akxl7UWAHLtguQVWoBDyq4x3eyHuJGfnve7sZtToTI8rCfshD9aT6paM2pl4JhW5TBKLlNWjWidNWCGuZk9TCahuhZ2KNvMQWxTTMoYtpuB2JrKIeqvAhq3oSfbjEJBwmtoaUTY4PDidU2noDI8zDA5gDvFE1VXMQDd2TWcUhHxI0g2No+bSLPRYhcEF7hdwpr0lrwUMWwygAJvyonQisCVTaOZ00CC/2lOnlKxefmCvQv/1lXCyGS4KkUIN6YjXVuaVRDfaSAuxKBQipROnPjxJo1MMuuSQ6syHNkXdoDL6VlxgBAXZVcwJ3fCoOAujtJYkrVByRVZvSOS4dpUMCyZQUG6Fs10eLNRNgRzRFJThV1OO2S5j4+5wSlIvnWNwRGJMDQYBck34gTu9N3hVmDIgrGXOkkwZ1VMnpuTFECOhqN1Fo4ZrhXFNCZCjevBeO6HcZAEc4brvopCjZ2LW0s465FGOsNzgCXpcSoAx9LZRa8MrnM+ii1E6jM+wK2Hi/DpkfVdwsgvKWC4CBjSqyDrBjVc6326fMEcVXeWB3i6DDzo5tJeKkBjsnO9I93bKepquN58UEv2glm4WxK3Cz2tgspwLPNo+hfhi1IReKY3mBOt3Ikate7+0UCwoK8Al5Nswhzbdpuf46PDfWUqfrBOzHOiBtRyOoDeQrK2zJ8ezGgeFY4ELMuSZdguyvbUMDx3xsJIH7YCJ5/Dd5Yo3ovt3PUsT+jKF0YLw+uTdSVia4BlWG8M8T+al0RmeFrSHk9ais2DCdbwt5IoWcWzwmgpCRzBFGwiXQkwHKZsmReZYZsocrgd9y4SzDXyqG92iS2jhuHryTJcCMZEvNb05o4O3wnhkOFb6BTxo88HfIlnP2tDx4rvLHtgMnqmKgDl2yK0VAC4W3A2uvAWNdHJ3w41SScJ/aMGYWEMMCfXwDCHvTX9smzKQc9zh8HuvyOGL3zw2Br4Aj10hzDc/Ecwbs2ZE6c/E6GJPrSjbNYV1+//z975xzZ1XXH8Lk58E8grs+P8mvuwSdxgwiIIPxYMOGFhoQsJiJEmDklIW36UlNIQaIA6kM0barqsA9xBBoVSZQhoV5r9KMoKU1oNskpsk0qHCtN+UE3q/ti0Sa2qrdK0f/buve+9vGe/Zz+/Zzsv9b2qFPwjzul5H5937r3nnq/KR/lMdx534h6ZzJmxmGM8tZtOZhtLjTIchKrVDM+unnu/DIBD2+FmlmPY/b33ABi6i9XPMMOPl7b+iwvGv7PiNGNTnXouASxmq14rIpO5cVN2HJkVDGQSwzlGGbZBtcvIroUncQr8uI2j8wKWNgOO4dIn/0AYrn0U7kNSDu82xWfYD021Wr+lgEzmjpjwiob8HWBLhtCbJWM4pD8Oj6q80jjAC/k+tXXNDziGCaLvbkVa7Yjh5gH4DE45Ho3P8Lip1jrnkVp356gZr+u4eY7xpX5WfS+AGUb/x6F+v96P8aidGnN01fPCkV313FztAly2TnyAGT5cjyMzEmyPy7DTRPmwMJk7YM6CsIlVFRnDMMeFswE3Eu8IB5kx/Z+iRtfhJp7R5u3wOXFtDT8gDDehiAyEZbeYDHvgA2Zx2wg5uOzNNuM17XBmAzZzEAYN6HaYC52ou5L+44t9sC9OHCb/uIAlfnXG4Q7GFTKJ14pIrft4yJTX9DIszySE0dIuuiWiGyOjv4vDUtXizcZHsPwkzodPcAzvPSMmxyQfxhGZY3x9XIbbjO4mJm0SQTrOB825jVsFqgZHMwphMG9KaNPAFJ1h1BbXhHWJFtvKMxzDiF0Ahku/9AS/LvEa3IxnefVxGbaY5HRzwMyTOTDhzQcZN/bzCDNGmun4VPuYnNs49z6LhNjd21DSC9/5Fl4fPiasDy+xbfgvAK+cD2KGz63e8B21VMJliuYeVX14MufKNentOh/mFWccw7N4hi3GPqRQxXOOi9Von64a/nUFovb23affuPk6vIH24jDDzXdh766br6/8GDPcVQ+f9n2o+EHtRhexkzL4LlQek077J1gwpwNk3rhnPAwD1qu6h+bA9RJn76DJ3HF4bOhPnbYdl/B2MqmXGHq/03X06nv8ksXPul07FBkOFZrgbK7QhWrQnJM5MFY4zoJMHF80HoYBOAKDWQm8PVp//SD8YZylj7xpvzxiFyrTTm5czqqMZBjLFLoM9oZgZ+v8Fgz97zNUCL/gNbgtZoRhpn9xeKoLlTnHA1mgMkMRBjnJ6KnEQaar4PqFOlTzU3u9bs2JGO8KeYzeKIxP5iRdqEw5GlyeDpCpg80zHIbxnMulZ6Kz8Dyz+GzBR7bFb5fFsNAOvdN8fWRdqEw5srz24oxlGLRBfxK+CXbYo+cuu+Dlb++x7Tj1ixgIgzC0Tjc7FlLrbtp7dU4DyGIzF2HArhpNwqdw93tvalLFXAg1dMwZaUjlQDsbwfYGPV+lEkvqh4+x6jgNlZsGyyx69lwqEv8zBYn/isIqxFve1EDMIbwKtoN4IdCcmuOA9HBN/bDriML702GYnkZ5OWlxmdK3PssDe5J+zy/m5lL5fcERUFMeXSVWXCJluKc8lcPL/aeT4cL8VI9CXc039kN/qg2z6GTYm3KXWRUZZrO42WGSe1ZlzYbMHA5WUGVlRkFfUUj+smdCwnDK1cdn6WQ49R2KPDoZTvl5pSM6GU79pmwhVM6+qgog9IeS+IcCPTDIn7gMfQJGUS+WgHT2nTeVvVCGKcPJYBiAdgZ6k3bMFzWTLJfMN7f09yFRU3aqxLsGerMow5ThpDKMmoYw/uQs5ub0QOZA5JrnPG8ByO4J848uQyis7FOGKcNJYhhXJ1oPGF9IrZzN8al02CcEDsBBUJmLUuF+bnqZ10EZpgwnlWEAsjn6evKNUZxth9DarrLxxAZGwCC8DCY68CLMvZAWhpVaFB76xx73sTLKMGVYYSrmgTDYp3uxmA34IGQGY1bCLa2pAAVMmJypqNLHcO152LvrGmWYMqxIYRFHsWv8Ez3bnxNhL/e7WnTUfAy/GO4rjs+wQpvN5gH3M4BlKcOUYZVY7EQiQZcrE8M4a85shvu1XG2zwoZCfsulplhPPty8nT9VTRmmDCuPkQNIdjtomdTYNonNDq/iAHbVtGkswKoIivuGBay2XOIC3Lfwt92lO0/9HpA2m/Dkl2W9OSnDlGE5lfMGUaRk8gaLRmLH4y2zwj5EJOPM17wwVxmUbH5btDHcAk+e7931407YegK87N/ovtR3p0zWm5MyTBlWCa4QWssLwpOVo5EhtmMskO939pBTPppDNk4krDy+1rwaf3+bTxPDD8KduPXmAOoJwOcSst6clGHKsGKQDZAgS0D1rHL67HaLvcbpzCt0Ca0B8vxFiVUPBlzB8vmX+3MqeOxrNDJMUmDcV4hnWNabkzJMGVYdb3Hx1ucJRhbAuXrujYfbxhJfTS4JyR9rZZhw2oLaFxKG5b05KcOU4XijeDQ7MGtyMj//yGROoGEkeV1ytTK8bAV6hH8ShuW9OSnDlOFpG5oZXhfBsLw3J2WYMjzzGJb35qQMU4ZnHsPy3pyUYcrwzGNY3puTMkwZnoEMy3pzGmR4YoQyTBlOP8Oy3pzGGHawXvuIEYbjSqmmh2EHqUqNIQuPDY0vG59WhqPMiWXf54thWW9Oo7nEHMj4KlLKsJIue7IZ5qtSNTIcQyk+kuGJjvQzrGzeTGQ4CUMLw6wXchRnp45hRV32ZDOMq1IV61VlhpLXYynFyxke9WuTCtHJcJS5+AkV8yjD6qMIb53bx1LFsKIue9IZjluVKjE0llK8lOGJQZfGJtJJzYdVzKMMx8qI+br87BgM//q7nbadP7mKe4kfhCfxUZLj6Kdclh3U/ur0HiTJju+L+3502rpZWZc9yQwLVan4XiwtVwW8SPylK1O5REyl+CmGEcHQw+pnmHcA52LsPZT6LXxYaPm7HD60iE8dJL5FT6iZRxmOF4hRLJ5focbwptXuW+MF3cyGE9EMS2XZa7nZ5ku+Tog0S1rgnx+Grm8o67InmWGhKhVDIS1XBWAhEokf/Kj1pshwTKV4gWFMMNTay1+RYd4BwHG92v3SG5yL3nkVLGG+j+fhjQPu5/n0V+pb9ISaeZThOBkxlMTiKIYdSA2KCxgLLtqQ9noEw1JZ9nMb13zAov623AT0QXj0n1dYVlk7KskM1/K5BIZCVq7KDpciOGovlk7N6WKpWRGGR/2kPlFjGFZmWHDA7o18qax7m7At5Xi2TlQAl/qWQF1Hcwkpwx6rOLT1pavJVojDjQNkU/uVhv+URTFMElEiy74WHiOK7Dde5C7hYlzNkQ6GgZxhSbkqEonH87gB7QzzMZgb7RXaxhxlhokD1mJVLeSivWcE/YDlotKWzLczj+GevBQPL/Qk3l2xpiiKYQ6E21fEkBTBMHa4A8uyNz5CFNn5S4hE/dLDsEPOsLRclReJ50jSyLBPJFj7yFNmGDtAdMo3m1rfBC02lEw0E3BxHJb6duYxnIaROMOMpS06H979S+i+9bfPFikxLJFl76pf/JjkEu59dZrisKRc9bBg0nHNcXjebNEXXo3DqcwwdkBXvehbzkYO5BOiBdgcqW9nHsPhL6R49CfMMGMpUZrTsUN/72Yg7L22TmFd4mskEMLnpqpCeYTWTVMclmwLiSYtSSAfbnDy7ghrNEwlH0Z2OA43uU8JXbCvoM2YbSiV2Dy1pSHxLc2HFfLh/SVoZHWojioOUBF0Bu87K64POxyHPj1diqcfAsMHCcMSWXZZMWg6GQbqDAtx+GAiczrAx2LrFsMMR55UGC5dtqJ5gBzAEfbpRN9ShnWuS3xdIHi8JNYeB8s6rlc/+QRmF3t+PWFYIssuVoWaJw6L+fD6hBgWYnHYOMMypyCkW9/cVEdW2MS9ZsG3lGF9DPNhmBFrf6IZHvr0Do68h5taX0Q7Xjjf5LIHzLBUlp2vCu2q3/GYSeIwWpcoI9YmxjCJxRoDcSyGOaeQn+fKr3HOcayFX1nO73Qgc2S+pQzrY3iSxOCp6rVohp/aikT50GI98u6m6jXcowW/CRKGpbLs51bP/bCMe8m28qfiJVTUZU9bHAYttlZsrWR9OIZSvLxegqM4bJzh3RsXv8391UN3CbkvVN/ejkIBb67Mt9g+FfMowzHDMCOrv4xmuPZiqftWgf0j29z75OY4d5e9+8bHzMmyCFl2/EZfJ1zzwdQlVNRlT1scBo1/gXPP2rtb/82IDMdQio+sW2uY32GYYQ5PeMuC9ulwX6bmAbftoUUiwzLfYvtUzPs8MBy/9lUXw5Naai9RGYTNffTSH/FC5qH397h3XP35cClnkFyWHb+RIcUTwiVU1GVPXxwGyLzeS1eGS78qFCioK8Ur1A8XG2aY1Ev0nr1DHoHl0P285JJKfUvsUzZvZjIsryNNDcNsni9SGkqBYYeGPVdHIpal/RyH1k6QKayBZx2GTJuRDEfUkcaojTXA8OhY1FP0LFJqGDY4ZiTDscpck7m2RhmmDBtnWKw0lZSaimWuwoskl5C8IaIYVfIKZZgynG6G/8/euQdVdZwB/JQL9wNyj829crkS5nLA50VDK3GQoIAPpKmNUh8NAr5qhXKjaICACVYSHFvUaA2pEh8xDbEpzTQhTcaoSYdOMnGmncSoyYwxycROE//qP5060+l0MtM/umf3PHb3HO6Lc2g77PeHXu7u3cd3fmfP7tlvv0+3NGVMTXU7Uj0RM0xnYI1RmRTBsGCYlaam0Wkj6eqWbYk7DOuWpoypqf6uW08kBiJ0BsYYlUkRDAuGsTSm7+v2VGQFZcomxhvpDFR1ZY+GHWaYWJoypqYmwyQRM8xkYIxRmRTBsGC46U53RZAi1xtF0uM1DUuV+J7ieSmamzY2w8TUljU1NRgmidhgmslAG6NyKYLhSc1wyZ2qmTKxHi1v99XXTusz08KXZt/JzfQsJl6JvRW+JG6NaUHVAfyw7+7BEivDxNSWNTU1GCaJKsNsBtoYlUsRDE9ehpt8FepgK8+o2jcYa4cmrSiTeIqPDE9JGOKoTlmw88JAbgXNMN7R4UxNDYbJdo/KMJuBNkblUgTDk5ThUEa5CvDM9qK+xKD04fyRgdHEWjEapWbWVeUWhjlTUxuGea/ZpjGqrT9twfAkY/hSdw8OczSUTMElG6rwr7ITmhsPmSeIe8M2DLOmpjYMc7aolDEqnyIYnnwMj3gUdUQdSr7sUMYc1ZlGbgLGIeF6HWJPWLJhmDU1tWGYs0WljVG5FMHwZGN4dKrqXCFlBaUNoME4+t04Y3GfNAwegvCFsGTLMGNqqtmRMgxztqiUMSqfIhieVAw3tSug9A6Op4ISHxphZxTFyHEn0isVBXsxwoGQZM8wY2qq2ZEyDHO2qJQxKp8iGJ5MDNejQTQw7r3okA8Vc6FpjHG6W0qHiBQO5xoI2zLMmpoSO1KGYd4WlTJG5VMEw5OG4bQAwOIpTlTS2K1AMMO6kKuXBkHpkzao5HarcxbL+2HrxDmeMe7YGegUwfCkYHhDDyhdYYeqGVyMVmuMTUWjlCbLTVJ7hrbiu4AQ1j7+z5xrFgz/fzPcJcNdDpq0hRsUmGG+2wiXK0NSfgVVwU19FBYMC4YdYTiEhsX2sKM1pUchSGYmGXMGpQr5MnvUJJhvDNOCYcHw+BkOlYOS63RVafmgFIUWDKJpQ7c0eIl7fdHZJwmGBcOOMVxSAd65ztcVCoB3DgxLtZnWLehGE2HEcG+uy9KeIsPeu9wWJUWGZ7rdsEiKDE+EyqwMh8vBm+7GDROaCkq0K262CfF7mRrDEyGpMTwBkhrDEyFWhgdcQhjdHQGIpsXN1RCYABlI5R1h9kRIYwotmzsRDZudygRyQlRmOUWUIScabCF5KVkMnSFJiBBXJc2LllyuyVAPDAgdC3FXPJAfdrH4bFCmCSU7IaPYg7J4qlmlFpRBVysIQIXN9ZirypBQv/nAwiFZYi0eujJVSROq0sXXoApe4ba7fHG8UGsdnfH1+Ia4DoYswBqZKxhOgmGsEElKT9hLfUyJ5cavHQKCYcGwewx7oCrZn9oFM4/F8KgsDwmGBcNuMRxSINnZsG0w85iuKMuhQTAsGHaL4VqIJPvL5J1Q5lpXdYJhwbBTDA9AL/P1MejoN4O/G14oq9891OZvOf3HJ00nlKx3Sbsw7eZkArwhwbBg2CWGKziTsfvg+i0S/P1ryfRCWf1S3vwzvejbo38xnFCy3iVtwrRTEoV0wbBg2CWGecs/Kvj7CtPR5OOVmidJWGdEf2e9S1rDtNOSD3cLhgXDLjEchFGOYTr4uxnvHAdbk7b5Eb4aw6x3SWuYdlqmQq5gWDDsEsMKNHIMU8HfjXjne4GcGMYhMAnDnHdJa5h2WqosLyYEw4Jhpxj2QhrHMIm0TpyWGfHOteDD+FvCMOdd0hqmnRYP+ATDgmGXGI7ACMfwMjP4uxnvnMwRyLeEYc67pF04NFMqLMadgmHBsFMM3+TOZTHB381458Y4PN8chxnvkrEZXgxFgmHBsEsMeyCTYxj7/0fzYdUNKh/vHIe9MObDCxNluESBS4JhwbBLDPNbaOcAB2fRgr+b8c7Je4n1/kWnzPcStHfJmAwXWTcDBcOCYacYHgJvCcswCf7+A/zmzAj4Xlfw57Akvfj7QtMJJetdMibD3dxmoMHwNzOE6OJLkOHLQlW6NGh2azPZV7fnmODvOpTVL5Wq+3Sl8OX9hhNK1rtkLIZDUVhgz7AQXuIzLIQTNB6zbkDOwSwq+LvpSRXbS2i2EVowc8a7ZCyG6yEaFgwLhl1juI89ZXHO2GJLNPh7fMeUN62ml4JhwbBzDEvtkBW2Y9gx2Qc9TYJhwbCLDDcGoctNhlH5PkkwLBh2kWHpMngHXWTYAzNsjniMpguxk1hvzmYL9dgJ1k05RBpdY9gHSrokRIi70hiBcre8pNTKkCs0LMR1GfSqUeLckPSe5I9NCxGSgmQr7kA8xQvlwreSkImCOFDieKl3YiPc/9XJNr/y2vnP8e2zXuYM5+PIeplY2KWWPH6hK3CusiN5jzjcTlbLE6GN/5ZsUCBr1Nkiw5kyzBkb4eIPXgBoibQBzL+q7uqVwdqkiq+Jnb8myeKSFlzBpuUdzla2B4472kpey+MSrbd237mu7kRkdhR6HA3x0BiIGaVm5d/kgvP/nC7lvPhRHqy9Vyp+QDvblPAtEssri1rcQXcVhutf718Yvy1JSPVWKj6vA8JreZyDrX/hWN85poFxSVM+QG+jY8VlR2NGqamukR+6gQMlhYvL/EufRvfz0qed60wOKu4X7uts3gPzf+hogau2z/+pg8VZtOx4bx3XwPgk1C1D1KGhuMkDkDUSI8PtJQU3dJOMVZ/8+hVpR92i73+wRWk+/wbR/rsn2wqbT3w8Xf3jsH9W/0dtLacvSsVfbVEOvKXOvA7nqUf9is/ub2t57U9Pkp8c2qg0n7iIR5vnKu/5ljkoU7mKz57c6N994uKYBa+HZ7GXmPPXLNnRH21+VNA1rf4yfJzwoNEWtuR/Ud3RkKJbyObo//sWf8uJV3bWYbtWp8Si5WS7rx/rURcrem/pbrAaYEpn+0erzrgq8fSV0nwiCyB/tgN3g68H5PZQzFsaOtgn2za/6pzls1JYpk7b5r3vL2j17M+b/we1h8fgi092BbbIq79+f3fr/rzChXji+Ox0qf8WtJz57AV46neqfWhe4emp6k/CZI2hrxBz6Fz9V+SC1t5YBZfBF9ub1YYc/Q2Xfd7z8u7W4fd+iwtS6z97SN413P2O1ha+5Cu4O5QFH9tCJsdjH0Jz63sbV/8bOzpw7jHBaznJ7hvTXPR/jt5bqhs5jAbY0pn+MaoboykWfaUI34ACcu8413ahfVGAzti3wo66pW+y35SB90s0UN4uVU/6V5fJ19ENmfN66epnUNr3oOXqt6WVt+DMP65JOXvkZSukHHXiWPw8PPUGdt2CJpHEj0vO23naKRNjjUHn0j5Xv42rsSsYzUgLryL811QW/ozLvmYJNqr+5ZUDN0j92qWj22KWTLqzBP9FhG0hnQP9+Dr2TOOF4/c6x7BFy0l2X70JDpqrC9JbthuUBrjSGQ3QqhujKVZ9pSppVTLIFeMIPN7niwBELseZ4d9HDv1T2n1Z9YOlHpdWj1A/V7dIvV9z5mEnFuhfPDjXACb6SCkaIlbuxadT8RfSngNXw9LrW36l7pLv3Kw+jeklHZ3rNrkptNOAdgWv2g6zvkPGsHUSm32bObaT+smlI58tJT+Cu7O8wJwuMi1kcjxeSS7d4TxHl3QWLSfZfdQ4sqrYtLzgTb23TDdoDbClsxqgVTdGU6z6Sl1G5shoRnE5tbfFI+1egKgv7r5GDRyfzr2iIR6FiMeVGv1SblU7+JMH8UIH6WttGM860Bztic0PPYNu3o7p3FouvKZSPQhIL+moXNXG563qOG1X8M7Nmha3wjouOxqA3tJfguL6yaXDny0lF2rd4RdSeguZHGXaecUddYVOLul4LSfZfbyq+DFp18Of6r1lukFpgCud1QCtOvumjKWvFGW0SgHwXtiQ7NuSJt9NNMHPyk1gZ24rdPCPvXs+Jc9btBZDg4Ehj+LviLchgjl+kXykdNGpVdtJx4k89tf9bX71F0fvN5WPl/pmrk3Ltc85Rd3NTAAAC0FJREFU+BLZFqzNSKtfhh9x2dFEEJrPf44f9mr96NJpA9iiU5aSHza7Y9tCOgca9BZqsw0yODkkvJaT7L46fJLp6TY/arLWW6YblAa40lkN0Kqzb4qNvsb5WqFhJmpjsLe+L/H1YGYnGr+9ntoEtcu9EkeDwApjvwcNBq2a+5VX3zH2gJ54EK/ZkXYPkrNPO9W733hQV8KuV7szuz7E143a9KNzGcv+efgJZlfwMTLpk1bthUe57Orpq1KA0x9L2tmrI6X4guO22JbMbD7yLTRz6D5okBacXNJZtJxk91WsO7TFys/Dem+ZblAa4ErnNECpLkZTkt6sjcPkcBBhrPynvfOPjaKI4vgmJCyYnvHKQqzkuKYYoLaGklBstaW1FQLFkFJ+SMAUikQt8itWClghJk2MxIAYTVQ0DRHwBySERFAJUYMFBFSCPxKNMWpM0BA0xv/8T3d+3b43+3bvltttC5n3B112vvNm5s3d7rydu89N3HLbirxP+6eUjHLTODs18ZlnC7/LVWsp3SJv92tbA6J0y/xMxuvBRxgJro291Zu61cXWOrug/KvpYh03C236OVDV3iQvzzv5qybIsXzpv6jJmQ28+WVKZCwdbOr4KNgx7RmmlloPoWLdQvk2q401pfNFOeLw2ct6lpXrshgtHgaIgObdHwEVupCuxL7dl7lry2R+O582bu/gFHp9vP+hksaJo5lo+4l5Kwr33ZUWSwe+ur/2dYWb0vV4CfC2JnhHUfmZjNcTbG3Gk732GZ5scUoci/UcSumAqr2p+5RonyXVlGM3xVgj9582vYblMipV77oTJpJNMeGiL6Rn2A+6h/zvNlnZvfjFukunRzni8NmOy2rRZfZXjBYPA0QAh4CKgAhd2Ewksrv64bzG+1L8hZwaP7Z+1OYxT5VMGBwcLCkZs7dx6pPTsmLNOn7q8lsjLZ4zD7eonU/n2MLyjmqZg8ntNY4TYiu1q5/XeflZmwjvrjJ3HdbHdvXcyxd/W+85/4/VyxeZVmWbzWIDUzqoEjRP1zHPuinHOxfYuytUXo7klRevfZ+7ZfD2xdSJY9ozz+el0T3kCvVY4mQZXOAXfxHSoxxx+Owh0XHxGMy98cvRomHACOAQoPGh0In+5I9XrHb3nJLG+sdT5O+Xj558Yu+y/dfh9OSM8l/Z48Ezl8vsA3NZSveo2F5jN373/cqgFQN/pQ5Mt1TZ/CVignvZ2oyv/d2Lhls++9hCNwBdacaeH7gwll8xlTv58CanqlzFHVddSLNnd5Tj9qbs0j/dKTpY1v0plruZNOsNA8X0qNSTV+THuuduL5/PXRRxD4Gir8XuqGZdtJe+FOvUaVGOOHyWW6/JWFUH16c3vaNGi4YBI4C9o/Gh0Mmba954JfFKvn3OspItjTtGld5TXzpux47NyyfcMuX6uUmzDzbZ5Wunldk2f+jSlRZr+cUiEV532N7AflCBPfhXZeKpG3sIn8sBfmuw++s7U5N+rmC3YfYTDDP/bag59EHOnbiLeio3im5C8lln6vSRAMdv2Z98MekxV9F8xcJyh/+n8b0Z9oE60b777tjwwxXZF92zl8+r5yN6Dz2F05suf720s/ltlt7HaVqUow5/dm2qZl/p4dN/p9zVhhwtGgaKAPKOIwBDJy1vvG4E2/pt5/Zs/75zl8RNRiXA4u/Wywy/cm4uOCcxbw8+zdZm8qZ05vn12f5D/JOxz11emT3/UV3VH3ce/U77HCdQua2ulL+NQztutTsEI+aIpctZj8vK177yzQOq/d8PZ/uPq8YIzyyfB/u8uIdQUXmxM73x0JGuVOxgBBTlyMMf+HFltv/9S718GStGi4eBIgC9axEAofN6lideN4DJBbTjhBQWbtyNUyjXxQn5hEGPv9SJ0I/r76GTGaooRxw+ouDkD7QTad4sYzFbX6yfADXDNzb09kZ8+0Rm+MaGxVAyaIZv7Aa02pHwtTAzfGPGjBkzZsyYMWPGjBkzZsyYMWPGjBkzZsyYMWMj0JwX8sJwCpBAI8CjybFIh4FyGvGblnFScX3iZJC3I8QoMChtvfm/Odkb6cuVxDcRE2CRDh/lNOIWcixU3KDRihOitPVm29qmwKCkFcA3jYZAJb6JmMSXE4eNchoVixsLFTdotOKEKB0ZwNf4rHAIaAF802gIVILzmgD6dfgop/FicQsLTfhoRxjxtagLhAf0pMCg4XxTKHR1W6+O3l1NIlApQikCh8pPzUKH8IO0mGaaawqhR7FGB8+yCq2IcooUBNe0+KQB8GpDsLjBVNxALC76jDGaLVAFMl3b1IphT3rTL9y5LJUNwf4kEYpkL70e0JMCg1qhfFMkdHU/bRz7MY1ApQilCBwqOK/IIUC/ajRT1RRGjyKNDzzLKiDKKVIQXNPiDfJqQ7C4gVTcYCwuDA2eLa8KYrqq3KSvpaaHn1CloiHYn0RCkaghoCcFBg3jmyJhm32U6WgEKkEoxeBQkVoghyDbwDRT0BTwgDQ+8CyvACmnWOHnmsZwh4NU2xAsbhAVNwSLCxMxVICqgNHuSvM3v1Wbur9OcjJ5qThG/UkiFMkaBHpSYNBQvikUKh2JQKUIpQgcKpMU6BDmLZhmqprC6FGkkeBZKwee5RUg5RQr/FzTOC4PHq+WxOKKtgOpuMFYXJTSodmCVeBoJcfi7ILm49K5KBXHqD9JhCJZA0BPhwKD5uebSqGr6xF3fQKBShBKMTgUJinSITyFaaayKQ09ijQ6eJZXcCDlFCt8XNMYDFJtQ7C4gVTcYCyuP6VTswWrwNH2tfDrf6vtvt6Fc1EqjlF/kghFsgaBnhQYNJRvCoWu7pSVo/FpCFSCUIrBoZLzCh0C9KtGM5VNaehRqPGBZwVYDFBONYWPa1q8IaptCBY3iIprBWNxYWhQAaoCma7zl7BXrECG8ROyVDYE+5NAKBI2J+MBPSkwaBjfFAmljkagikIHEkrVYwtHUkbZLpbm0NvYwjRT6Q17wMBXEjyLOK9YAcMQU2AR1TYEi0vERnJYA7G4gTRaVAUyXfkV1r1xdVSoE6JUNoRjEXcohsIU0JMCg4bwTbFQ6mgEKkEoxeBQfvXBDuHGFqKZKm8aehRqaPAspJxqChiGuFZpgFcbhsUNpLcGY3Frg2i0qE3IdLV6+Zj5zUCcEKWiIV8sYg7FUJgEelJg0BC+KRIqHYlAxYRShxNKCcoo6VAmbYBmqkowehRpaPAspJxiBQpDTNdhyKsNweJSsZEc1iAsbjCNFlZBTFf3RvBy5Sr+2E6eaJPZcY9FxSLWUCRsEOhJgUHD+KZIqHQkApUilBKUUdKhuNBCmqkqwehRpKHBs5ByihR+rmkMBnm1XhR9WNxAKm4wFheGBs8WrIKYru4SeuZ/DfIBEzshSsUx7E8ioUjWINCTAoMqoqdD8E2RUJE/KQSqQxFKNcooE2gO7wDoeEgzVU1h9CjS6OBZUQFSTpGC4JoWb5BXG4LFDaTiBmNxYWjwbMEqiOnq5in3vlrTk0srZak4hv1JJBTJGgR6UmDQML4pEiodiUClCKU6ZXSu32Eub8E0U9UURo9ijQ6erZOvKo9yihQE17R4A7zaECxuMBU3EIsLQ4NnC1bBTFf3PZLij6HlCVEqC2F/EglFsgaBngIC6gTzTTOIb4qESpehEKgUoVSjjLIbVwY7XATSHkgzrc390hBEj2JNhgDPYs4rUlBc0+LN49VqWFzYdggVFzhwgkKDYoaqYKars8puXg0XCbxUHqNYJBKKIX/cxv8JAXoqjmiIMFMwDxTWD3BYFf65RV6hKuJnG2+aSck7W3SojQ2tFUIzNcRTYyPZCqGZGuKpsZFshdBMDfF0WO1/qYwTgM8rXMoAAAAASUVORK5CYII=" style="width:75.0%" alt />
<p class="caption">Structure of CHNOSZ.</p>
</div>
<p>Many functions in CHNOSZ have no side effects. That is, the function only returns a result; to use the result elsewhere, it can be assigned to a variable with <code>&lt;-</code>. In this document, the names of these functions are shown in <span style="color:green">green text</span> (not applicable to the code chunks). <label for="tufte-mn-3" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-3" class="margin-toggle"><span class="marginnote"><span style="display: block;">When they are mentioned, names of functions in the base and recommended packages of R are said to belong to R. Example: Use R’s <code>plot()</code> to plot the data.</span></span> Major functions without side effects in CHNOSZ are:</p>
<ul>
<li><span style="color:green"><code>info()</code></span>: search for species in the thermodynamic database;</li>
<li><span style="color:green"><code>subcrt()</code></span>: calculate the thermodynamic properties of species and reactions;</li>
<li><span style="color:green"><code>affinity()</code></span>: calculate the affinities of formation reactions using given chemical activities;</li>
<li><span style="color:green"><code>equilibrate()</code></span>: calculate the equilibrium chemical activities of the species of interest;</li>
<li><span style="color:green"><code>diagram()</code></span>: plot the results.</li>
</ul>
<p>Some functions in CHNOSZ do have side effects: they modify the <code>thermo</code> data object in the current R session. In this document, the names of these functions are shown in <span style="color:red">red text</span> (but not in the code chunks). Major functions with side effects are:</p>
<ul>
<li><span style="color:red"><code>basis()</code></span>: set the basis species and their chemical activities;</li>
<li><span style="color:red"><code>species()</code></span>: set the species of interest and their (non-equilibrium) chemical activities;</li>
<li><span style="color:red"><code>reset()</code></span>: reset the database, restoring all settings to their default values.</li>
</ul>
<p>The following pseudocode shows a common sequence of commands. In actual usage, the <code>...</code> are replaced by arguments that define the chemical species and variables:</p>
<pre class="r"><code>basis(...)
species(...)
a &lt;- affinity(...)
e &lt;- equilibrate(a)  ## optional
diagram(e)           ## or diagram(a)
reset()         ## clear settings for next calculation</code></pre>
</div>
</div>
<div id="thermodynamic-database" class="section level1">
<h1>Thermodynamic database</h1>
<p>An attempt has been made to provide a primary database (OBIGT) that has no major inconsistencies. As the database includes datasets from many sources, it can not be guaranteed to be fully internally consistent. For crucial problems, check not only the accuracy of entries in the database, but also the <em>suitability of the data</em> for your problem. If there are any doubts, consult the primary sources. Use <span style="color:blue"><code>thermo.refs()</code></span> to show a list of references for the data; see also the vignette <a href="OBIGT.html"><span style="color:blue"><em>OBIGT thermodynamic database</em></span></a> for more information.</p>
<div id="the-info-function" class="section level2">
<h2>The <span style="color:green"><code>info()</code></span> function</h2>
<p><span style="color:green"><code>info()</code></span> provides an interface to the thermodynamic database packaged with CHNOSZ. Suppose you are interested in the thermodynamic properties of aqueous methane. Because the database is assembled with aqueous species first, they take precedence over other states. Searching by chemical formula alone gives the first matching species, in this case aqueous methane:</p>
<pre class="r"><code>info(&quot;CH4&quot;)</code></pre>
<pre style="color:blue">## info.character: found CH4(aq); also available in gas, liq
</pre>
<pre><code>## [1] 880</code></pre>
<p>The number that is returned is the species index in the database. A second argument can be used to specify a physical state with lower precedence:</p>
<pre class="r"><code>info(&quot;CH4&quot;, &quot;gas&quot;)</code></pre>
<pre><code>## [1] 2628</code></pre>
<p>While some species are identified only by chemical formula, others have distinct names (in English) listed in the database. For CH<sub>4</sub> and inorganic substances that are represented by both gaseous and aqueous forms, the name is applied only to the gas. However, the names of organic substances other than methane are applied to aqueous species, which have precedence, and those in other states. The following commands get the species indices for some common gases:</p>
<pre class="r"><code>info(&quot;methane&quot;)</code></pre>
<pre style="color:blue">## info.character: found methane(gas); also available in liq
</pre>
<pre><code>## [1] 2628</code></pre>
<pre class="r"><code>info(&quot;oxygen&quot;)</code></pre>
<pre><code>## [1] 2637</code></pre>
<pre class="r"><code>info(&quot;carbon dioxide&quot;)</code></pre>
<pre><code>## [1] 2629</code></pre>
<p>A special case is sulfur; the name refers to both the native mineral, which has precedence, and the gas. These two phases can be identifed with the formulas S<sub>2</sub> and S, respectively.</p>
<pre class="r"><code>info(&quot;S&quot;)</code></pre>
<pre style="color:blue">## info.character: found S(cr) [sulfur] with 2 phase transitions
</pre>
<pre><code>## [1] 1992</code></pre>
<pre class="r"><code>info(&quot;S2&quot;)</code></pre>
<pre><code>## [1] 2639</code></pre>
<p>Taking the species number of aqueous methane returned by <span style="color:green"><code>info()</code></span>, use the function again to retrieve the set of standard molal thermodynamic properties and equations of state parameters:</p>
<pre class="r"><code>iCH4 &lt;- info(&quot;CH4&quot;)
info(iCH4)</code></pre>
<pre><code>##     name abbrv formula state ref1 ref2       date E_units     G      H  S    Cp
## 880  CH4  &lt;NA&gt;     CH4    aq PS01 &lt;NA&gt; 2000-10-04     cal -8140 -20930 21 60.23
##      V    a1    a2     a3     a4    c1    c2  omega Z
## 880 36 1.769 -1530 -67.88 114700 40.87 64500 -40000 0</code></pre>
<p>Liquid water is species number 1; it has NA entries in the database because specialized functions are used to compute its properties:</p>
<pre class="r"><code>info(info(&quot;water&quot;))</code></pre>
<pre><code>##    name abbrv formula state  ref1  ref2       date E_units  G  H  S Cp  V  a  b
## 1 water  &lt;NA&gt;     H2O   liq HGK84 JOH92 2006-10-25     cal NA NA NA NA NA NA NA
##    c  d  e  f lambda  T
## 1 NA NA NA NA     NA NA</code></pre>
</div>
<div id="fuzzy-searches" class="section level2">
<h2>Fuzzy searches</h2>
<p>Calling <span style="color:green"><code>info()</code></span> with a string that does not exactly match the name of any species invokes a fuzzy search of the database:</p>
<pre class="r"><code>info(&quot;acid&quot;)</code></pre>
<pre style="color:blue">## info.approx: &#39;acid&#39; is ambiguous; has approximate matches to 86 species:
</pre>
<pre style="color:blue">##  [1] &quot;a-aminobutyric acid&quot;         &quot;acetamide&quot;                   &quot;formic acid&quot;                 &quot;acetic acid&quot;                 &quot;propanoic acid&quot;             
##  [6] &quot;n-butanoic acid&quot;             &quot;n-pentanoic acid&quot;            &quot;n-hexanoic acid&quot;             &quot;n-heptanoic acid&quot;            &quot;n-octanoic acid&quot;            
## [11] &quot;n-nonanoic acid&quot;             &quot;n-decanoic acid&quot;             &quot;n-undecanoic acid&quot;           &quot;n-dodecanoic acid&quot;           &quot;n-benzoic acid&quot;             
## [16] &quot;o-toluic acid&quot;               &quot;m-toluic acid&quot;               &quot;p-toluic acid&quot;               &quot;oxalic acid&quot;                 &quot;malonic acid&quot;               
## [21] &quot;succinic acid&quot;               &quot;glutaric acid&quot;               &quot;adipic acid&quot;                 &quot;pimelic acid&quot;                &quot;suberic acid&quot;               
## [26] &quot;azelaic acid&quot;                &quot;sebacic acid&quot;                &quot;glycolic acid&quot;               &quot;lactic acid&quot;                 &quot;2-hydroxybutanoic acid&quot;     
## [31] &quot;2-hydroxypentanoic acid&quot;     &quot;2-hydroxyhexanoic acid&quot;      &quot;2-hydroxyheptanoic acid&quot;     &quot;2-hydroxyoctanoic acid&quot;      &quot;2-hydroxynonanoic acid&quot;     
## [36] &quot;2-hydroxydecanoic acid&quot;      &quot;cyclohexane carboxylic acid&quot; &quot;N-acetylmuramic acid&quot;        &quot;diaminopimelic acid&quot;         &quot;aspartic acid&quot;              
## [41] &quot;glutamic acid&quot;               &quot;cis-aconitic acid&quot;           &quot;isocitric acid&quot;              &quot;a-ketoglutaric acid&quot;         &quot;fumaric acid&quot;               
## [46] &quot;malic acid&quot;                  &quot;oxaloacetic acid&quot;            &quot;pyruvic acid&quot;                &quot;uracil&quot;                      &quot;citric acid&quot;                
## [51] &quot;metacinnabar&quot;                &quot;acide fulvique&quot;              &quot;acide humique&quot;               &quot;aspartic acid&quot;               &quot;glutamic acid&quot;              
## [56] &quot;2-iodobenzoic acid&quot;          &quot;3-iodobenzoic acid&quot;          &quot;4-iodobenzoic acid&quot;          &quot;uracil&quot;                      &quot;phosphoric acid&quot;            
## [61] &quot;citric acid&quot;                 &quot;acetamide&quot;                   &quot;nicotinamide,red&quot;            &quot;nicotinamide,ox&quot;             &quot;2-iodobenzoic acid&quot;         
## [66] &quot;3-iodobenzoic acid&quot;          &quot;4-iodobenzoic acid&quot;          &quot;acetic acid&quot;                 &quot;propanoic acid&quot;              &quot;n-butanoic acid&quot;            
## [71] &quot;n-pentanoic acid&quot;            &quot;n-hexanoic acid&quot;             &quot;n-heptanoic acid&quot;            &quot;n-octanoic acid&quot;             &quot;n-nonanoic acid&quot;            
## [76] &quot;n-decanoic acid&quot;             &quot;n-undecanoic acid&quot;           &quot;n-dodecanoic acid&quot;           &quot;n-tridecanoic acid&quot;          &quot;n-tetradecanoic acid&quot;       
## [81] &quot;n-pentadecanoic acid&quot;        &quot;n-hexadecanoic acid&quot;         &quot;n-heptadecanoic acid&quot;        &quot;n-octadecanoic acid&quot;         &quot;n-nonadecanoic acid&quot;        
## [86] &quot;n-eicosanoic acid&quot;
</pre>
<pre><code>## [1] NA</code></pre>
<p>The message includes e.g. “uracil” and “metacinnabar” because their names have some similarity to the search term. Since “ribose” is the name of a species in the database, to find species with similar names, add an extra character to the search:</p>
<pre class="r"><code>info(&quot; ribose&quot;)</code></pre>
<pre style="color:blue">## info.approx: &#39; ribose&#39; is ambiguous; has approximate matches to 8 species:
</pre>
<pre style="color:blue">## [1] &quot;ribose&quot;               &quot;deoxyribose&quot;          &quot;ribose-5-phosphate&quot;  
## [4] &quot;ribose-5-phosphate-1&quot; &quot;ribose-5-phosphate-2&quot; &quot;ribose&quot;              
## [7] &quot;deoxyribose&quot;          &quot;ribose-5-phosphate&quot;
</pre>
<pre><code>## [1] NA</code></pre>
<p>The messages may be useful for browsing the database, but owing to their ambiguous results, these fuzzy searches return an <code>NA</code> value for the species index.</p>
</div>
<div id="counting-elements-chemical-formulas-zc" class="section level2">
<h2>Counting elements, chemical formulas, <span style="color:green"><code>ZC()</code></span></h2>
<p>Continuing with the example of aqueous methane, let’s look at its chemical formula:</p>
<pre class="r"><code>info(iCH4)$formula</code></pre>
<pre><code>## [1] &quot;CH4&quot;</code></pre>
<p>We can use <span style="color:green"><code>makeup()</code></span> to count the elements in the formula, followed by <span style="color:green"><code>as.chemical.formula()</code></span> to rewrite the formula on one line:</p>
<pre class="r"><code>makeup(iCH4)</code></pre>
<pre><code>## C H 
## 1 4</code></pre>
<pre class="r"><code>as.chemical.formula(makeup(iCH4))</code></pre>
<pre><code>## [1] &quot;CH4&quot;</code></pre>
<p>For organic species, a calculation of the average oxidation state of carbon (<i>Z</i><sub>C</sub>) is possible given the species index, chemical formula, or elemental count:</p>
<pre class="r"><code>ZC(iCH4)</code></pre>
<pre><code>## [1] -4</code></pre>
<pre class="r"><code>ZC(info(iCH4)$formula)</code></pre>
<pre><code>## [1] -4</code></pre>
<pre class="r"><code>ZC(makeup(iCH4))</code></pre>
<pre><code>## [1] -4</code></pre>
</div>
</div>
<div id="calculating-thermodynamic-properties" class="section level1">
<h1>Calculating thermodynamic properties</h1>
<p>To calculate the standard molal properties of species and reactions, use <span style="color:green"><code>subcrt()</code></span>. The name of this function is derived from the SUPCRT package <span class="citation">(Johnson et al., <label for="tufte-mn-4" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-4" class="margin-toggle">1992<span class="marginnote">Johnson JW, Oelkers EH, Helgeson HC. 1992. SUPCRT92: A software package for calculating the standard molal thermodynamic properties of minerals, gases, aqueous species, and reactions from 1 to 5000 bar and 0 to 1000°C. <em>Computers &amp; Geosciences</em> <strong>18</strong>(7): 899–947. doi: <a href="https://doi.org/10.1016/0098-3004(92)90029-Q">10.1016/0098-3004(92)90029-Q</a></span>)</span>, which is also the source of the Fortran subroutine used to calculate the thermodynamic properties of H<sub>2</sub>O.</p>
<p>If no reaction coefficients are given, <span style="color:green"><code>subcrt()</code></span> calculates the standard molal properties of individual species:</p>
<pre class="r"><code>subcrt(&quot;water&quot;)</code></pre>
<pre style="color:blue">## subcrt: 1 species at 15 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre><code>## $species
##    name formula state ispecies
## 1 water     H2O   liq        1
## 
## $out
## $out$water
##         T         P      rho    logK        G        H       S       V      Cp
## 1    0.01   1.00000 0.999829 45.0353 -56289.5 -68767.7 15.1324 18.0183 18.2056
## 2   25.00   1.00000 0.997061 41.5525 -56687.7 -68316.8 16.7123 18.0683 18.0116
## 3   50.00   1.00000 0.988030 38.6328 -57123.9 -67866.5 18.1623 18.2335 18.0046
## 4   75.00   1.00000 0.974864 36.1544 -57594.9 -67416.1 19.5048 18.4797 18.0416
## 5  100.00   1.01322 0.958393 34.0270 -58098.4 -66963.8 20.7596 18.7973 18.1579
## 6  125.00   2.32014 0.939073 32.1832 -58631.7 -66507.3 21.9419 19.1840 18.3333
## 7  150.00   4.75717 0.917058 30.5718 -59193.3 -66045.6 23.0640 19.6446 18.5664
## 8  175.00   8.91805 0.892343 29.1531 -59781.4 -65576.6 24.1360 20.1887 18.8830
## 9  200.00  15.53650 0.864743 27.8960 -60394.5 -65098.0 25.1682 20.8330 19.3288
## 10 225.00  25.47860 0.833873 26.7753 -61031.2 -64605.9 26.1712 21.6042 19.9704
## 11 250.00  39.73649 0.799072 25.7711 -61690.3 -64095.0 27.1569 22.5452 20.9123
## 12 275.00  59.43125 0.759236 24.8670 -62370.7 -63557.5 28.1400 23.7281 22.3513
## 13 300.00  85.83784 0.712408 24.0494 -63071.1 -62980.9 29.1407 25.2878 24.7394
## 14 325.00 120.45757 0.654577 23.3072 -63790.8 -62341.4 30.1952 27.5219 29.4475
## 15 350.00 165.21129 0.574688 22.6310 -64528.9 -61575.6 31.3971 31.3478 43.5985</code></pre>
<p>That uses the default temperature and pressure settings, i.e. equally spaced temperature intervals from 0 to 350 °C at <em>P</em><sub>sat</sub>, i.e. 1 bar below 100 °C, or the pressure of liquid-vapor saturation (i.e. boiling) at higher temperatures. The columns in the output are temperature, pressure, density of water, logarithm of the equilibrium constant (only meaningful for reactions; <a href="#properties-of-reactions">see below</a>), standard molal Gibbs energy and enthalpy of formation from the elements, standard molal entropy, volume, and heat capacity. <label for="tufte-mn-5" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle"><span class="marginnote"><span style="display: block;">The corresponding units are °C (<code>T</code>), bar (<code>P</code>), g cm<sup>-3</sup> (<code>rho</code>), cal mol<sup>-1</sup> (<code>G</code> and <code>H</code>), cal K<sup>-1</sup> mol<sup>-1</sup> (<code>S</code> and <code>Cp</code>), and cm<sup>3</sup> mol<sup>-1</sup> (<code>V</code>).</span></span></p>
<p>A custom temperature-pressure grid can be specified. Here, we calculate the properties of H<sub>2</sub>O on a <em>T</em>, <em>P</em> grid in the supercritical region, with conditions grouped by pressure:</p>
<pre class="r"><code>subcrt(&quot;water&quot;, T = c(400, 500, 600), P = c(200, 400, 600), grid = &quot;P&quot;)$out$water</code></pre>
<pre style="color:blue">## subcrt: 1 species at 9 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre><code>##     T   P       rho    logK        G        H       S        V      Cp
## 1 400 200 0.1005447 21.5271 -66306.4 -56639.3 39.0387 179.1760 27.4305
## 2 500 200 0.0677109 19.8868 -70353.7 -54819.8 41.5776 266.0607 14.0774
## 3 600 200 0.0550386 18.6704 -74593.1 -53540.0 43.1368 327.3197 11.9607
## 4 400 400 0.5236661 21.4119 -65951.4 -60454.4 32.8438  34.4021 37.5317
## 5 500 400 0.1779739 19.6639 -69565.0 -56252.5 38.7044 101.2238 24.9675
## 6 600 400 0.1238075 18.4124 -73562.4 -54361.7 41.0152 145.5098 15.4901
## 7 400 600 0.6124511 21.3631 -65801.3 -60832.4 32.0592  29.4149 25.8810
## 8 500 600 0.3384430 19.5660 -69218.6 -57694.2 36.3916  53.2296 32.4385
## 9 600 600 0.2071976 18.2784 -73027.2 -55195.1 39.4479  86.9469 19.3763</code></pre>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Isothermal contours of density (g cm&lt;sup&gt;-3&lt;/sup&gt;) and pressure (bar) of water." width="100%" /> <!--
<p class="caption marginnote">-->Isothermal contours of density (g cm<sup>-3</sup>) and pressure (bar) of water.<!--</p>--> <!--</div>--></span>
</p>
<p>The additional operations (<code>$out$water</code>) are used to extract a specific part of the results; this can be used with e.g. R’s <code>write.table()</code> or <code>plot()</code> for further processing:</p>
<pre class="r"><code>substuff &lt;- subcrt(&quot;water&quot;, T=seq(0,1000,100), P=c(NA, seq(1,500,1)), grid=&quot;T&quot;)
water &lt;- substuff$out$water
plot(water$P, water$rho, type = &quot;l&quot;)</code></pre>
<div id="changing-units" class="section level2">
<h2>Changing units</h2>
<p>The default units of temperature, pressure, and energy are °C, bar, and calories. The functions <span style="color:red"><code>T.units()</code></span>, <span style="color:red"><code>P.units()</code></span>, and <span style="color:red"><code>E.units()</code></span> can be used to change the units used by various functions in CHNOSZ. What is the Gibbs energy in J/mol of aqueous methane at 298.15 K and 0.1 MPa?</p>
<pre class="r"><code>T.units(&quot;K&quot;)
P.units(&quot;MPa&quot;)
E.units(&quot;J&quot;)
subcrt(&quot;CH4&quot;, T = 298.15, P = 0.1)$out$CH4$G</code></pre>
<pre><code>## [1] -34057.8</code></pre>
<p>A related function, <span style="color:green"><code>convert()</code></span>, can be used to convert given values between units. Let’s convert the standard Gibbs energy of aqueous methane listed in the database from cal/mol to J/mol:</p>
<pre class="r"><code>convert(info(info(&quot;CH4&quot;))$G, &quot;J&quot;)</code></pre>
<pre><code>## [1] -34057.8</code></pre>
<p>As expected, we get the same result from both operations.</p>
<p>Use <span style="color:red"><code>reset()</code></span> to restore the units and all other settings for CHNOSZ to their defaults:</p>
<pre class="r"><code>reset()</code></pre>
<pre style="color:blue">## reset: resetting &quot;thermo&quot; object
</pre>
<pre style="color:blue">## OBIGT: loading default database with 1903 aqueous, 3443 total species
</pre>
</div>
</div>
<div id="properties-of-reactions" class="section level1">
<h1>Properties of reactions</h1>
<div id="reaction-definitions" class="section level2">
<h2>Reaction definitions</h2>
<p>To calculate the thermodynamic properties of reactions, give the names of species, the physical states (optional), and reaction coefficients as the arguments to <span style="color:green"><code>subcrt()</code></span>. Here we calculate properties for the dissolution of CO<sub>2</sub>. This doesn’t correspond to the <em>solubility</em> of CO<sub>2</sub>; see the <a href="#complete-equilibrium-solubility">solubility section</a> in this vignette and <a href="../demo"><span style="color:blue"><code>demo(solubility)</code></span></a> for examples of solubility calculations.</p>
<pre class="r"><code>subcrt(c(&quot;CO2&quot;, &quot;CO2&quot;), c(&quot;gas&quot;, &quot;aq&quot;), c(-1, 1), T = seq(0, 250, 50))</code></pre>
<pre style="color:blue">## subcrt: 2 species at 6 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre><code>## $reaction
##      coeff           name formula state ispecies
## 2629    -1 carbon dioxide     CO2   gas     2629
## 1519     1            CO2     CO2    aq     1519
## 
## $out
##        T        P      rho     logK       G         H         S       V      Cp
## 1   0.01  1.00000 0.999829 -1.10873 1385.80 -5907.949 -26.70130 23.6978 49.1458
## 2  50.00  1.00000 0.988030 -1.71865 2541.27 -3947.724 -20.08036 36.9843 34.6260
## 3 100.00  1.01322 0.958393 -2.00354 3420.89 -2271.995 -15.25623 41.5584 33.0446
## 4 150.00  4.75717 0.917058 -2.10770 4080.94  -596.111 -11.05290 44.5642 34.3421
## 5 200.00 15.53650 0.864743 -2.09920 4544.74  1228.815  -7.00814 47.9553 39.3857
## 6 250.00 39.73649 0.799072 -2.01184 4815.90  3513.101  -2.49026 54.3882 55.7180</code></pre>
<p>In order to make a plot like Figure 18 of <span class="citation">Manning et al. (<label for="tufte-mn-6" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-6" class="margin-toggle">2013<span class="marginnote">Manning CE, Shock EL, Sverjensky DA. 2013. The chemistry of carbon in aqueous fluids at crustal and upper-mantle conditions: Experimental and theoretical constraints. <em>Reviews in Mineralogy and Geochemistry</em> <strong>75</strong>(1): 109–148. doi: <a href="https://doi.org/10.2138/rmg.2013.75.5">10.2138/rmg.2013.75.5</a></span>)</span>, let’s run more calculations and store the results. In addition to the reaction definition, we specify a greater number of temperature points than the default:</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Calculated equilibrium constants for dissolution of CO&lt;sub&gt;2&lt;/sub&gt;, CO, and CH&lt;sub&gt;4&lt;/sub&gt;." width="100%" /> <!--
<p class="caption marginnote">-->Calculated equilibrium constants for dissolution of CO<sub>2</sub>, CO, and CH<sub>4</sub>.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>T &lt;- seq(0, 350, 10)
CO2 &lt;- subcrt(c(&quot;CO2&quot;, &quot;CO2&quot;), c(&quot;gas&quot;, &quot;aq&quot;), c(-1, 1), T = T)$out$logK
CO &lt;- subcrt(c(&quot;CO&quot;, &quot;CO&quot;), c(&quot;gas&quot;, &quot;aq&quot;), c(-1, 1), T = T)$out$logK
CH4 &lt;- subcrt(c(&quot;CH4&quot;, &quot;CH4&quot;), c(&quot;gas&quot;, &quot;aq&quot;), c(-1, 1), T = T)$out$logK
logK &lt;- data.frame(T, CO2, CO, CH4)</code></pre>
<p>Now we can make the plot, using R’s <code>matplot()</code>. Here, <span style="color:green"><code>axis.label()</code></span> and <span style="color:green"><code>expr.species()</code></span> are used to create formatted axis labels and chemical formulas:</p>
<pre class="r"><code>matplot(logK[, 1], logK[, -1], type = &quot;l&quot;, col = 1, lty = 1,
        xlab = axis.label(&quot;T&quot;), ylab = axis.label(&quot;logK&quot;))
text(80, -1.7, expr.species(&quot;CO2&quot;))
text(240, -2.37, expr.species(&quot;CO&quot;))
text(300, -2.57, expr.species(&quot;CH4&quot;))</code></pre>
</div>
<div id="unbalanced-reactions" class="section level2">
<h2>Unbalanced reactions</h2>
<p>A balanced chemical reaction conserves mass. <span style="color:green"><code>subcrt()</code></span> won’t stop you from running an unbalanced reaction, but it will give you a warning:</p>
<pre class="r"><code>subcrt(c(&quot;CO2&quot;, &quot;CH4&quot;), c(-1, 1))</code></pre>
<pre style="color:blue">## info.character: found CO2(aq); also available in gas
</pre>
<pre style="color:blue">## info.character: found CH4(aq); also available in gas, liq
</pre>
<pre style="color:blue">## subcrt: 2 species at 15 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre style="color:blue">## subcrt: reaction is not balanced; it is missing this composition:
</pre>
<pre style="color:blue">##  H  O 
## -4  2
</pre>
<pre style="color:magenta">## Warning in subcrt(c(&quot;CO2&quot;, &quot;CH4&quot;), c(-1, 1)): reaction among CO2,CH4 was
## unbalanced, missing H-4O2
</pre>
<p>In other words, to balance the reaction, we should add 4 H to the left and 2 O to the right. That could be done manually be redefining the reaction with the appropriate species. There is another option: balancing the reaction automatically using basis species.</p>
</div>
<div id="setting-the-basis-species" class="section level2">
<h2>Setting the basis species</h2>
<p><em>Basis species</em> are a minimal number of chemical species that linearly combine to give the composition of any species in the system. The basis species are similar to thermodynamic components, but can include charged species. Basis species are used in CHNOSZ to automatically balance reactions; they are also required for making chemical activity diagrams.</p>
<p>Let’s start with an example that doesn’t work:</p>
<pre class="r"><code>basis(c(&quot;CO2&quot;, &quot;H2&quot;, &quot;H2CO2&quot;))</code></pre>
<pre style="color:red">## Error in put.basis(ispecies, logact): singular stoichiometric matrix
</pre>
<p>That set of species has a singular (non-invertible) stoichiometric matrix. An error would also result from either an underdetermined or overdetermined system. A valid set of basis species has an invertible stoichiometric matrix and the same number of species as elements:</p>
<pre class="r"><code>basis(c(&quot;CO2&quot;, &quot;H2&quot;, &quot;H2O&quot;))</code></pre>
<pre><code>##     C H O ispecies logact state
## CO2 1 0 2     1519      0    aq
## H2  0 2 0       62      0    aq
## H2O 0 2 1        1      0   liq</code></pre>
<p>The composition of any species made up of C, H, and O can be represented by a single linear combination of these basis species.</p>
</div>
<div id="automatically-balancing-reactions" class="section level2">
<h2>Automatically balancing reactions</h2>
<p>Methanogenic metabolism in reducing environments may proceed by acetoclastic or hydrogenotrophic processes. To consider reactions involving a charged species (acetate), let’s define a basis with H<sup>+</sup>:</p>
<pre class="r"><code>basis(c(&quot;CO2&quot;, &quot;H2&quot;, &quot;H2O&quot;, &quot;H+&quot;))</code></pre>
<pre><code>##     C H O Z ispecies logact state
## CO2 1 0 2 0     1519      0    aq
## H2  0 2 0 0       62      0    aq
## H2O 0 2 1 0        1      0   liq
## H+  0 1 0 1        3      0    aq</code></pre>
<p>By identifying species <em>other than</em> the basis species, the reactions will be automatically balanced. This produces the balanced reaction for acetoclastic methanogenesis:</p>
<pre class="r"><code>subcrt(c(&quot;acetate&quot;, &quot;CH4&quot;), c(-1, 1))$reaction</code></pre>
<pre><code>##      coeff    name formula state ispecies
## 1078    -1 acetate C2H3O2-    aq     1078
## 880      1     CH4     CH4    aq      880
## 1519     1     CO2     CO2    aq     1519
## 3       -1      H+      H+    aq        3</code></pre>
<p>We can similarly consider reactions for hydrogenotrophic methanogenesis as well as acetate oxidation (without production of methane):</p>
<pre class="r"><code>acetate_oxidation &lt;- subcrt(&quot;acetate&quot;, -1)
hydrogenotrophic &lt;- subcrt(&quot;CH4&quot;, 1)
acetoclastic &lt;- subcrt(c(&quot;acetate&quot;, &quot;CH4&quot;), c(-1, 1))</code></pre>
<p>Use <span style="color:green"><code>describe.reaction()</code></span> to write the reactions on a plot:</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt=" " width="100%" /> <!--
<p class="caption marginnote">--> <!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>plot(0, 0, type = &quot;n&quot;, axes = FALSE, ann=FALSE, xlim=c(0, 5), ylim=c(5.2, -0.2))
text(0, 0, &quot;acetoclastic methanogenesis&quot;, adj = 0)
text(5, 1, describe.reaction(acetoclastic$reaction), adj = 1)
text(0, 2, &quot;acetate oxidation&quot;, adj = 0)
text(5, 3, describe.reaction(acetate_oxidation$reaction), adj = 1)
text(0, 4, &quot;hydrogenotrophic methanogenesis&quot;, adj = 0)
text(5, 5, describe.reaction(hydrogenotrophic$reaction), adj = 1)</code></pre>
</div>
<div id="chemical-affinity" class="section level2">
<h2>Chemical affinity</h2>
<p>Usually, <span style="color:green"><code>subcrt()</code></span> returns only standard state thermodynamic properties. <label for="tufte-mn-7" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-7" class="margin-toggle"><span class="marginnote"><span style="display: block;">The standard state adopted for H<sub>2</sub>O is unit activity of the pure component at any <em>T</em> and <em>P</em>. The standard state for aqueous species is unit activity of a hypothetical one molal solution referenced to infinite dilution at any <em>T</em> and <em>P</em>.</span></span> Thermodynamic models often consider a non-standard state (i.e. non-unit activity). The activities of basis species can be modified with <span style="color:red"><code>basis()</code></span>, and those of the other species using the <code>logact</code> argument in <span style="color:green"><code>subcrt()</code></span>.</p>
<p>Let us calculate the chemical affinity of acetoclastic methanogenesis. <label for="tufte-mn-8" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-8" class="margin-toggle"><span class="marginnote"><span style="display: block;">The affinity is equal to the negative of the overall (non-standard) Gibbs energy change of the reaction.</span></span> We begin by changing the energy units to Joules. Then, we change the state of H<sub>2</sub>O and CO<sub>2</sub> in the basis from <code>aq</code> (aqueous) to <code>gas</code>, and set the logarithm of fugacity of gaseous H<sub>2</sub> and the pH, using values from <span class="citation">Mayumi et al. (<label for="tufte-mn-9" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-9" class="margin-toggle">2013<span class="marginnote">Mayumi D, Dolfing J, Sakata S, Maeda H, Miyagawa Y, Ikarashi M, Tamaki H, Takeuchi M, Nakatsu CH, Kamagata Y. 2013. Carbon dioxide concentration dictates alternative methanogenic pathways in oil reservoirs. <em>Nature Communications</em> <strong>4</strong>: 1998. doi: <a href="https://doi.org/10.1038/ncomms2998">10.1038/ncomms2998</a></span>)</span>. The activity of acetate and fugacity of methane, as well as temperature and pressure, are set in the call to <span style="color:green"><code>subcrt()</code></span>:</p>
<pre class="r"><code>E.units(&quot;J&quot;)
basis(c(&quot;CO2&quot;, &quot;H2&quot;, &quot;H2O&quot;, &quot;H+&quot;))
basis(c(&quot;CO2&quot;, &quot;H2&quot;), &quot;gas&quot;)
basis(c(&quot;H2&quot;, &quot;pH&quot;), c(-3.92, 7.3))</code></pre>
<pre class="r"><code>subcrt(c(&quot;acetate&quot;, &quot;CH4&quot;), c(-1, 1),
       c(&quot;aq&quot;, &quot;gas&quot;), logact = c(-3.4, -0.18), T = 55, P = 50)$out</code></pre>
<pre><code>##    T  P      rho    logK        G       H       S        V      Cp  logQ
## 1 55 50 0.987821 13.5984 -85429.6 18706.9 317.685 -40.1339 39.2144 10.52
##         A
## 1 19339.4</code></pre>
<p>The new <code>A</code> column shows the affinity; the other columns are unaffected and still show the standard-state properties. Let’s repeat the calculation for hydrogenotrophic methanogenesis.</p>
<pre class="r"><code>subcrt(&quot;CH4&quot;, 1, &quot;gas&quot;, logact = -0.18, T = 55, P = 50)$out</code></pre>
<pre><code>##    T  P      rho   logK       G       H        S       V      Cp logQ       A
## 1 55 50 0.987821 18.828 -118284 -251807 -407.195 36.4746 33.4702 15.5 20907.8</code></pre>
<p>Under the specified conditions, the affinities of hydrogenotrophic and acetoclastic methanogenesis are somewhat greater than and less than 20 kJ, respectively. This result matches Figure 4b in Mayumi et al. (2013) at unit fugacity of CO<sub>2</sub>.</p>
<p>We can go even further and reproduce their plot. <label for="tufte-mn-10" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-10" class="margin-toggle"><span class="marginnote"><span style="display: block;">The reproduction is not identical, owing to differences of thermodynamic data and of calculations of the effects of temperature and pressure.</span></span> To make the code neater, we write a function that can run any of the reactions:</p>
<pre class="r"><code>rxnfun &lt;- function(coeffs) {
  subcrt(c(&quot;acetate&quot;, &quot;CH4&quot;), coeffs,
         c(&quot;aq&quot;, &quot;gas&quot;), logact = c(-3.4, -0.18), T = 55, P = 50)$out
}</code></pre>
<p>Now we’re ready to calculate and plot the affinities. Here, we use R’s <code>lapply()</code> to list the results at two values of logarithm of fugacity of CO<sub>2</sub>. We insert an empty reaction to get a line at zero affinity. R’s <code>do.call()</code> and <code>rbind()</code> are used to turn the list into a data frame that can be plotted with R’s <code>matplot()</code>. There, we plot the negative affinities, equal to Gibbs energy, as shown in the plot of Mayumi et al. (2013).</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Gibbs energies of acetate oxidation and methanogenesis (after Mayumi et al., 2013)." width="100%" /> <!--
<p class="caption marginnote">-->Gibbs energies of acetate oxidation and methanogenesis (after Mayumi et al., 2013).<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>Adat &lt;- lapply(c(-3, 3), function(logfCO2) {
  basis(&quot;CO2&quot;, logfCO2)
  data.frame(logfCO2,
    rxnfun(c(0, 0))$A,
    rxnfun(c(-1, 0))$A,
    rxnfun(c(-1, 1))$A,
    rxnfun(c(0, 1))$A
  )
})
Adat &lt;- do.call(rbind, Adat)
matplot(Adat[, 1], -Adat[, -1]/1000, type = &quot;l&quot;, lty = 1, lwd = 2,
  xlab = axis.label(&quot;CO2&quot;), ylab = axis.label(&quot;DG&quot;, prefix = &quot;k&quot;))
legend(&quot;topleft&quot;, c(&quot;acetate oxidation&quot;, &quot;acetoclastic methanogenesis&quot;,
  &quot;hydrogenotrophic methanogenesis&quot;), lty = 1, col = 2:4)</code></pre>
<p>Let’s not forget to clear the system settings, which were modified by <span style="color:red"><code>basis()</code></span> and <span style="color:red"><code>E.units()</code></span>, before running other calculations:</p>
<pre class="r"><code>reset()</code></pre>
</div>
</div>
<div id="using-affinity" class="section level1">
<h1>Using <span style="color:green"><code>affinity()</code></span></h1>
<p><span style="color:green"><code>affinity()</code></span> offers calculations of chemical affinity of formation reactions over a configurable range of <em>T</em>, <em>P</em>, and activities of basis species.</p>
<div id="from-affinity-to-diagrams" class="section level2">
<h2>From affinity to diagrams</h2>
<p>By <em>formation reaction</em> is meant the stoichiometric requirements for formation of one mole of any species from the basis species. The <span style="color:red"><code>species()</code></span> function is used to set these <em>formed species</em>. Let’s consider the stoichiometry of some aqueous sulfur-bearing species. Here we use <span style="color:red"><code>basis()</code></span> with a keyword to load a preset basis definition. To use Eh as a variable, the electron (<em>e</em><sup>-</sup>) should be in the basis, so we use the keyword (<span style="color:red"><code>basis(&quot;CHNOSe&quot;)</code></span>). <label for="tufte-mn-11" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-11" class="margin-toggle"><span class="marginnote"><span style="display: block;">Some available keywords are <code>CHNOS</code> (including CO<sub>2</sub>, H<sub>2</sub>O, NH<sub>3</sub>, H<sub>2</sub>S, and O<sub>2</sub>), <code>CHNOS+</code> (also including H<sup>+</sup>), and <code>CHNOSe</code> (including H<sup>+</sup>, and <em>e</em><sup>-</sup> instead of O<sub>2</sub>). See <span style="color:blue"><code>?basis</code></span> for more options.</span></span> <label for="tufte-mn-12" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-12" class="margin-toggle"><span class="marginnote"><span style="display: block;">What is <code>SO42-</code>? Is it 1 S, 4 O, and 2 negative charges, or 1 S, 42 O, and 1 negative charge? The ambiguity of a digit that could belong to the coefficient for the following charge or to that for the preceding element is why formulas in CHNOSZ are written with the number of charges after the + or - symbol. <code>SO4-2</code> is unambiguously parsed as 1 S, 4 O and 2 negative charges.</span></span></p>
<pre class="r"><code>basis(&quot;CHNOSe&quot;)</code></pre>
<pre class="r"><code>species(c(&quot;H2S&quot;, &quot;HS-&quot;, &quot;HSO4-&quot;, &quot;SO4-2&quot;))</code></pre>
<pre><code>##   CO2 H2O NH3 H2S e-  H+ ispecies logact state  name
## 1   0   0   0   1  0   0       65     -3    aq   H2S
## 2   0   0   0   1  0  -1       22     -3    aq   HS-
## 3   0   4   0   1 -8  -9       25     -3    aq HSO4-
## 4   0   4   0   1 -8 -10       24     -3    aq SO4-2</code></pre>
<p>Aqueous species are assigned default activities of 10<sup>-3</sup> (<code>logact</code> is -3). Now, we can use <span style="color:green"><code>affinity()</code></span> to calculate the affinities of the formation reactions of each of the species. R’s <code>unlist()</code> is used here to turn the list of values of affinity into a numeric object that can be printed in a couple of lines (note that the names correspond to <code>ispecies</code> above):</p>
<pre class="r"><code>unlist(affinity()$values)</code></pre>
<pre style="color:blue">## affinity: temperature is 25 ºC
</pre>
<pre style="color:blue">## affinity: pressure is Psat
</pre>
<pre style="color:blue">## subcrt: 10 species at 25 ºC and 1 bar (wet) [energy units: cal]
</pre>
<pre><code>##       65       22       25       24 
## -4.00000 -3.98775 76.30176 81.32264</code></pre>
<p>The values returned by <span style="color:green"><code>affinity()</code></span> are dimensionless, i.e. <em>A</em>/(2.303<em>RT</em>). Although <span style="color:green"><code>subcrt()</code></span> can also calculate affinities (in units of cal/mol or J/mol), the main advantage of <span style="color:green"><code>affinity()</code></span> is that it can perform calculations on an arbitrary grid of <em>T</em>, <em>P</em>, or activities of basis species. This is the foundation for making many types of diagrams that are useful in geochemistry.</p>
<p>Given the values of affinity, the <span style="color:green"><code>diagram()</code></span> function identifies the species that has the maximum affinity at each grid point. The result is equivalent to a “predominance diagram” <span class="citation">(Dick, <label for="tufte-mn-13" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-13" class="margin-toggle">2019<span class="marginnote">Dick JM. 2019. CHNOSZ: Thermodynamic calculations and diagrams for geochemistry. <em>Frontiers in Earth Science</em> <strong>7</strong>: 180. doi: <a href="https://doi.org/10.3389/feart.2019.00180">10.3389/feart.2019.00180</a></span>)</span>, where the fields represent the predominant aqueous species and the boundaries are equal-activity lines. If both aqueous species and minerals are present, it is common practice to assign a constant activity to all aqueous species and unit activity (i.e. log activity = 0) for minerals. More sophisticated diagrams can be made by showing the solubility contours of a metal on the diagram; see <a href="../demo"><span style="color:blue"><code>demo(contour)</code></span></a> for an example.</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Aqueous sulfur species at 25 °C." width="100%" /> <!--
<p class="caption marginnote">-->Aqueous sulfur species at 25 °C.<!--</p>--> <!--</div>--></span>
</p>
<p>Let’s use <span style="color:green"><code>diagram()</code></span> to make a simple Eh-pH diagram for aqueous species in the system S-O-H. After running the <span style="color:red"><code>basis()</code></span> and <span style="color:red"><code>species()</code></span> commands above, we can calculate the affinities on an Eh-pH grid. With the default settings in <span style="color:green"><code>diagram()</code></span>, areas beyond the stability limits of water are colored gray. This can be changed by setting the <code>limit.water</code> argument to FALSE (to not show the stability region of water) or TRUE (to plot the main diagram only in the stable region of water). The names of species that can be parsed as chemical formulas are formatted with subscripts and superscripts; if this is not desired, set <code>format.names = FALSE</code>.</p>
<pre class="r"><code>a &lt;- affinity(pH = c(0, 12), Eh = c(-0.5, 1))
diagram(a, limit.water = TRUE)</code></pre>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="The same plot, with different colors and labels." width="100%" /> <!--
<p class="caption marginnote">-->The same plot, with different colors and labels.<!--</p>--> <!--</div>--></span>
</p>
<p>Other arguments in <span style="color:green"><code>diagram()</code></span> can be used to control the line type (<code>lty</code>), width (<code>lwd</code>), and color (<code>col</code>), field colors (<code>fill</code>), and species labels (<code>name</code>). Additional arguments are passed to R’s plotting functions; here, we use <code>las</code> to change the orientation of axes labels. Another function, <span style="color:green"><code>water.lines()</code></span>, can be used to draw lines at the water stability limits:</p>
<pre class="r"><code>diagram(a, fill = &quot;terrain&quot;, lwd = 2, lty = 3,
        names = c(&quot;hydrogen sulfide&quot;, &quot;bisulfide&quot;, &quot;bisulfate&quot;, &quot;sulfate&quot;),
        las = 0)
water.lines(a, col = 6, lwd = 2)</code></pre>
<p>See the demos in the package for other examples of Eh-pH diagrams. In particular, <a href="../demo"><span style="color:blue"><code>demo(Pourbaix)</code></span></a> shows how to plot the concentrations of metals as equisolubility (or isosolubility) lines on Eh-pH diagrams <span class="citation">(Pourbaix, <label for="tufte-mn-14" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-14" class="margin-toggle">1974<span class="marginnote">Pourbaix M. 1974. <em>Atlas of Electrochemical Equilibria in Aqueous Solutions</em>. 2nd ed. Houston, Texas; Brussels: National Association of Corrosion Engineers; CEBELCOR. Available at <a href="https://www.worldcat.org/oclc/563921897">https://www.worldcat.org/oclc/563921897</a>. </span>)</span>.</p>
<p>Mineral stability diagrams often depict activity ratios, e.g. log (<em>a</em><sub>Ca<sup>+2</sup></sub>/<em>a</em><sub>H<sup>+</sup></sub><sup>2</sup>), on one or both axes. The variables used for potential calculations in CHNOSZ include only a single chemical activity, e.g. log <em>a</em><sub>Ca<sup>+2</sup></sub>. However, you can set pH = 0 to generate diagrams that are geometrically equivalent to those calculated using activity ratios, and use <span style="color:green"><code>ratlab()</code></span> to make the axes labels for the ratios. Moreover, <span style="color:green"><code>diagram()</code></span> has a “saturation” option that can be used to draw saturation limits for minerals that do not contain the conserved basis species. See <a href="../demo"><span style="color:blue"><code>demo(saturation)</code></span></a> for an example that uses activity ratios on the axes and plots saturation limits for calcite, magnesite, dolomite, and brucite on a diagram for the H<sub>2</sub>O–CO<sub>2</sub>–CaO–MgO–SiO<sub>2</sub> system. That demo can be used as a template to produce a wide range of diagrams similar to those in <span class="citation">Bowers et al. (<label for="tufte-mn-15" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-15" class="margin-toggle">1984<span class="marginnote">Bowers TS, Jackson KJ, Helgeson HC. 1984. <em>Equilibrium Activity Diagrams for Coexisting Minerals and Aqueous Solutions at Pressures and Temperatures to 5 Kb and 600°C</em>. Heidelberg: Springer-Verlag. Available at <a href="https://www.worldcat.org/oclc/11133620">https://www.worldcat.org/oclc/11133620</a>. </span>)</span>.</p>
</div>
<div id="retrieving-species-in-a-chemical-system" class="section level2">
<h2>Retrieving species in a chemical system</h2>
<p>Most of the diagrams in this vignette are made by giving the names of all the species. However, it can be tedious to find all the species by manually searching the OBIGT database. The <span style="color:green"><code>retrieve()</code></span> function can be used to identify the available species that contain particular chemical elements. For example, to get Mn-bearing aqueous species and minerals including the single element, oxides and oxyhydroxides, use this:</p>
<pre class="r"><code>retrieve(&quot;Mn&quot;, c(&quot;O&quot;, &quot;H&quot;), &quot;aq&quot;)</code></pre>
<pre><code>##  MnO4-   Mn+2   Mn+3 MnO4-2  MnOH+    MnO HMnO2- MnO2-2 
##    438    447    524    525    617    618    619    620</code></pre>
<pre class="r"><code>retrieve(&quot;Mn&quot;, c(&quot;O&quot;, &quot;H&quot;), &quot;cr&quot;)</code></pre>
<pre><code>##     MnO    MnO2   Mn2O3   Mn3O4      Mn Mn(OH)2 
##    2043    2044    2045    2046    2047    2048</code></pre>
<p>Below, these commands are used to identify the species in an Eh-pH diagram for the Mn-O-H system at 100 °C. This diagram includes Mn oxides (pyrolusite, bixbyite, hausmannite), Mn(OH)<sub>2</sub>, and aqueous Mn species.</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAMAAAD8CC+4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAM1BMVEXf4+c9PD13dnTJys7///+oqakWDRP89Onk3NH3+/+IPQyMxuQOP4fco1s/h8rv4J655+8CLa1kAAAgAElEQVR42uydiZqjKhBGBQLuy/s/bVOFJtqJcSMJ6F/fvRMl3ZmJx1rBIrlBLicJLgGgQwAdAugQQIcAOgTQIYAOAXQIoEMAHQLoEECHADoE0CGADgF0CKADOgTQIYAOAXQIoEMAHQLoEECHADoE0CGADgF0CKBDAB0C6BBAhwA6oEMAHQLoEECHADoE0CGADgF0SEzQ09pU+XBSGJYOl/DU0FvLeAS90kppleMSnhp63STFHXpaVPwK6Kf36c/QIdeCbr16BZd+JehtYaSuh0BOi/9i4hkwSwMxfxmhj0JPH9Bvac6xXcMnQi+K/M3AHpFn+jLCo6ZP7wKhk6no/wNqeUD+G0j2DKj//5DlAb15IKYv8xHot5fQVUTXSXlgHO6X8Qk9VeTN67t5//+l1faBpy+ttg88fekVn7EMPeYvcxB6pjRVZDqLurSBnNCqHsL3J+g7RHn4jGfl2CH6VF/mIPS+8FoxdArfHylbMND1maDrAKC/ER/QExXIZwTzD/HxGaFDh3xAAB3QAR3QAR3QAf1zkhXVh/+GwjSfh2601go0Q4FeGwddWSwG0C8BvS3EN6DDvG+GnkljjCjpzJhKEyUeajwYd/dx8OnBQbduV+nClBkdSIJtj7QutlCvTS/ldLRsAT1E6K2pmE/j+BDrVtijdgv0bJg078bG3X4MoAcJvWYsbVG5g3qg1B6270XVAXrI0LMx9FoMptqZAav+d7NdT26Fopkz9lVXuw8A9HA13Tyg16YqVdIzowivFXfoddVNP6B84dMpVtdJMYx1gB6+T2e9zsg4W9zk3mshyrqSNv3KCndalTbAF9KqczXr0+kJFG0/V0HTQ43eRR+9C9J0OyBMpQi6pJ+QFjqZ/aq1ik//W2dAv1B1dPI2U4d5DzdPr8iKU55ekzrTOS1GsoC1KPmPWnQWuu6te12RiteAfg6pJ6m2ZVo0rODkzAl1Z28SYc1A4aAPTn1ZAD1I4dVZT9Drqmju0DX/2a3X9K9AR+39QF5tGi3NpBrfknEX3QO6ZWxxt6t9+hDUYcIlVA9Pzl12/6AnFOEP0LuC6nXCOnkb44+i999Ch3n/sMsf5+l1pVa7dPj0mH1AM4ZerC/VAvoVw0RAB3RAB3RAB3RAB3RA95mBDdOfr1dM2MzdpWg0w85H9wOXxY/eNqIB9CjKMVQ0oULcdJ3T+JZwqE2lmf/9gH/bJmyFm44VUkthqg7QY8m8Z1nVjeI33Uppnn/rD3pFpyId3xK9vpeAHom2v1377pZS9ItrmvvBWNOzwqwpy2HCJSAZL4B8Wsns1s+4mTdeRleObxPn01uzXH/HhEtosdwD+vOqpxno3cxd8xvoMO/boZdvbb8X6PDpgcVxplvy6XPmfYBeAXrEcdyMT58J5O4/8+tADtA3x3Ej6DM+/W7kx9Z+fKsMKVsD6NHFcU+cNPXr0+VMcWb0GVScKX5XnDFCIXr3FMcN/frmyrCPD/l1GZb+fmAPTz4KPctogZ+Gvl8MOmM3KNJcDLoVbbGD+8WgM3Yjgf380Ln2PuEuoe6/ly9MuGQj0UJY7pfJv3z0hIoO+ti8D6IIe/zci6F2Vv/LlNdkyZfx6WPswkRfqyv6kng2LX1lqxYrXRA6CWHXWczQ++6LtRGTB8p6A1CbBtCfRdLjlvFGdUXl5rH5lec5yabfJ7dXTnZdDTpzjzd576ez26Jh6KaihazlY5asBvQ36m5klNl7USnu7WRKB73s+381d+jNqaGn9Wj/9Jub+VkJfeCuI4Te0dPhRZU4855cC3pL83136PYGUHo4XwOds3er7jo66P3ilTH0y5j3mr73aCvt/OZ2aFsPPcaizRC+dRPo2bDGrY/ogkXvddtNt5+yDW+2QY9P3QteucLt/kbQH4uV3Po1cQnoTscfuypnG0RLanYZEfSWCzQT6P2TZH3Fxob2p4WezkG3Jlv+L7+/FUXYZSzQ73+MnyrTjzLsptY/3yy8ay3NxzTduP3d1QZ1V9KG8zI5g2RFmYUJXfqYcJk372oL8Dt3i/0EU+91lWTFhQK5+/7p2R7qNnmXIv4VF8XzPirn9OmvU7Y94Am7UPFb+FNqet4qWoSvOoeaijP1/+KMUnsUnqL5yFdcnNa8D4vwe/2mMmyTPJVhd1l5y90IPCYTpk9fOeGisn3qDuwxQ98X1bG6S4CKE3q2M5bPNLhHDH2/KB1RjRbQn/mpvdwFuEer6Wo/duIOZEFDN3OFd7XfzhN2gcdkjpbfzfehH7HyLqwD9lChvw/kdlt5zuLA/fzR+yt1NyjaRAp9v7orbnYAgMFBT9dQ349daWAPEDrJIrtDRRtqdgCKwUFfwf0IeOIO7AFCX+R+wMjTb9NiRKAMD/oS+IPYFToVBgp9Ef0R7plA8h4u9HfgD6k7NzuAugcLfZa7OojddSrMwPVnEy5Sa5VuB39Q0KHyp7X3Regz3I+qOxrS/nLCJV0nH8CODpVB+vSPW3p0qAwe+gvuR7WdVlxA3b8NXaZbxbORP02HyoigG52l6SHw6riVP0WHyoigi53YU79Wvu9QCdbf8em59aoq3SderXwm4u5QGRX0PNdG78We+lT2uDtURgadlF3uxp56de/UqRDYvwE9z20ErdMD4tHKc7MDZHFfgG6x27wpPc7di5W/1PYSv8jTrQ911BNxFLvPml2MjUljqb2bB3SLnboLpOlh8MqLlddCXpb7pydc8rEkNo5Kj4sf394XbSTM+2ehk5HfUZmdsfQ+wMfToTJi6HnO/SC9cPej7yfqUBkudMaeeaFunZOfJhcn6VAZMnTCLv1g9xbSs7orQP8g9FzbyNkTdvsFPHG/VNHmB9AZu/JFXSV+9P0UDWlDhk7zMNIT9jTxZujJBF1i6v1H0HPlpVgzsvJewF+kQ+WvoDN2j9RV4im0u0JD2t9Bp3kYf8qeJt5CeiXP3qnw00+4vKeufWInhffG/byNSb/whMuCsic2ovMIXSW+FN5empOq+1cnXOawGyE/oes+uFOnQpj3D0DPaVsrj9in7v0gd33ODpW/h57fEr60Xq38fLG2LUzziu/cOHNXgO4Zen7Lc1ojL3zNxdzz9lfc5+BmhbDjralmsjgF6F6hk9irqqgfoMg+Y+Uf4Oegs9SvoJ+uQ2Uo0HNWc8f9QIG2oF3MjSjtQWWtvD0u7ZD9L6UthYxUTtNbQ+Tp3aylJgaidOO8DRG9I3jsrB0qD0On61N1/Um/d1O3A3ounZYzd7O3WEf/AKLbEdA0segtSNpBim4F+pcm6QQ6cRbSvlEydPqrZUlvyILuiKftJc6B/fD+6aZSetiJ7UZbtCmbnO+BTmsns8EM653cLaouJZjEMCVTTkNlak+rlN8g6OlD01tmW7hfoIMq62+JV27gJB0qD0Kf7rloz/h1H3RSdvXwv3x9t0OvnJG3gCve7TobcJf92wy9GDTdHtH210OAx9DJKkhZvHTv6gwdKg9C73dXLZoJ9NtO6LmezLNzK8ht4ImoY0vAa+Jth9QIejZAT/lH2H1bs6+m0N0Og286VMoLQ5/uo2xfi4eH3wH9H3W29BRTbdN0h7QP4BhyDz0ba3o/aHWcfHU1hV6u6FAJ6AzdXjip6yGQM1LSDupqI3X9nGnxTvTZSujOpxNSQSdO+f/5dIKbsLdvRZVwprbKp097XETIXfGW9gdr71PotzS/PbbStjfAduivqLPQNc6yldE7wSZvXaW9pqeT6J1P+QcpaLf+u78ZiLQRnLnRD5fn61DJ0O339Ql9FNztM+95ftOzYTslVOo9+Hueno6Ct4bPyFw0SX8TENeq7eN6QxO8PJ61Yi5Pn21Ia9RFA7let2+TcG4fdFpbMZ+tuRw+WwjknFD8vjQN52FVtYyvQaXflE11rP3NIej8aPMbKpzDzyj8CHo7vgHezMYc5+4ak6rLQOfiTE3FGQLfFkLTWXcQ+gJ1x11mL8DfQbe9Z19Tk/dAXkfVkNZLGbZJem1nB3kkZXssrVhKz5Wrpas56NYpd1um4Xxwj6VDZTATLpupExRuCam2T9Ak04VVnrhH05A2VOh5sm4Vlcvht3JXnzL0OooOlcFCp6fZ1zKU3B1ww0x8sj6o28o9hg6V4UKnKfb1E23cLmw1eLXRuW/U99A7VIYMnabYN9hsyX1JV3FP/p15V3hW9wzQdyr7tuVTmrmrjdA36Pt67vYeDLVD5U+fcFmj7JsXzblGcVpvDOc/0AohzA6Vv3/CZY2J375UUgkHfutCyuQD3INrSBvCEy4foc65nOBpvvVFOb4kd1s/fn0a4NdMuR5Xamh1NRxMXkndJYuW71+/+IYIHfptd9sKuuBCvOKezFfqBsgvX5/fyB79DFV/oMYDw7YitKo/IAkd+vNymk1C4J9CeuXNva+z9Ba7RvS+lfqhZiXcPUqOmxslm56K8sFdh9SFOAro1Jno2HPsUrr+USs0fWMKtxa8Dqj5dBzQ51dRbcnlHtyTxQxO7WlsudzYRAL6til2Dz0raHkYhbCrHn31386QulMC+tepM3du+/2Bms0K7iqIribxQF9cTrOheOMUXi6Wafd597fcQ+hAHBH0dQsrVs6yZdLF9AuzcDt1/S14+fOH3WOC7o9632twlrvyYeXnuf+6Iel39nDxRn1eOfesnHmZw1vJlY8c7g34X/ah/eIeLt50nauI0oum30M7TqbUu4rdEeovwVNPZEy4rG1KRMV0TdwzX9AZvOsrs/G3DnH/YRfaqHw6NyXipXMO0h97Z8LmKAiDYY4B8Wj1///aNQEtqCiXR2fW3Wfb2k5319eEEMKXcvo081fuVWgFl9CGgRe3Yf826FhNQyxIvCB39Hx73DO9/JI7ZJf/Q4+soRIafEl52Qr1QXejhlzw7jrMScaO2zh/EfTRwzMb0pFXjh6dRwsE8F7uPNveK7dN2AnMR+KvbvhFlr4snFPaK0eE9PzwptBKkazY4qufOxcnaJmo8cb8XdB/NkqoVBR3EnRTaGVYX7iYb+5zv+hzVt9e3W8a010dKps7DQTPQ98XO9OEIvZeTUpl7AwP/7uge0qooCyNBujTkJj3tZzh1jSBlOkmaWosaLkY7r3L/Guh7xTOBWjMxsLSurWba7uFwFfQ2D2AKCgkGbTukI3yKvQdYOdh0Cuhd5z37wdBr/eS8H7jzKDCt2Usy3h5OEI0xkERCyO1xoUOeklQGmRO9nvMg6D3VEN/dbfn3sMLqIwsSFnuuAV9tdRXytgrSM0eYG+ofGtDpzb0l3EAL/0u0epZbXLuvWqoKdqWcdDpudB/jsvmDCSRGL177iWeol8aXN4hD6B3DcLGR9V0L/TpqjF3wOgA2hILLpXOfkCWqn2Sew8roFKbIrNe6Ea+hLs6VctXGC1K59To5Ms4ldE98XoP+guw9s0boctOiAZkjbvZ5NsyadieDc8L5GLK5lbG6eOjLOj0vT5v30zoQHsUIC7r5RF77YXOmzey1dBbdOmTV//491+Xe08pm9PiwjTc0jfPL50IGLwq7+SF1MPiJvQBMm1NR7R7J+dAZ4zOv54GvVYRo6sRFwYhsj1LN4qTWj5ctrN09KdjhBajNFryeECbgK5FL89LBPPjiGRdvAX0Xr7H3w704u59+o+BWNjjoNcitsuT5q68lm46Q1RGSbrDliCLjhEgRqnMXSHZ/O6gXXwRN+9ir23oGL4NDvTxHzMFchjRHaA/hF4/2b2n1Uqi1ihX25ZOB+z7MItHo1jw57zdMeI9SY2P54XRhyfTQlx+IC8FqVfcAepLAmwb+pyq0d69p5nQ8cBq7Td5IPRQ6bEt8GJt8R+9+Fk82vSKmM5PHSMs6OOHOugEIbWO5RzUkVzqkpHl/xag95igcaCb5IzJ2IyhfT703nj34YHQU6lrrdGFyKz6dIYwoVszdQdYdoxQDnR9fUjFNXcjW5A7vkOttIv9B9339IcF3U7DvsYIPxt61SDuvumeCD1GcG69irbgvmnpw1bHCNfSW4cUtAJTZapsRuyLZeW6rg/W0ptW5UPvmzYlDXsV9LqOpm6j4JbWqPp0hpi7vEydIBYdI5Q7pjuzOlfGMi9voyjdTGvurqOXgE5b8/hQ6Fwmb3b4QEJxYTd6V6adV7vRMWLuEDHO40zbiMG5qyhy5yrb4GEdpo7gjo3oZJvt3t9Jln5u7j1Hbo5sOlJJxTwfNzMyoDye4OuOEWoK75H9PE8ny2iRimmewJPX45ikxDe2+Tx89maHF6R44YI8aZUtR27Oc/FR5/FQc3KzY4Q3FctsGctki2dUkDqcewnoJj591w9170kig76ruyVMZB+ejhE7VLWMpeA56+8gSEfqOsre89w7r6F2pH5iciZXbs4D3isuvNMxwoZO1txBc4ZnbJkYse/6zcLQx1AmZZ3tWugj9XIrHsSIC6+j7v2OERP0TarclbGM3wrL9ow9hntQckZAozJBng29jqiSCSqiEJZxRt81nu+1dWvjqYMc3UGUVHJbUwXcu/bR0CM0BkNLoHmKuPB+wKaojhrSDB6wB6Sriq2nw1/4aOgR1CNKoJPEhQ84on6pYMLM4aNyNyCkWGdyD4bes+0aOZyiDluvLoceLjbH497Xmv0i4nYiIdEibLVXlsUH/tvhHgzLT2evssHC8Ub8Dn3ZhJy6bjqvroceTJ3Evw86JYIdzeHjRmmQsRRsytIHz+U4WyTkY7mHZeRgPN+csS06MDqvboAeWjWXliMxglSqGHTDnX30SwOHeBVq7Nvcw3Lv3sjd9Fo1eVr31R3QR+on1KytIalS0KulnGEgdVCxiFiITHHv3ryM21XZfXUL9Jqy6uTDQOKx8/SD77S4hwzx2COmTuOeWQ27Bx1VWK9Lv8cUyJLMQM+FVGb84I5uLSFB2OMKD0z/dFG0f/oKumCXQw+qmsuGXu2LCycurHDwIbNSHjn+l4LkaJxJAPJcSbHnufcg6rxMoMe94sIZWoNGznC6e/a1Tlg0djD4TPduQjf53nh1F/SAqrkSlv6BJFcylplVUs404aDGUlAZS73OhP60Kdtk6+ISS18bZ7ENrGaaMM0SwOCJdx2GqdOgV4qTzeTMC9IxiHp+dS/0mtEz5ul73MeREo2z5DebqIFbzoNsfy4sNZsCHVYV11XQkHiFinht39Orm6EnFMgWgYSaNyUTBQLAW4JpHoMHpdmTLF2IWtUPXnDJKpAtxV2LzJKy4D/ciWeIFzHJmrgxvf75Fuh1lnJsMjNAcp6M5d56LI/I0QUuuOhJvagfvbQaXjUXucqWaJxFwbsKiVupGy6kKAh92rcjhy+CvkednAx9/At4tIxlEHhH7X6Jngcae+C2Jg7NYjn5JkvfS8MfQK1zoRsW6hTuKJFI5uSN+66krAz0aYfLw2vkNlbX1dWWvnK6ETKWMaMHdWQsLYtXIoB6mKWnQb8h8b4skOV+6Gqvfj3NCsdvJH7jrMqGdrbavV2AsdrzuE6/By24vLoUFRp5O/T9qrni0EGciFS29pAFCQWpivai0DKW1G4nZnZIj7dYHnRdzGX65XxVIHdAvbyla/cOm9c3x48VpCLgbRnL2eABO8lw733zgd59HfQ96tamRLMNvZ/3J1coN9m1eAqUJkB6Bne2WB/VP9074kQKBSlGg5/3NC4gsXPkS6VTgIFFvOSsBZfHQ9+WkDVjOjXbjxvUh+qGGTpsT6dQDDoovfFXok5NV80f/fy08z2T9hDcIyBIsrEZxitjmcF9IWOJEhg7W10PoVefVZb++9y7p1SSa0uXuLW87UEosMcnE/TeiImhahhw1XvUh/mjn592nhmdArLSKVhCEoW5V5q7XUoAOTqV6N5hIUXH7y/5hdA3qRtLn1UkqsqF3gJm7M+nPzUJUQzTR9+WBoX9bIIOhg7aQ/5NzZvypfng6UchcTR4zzpMGPRefi/0Lep8jt4RFor0THph+lTfaGmlSXCiI9qYp49W9khgPSMr7aHd4ViWBk/l+hB/EPpGreRnng6wwCzFa7Z0oxsEXdMmlanGQB+mjwZAb0OHY9s486YO8E0bVe4r7n8B+lpMlDiWjn4bSCqEC2N0T7UaqBaG/Fj6/NED6Ptj+gq8nsOrnBAeZXMIhG4/i191jdyhScxfgr5ZK+lYOkxKx1mX1sbXNk8Zs8fp2dL1R4UXuk976LA+yidjGUAcmB66u/mu+CPQNyVkrTEdOPVUz7I7DM5xTKeiUssxffqoFzpqD/nm6SHcVVzsJrZGbV9Bkeb+N6D/LApkz15aTa+P3JCxPAAuoy4zjvvsGLp1DF+We3fKoq0recF6es4iWgD3qUVNQlgrRu6HuXfrGL5rlW05ptHJd160np6RU9cas8pHXAtZp12IsFU2y01+65iuVSWNeqc60dJJAUuvpkUTI2O5lb7XYXpyhPPLc+829ClYOtQHJLeZ+MKkjdaotVBH5e4C2n/oW9An7pyfsZGdFN9GMbknosySfI6J/2HolRHzE4J/AXS8TTE3QFmha/FHoRvwOME4A3ph9jA3Y+WuxR+GXvn1wkhmIFfY4Lksey3/JnTiBEtr7vfO05M3MfyHvgd9WydOPCAjt0bOZPEL+d/S51jJ0vzOZlYsUBC+tg7/oWdaugVez+H5Q6L3yC3I/6FHWrrFnQnGnwAd9jOcksc+EboUz8q9B19rmq75XRI6k4yccSGyJcUOoZPvg66NzK8Xds08XVB6zrU7FzoVpkjr+6CTaqneGQc92+BTpMIeMqZb1XnfMqa7gR5P4F7A0lm5jOut0G/nHhK9b73vivldMbSrk5FfCv1e7lGW7r6vAjS/i0FX7GzkV0O/EXyqpc8uN4x7ZiCnTsi/PQH6TdwzLH0R0vPzpmw8Qrz/26DfwT0K+t5Uzqv1ng2dM3lNPusu6JeD58V69Z2g+W3yb+yiHOad0C/lzgs2aKyETyAwfZ4uIvVdvxj6deST5un7y9zMLxsV3c6Dygsz1k+Afgn34tCrSSduA3ykpQe00/yqBZfHcI+asoUzQ72wNfe49mxHjXO/bsEl6vgyS/8M8ajEpJIsnSW0ZsiELuQj3Psx9xeFhoCPs/RFaBet+Q2Nti6fvz5kTN/jXsFw19O2fnW3z9MDQjse5dhvQP5M6Avwig6afN8ND5my7Rh8jOY3ttP7+Q99g3tFDetyln7aQWbN70PualfM869C1+C1TtMbR/XhKui5mx2gE8O+bBTI9t5WS/Zw6OPxozTsF23rqwK5AnXvRr3TA17diLwAdNRWmcQKGluwIhY6qPng8Rq/0DrfI/Q8Oz93yuYxeKV3FrON3VSS1fX3QodObGLqxPbTdIJzwetE6LKFRxD2sqFjI7o+z87jLL2kEoVaaX5zKdm9ZUSlOzBq6Yo06FS+taFTF7o+CZdueLqlb2ZltD7MxF1IcXfFYJleq83bgZ42pjddg7DxUTUdqHe9iyXtLpin76XijC4QiAjdvwekaP/08bH5jPDx0F/g38c7CKHLTohGO/wS3JOmbKQY9Jn7I0TwS0LvG62cOsySYjHp96bjzRsceauht/D8XSpJnwQ9Oqt6tNmBsntxY/90xkr2T/+p6p9PK20DPcLSh9fo35uOaPdOdqDHs0+ap6dC93dAFrdDZyIdum5rsYBuBXcp7n3oQV7/HQ49gntCINfCMRQd2p+xqTPZvVfYhtMEcsa2f5xwLgE6hm9DFPRQ8CN01Rqt1vnJxIgD3UG/RRC6eSQ58/QHWvoZUzY+oA94p0IfKQPsWOgh3DV0kyV1oY/nx1mDPkkc6AMpHMTT3wAdkzMvSM4A+L6hAl4NydB7TNAkQD8kj9C5dtYtd6AbF07gUcMm82Oiif9qS9dp2Dcx1o6C2elTtuHzRxL0Pe4InbTasgE6b8G4B3wyWTxZQC++P/13WPr5Cy6Fam8MdDBqPmjo6NNJ9TH78V01jwCnQGf/oV8JHqFX6N9bov61dyZajoJAFFVo1GjU/P/XNntwF8EtPuac6Yx2HOX6qAWxKoOVc/466BK6aTmUfjPoQ+4KeiJH8FxBz0ehq7R/mNKTBEq/AncFXXDlaqcudDu8F3Z4p1tt+jO890tDd8Fr6JywNuOKtbwDBo6cC90G9cl0dP+sOP360A13DT2vDHCr9FzDdEK2HvTF6B5KD1jssCN4A52qKM2FbvB9bHLGDdkSG91/JqP7Oyn9citcdmxMQ08UeRe6FLHW8zBOXxPdr/DeC/mt9BLQL7fCZa9GM6cOjo+TltjovuhG93bU/6zK6sOmn6H0Qjff18BMRfcauvL5V9p9eO8nQffknkxE97Sj9F5WP5mw+1D68cP7Wu60q3Qd3Rfd6L4DvWf3qwm7D6Wfp3S6AD7pKl1H90U3uney9EXP7ld0mNWH0k9WOl0QfF/pathOetG9acnQ7ifDBC+Ufg2lT4KnPaWr6L4zvAs9f8R8nfDS+ln9SehQ+hWUPs496Ss9qfK+0rnXLmVO9cAv7X4yndWH0i+l9E2RnM7d5Ubiyu4n01l9EbklUPqp3vto84vfE2eaRtv9ZDqrL7hXgH6e0mNwTzreu7b7BnoyktUXNwLBhMvllG64Jx5KN8O7NPkaunbkOll9+RVMuFzLphfd/RHWpw/aJWz6QTVcbuC9D6EXIdzHJ9u44mHTL630jT79jNLFKA/oV1f6Fu7Tix1kyg5x+h2U7uvST7uAMmMLpV/Vew+I5fDc+y3j9DDuWOHyW0pfxX1psQOUfh+b7j3Q47n3m3vv2wUPpf+O0pfBYy3bLyp9CTxWuPyo0se4n+a9ry988aQJFy+lb/bpz4rTPQpfPGmFC8uKXdu5SvcrfIE4PSr3xTdG7mjT1xe+QEYu1KZ323lvovB4IT6897jQO+zDlf5XZlq/dfbuWXHxLvRK7hHVTnwKXyBON028Du0tPogXoFadPbxXxXbZzYTKXzW/WemPvZtm6tEbb6Xzk5ICzssO9LzmZyLeknD8U7EAAAlvSURBVG3suFfhCyi9A13sKPvQS7ldlyoRn13otbojVj5646/0VBYterVZ6kKv1Vb706/wBZTuQhew26wHXQm9Nrg5bxd60ZE6pfNxvL/S3+VbeWn8Z142fLjhfPNSK9x88Ct8AaU70FNFlw/jFf9XI0pLVGKDFjdVspc7v9Drzi1C5/M3/koXlQ9er0JUPpBjfEXLTLwt20p+Q20beO8OdCLAih+SaypHc6qkbEdx8aEDvXXHd0rn0zcblM55C7YfCV3omnN2oTeAvj1OF9ouJW2moGsV29G9soN9a+y73Ngd3+fj+A1K5yP7h7N/KejSvDcW+h+ghyq9kWP6u7YjuCRsoDdz0EtlCrTSJwW/QekcslT2KPTLDe83y70rK/5WtlzadEVYaXxkeKda/qV6+znRRn9W8Cnxqz/zp1BrsVvoXUfOr8o4Vrj0oCsPfgz6tCNXfPdUq6AnPtwFZu65N68OdJuqEaO7Z5VxrHDpQS9kRNaFblIzUyGbsentGqUTYs5nvdJfovJBD7pIzjCZnNlSZRxxege6HMVHoU8lZwx09QVz5AWlrwcvMcvBvAOd/y3rKVTeky2I0wfQW+uzW+jWO1dpWFZ007CatmG+kLUnpHdaS0rv/hVhsgXe+6pWu+P22G5LfnmqJiXDM4sxwVYhZIs7nz6eXXcz8/LGIIRQf6XHIO9dZRxKX27lnNTVLVHqoJ162fQ43P2rjAdDz+vMKb8o7N7Wak2XnU9v56Q+OrW6wnuPB96/yngodDEn9YUuzB8z//71597nvr9F6dFM/O7Qa1EZ1UDv1mN88pMzW5V+DPcINv0LXVdeLZunK70IUPoB4KNC79ZYfqLSN3vvh3IPh55PQdf10+kNlR5f4t5K34e7WOlASITc+z2gH/Dce2yl7wBeQt8+4VLbUrr3GN7ZIdALGsum7yn4zcN7LlT8GnXksubuGTkaOrrTiEqPDz6qTb9yyHabOP0A8KHQC8rKN6MfhbpWD5G8EKfHV3pE7qHQ9SzzW+tbpGGb5A9x+j5KjwQe8+lxoe/gvcfnjidnDg3ZUhLxkgD9GnH6YUoP4o759F2UTo9Q+mbuUPouNp0epPRt4GHTb+i9h3LHCpdDkzOE7HiJWOHyNKWvBo8VLjfKvUcED5t+aHImJQddLqDfez49PnfE6Zd+cmYf7lD6ockZQg6/cCj95733Vdwxy/Y7cfpq7lD6A5TeBw+l3+zJmRjsofRDFzuk5BJ9AaXfeT79ctAvnHs/LTlzAaXvW87jwrNspy12IL8O/ZGVHeiFvXfY9Od67w+C/hMrXAAdSgd0xOmAjjgd0BGnP17pBZQOpce26fDe4b1D6U+I05+bkXvwCpfn5t4fucLl+rn3J024/NibKGDTEacDOuJ0QD9D6YjT4b0/SOkpudCfVFXXwnz6ztDJxVqWGu5Q+n7De3GtxiR3QpCRexB0xV2CP+shCij9pEZXcd8nZIPSO02VL5dvkZbl51uSyQ96u9gkK9MzUSRtbKd4F7H7xe+WUe5pugd4ihUujFEf6KmsKidfKi0Bk5TfA2Z7RiXzVBY6HNnJ2ZNS7eO+uq6Tq7ZM9D9j3KNP6S5Kf2zu3Q+6qUavipjzT6mtaW0KHZubYWKnrH7ZtLq8dWO3zJl4yX0I/t5vlzp3wsVzeH/rsqa1kacsXy63i09qsy13O9jJ/XL+T3EfpITJX1Rb5i0vY24shzj9cJvuQq/VuN18C5lb6BM7dUl7tU/6BqbI/ZK7JV6n1+GOOP0g770LXfh0rO5zbYqZndZ4t5xh9q6nzfkIE8XduHaI009Req2NtcPV2vRmfKey4HUqpF3zcX7GptNxA8+NneKO+fSzlC7S5TxEs1y/3vvMTuHbSe/9u8UHDfdy+H9A4htzKH2NTRfIKm6fmy/XVsfpozu/cbqoJZQ2Tpzud/Mp7lnqR3OV0mkE6PQK0PPaqZ+uazd9omXk6EB0c6Z6akz1Hq2ZiOU63BnzUjqduJhw6ISeD70V/vEX+ptRyugrXhrWhV6nzUHQqeQnTImJ4VdCn0/OxIDOLgC9bpJOBUb5cwI6XU6C0DmlayPd88wGNNgi9MGJDH+B6h9EpvtGoM9fDJ24mB50ujh400WlrzgGjW/Th9AnbDrz39Ad3oWDNvDGSbG4gfr+v/S7QXFnxO/c6cTF9KAPdL9iA12S/ooNkaGXptbyGuh0cQNbgdQf+uJdQLsEJfeMrb8YOQyMXcw50Nme0LnjTETSxDhy/UZuvIEI8CT0qCk54dyHLWZV5b/89fctpc3SXhMmeX5DepkNWfiG615MyjZCF6ltNZA70Ad3Adpt2hrouRgmXhPQ0YW/CX3UkaMfOQY06MKfhs59VJGR+cj66W2ZMlpb9x3tR6HrxOtbQv+TeW8wf8DwjgboaICOBuhovw69FM5dSGvLYL8wF49ShBzDPjAQcCBzjKCTcZ9c2Nqz9hjDno0EXUx9BzJ/Mx4RhlB/1VlT0IBj2AcGeHdRlm1KNrrHYGwjdffJha09a48x0rNxoLclCYRei6mbloRAV+nBdvuJmAcGVHK53nSgGMdwn1zY3LP2GCM9Gwd6+W7DoOdlcGovD4b+p1OOahqp3XpKqq+L5O87IbX1IGE9q+++Zh+bXou1RkHQee+IB9hDR4vqVYSZCEefmyeTnO/VYcACe9bcwYOejQFdaCIYujCjZRbkyeV1cJIwLnTe4a8g6GE9q6EPezYGdHHwYOjfcTVA6Q2lQUrPI0D/fq/ONk8864ME9WyuoQ97NgJ0lYoPHt7/QmdqtSkOunFiKr3ernP3RMKH90HPRoBemuWDYRILhh7IauDIZUGOXBhzdZDAnjVhxB7Qc8obv8TkFSSxT6hKoyk9KNwy0AMfNZAHKcJ61piIzw7Du+7xwOSMyGWk77A4Xdr07SfiPDAglj9vGjHMMXLxN//zCTqRgJ61xxjp2atAj5eG3X4e9oEBmYZtkpBjtHpkbsJOZHvPfo+xWxpWtPMfkbzgQ5qv1wWvC7NsD2yADuhogI4G6GiAjgboaICOBuhogI4G6GiAjgboaICOBuhogB7ezPPC5a++cwHQAR0N0J/U8lLVfQP0R0FX638qQH8O89w+IG7WGGSA/vtKNwtCyky9SxdKfwJ0jR7D+yOVDugPtOmA/iTvncJ7f9rwjjj9mY7c3xOKFgC6Y9Ofcq2A3lM6oAM6oKMBOhqgowE6GqCjATraie0fEYkLUflT2AQAAAAASUVORK5CYII=" alt="Eh-pH diagram for the Mn-O-H system." width="100%" /> <!--
<p class="caption marginnote">-->Eh-pH diagram for the Mn-O-H system.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code># Set decimal logarithm of activity of aqueous species,
# temperature and plot resolution
logact &lt;- -4
T &lt;- 100
res &lt;- 400
# Start with the aqueous species
basis(c(&quot;Mn+2&quot;, &quot;H2O&quot;, &quot;H+&quot;, &quot;e-&quot;))
iaq &lt;- retrieve(&quot;Mn&quot;, c(&quot;O&quot;, &quot;H&quot;), &quot;aq&quot;)
species(iaq, logact)
aaq &lt;- affinity(pH = c(4, 16, res), Eh = c(-1.5, 1.5, res), T = T)
# Show names for only the metastable species here
names &lt;- names(iaq)
names[!names(iaq) %in% c(&quot;MnOH+&quot;, &quot;MnO&quot;, &quot;HMnO2-&quot;)] &lt;- &quot;&quot;
diagram(aaq, lty = 2, col = &quot;#4169E188&quot;, names = names, col.names = 4)
# Overlay mineral stability fields
icr &lt;- retrieve(&quot;Mn&quot;, c(&quot;O&quot;, &quot;H&quot;), &quot;cr&quot;)
species(icr, add = TRUE)
# Supply the previous result from affinity() to use
# argument recall (for plotted variables and T)
acr &lt;- affinity(aaq)
diagram(acr, add = TRUE, bold = acr$species$state==&quot;cr&quot;, limit.water = FALSE)
# Add legend
legend &lt;- c(
  bquote(log * italic(a)[&quot;Mn(aq)&quot;] == .(logact)),
  bquote(italic(T) == .(T) ~ degree*C)
)
legend(&quot;topright&quot;, legend = as.expression(legend), bty = &quot;n&quot;)</code></pre>
<p>This introductory vignette shows examples for diagrams with a single metal. Other functions are available to make diagrams for multiple metals; see the vignette <a href="multi-metal.html"><span style="color:blue"><em>Diagrams with multiple metals</em></span></a> for more information.</p>
</div>
<div id="mosaic-diagrams" class="section level2">
<h2>Mosaic diagrams</h2>
<p>If sulfur is an element in the basis species, then we should consider that its speciation is sensitive to Eh and pH, as shown in a previous diagram. Mosaic diagrams account for speciation of the basis species and are useful for visualizing the stabilities of many types of minerals including oxides, sulfides, and carbonates. These diagrams are made by constructing individual diagrams for the possible basis species. The individual diagrams are then combined, each one contributing to the final diagram only in the range of stability of the corresponding basis species.</p>
<p>Let’s use <span style="color:green"><code>mosaic()</code></span> to make a diagram for aqueous species and minerals in the Cu-S-Cl-H<sub>2</sub>O system. To know what aqueous copper chloride complexes are available in the database, we can use a fuzzy search:</p>
<pre class="r"><code>info(&quot; CuCl&quot;)</code></pre>
<pre style="color:blue">## info.approx: &#39; CuCl&#39; is ambiguous; has approximate matches to 7 species:
</pre>
<pre style="color:blue">## [1] &quot;CuCl3-2&quot; &quot;CuCl+&quot;   &quot;CuCl2&quot;   &quot;CuCl3-&quot;  &quot;CuCl4-2&quot; &quot;CuCl&quot;    &quot;CuCl2-&quot;
</pre>
<p>Next we define the basis, and set the activities of the H<sub>2</sub>S and Cl<sup>-</sup> basis species. These represent the total activity of S and Cl in the system, which are distributed among the minerals and aqueous species. Aqueous copper chloride complexes and four minerals are added. Be sure to include <code>add = TRUE</code> in the second call to <span style="color:red"><code>species()</code></span>; otherwise, the minerals would simply replace the previously added aqueous species.</p>
<pre class="r"><code>basis(c(&quot;Cu&quot;, &quot;H2S&quot;, &quot;Cl-&quot;, &quot;H2O&quot;, &quot;H+&quot;, &quot;e-&quot;))
basis(&quot;H2S&quot;, -6)
basis(&quot;Cl-&quot;, -0.7)
species(c(&quot;CuCl&quot;, &quot;CuCl2-&quot;, &quot;CuCl3-2&quot;, &quot;CuCl+&quot;, &quot;CuCl2&quot;, &quot;CuCl3-&quot;, &quot;CuCl4-2&quot;))
species(c(&quot;chalcocite&quot;, &quot;tenorite&quot;, &quot;cuprite&quot;, &quot;copper&quot;), add = TRUE)</code></pre>
<p>Note that chalcocite (Cu<sub>2</sub>S) undergoes phase transitions. To get the temperatures of the phase transitions from <code>thermo()$OBIGT</code> (in Kelvin, regardless of the <span style="color:red"><code>T.units()</code></span>), we can use <span style="color:green"><code>info()</code></span>. We see that at 200 °C (473.15 K) the second phase is stable; this one is automatially used by CHNOSZ for this diagram.</p>
<pre class="r"><code>info(info(&quot;chalcocite&quot;, c(&quot;cr&quot;, &quot;cr2&quot;, &quot;cr3&quot;)))$T</code></pre>
<pre><code>## [1]  376  717 1400</code></pre>
<p>We use <span style="color:green"><code>mosaic()</code></span> to generate and combine diagrams for each candidate basis species (H<sub>2</sub>S, HS<sup>-</sup>, HSO<sub>4</sub><sup>-</sup>, or SO<sub>4</sub><sup>-2</sup>) as a function of Eh and pH. The key argument is <code>bases</code>, which identifies the candidate basis species, starting with the one in the current basis. The other arguments, like those of <span style="color:green"><code>affinity()</code></span>, specify the ranges of the variables; <code>res</code> indicates the grid resolution to use for each variable (the default is 256). The first call to <span style="color:green"><code>diagram()</code></span> plots the species of interest; the second adds the predominance fields of the basis species. We also use <span style="color:green"><code>water.lines()</code></span> to draw dashed blue lines at the water stability limits:</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Copper minerals and aqueous complexes with chloride, 200 °C." width="100%" /> <!--
<p class="caption marginnote">-->Copper minerals and aqueous complexes with chloride, 200 °C.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>T &lt;- 200
res &lt;- 200
bases &lt;- c(&quot;H2S&quot;, &quot;HS-&quot;, &quot;HSO4-&quot;, &quot;SO4-2&quot;)
m1 &lt;- mosaic(bases, pH = c(0, 12, res), Eh=c(-1.2, 0.75, res), T=T)
diagram(m1$A.species, lwd = 2)
diagram(m1$A.bases, add = TRUE, col = 4, col.names = 4, lty = 3,
        italic = TRUE)
water.lines(m1$A.species, col = &quot;blue1&quot;)</code></pre>
<p>The diagrams are combined according to the relative abundances of the different possible basis species listed in <code>bases</code> along with a term for the Gibbs energy of mixing (see <span style="color:blue"><code>?mosaic</code></span>). The smooth transitions between basis species can result in curved field boundaries, in this case around the chalcocite field. If we added the argument <code>blend = FALSE</code>, the diagrams would instead be assembled using the single predominant basis species at any point on the Eh-pH grid, and all of the line segments would be straight.</p>
<p>The reactions used to make this diagram are balanced on Cu, so that no Cu appears in reactions between any two other species (minerals or aqueous species). If <span style="color:green"><code>diagram()</code></span> is run with <code>balance = 1</code>, then the reactions are balanced on formula units. That is, one mole of the mineral formulas appears on each side of the reaction, with the possibility of Cu appearing as an additional species to conserve the elements. This may be problematic, as Cu would be be present in some reactions in Eh-pH space where it is not a stable phase. However, it is common in low-temperature aqueous geochemical calculations to “turn off” particular redox reactions that are not thought to attain equilibrium, so decoupling a species from equilibrium may be justified in some circumstances. Changing the balance to 1 results in the loss of the tenorite stability field and extension of chalcocite stability to lower pH, as shown in Figure 5a of <span class="citation">Caporuscio et al. (<label for="tufte-mn-16" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-16" class="margin-toggle">2017<span class="marginnote">Caporuscio FA, Palaich SEM, Cheshire MC, Jové Colón CF. 2017. Corrosion of copper and authigenic sulfide mineral growth in hydrothermal bentonite experiments. <em>Journal of Nuclear Materials</em> <strong>485</strong>: 137–146. doi: <a href="https://doi.org/10.1016/j.jnucmat.2016.12.036">10.1016/j.jnucmat.2016.12.036</a></span>)</span>.</p>
</div>
<div id="t-p-activity-transects" class="section level2">
<h2><em>T</em>, <em>P</em>, activity transects</h2>
<p>Above, we used evenly-spaced grids of chemical activities of basis species; the ranges of variables were given by two or three values (minimum, maximum, and optionally resolution). <span style="color:green"><code>affinity()</code></span> can also perform calculations along a transect, i.e. a particular path along one or more variables. A transect is calculated when there are four or more values assigned to the variable(s). Let’s use this feature to calculate affinities (negative Gibbs energies) of methanogenesis and biosynthetic reactions in a hydrothermal system.</p>
<p>Some results of mixing calculations for seawater and vent fluid from the Rainbow hydrothermal field, calculated using EQ3/6 by <span class="citation">Shock and Canovas (<label for="tufte-mn-17" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-17" class="margin-toggle">2010<span class="marginnote">Shock E, Canovas P. 2010. The potential for abiotic organic synthesis and biosynthesis at seafloor hydrothermal systems. <em>Geofluids</em> <strong>10</strong>(1-2): 161–192. doi: <a href="https://doi.org/10.1111/j.1468-8123.2010.00277.x">10.1111/j.1468-8123.2010.00277.x</a></span>)</span>, are included in a data file in CHNOSZ. Reading the file with R’s <code>read.csv()</code>, we set <code>check.names = FALSE</code> to preserve the <code>NH4+</code> column name (which is not a syntactically valid variable name):</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/cpetc/SC10_Rainbow.csv&quot;, package = &quot;CHNOSZ&quot;)
rb &lt;- read.csv(file, check.names = FALSE)</code></pre>
<p>We take a selection of the species from Shock and Canovas (2010) with activities equal to 10<sup>-6</sup>; aqueous CH<sub>4</sub> is assigned an activity of 10<sup>-3</sup>. We will write the synthesis reactions of organic species in terms of these basis species: <label for="tufte-mn-18" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-18" class="margin-toggle"><span class="marginnote"><span style="display: block;">The constant activity of CH<sub>4</sub> is a simplification of the calculation reported by Shock and Canovas (2010). The code here could be expanded to vary the activity of CH<sub>4</sub>.</span></span></p>
<pre class="r"><code>basis(c(&quot;CO2&quot;, &quot;H2&quot;, &quot;NH4+&quot;, &quot;H2O&quot;, &quot;H2S&quot;, &quot;H+&quot;))
species(&quot;CH4&quot;, -3)
species(c(&quot;adenine&quot;, &quot;cytosine&quot;, &quot;aspartic acid&quot;, &quot;deoxyribose&quot;,
          &quot;CH4&quot;, &quot;leucine&quot;, &quot;tryptophan&quot;, &quot;n-nonanoic acid&quot;), -6)</code></pre>
<p>Now we can calculate affinities along the transect of changing temperature and activities of five basis species. Each variable is given as a named argument; <code>NH4+</code> must be quoted. <label for="tufte-mn-19" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-19" class="margin-toggle"><span class="marginnote"><span style="display: block;">A shorter expression would use R’s <code>do.call()</code> to construct the function call: <code>do.call(</code><span style="color:green"><code>affinity</code></span><code>, as.list(rb))</code>.</span></span> <label for="tufte-mn-20" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-20" class="margin-toggle"><span class="marginnote"><span style="display: block;">The target of the conversion is <code>G</code>, or free energy, from <code>logK</code>. That conversion requires temperature in Kelvin, which is obtained by conversion from °C. We finish with a negation (affinity is negative Gibbs energy) and scaling from cal to kcal.</span></span> Using R’s <code>lapply()</code> to run <span style="color:green"><code>convert()</code></span> for each species, we convert the affinity from dimensionless values (<em>A</em>/(2.303<em>RT</em>)) to cal/mol, then kcal/mol.</p>
<pre class="r"><code>a &lt;- affinity(T = rb$T, CO2 = rb$CO2, H2 = rb$H2,
              `NH4+` = rb$`NH4+`, H2S = rb$H2S, pH = rb$pH)
T &lt;- convert(a$vals[[1]], &quot;K&quot;)
a$values &lt;- lapply(a$values, convert, &quot;G&quot;, T)
a$values &lt;- lapply(a$values, `*`, -0.001)</code></pre>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Affinities of organic synthesis in a hydrothermal system, after Shock and Canovas (2010)." width="100%" /> <!--
<p class="caption marginnote">-->Affinities of organic synthesis in a hydrothermal system, after Shock and Canovas (2010).<!--</p>--> <!--</div>--></span>
</p>
<p>Finally, we use <span style="color:green"><code>diagram()</code></span> to plot the results. Although only temperature is shown on the <em>x</em> axis, pH and the activities of CO<sub>2</sub>, H<sub>2</sub>, NH<sub>4</sub><sup>+</sup>, and H<sub>2</sub>S are also varied according to the data in <code>rb</code>. By default, <span style="color:green"><code>diagram()</code></span> attempts to scale the affinities by dividing by the reaction coefficients of a shared basis species (in this case, CO<sub>2</sub>). To override that behavior, we set <code>balance = 1</code> to plot the affinities of the formation reactions as written (per mole of the product species).</p>
<pre class="r"><code>diagram(a, balance = 1, ylim = c(-100, 100), ylab = axis.label(&quot;A&quot;, prefix=&quot;k&quot;),
        col = rainbow(8), lwd = 2, bg = &quot;slategray3&quot;)
abline(h = 0, lty = 2, lwd = 2)</code></pre>
<p>When making line plots, <span style="color:green"><code>diagram()</code></span> automatically places the labels near the lines. The additional arguments <code>adj</code> and <code>dy</code> can be used to fine-tune the positions of the labels (they are used in a couple of examples below). If labeling of the lines is not desired, add e.g. <code>legend.x = &quot;topright&quot;</code> to make a legend instead, or <code>names = FALSE</code> to prevent any plotting of the names.</p>
</div>
<div id="buffers" class="section level2">
<h2>Buffers</h2>
<p>There is one other feature of <span style="color:green"><code>affinity()</code></span> that can be mentioned here. Can we go the other direction: calculate the activities of basis species from the activities of the species of interest? This question relates to the concept of chemical activity buffers. In CHNOSZ there are two ways to perform buffer calculations:</p>
<ol style="list-style-type: decimal">
<li>Assign the name of a buffer (listed in <code>thermo()$buffer</code>) to the basis species:</li>
</ol>
<ul>
<li>more versatile (multiple activities can be buffered, e.g. both S<sub>2</sub> and O<sub>2</sub> by pyrite-pyrrhotite-magnetite);</li>
<li>the buffers are active in calculations of affinity of other species;</li>
<li>use <span style="color:red"><code>mod.buffer()</code></span> to change or add buffers in <code>thermo()$buffer</code>;</li>
<li><a href="../demo"><span style="color:blue"><code>demo(buffer)</code></span></a> uses it for mineral buffers (solid lines).</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Use the <code>type</code> argument of <span style="color:green"><code>diagram()</code></span> to solve for the activity of the indicated basis species:</li>
</ol>
<ul>
<li>more convenient (the buffers come from the currently defined species of interest), but only a single basis species can be buffered, and it’s not used in the calculation of affinity;</li>
<li><a href="../demo"><span style="color:blue"><code>demo(buffer)</code></span></a> uses it for aqueous organic species as buffers (dotted and dashed lines).</li>
</ul>
<p>As an example of method 1, let’s look at the pyrite-pyrrhotite-magnetite (PPM) buffer at 300 °C. <label for="tufte-mn-21" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-21" class="margin-toggle"><span class="marginnote"><span style="display: block;">For other examples, see <span style="color:blue"><code>?buffer</code></span> and <a href="../demo"><span style="color:blue"><code>demo(protbuff)</code></span></a> (hypothetical buffer made of proteins).</span></span> Without the buffer, the basis species have default activities of zero. Under these conditions, the minerals are not in equilibrium, as shown by their different affinities of formation:</p>
<pre class="r"><code>basis(c(&quot;FeS2&quot;, &quot;H2S&quot;, &quot;O2&quot;, &quot;H2O&quot;))
species(c(&quot;pyrite&quot;, &quot;magnetite&quot;))
species(&quot;pyrrhotite&quot;, &quot;cr2&quot;)</code></pre>
<p><label for="tufte-mn-22" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-22" class="margin-toggle"><span class="marginnote"><span style="display: block;">The affinity of formation of pyrite happens to be zero because it is identical to one of the selected basis species.</span></span></p>
<pre class="r"><code>unlist(affinity(T = 300, P = 100)$values)</code></pre>
<pre><code>##     1955 
## -20.6134</code></pre>
<p>We use <span style="color:red"><code>mod.buffer()</code></span> to choose the <code>cr2</code> phase of pyrrhotite, which is stable at this temperature (<a href="#mosaic-diagrams">see above</a> for how to get this information for minerals with phase transitions). Then, we set up H<sub>2</sub>S and O<sub>2</sub> to be buffered by PPM, and inspect their buffered activities:</p>
<pre class="r"><code>mod.buffer(&quot;PPM&quot;, &quot;pyrrhotite&quot;, &quot;cr2&quot;)</code></pre>
<pre style="color:blue">## mod.buffer: changed state and/or logact of pyrrhotite in PPM buffer
</pre>
<pre class="r"><code>basis(c(&quot;H2S&quot;, &quot;O2&quot;), c(&quot;PPM&quot;, &quot;PPM&quot;))</code></pre>
<pre class="r"><code>unlist(affinity(T = 300, P = 100, return.buffer = TRUE)[1:3])</code></pre>
<pre><code>##       H2S        O2      FeS2 
##  -2.36691 -36.49303   0.00000</code></pre>
<!-- put demo(buffer) here for appealing placement on page -->
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Values of log&lt;i&gt;f&lt;/i&gt;&lt;sub&gt;H&lt;sub&gt;2&lt;/sub&gt;&lt;/sub&gt; corresponding to mineral buffers or to given activities of aqueous species." width="100%" /> <!--
<p class="caption marginnote">-->Values of log<i>f</i><sub>H<sub>2</sub></sub> corresponding to mineral buffers or to given activities of aqueous species.<!--</p>--> <!--</div>--></span>
</p>
<p>Et voilà! We have found log<em>a</em><sub>H<sub>2</sub>S</sub> and log<i>f</i><sub>O<sub>2</sub></sub> that are compatible with the coexistence of the three minerals. Under these conditions, the affinities of formation reactions of the minerals in the buffer are all equal to zero: <!-- show static (commented) results because demo(buffer) changes the system --></p>
<pre class="r"><code>unlist(affinity(T = 300, P = 100)$values)
## 2031 1999 2036 
##    0    0    0</code></pre>
<p>Another example, based on Figure 6 of <span class="citation">Schulte and Shock (<label for="tufte-mn-23" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-23" class="margin-toggle">1995<span class="marginnote">Schulte MD, Shock EL. 1995. Thermodynamics of Strecker synthesis in hydrothermal systems. <em>Origins of Life and Evolution of the Biosphere</em> <strong>25</strong>(1-3): 161–173. doi: <a href="https://doi.org/10.1007/BF01581580">10.1007/BF01581580</a></span>)</span>, is given in <a href="../demo"><span style="color:blue"><code>demo(buffer)</code></span></a>. Here, values of log<em>f</em><sub>H<sub>2</sub></sub> buffered by minerals or set by equilibrium with given activities of aqueous species are calculated using the two methods:</p>
<pre class="r"><code>demo(buffer)</code></pre>
</div>
</div>
<div id="equilibration" class="section level1">
<h1>Equilibration</h1>
<p>Above we considered this kind of question: for equal activities of species, what are the affinities of their formation reactions from basis species? Turning the question around, we would like to know: for equal affinities, what are the activities of species? This is the question of equilibration.</p>
<p>Before presenting some examples, it is helpful to know about the limitations of the functions. CHNOSZ does not take account of all possible reactions in the speciation of a system. Instead, it assumes that the total activity of species in the system is set by the activity of <em>one</em> basis species. <label for="tufte-mn-24" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-24" class="margin-toggle"><span class="marginnote"><span style="display: block;">When activity coefficients are assumed to be zero, activities are equal to concentration and we can refer to “total activity”. If the ionic strength is specified, <span style="color:green"><code>nonideal()</code></span> (<a href="#activity-coefficients">see below</a>) can be used to calculate activity coefficients.</span></span> This balanced, or conserved, basis species must be present (with a positive or negative coefficient) in the formation reactions of all species considered.</p>
<p>For a given total activity of the balanced basis species, activities of the species can be found such that the affinities of the formation reactions are all equal. This is an example of metastable equilibrium. With additional constraints, the affinities of the formation reactions are not only equal to each other, but equal to zero. This is total equilibrium. An example of total equilibrium was given above for the PPM buffer. In contrast, models for systems of organic and biomolecules often involve metastable equilibrium constraints.</p>
<div id="getting-from-affinity-to-equilibrium" class="section level2">
<h2>Getting from affinity to equilibrium</h2>
<p>The <span style="color:green"><code>equilibrate()</code></span> function in CHNOSZ automatically chooses between two methods for calculating equilibrium. The method based on the Boltzmann equation is fast, but is applicable only to systems where the coefficient on the balanced basis species in each of the formation reactions is one. The reaction-matrix method is slower, but can be applied to systems were the balanced basis species has reaction coefficients other than one.</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Three views of carbonate speciation: affinity, activity, degree of formation." width="100%" /> <!--
<p class="caption marginnote">-->Three views of carbonate speciation: affinity, activity, degree of formation.<!--</p>--> <!--</div>--></span>
</p>
<p>The distribution of aqueous carbonate species as a function of pH (a type of Bjerrum plot) is a classic example of an equilibrium calculation. We can begin by plotting the affinities of formation, for equal activities of the species, calculated at 25 °C and 150 °C. Here, CO<sub>2</sub> is in the basis, so it has zero affinity, which is greater than the affinities of HCO<sub>3</sub><sup>-</sup> and CO<sub>3</sub><sup>-2</sup> at low pH. To avoid overplotting the lines, we offset the species labels in the <em>y</em> direction using the <code>dy</code> argument:</p>
<pre class="r"><code>par(mfrow = c(3, 1))
basis(&quot;CHNOS+&quot;)
species(c(&quot;CO2&quot;, &quot;HCO3-&quot;, &quot;CO3-2&quot;))
a25 &lt;- affinity(pH = c(4, 13))
a150 &lt;- affinity(pH = c(4, 13), T = 150)
diagram(a25, dy = 0.4)
diagram(a150, add = TRUE, names = FALSE, col = &quot;red&quot;)</code></pre>
<p>Now we use <span style="color:green"><code>equilibrate()</code></span> to calculate the activities of species. Our balancing constraint is that the total activity of C is 10<sup>-3</sup>. This shows a hypothetical metastable equilibrium; we know that for true equilibrium the total activity of C is affected by pH.</p>
<pre class="r"><code>e25 &lt;- equilibrate(a25, loga.balance = -3)
e150 &lt;- equilibrate(a150, loga.balance = -3)
diagram(e25, ylim = c(-6, 0), dy = 0.15)
diagram(e150, add = TRUE, names = FALSE, col = &quot;red&quot;)</code></pre>
<p>To display the species distribution, or degree of formation, add <code>alpha = TRUE</code> to the argument list:</p>
<pre class="r"><code>diagram(e25, alpha = TRUE, dy = -0.25)
diagram(e150, alpha = TRUE, add = TRUE, names = FALSE, col = &quot;red&quot;)</code></pre>
</div>
<div id="complete-equilibrium-solubility" class="section level2">
<h2>Complete equilibrium: Solubility</h2>
<p>It is important to remember that <span style="color:green"><code>equilibrate()</code></span> calculates an equilibrium distribution of species for a given total activity of the conserved basis species. For instance, the previous diagram shows the relative abundances of CO<sub>2</sub>, HCO<sub>3</sub><sup>-</sup>, and CO<sub>3</sub><sup>-2</sup> as a function of pH assuming that the possible reactions between species are all balanced on 1 C and the total activity of C is constant. Although this assumption of metastable equilibrium is useful for making many types of diagrams for aqueous species, the aqueous solutions would not be in equilibrium with other phases, including gases or solids such as carbon dioxide or calcite.</p>
<p>Moving away from metastable equilibrium to complete equilibrium actually involves a simplification of the computations. Instead of finding the activities of aqueous species where the affinities of formation reactions are equal to each other, equilibrium occurs when the affinities of all formation reactions are equal to zero. However, the solubility calculation comes with a different constraint: all reactions between the pure substance that is being dissolved and any of the possible formed aqueous species must be able to be balanced on the same element (usually the main metal in the system). This balancing constraint can be expressed as a conserved basis species, i.e. one that is present in non-zero quantity in the formation reactions of all species considered.</p>
<p>The <span style="color:green"><code>solubility()</code></span> function provides a way to compute activities of aqueous species in equilibrium with one or more minerals or gases. The following example for corundum (Al<sub>2</sub>O<sub>3</sub>) is based on Figure 15 of <span class="citation">Manning (<label for="tufte-mn-25" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-25" class="margin-toggle">2013<span class="marginnote">Manning CE. 2013. Thermodynamic modeling of fluid-rock interaction at mid-crustal to upper-mantle conditions. <em>Reviews in Mineralogy and Geochemistry</em> <strong>76</strong>(1): 135–164. doi: <a href="https://doi.org/10.2138/rmg.2013.76.5">10.2138/rmg.2013.76.5</a></span>)</span>. To more closely reproduce the diagram, we use superseded thermodynamic data that are kept in the <code>SLOP98</code> optional data file.</p>
<p>The basis species are defined with the main element (Al) first. The mineral we want to dissolve, corundum, is loaded as a formed species. The aqueous species that can form by dissolution of corundum are listed in the <code>iaq</code> argument of <span style="color:green"><code>solubility()</code></span>. The next arguments describe the variables for the <span style="color:green"><code>affinity()</code></span> calculations. Note that setting <code>IS</code> to 0 has no effect on the calculations, but signals <span style="color:green"><code>diagram()</code></span> to label the <em>y</em> axis with logarithm of molality instead of logarithm of activity. An additional argument, <code>in.terms.of</code>, is used to compute the total molality of Al in solution, that is, twice the number of moles of Al<sub>2</sub>O<sub>3</sub> that are dissolved.</p>
<p><span style="color:green"><code>diagram()</code></span> is used twice, first to plot the total molality of Al, then the concentrations of the individual species, using <code>adj</code> and <code>dy</code> to adjust the positions of labels in the <em>x</em>- and <em>y</em>-directions. At the end of the calculation, we use <span style="color:red"><code>reset()</code></span> to restore the default thermodynamic database.</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Solubility of corundum (green line) and equilibrium concentrations of aqueous species (black lines)." width="100%" /> <!--
<p class="caption marginnote">-->Solubility of corundum (green line) and equilibrium concentrations of aqueous species (black lines).<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>add.OBIGT(&quot;SLOP98&quot;)
basis(c(&quot;Al+3&quot;, &quot;H2O&quot;, &quot;H+&quot;, &quot;O2&quot;))
species(&quot;corundum&quot;)
iaq &lt;- c(&quot;Al+3&quot;, &quot;AlO2-&quot;, &quot;AlOH+2&quot;, &quot;AlO+&quot;, &quot;HAlO2&quot;)
s &lt;- solubility(iaq, pH = c(0, 10), IS = 0, in.terms.of = &quot;Al+3&quot;)
diagram(s, type = &quot;loga.balance&quot;, ylim = c(-10, 0), lwd = 4, col = &quot;green3&quot;)
diagram(s, add = TRUE, adj = c(0, 1, 2.1, -0.2, -1.5), dy = c(0, 0, 4, -0.3, 0.1))
legend(&quot;topright&quot;, c(&quot;25 °C&quot;, &quot;1 bar&quot;), text.font = 2, bty = &quot;n&quot;)</code></pre>
<pre class="r"><code>reset()</code></pre>
<p>Other examples of using <span style="color:green"><code>solubility()</code></span> are available in CHNOSZ. See <a href="../demo"><span style="color:blue"><code>demo(solubility)</code></span></a> for calculations of the solubility of CO<sub>2(<i>gas</i>)</sub> and calcite as a function of pH and temperature. The calculation considers the stoichiometric dissolution of calcite, in which CaCO<sub>3</sub> dissociates to form equal quantities of Ca<sup>+2</sup> and CO<sub>3</sub><sup>-2</sup> ions. Adding in activity coefficients, an example in <span style="color:blue"><code>?solubility</code></span> uses the <code>find.IS</code> option to find the final ionic strength for dissolving calcite into pure water. <a href="../demo"><span style="color:blue"><code>demo(gold)</code></span></a> shows calculations of the solubility of gold as a function of pH and <em>T</em> as well as oxygen fugacity set by diferent mineral buffers, and considers ionic strength effects on activity coefficients, so that activities are transformed to molalities (<a href="#transformation-of-variables">see below</a>).</p>
</div>
</div>
<div id="activity-coefficients" class="section level1">
<h1>Activity coefficients</h1>
<p>For calculating activity coefficients of charged species, <span style="color:green"><code>nonideal()</code></span> uses the extended Debye–Hückel equation as parameterized by <span class="citation">Helgeson et al. (<label for="tufte-mn-26" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-26" class="margin-toggle">1981<span class="marginnote">Helgeson HC, Kirkham DH, Flowers GC. 1981. Theoretical prediction of the thermodynamic behavior of aqueous electrolytes at high pressures and temperatures: IV. Calculation of activity coefficients, osmotic coefficients, and apparent molal and standard and relative partial molal properties to 600°C and 5 Kb. <em>American Journal of Science</em> <strong>281</strong>(10): 1249–1516. doi: <a href="https://doi.org/10.2475/ajs.281.10.1249">10.2475/ajs.281.10.1249</a></span>)</span> for NaCl-dominated solutions to high pressure and temperature, or optionally using parameters described in Chapter 3 of <span class="citation">Alberty (<label for="tufte-mn-27" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-27" class="margin-toggle">2003<span class="marginnote">Alberty RA. 2003. <em>Thermodynamics of Biochemical Reactions</em>. Hoboken, New Jersey: Wiley-Interscience. Available at <a href="https://www.worldcat.org/oclc/51242181">https://www.worldcat.org/oclc/51242181</a>. </span>)</span>, which are applicable to relatively low-temperature biochemical reactions. The activity coefficients are calculated as a function of ionic strength (<em>I</em>), temperature, and charge of each species, without any other species-specific parameters. Using the default <code>Helgeson</code> method, the extended term parameter (“B-dot”) is derived from data of <span class="citation">Helgeson (<label for="tufte-mn-28" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-28" class="margin-toggle">1969<span class="marginnote">Helgeson HC. 1969. Thermodynamics of hydrothermal systems at elevated temperatures and pressures. <em>American Journal of Science</em> <strong>267</strong>(7): 729–804. doi: <a href="https://doi.org/10.2475/ajs.267.7.729">10.2475/ajs.267.7.729</a></span>)</span> and Helgeson et al. (1981), and extrapolations of <span class="citation">Manning et al. (<label for="tufte-mn-29" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-29" class="margin-toggle">2013<span class="marginnote">Manning CE, Shock EL, Sverjensky DA. 2013. The chemistry of carbon in aqueous fluids at crustal and upper-mantle conditions: Experimental and theoretical constraints. <em>Reviews in Mineralogy and Geochemistry</em> <strong>75</strong>(1): 109–148. doi: <a href="https://doi.org/10.2138/rmg.2013.75.5">10.2138/rmg.2013.75.5</a></span>)</span>.</p>
<div id="transformation-of-variables" class="section level2">
<h2>Transformation of variables</h2>
<p>Following the main workflow of CHNOSZ, <span style="color:green"><code>nonideal()</code></span> normally does not need to be used directly. Intead, invoke the calculations by setting the <code>IS</code> argument in <span style="color:green"><code>subcrt()</code></span> or <span style="color:green"><code>affinity()</code></span>. There are a few things to remember when using activity coefficients:</p>
<ul>
<li><p>H<sup>+</sup> is assumed to behave ideally, so its activity coefficient is 1 for any ionic strength. You can calculate activity coefficients of H<sup>+</sup> by running <code>thermo(&quot;opt$ideal.H&quot; = FALSE)</code>.</p></li>
<li><p>Using <span style="color:green"><code>subcrt()</code></span> with <code>IS</code> not equal to zero, calculated values of <code>G</code> are the <strong>adjusted</strong> Gibbs energy at specified ionic strength <span class="citation">(denoted by Δ<em>G</em>°(<em>I</em>); Alberty, <label for="tufte-mn-30" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-30" class="margin-toggle">1996<span class="marginnote">Alberty RA. 1996. Recommendations for nomenclature and tables in biochemical thermodynamics. <em>European Journal of Biochemistry</em> <strong>240</strong>(1): 1–14. Blackwell Science Ltd. doi: <a href="https://doi.org/10.1111/j.1432-1033.1996.0001h.x">10.1111/j.1432-1033.1996.0001h.x</a></span>)</span>.</p></li>
<li><p>Using <span style="color:green"><code>subcrt()</code></span> with <code>IS</code> not equal to zero, values in the <code>logact</code> argument stand for <strong>log molality</strong> of aqueous species in affinity calculations.</p></li>
<li><p>Using <span style="color:green"><code>affinity()</code></span> with <code>IS</code> not equal to zero, the following values stand for <strong>log molality</strong> of aqueous species:</p>
<ul>
<li>values of <code>logact</code> set by <span style="color:green"><code>basis()</code></span>;</li>
<li>values of <code>logact</code> set by <span style="color:green"><code>species()</code></span>.</li>
</ul></li>
<li><p>Using <span style="color:green"><code>equilibrate()</code></span> on the output of affinity calculated with <code>IS</code> not equal to zero, the following values stand for <strong>log molality</strong> of aqueous species:</p>
<ul>
<li>the value of <code>loga.balance</code> used by <span style="color:green"><code>equilibrate()</code></span> (i.e., logarithm of total molality of the balancing basis species);</li>
<li>values of <code>loga.equil</code> returned by <span style="color:green"><code>equilibrate()</code></span>.</li>
</ul></li>
</ul>
<p>In other words, the activation of activity coefficients effects a transformation from activity to molality in the main workflow. A simple but comprehensive series of calculations demonstrating these tranformations is in <code>tests/testthat/test-logmolality.R</code>.</p>
<p>Because it is not possible to dynamically change the names of arguments in the functions, the user should be aware of the transformations mentioned above. However, the labels on diagrams <em>can</em> be automatically adjusted; accordingly, activities of aqueous species are relabeled as molalities by <span style="color:green"><code>diagram()</code></span> when <code>IS</code> is used in the calculation of <span style="color:green"><code>affinity()</code></span>.</p>
</div>
<div id="biochemical-example" class="section level2">
<h2>Biochemical example</h2>
<p>For the following calculations, we change the nonideality method to <code>Alberty</code>; this is a simpler formulation with parameters that are suitable for biochemical species at relatively low temperatures:</p>
<pre class="r"><code>oldnon &lt;- nonideal(&quot;Alberty&quot;)</code></pre>
<pre style="color:blue">## nonideal: setting nonideal option to use Alberty equation
</pre>
<p>Let’s take a look at calculated activity coefficients at two temperatures and their effect on the standard Gibbs energies of formation (Δ<em>G</em>°<sub><em>f</em></sub>) of species with different charge:</p>
<pre class="r"><code>subcrt(c(&quot;MgATP-2&quot;, &quot;MgHATP-&quot;, &quot;MgH2ATP&quot;),
       T = c(25, 100), IS = c(0, 0.25), property = &quot;G&quot;)$out</code></pre>
<pre style="color:blue">## subcrt: 3 species at 2 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre style="color:blue">## nonideal: calculations for MgC10H12N5O13P3-2, MgC10H13N5O13P3- (Alberty equation)
</pre>
<pre style="color:blue">## nonideal: calculations for MgC10H14N5O13P3 (Setchenow equation)
</pre>
<pre><code>## $`MgATP-2`
##     T       P       G    loggam   IS
## 1  25 1.00000 -773609  0.000000 0.00
## 2 100 1.01322 -780427 -0.662587 0.25
## 
## $`MgHATP-`
##     T       P       G    loggam   IS
## 1  25 1.00000 -780994  0.000000 0.00
## 2 100 1.01322 -789620 -0.165647 0.25
## 
## $MgH2ATP
##     T       P       G      loggam   IS
## 1  25 1.00000 -786200  0.00000000 0.00
## 2 100 1.01322 -795015 -0.00195159 0.25</code></pre>
<p>The logarithms of the activity coefficients (<code>loggam</code>) are more negative for the higher-charged species, as well as at higher temperature, and have a stabilizing effect. That is, the adjusted Gibbs energies at <em>I</em> &gt; 0 are less than the standard Gibbs energies at <em>I</em> = 0.</p>
<p>We can use these calculations to make some speciation plots, similar to Figures 1.2–1.5 in Alberty (2003). These figures show the distribution of differently charged species of adenosine triphosphate (ATP) as a function of pH, and the average number of H<sup>+</sup> and Mg<sup>+2</sup> bound to ATP in solution as a function of pH or pMg (-log<em>a</em><sub>Mg<sup>+2</sup></sub>).</p>
<p>Use <span style="color:green"><code>info()</code></span> to see what ATP species are available. The sources of high-temperature thermodynamic data for these species are two papers by LaRowe and Helgeson <span class="citation">(<label for="tufte-mn-31" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-31" class="margin-toggle">2006a<span class="marginnote">LaRowe DE, Helgeson HC. 2006a. Biomolecules in hydrothermal systems: Calculation of the standard molal thermodynamic properties of nucleic-acid bases, nucleosides, and nucleotides at elevated temperatures and pressures. <em>Geochimica et Cosmochimica Acta</em> <strong>70</strong>(18): 4680–4724. doi: <a href="https://doi.org/10.1016/j.gca.2006.04.010">10.1016/j.gca.2006.04.010</a></span>; <label for="tufte-mn-32" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-32" class="margin-toggle">2006b<span class="marginnote">LaRowe DE, Helgeson HC. 2006b. The energetics of metabolism in hydrothermal systems: Calculation of the standard molal thermodynamic properties of magnesium-complexed adenosine nucleotides and NAD and NADP at elevated temperatures and pressures. <em>Thermochimica Acta</em> <strong>448</strong>(2): 82–106. doi: <a href="https://doi.org/10.1016/j.tca.2006.06.008">10.1016/j.tca.2006.06.008</a></span>)</span>.</p>
<pre class="r"><code>info(&quot; ATP&quot;)</code></pre>
<pre style="color:blue">## info.approx: &#39; ATP&#39; is ambiguous; has approximate matches to 14 species:
</pre>
<pre style="color:blue">##  [1] &quot;ATP-4&quot;    &quot;HATP-3&quot;   &quot;H2ATP-2&quot;  &quot;H3ATP-&quot;   &quot;H4ATP&quot;    &quot;dATP-4&quot;  
##  [7] &quot;dHATP-3&quot;  &quot;dH2ATP-2&quot; &quot;dH3ATP-&quot;  &quot;dH4ATP&quot;   &quot;MgATP-2&quot;  &quot;MgHATP-&quot; 
## [13] &quot;MgH2ATP&quot;  &quot;Mg2ATP&quot;
</pre>
<p>The plots for this system in Alberty’s book were made for <em>I</em> = 0.25 M and <em>T</em> = 25 °C. As a demonstration of CHNOSZ’s capabilities, we can assign a temperature of 100 °C.</p>
<pre class="r"><code>T &lt;- 100</code></pre>
<p>Use the following commands to set the basis species, add the variously protonated ATP species, calculate the affinities of the formation reactions, equilibrate the system, and make a degree of formation (α) or mole fraction diagram. This is similar to Figure 1.3 of Alberty (2003), but is calculated for <em>I</em> = 0 M and <em>T</em> = 100 °C: <label for="tufte-mn-33" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-33" class="margin-toggle"><span class="marginnote"><span style="display: block;">To make the code more readable, commands for plotting titles and legends are not shown. All of the commands are available in the source of this document.</span></span></p>
<pre class="r"><code>basis(&quot;MgCHNOPS+&quot;)
species(c(&quot;ATP-4&quot;, &quot;HATP-3&quot;, &quot;H2ATP-2&quot;, &quot;H3ATP-&quot;, &quot;H4ATP&quot;))
a &lt;- affinity(pH = c(3, 9), T = T)
e &lt;- equilibrate(a)
d &lt;- diagram(e, alpha = TRUE, tplot = FALSE)</code></pre>
<p>Note that we have saved the numeric results of <span style="color:green"><code>diagram()</code></span>, i.e. the degrees of formation of the species (α). With that, we can calculate and plot the average number of protons bound per ATP molecule. To do so, we use R’s <code>rbind()</code> and <code>do.call()</code> to turn <code>alpha</code> into a matrix, then multiply by the number of protons bound to each species, and sum the columns to get the total (i.e. average proton number, <em>N</em><sub>H<sup>+</sup></sub>):</p>
<pre class="r"><code>alphas &lt;- do.call(rbind, d$plotvals)
nH &lt;- alphas * 0:4
Hlab &lt;- substitute(italic(N)[H^`+`])
plot(a$vals[[1]], colSums(nH), type = &quot;l&quot;, xlab = &quot;pH&quot;, ylab=Hlab, lty=2, col=2)</code></pre>
<p>Adding the <code>IS</code> argument to <span style="color:green"><code>affinity()</code></span>, we can now plot <em>N</em><sub>H<sup>+</sup></sub> at the given ionic strength. Here we set <code>plot.it = FALSE</code> in <span style="color:green"><code>diagram()</code></span> because we use the computed α to make our own plot. This is similar to Figure 1.3 of Alberty (2003), but at higher temperature:</p>
<pre class="r"><code>a &lt;- affinity(pH = c(3, 9), IS = 0.25, T = T)
e &lt;- equilibrate(a)
d &lt;- diagram(e, alpha = TRUE, plot.it = FALSE)
alphas &lt;- do.call(rbind, d$plotvals)
nH &lt;- alphas * 0:4
lines(a$vals[[1]], colSums(nH))</code></pre>
<p>Next, we add the Mg<sup>+2</sup>-complexed ATP species:</p>
<pre class="r"><code>species(c(&quot;MgATP-2&quot;, &quot;MgHATP-&quot;, &quot;MgH2ATP&quot;, &quot;Mg2ATP&quot;), add = TRUE)</code></pre>
<p>Here is a function to calculate and plot <em>N</em><sub>H<sup>+</sup></sub> for a given pMg:</p>
<pre class="r"><code>Hplot &lt;- function(pMg, IS = 0.25) {
  basis(&quot;Mg+2&quot;, -pMg)
  a &lt;- affinity(pH = c(3, 9), IS = IS, T = T)
  e &lt;- equilibrate(a)
  d &lt;- diagram(e, alpha = TRUE, plot.it = FALSE)
  alphas &lt;- do.call(rbind, d$plotvals)
  NH &lt;- alphas * c(0:4, 0, 1, 2, 0)
  lines(a$vals[[1]], colSums(NH), lty = 7 - pMg, col = 7 - pMg)
}</code></pre>
<p>With that function in hand, we plot the lines corresponding to pMg = 2 to 6. This is similar to Figure 1.4 of Alberty (2003):</p>
<pre class="r"><code>plot(c(3, 9), c(0, 2), type = &quot;n&quot;, xlab = &quot;pH&quot;, ylab = Hlab)
lapply(2:6, Hplot)</code></pre>
<p>The next function calculates and plots the average number of Mg<sup>+2</sup> bound to ATP (<em>N</em><sub>Mg<sup>+2</sup></sub>) for a given pH. Here we multiply <code>alpha</code> by the number of Mg<sup>+2</sup> in each species, and negate log<em>a</em><sub>Mg<sup>+2</sup></sub> (the variable used in <span style="color:green"><code>affinity()</code></span>) to get pMg:</p>
<pre class="r"><code>Mgplot &lt;- function(pH, IS = 0.25) {
  basis(&quot;pH&quot;, pH)
  a &lt;- affinity(`Mg+2` = c(-2, -7), IS = IS, T = T)
  e &lt;- equilibrate(a)
  d &lt;- diagram(e, alpha = TRUE, plot.it = FALSE)
  alphas &lt;- do.call(rbind, d$plotvals)
  NMg &lt;- alphas * species()$`Mg+`
  lines(-a$vals[[1]], colSums(NMg), lty = 10 - pH, col = 10 - pH)
}</code></pre>
<p>Using that function, we plot the lines corresponding to pH = 3 to 9. This is similar to Figure 1.5 of Alberty (2003):</p>
<pre class="r"><code>Mglab &lt;- substitute(italic(N)[Mg^`+2`])
plot(c(2, 7), c(0, 1.2), type = &quot;n&quot;, xlab = &quot;pMg&quot;, ylab = Mglab)
lapply(3:9, Mgplot)</code></pre>
<p>
<div class="figure fullwidth">
<img src="data:image/png;base64,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" alt="Binding of H&lt;sup&gt;+&lt;/sup&gt; and Mg&lt;sup&gt;+2&lt;/sup&gt; to ATP at 100 °C and *I* = 0 M (first plot) or *I* = 0.25 M (third and fourth plots)." width="100%" />
<p class="caption marginnote shownote">
Binding of H<sup>+</sup> and Mg<sup>+2</sup> to ATP at 100 °C and <em>I</em> = 0 M (first plot) or <em>I</em> = 0.25 M (third and fourth plots).
</p>
</div>
</p>
<p>We have calculated the distribution of ATP species and average binding number of H<sup>+</sup> and Mg<sup>+2</sup> for given pH, pMg, ionic strength, and temperature. Accounting for the distribution of chemical species lends itself to thermodynamic models for reactions between reactants that have multiple ionized and complexed states. In contrast, Alberty (2003) and others propose models for biochemical reactions where the ionized and complexed species are combined into a single representation. Those models invoke Legendre-transformed thermodynamic properties, such as transformed Gibbs energies that are tabulated for specified pH, pMg, and ionic strength. Although the conceptual pathways are different, the two approaches lead to equivalent results concerning the energetics of the overall reactions and the conditions for equilibrium <span class="citation">(Sabatini et al., <label for="tufte-mn-34" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-34" class="margin-toggle">2012<span class="marginnote">Sabatini A, Vacca A, Iotti S. 2012. Balanced biochemical reactions: A new approach to unify chemical and biochemical thermodynamics. <em>PLoS ONE</em> <strong>7</strong>(1): e29529. doi: <a href="https://doi.org/10.1371/journal.pone.0029529">10.1371/journal.pone.0029529</a></span>)</span>. The example here shows how the required calculations can be performed at the species level using conventional standard Gibbs energies for species referenced to infinite dilution (zero ionic strength). The effects of ionic strength are modeled “on the fly” in CHNOSZ by setting the <code>IS</code> argument in <span style="color:green"><code>subcrt()</code></span> or <span style="color:green"><code>affinity()</code></span> to invoke the nonideality model on top of the standard Gibbs energies of species.</p>
<p>Now that we’re finished, we can reset the nonideality method to the default. (This really isn’t needed here, because there aren’t any nonideality calculations below):</p>
<pre class="r"><code>nonideal(oldnon)</code></pre>
<pre style="color:blue">## nonideal: setting nonideal option to use Bdot equation
</pre>
</div>
</div>
<div id="proteins" class="section level1">
<h1>Proteins</h1>
<p>Proteins in CHNOSZ are handled a little bit differently from other species. Amino acid group additivity is used to obtain the thermodynamic properties of proteins. Therefore, CHNOSZ has a data file with amino acid compositions of selected proteins, as well as functions for reading and downloading amino acid sequence data.</p>
<p>When proteins in CHNOSZ are identified by name, they include an underscore, such as in <code>LYSC_CHICK</code> (chicken lysozyme C). Use <span style="color:green"><code>pinfo()</code></span> to search for one or more proteins by name; multiple proteins from the same organism can be specified using the <code>organism</code> argument. The name search returns the rownumbers of <code>thermo()$protein</code> (i.e. <code>iprotein</code>, the protein indices). Supply those protein indices to <span style="color:green"><code>pinfo()</code></span> to get the amino acid compositions:</p>
<pre class="r"><code>p1 &lt;- pinfo(&quot;LYSC_CHICK&quot;)
p2 &lt;- pinfo(c(&quot;SHH&quot;, &quot;OLIG2&quot;), &quot;HUMAN&quot;)
pinfo(c(p1, p2))</code></pre>
<pre><code>##     protein organism     ref    abbrv chains Ala Cys Asp Glu Phe Gly His Ile
## 6      LYSC    CHICK UniProt   P00698      1  12   8   7   2   3  12   1   6
## 441     SHH    HUMAN UniProt Q15465.N      1  14   3  10  14   5  16   6   7
## 442   OLIG2    HUMAN UniProt   Q13516      1  51   5  10  10   5  35  18   7
##     Lys Leu Met Asn Pro Gln Arg Ser Thr Val Trp Tyr
## 6     6   8   2  14   2   3  11  10   7   6   6   3
## 441  15  11   3   8   7   3  13  12   8   9   3   7
## 442  14  29  11   4  31   5  13  50  11  10   1   3</code></pre>
<p>The length and chemical formula of one or more proteins are returned by <span style="color:green"><code>protein.length()</code></span> and <span style="color:green"><code>protein.formula()</code></span>. We can calculate the formula of the protein, and the per-residue formula, and show that both have the same average oxidation state of carbon: <label for="tufte-mn-35" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-35" class="margin-toggle"><span class="marginnote"><span style="display: block;">These functions accept either names or the protein indices (<code>iprotein</code>).</span></span></p>
<pre class="r"><code>pl &lt;- protein.length(&quot;LYSC_CHICK&quot;)
pf &lt;- protein.formula(&quot;LYSC_CHICK&quot;)
list(length = pl, protein = pf, residue = pf / pl,
     ZC_protein = ZC(pf), ZC_residue = ZC(pf / pl))</code></pre>
<pre><code>## $length
## [1] 129
## 
## $protein
##              C   H   N   O  S
## LYSC_CHICK 613 959 193 185 10
## 
## $residue
##                  C       H       N       O         S
## LYSC_CHICK 4.75194 7.43411 1.49612 1.43411 0.0775194
## 
## $ZC_protein
## [1] 0.0163132
## 
## $ZC_residue
## [1] 0.0163132</code></pre>
<div id="group-additivity-and-ionization" class="section level2">
<h2>Group additivity and ionization</h2>
<p>The group additivity calculations for proteins are based on equations and data from <span class="citation">Amend and Helgeson (<label for="tufte-mn-36" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-36" class="margin-toggle">2000<span class="marginnote">Amend JP, Helgeson HC. 2000. Calculation of the standard molal thermodynamic properties of aqueous biomolecules at elevated temperatures and pressures. II. Unfolded proteins. <em>Biophysical Chemistry</em> <strong>84</strong>(2): 105–136. doi: <a href="https://doi.org/10.1016/S0301-4622(00)00116-2">10.1016/S0301-4622(00)00116-2</a></span>)</span>, <span class="citation">Dick et al. (<label for="tufte-mn-37" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-37" class="margin-toggle">2006<span class="marginnote">Dick JM, LaRowe DE, Helgeson HC. 2006. Temperature, pressure, and electrochemical constraints on protein speciation: Group additivity calculation of the standard molal thermodynamic properties of ionized unfolded proteins. <em>Biogeosciences</em> <strong>3</strong>(3): 311–336. doi: <a href="https://doi.org/10.5194/bg-3-311-2006">10.5194/bg-3-311-2006</a></span>)</span>, and <span class="citation">LaRowe and Dick (<label for="tufte-mn-38" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-38" class="margin-toggle">2012<span class="marginnote">LaRowe DE, Dick JM. 2012. Calculation of the standard molal thermodynamic properties of crystalline peptides. <em>Geochimica et Cosmochimica Acta</em> <strong>80</strong>: 70–91. doi: <a href="https://doi.org/10.1016/j.gca.2011.11.041">10.1016/j.gca.2011.11.041</a></span>)</span>. There are two major options for the calculations: whether to calculate properties for crystalline or aqueous groups, and, for the latter, whether to model the ionization of the sidechain and terminal groups as a function of pH (and <em>T</em> and <em>P</em>). By default, additivity of aqueous groups is used, but the ionization calculations are not available in <span style="color:green"><code>subcrt()</code></sub>:</p>
<pre class="r"><code>subcrt(&quot;LYSC_CHICK&quot;)$out[[1]][1:6, ]</code></pre>
<pre><code>##        T       P      rho    logK        G         H       S       V      Cp
## 1   0.01 1.00000 0.999829 3465.97 -4332111 -10713933 3846.41 10049.2 4409.32
## 2  25.00 1.00000 0.997061 3250.23 -4434110 -10573283 4337.86 10421.0 6415.52
## 3  50.00 1.00000 0.988030 3076.73 -4549372 -10403450 4884.51 10600.2 7073.98
## 4  75.00 1.00000 0.974864 2936.71 -4678266 -10222409 5423.99 10708.1 7376.58
## 5 100.00 1.01322 0.958393 2823.20 -4820386 -10035675 5941.89 10782.9 7548.44
## 6 125.00 2.32014 0.939073 2730.69 -4974814  -9845120 6435.26 10840.9 7665.20</code></pre>
<p>Let’s compare experimental values of heat capacity of four proteins, from <span class="citation">Privalov and Makhatadze (<label for="tufte-mn-39" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-39" class="margin-toggle">1990<span class="marginnote">Privalov PL, Makhatadze GI. 1990. Heat capacity of proteins. II. Partial molar heat capacity of the unfolded polypeptide chain of proteins: Protein unfolding effects. <em>Journal of Molecular Biology</em> <strong>213</strong>(2): 385–391. doi: <a href="https://doi.org/10.1016/S0022-2836(05)80198-6">10.1016/S0022-2836(05)80198-6</a></span>)</span>, with those calculated using group additivity. After dividing Privalov and Makhatadze’s experimental values by the lengths of the proteins to get per-residue values, we convert those to calories, then plot them.</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="The heat capacity calculated by group additivity closely approximates experimental values for aqueous proteins. For a related figure showing the effects of ionization in the calculations, see &lt;span style=&quot;color:blue&quot;&gt;`?ionize.aa`&lt;/span&gt;." width="100%" /> <!--
<p class="caption marginnote">-->The heat capacity calculated by group additivity closely approximates experimental values for aqueous proteins. For a related figure showing the effects of ionization in the calculations, see <span style="color:blue"><code>?ionize.aa</code></span>.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>PM90 &lt;- read.csv(system.file(&quot;extdata/cpetc/PM90.csv&quot;, package = &quot;CHNOSZ&quot;))
plength &lt;- protein.length(colnames(PM90)[2:5])
Cp_expt &lt;- t(t(PM90[, 2:5]) / plength)
matplot(PM90[, 1], convert(Cp_expt, &quot;cal&quot;), type = &quot;p&quot;, pch = 19,
        xlab = axis.label(&quot;T&quot;), ylab = axis.label(&quot;Cp0&quot;), ylim = c(28, 65))</code></pre>
<p>The loop calculates the properties of each protein using group additivity with aqueous or crystalline groups, then plots the per-residue values.</p>
<pre class="r"><code>for(i in 1:4) {
  pname &lt;- colnames(Cp_expt)[i]
  aq &lt;- subcrt(pname, &quot;aq&quot;, T = seq(0, 150))$out[[1]]
  cr &lt;- subcrt(pname, &quot;cr&quot;, T = seq(0, 150))$out[[1]]
  lines(aq$T, aq$Cp / plength[i], col = i)
  lines(cr$T, cr$Cp / plength[i], col = i, lty = 2)
}
legend(&quot;right&quot;, legend = colnames(Cp_expt),
       col = 1:4, pch = 19, lty = 1, bty = &quot;n&quot;, cex = 0.9)
legend(&quot;bottomright&quot;, legend = c(&quot;experimental&quot;, &quot;calculated (aq)&quot;,
       &quot;calculated (cr)&quot;), lty = c(NA, 1, 2), pch = c(19, NA, NA), bty = &quot;n&quot;)</code></pre>
<p>Although <span style="color:green"><code>subcrt()</code></span> has no provision for protein ionization, the properties of ionization can be calculated via <span style="color:green"><code>affinity()</code></span>, which calls <span style="color:green"><code>ionize.aa()</code></span> if a charged species is in the basis. <label for="tufte-mn-40" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-40" class="margin-toggle"><span class="marginnote"><span style="display: block;">Whether to calculate properties using aqueous or crystalline groups is determined by the value of <code>thermo()$opt$state</code>; if it is changed from its default of <code>aq</code> to <code>cr</code>, no ionization is possible.</span></span> The following plot shows the calculated affinity of reaction between nonionized proteins and their ionized forms as a function of pH. Charged and uncharged sets of basis species are used to to activate and suppress the ionization calculations. The calculation of affinity for the ionized proteins returns multiple values (as a function of pH), but there is only one value of affinity returned for the nonionized proteins, so we need to use R’s <code>as.numeric()</code> to avoid subtracting nonconformable arrays:</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAMAAAC3Ycb+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAclBMVEX///+SQATt4+P//uH3+vff9/0qFxc5OTl6eXkKBw4+ouniaX5kt/aHx/G6ubhiHQwKFFRx1WETX7C89v7/9bSm2ver5qHsnqr5xHbQ0dAOO4ZJSE+1bC2M3X/g9t3G78ChnZnzwslgX2Lfm1AwgdFvlLMYS6aXAAAcWklEQVR42uydi3qiMBBGEQKCVXG9tHipWtH3f8VNAkgCCU64mSDZ/bZdqFY5/JnMTGa0LNWBfvzjdHr0d9Y4dBjbSRBM8QiCgyv5kb0/jppjrw7ktFog8tWJvbXkR/wp90v+jdcZOqa+ukDCWfZtvNpIgPBP+/s9zivA4dcBMs++jYBAzv/QeKk7A+JM1unldU4yI1J82lEiHQKx4uDwWO73y2sYzIFPO0qkSyBWFAZ0rBbgpx0l0iUQy7KXeLgKTztKpEsgrx3D8tOOEukOCMAxLD/tKJHugGSOIapwDMtPO0qkOz9E2TEcJfIex/DqZSOYWqNE+ncMUcExRPYe/yF/pwIgo0Te6BiKgFi/FzOvkXPyguC4IG+cOl6RN2MO5vcpcc2mD5Q/AuGDhyQOOzm4+O7FP0MfMVn37RgKgRgqkW24euyXp+BOL2tycZmDzMSBJ4cTuUfpSfwtnkniFfUNtphhAoTOKaeWgbx2DIVADJXIKbmm8WGTaCMm9yFzMAdC/g3veCZPTGuM4WzDe7b6oUBu1AC3rRCHwHD8m9wzFAMxUiLpJc3gbOj/uYMsEHIiO0mN7SkRFT5HgdzpwrRdhaAtnrEOl0mA58mFEhCdJHKtSBLZ3PzszTk6JyIK7iADxCHKiTLTSmBE3sJK/kmAEAm1rBA0WS2X4RH/5m24RkpANJLIEgyEW7lEAf1vFAiAULuKjXqU3adk6sIMEjIpEOwq7FoGQh3DiJozqWMoAWKiFeHFkC6bxAqxbXuJ79HnScohTme5DAiZyNoGMs+8w0gVyPmfgTaEu3rJtSwczG0IvlN3jA2hC6x5RFcAKRACs10bQp/V8XfZLaACxESJnJLVfZQsqNKbmz/IA3kuwei8huVwojN7BgR/0/IqKw7Wm9RhuluKQC4mSoS6HN4dMUD4g7kfsgwzJ2WfnYyCZAp7AsGLonaBOOkdEMnD71IgJkqEc8qzm1viqXv0XuVOYjwbDgi5o1t2DFESD9grOoaGSiR70z08oran/mrIgRgb0epp9A/EXIlIVsVJXC+4mwpklIhuQAYmEfOBjBLRDcgoEc2AGCaRxPNgsoVOPA1SN6PkjTCHUtc9C72XzmwnIjfuLUDMkkh2XZ/Zwjh4YJ/8+hDlDbn8Ig+kcAY/1UYXhVj/LsYBybOFTh6JKucNmUNFIPwZ5yQOzL4HiFESya5/li1Ez6lGkDdkDhWA8GdQikcTIBpI5O9HPpAQSJYtxFpZ+XRDgSArwhzCcxLZebAMEyDcmXUsS7a+Ccjl1zwgWbYQo/GxdT7sRHlD5lCaQgyCFAh3xpN59m8CYpIVeQLJNlmRYV/D1eaVQrgpizuz2sWSPW3vAvJ+iagD4VPh+AIL8obMoZIN4c44EiPyLiAGSUQORJA3ZA6VV1ncmW2o0bLXKIlM1nTHspXn0x97spshdy2YvCFzSOKHPM9svbWrERBzJJLYZrLUzTySm0c28boNPXXsYN51AmKQFREOVPc00i+WlUrkbI1DJyCmS4Rf7baVN3wjEDRKRC8gg5LIIICMEtEMyCgR3YAYIRFnkkSdEP5aKjJMSgrznyR7F7GDwrggsrrEbD+jVkCs718jgCQOuhfMi0WG+5PHVMgku3uv+BADRFaXGK+8mX5ATJCIMznSezlehfM8bZglmGImRJg54Ksd66SL6xLxKXHpwHuBmCARfOlILYwzeZAvFUWGeUHCggUifgipGvEW+gF5n0Qu3/KB+Mt8J/Ud0eo7KVSSFhlyCsmTheKHZJR0A/I+iagAIYVi8TotGsuKDBepFb/zQNBPSGxIniwU1iU6NK8rMuvvBqK/FaGVszNnMk+AsEWGyN7vJ/fCKotUM3FTlqgukcKJREnDjhqYgYHob0VIkU18iMgUQ69flhS5P89yqywbWVYBiKAu8cQIqDkQQAMzOBDtJZKUMt/WFgckWzKxhsBhsu8CIEzKED8Ko7NFc1aTBmYVna3hQLSXSFLKTLtksEC2E+KHXMPyslcKJE8ZMh1QWgACaWCmAER3idBJibxRHgh2u6dZ3hAI5OmpZw2ukMAV6aiztQIQ6/vTGpuhlmNZkM7WKkDGoG9TG1K3gdlAJdJulWGfDcxkChkl0twxrNfAbLQinQBBtG3A1j8eH24rQLBExvaYTVdZeOL0vEC2yFJUyCiRxkDI/m1iS9btANG5918aoZrOSY9RtqlolvNDecnhdsLuoK7Vp7QmkNQ5bMMx1F0iSYSKthvlm4pmOb+85DDyjjyQGn1KawOZCxzD5TEbgWcNRSJcOpZpKprl/JiSw3gRFYBYyn1Ka09Zd4FC6NqLDlWFaCwRDgjTVDTL+SG2ulkARLFPaS0gq+ONzp/btmzIGySyW8gHKgOxYzplMU1Fn70UnyWHQiCqfUrrhE5IMsSjRn21awtI7636FYAkTvADWWxTUSbnl5UcloHU6FPaKGPotOOH6G1FqGlOtMA2FeVzfrTkUKAQ9T6lNTtbX5Pfu/XdtoBo+2kWTjpB7dJIfNpUtJjzS665wIYo9imt29k6uLtWS+F3zSWSrZXWrsU0FS3l/CqBKPQprdfZekG27LntAtFVIs/Lmq0taVPR3JtgSg5tbPoXtsv7IYp9SmtnDCPy5K0C0VQi+dYRpqkom/N7lhw6IT+L1epTWj9jGGNXs1UgZn8mEmrpp+plDBO/NJi1C2T8TCSrdsZwQ4NqwbRVIAP52LBmGcQ6QFA8pRYNRWG7QEaJNN1KimzUJpCxPeb79/aOEtEayCgRzYCg878RiFYKGSWiG5CPb7KsG5CPl4h2QD5dItoB+XSJ6AfkwyWiHxCz+pB/ApDPloiGQD5bIjoC+eiuTToC+WiJaAnk0ySCLr0CmS7VJfJZNW5sprQHIMvAHiVSvaxE/U5Z/lQ17fRRZaD8m+3Fhkz9USJyHvzWjl6A2MFylIhsFHq99LPKWnp2s5c53HEu3Ho9LXt95WXwh0gEFX2unoAgZTPyIRIpvc2+HENlM/IZVuRS2vfUFxCkbEY+QSKoHCTqL3RyO44SqXLReweibEaG32/jItio2WNwca9oRgYvkbPoDfYZ7VU1I0OXiLD6otfwu6IZGXjXJvGqhQVidw0ETa9KQAYtEclOfwbI9riBXqm6na33wb6F1zzUFe8TiJ0MMJAGna2vntIlHrBEZG4WAZK2tJT3hyuMJp2tb7dRIrIV7xPIZK40ZTXqbI08JTPyO1CJyJf0BEiUfGoxHEiTztZqZmSoEpHfaOwqC/jeG3a2VjMjw5RIRZwuBeJUNeEtjoadrY+3T5fIuSIGkQLZHhWANOxsrWZGhiiRqo2AtYA07GytZEYGKJHKxEItIE0/8khpX9DgCniqb7E6QBQdw6+/RmZkaJXSqHrnch0gmWOIYI6hXSZie8uPlciLTOhzlQWfRJQdQwERle2lwyrgubywia1+5NHylo2AsyF/X3YTMzIkibzMuj2BOP4tHxuYY1j8UKu9f6V//KvHG3UBkaP/kRJ5uYp/AtmG3nMcNm07hmUiKmZkOAU8r7fS9PWRR39fxSlKIaE7mK3X59fbBHggW/92vD0ACy51x/CnRERhe+lQJAJ4HxwQ0i0Q/13tXjyoVmfrEhGFfUEDkQhk7x8X7Z3QjvJ/4bpyBVS3s3WJiML20kHsCLpAokAskGw9G1WnDmt3tv75qm1GhiARBJp4eSALCJD6na2/fgoHwPuChrBpDha3ZoE4aQ//+OACHMM6na2LROD7gsyXyAUWtuaMehzcrsvr7UUH4CadrYtEwJF44yVyBr4BDoiTfCjG/cW6t0Fna1QkAk7oGl6dgKDxn4Jj6OyX+5duSJPO1qgYaITuCzJcIuD7qeipIzrA3NU7WxdDv+CErtESuYDznrxjGKrtmFPx1KVEoGbEZIkgeKiBW2VNVkm49uF2CKREBGpGDJaIwk4NkWPYwqjMqRdDv0AzYq5EVG4l3g/pB0iRiA00I6ZK5KxyJ/F+yGHTC5AikT0soWuoRJBSrJoDQraTkARVp0Y9JcLZDWBC10x3XW2rH2/UgyPN4PqdAymGfmEJXSMlclHb6ccb9Vk/NqRMBJjQNVAiZ8WbSBTt7QVIIRgP3BdkXOoQqb5i3qiv3f6AWD8/6mbEuA0oynvFORvih8GRjNumDyCFQCMsoWvYHq3vX9QAyDacTj2yaffQC5ACEVhC92LUZvgar/atfXt5IrCErkn1IlADsplrAqQQjAftCzKoXgQBbx402/UKpGqhwAUaYfuCzJEINNSzmPc7Zc0XUCIgM2KMdwg1ILsZ6hcImi0qgyiM5bhCzIghMUaoR+jONn0bdQUikH1ByAjvEPwqCxNIL0bdne2ARED7gkxY+kINOp6wZMtetj6k7VXWKyL5BQYldA2w69B51Z25MiBsfUjbQFA1ETbQCEnonrW361ARo9J1EU1ZzrJtINj3mW2ARCBmRHe7Dr5jFvMXnrpDGmfFqw4cw93MrSSS3zSQhK7edh1s0Dfli8JnDNNtQIcOgLwi8qNkRrSetMAGHQkmcq4+5LTyfe8xaSEILwqdVBJhw1oQM6LzpAV+bSKXubgNaBvu0GnWCRA4EcgyT9+VFnhVzrvoQiALAsSKDt0AsRYzBCICMSPaTlrgF+YK78+iQsjerGjVEZBXRP5UzIim7iE8jiCOX3BG/bTaWJPVddKVQsgyr+IqMoFGY80I2KALVryCVZa/oZW4s86AWHMgEUC/IKSjGQHfJa7EoJYdQ2ffwk4HeX3IvGq7ak4EYkY0jDKC51EkC13wCqG7G7a3XXdAMBFY6NdIbwT+ghay+5L3Q+juhqyGsAJvk45ywGA8ugL2BV30IgKX7E66uhHXqVc/W4NW48nsCdMIpO2cVkTgRs2VR/bEderVT6fYUU7wckDBeFCVgk5E4Mu+immbrw9Jlldx9bK3UatxAJFn6BeUG9GHCNwx2lW4YzXq1Ju1GqfScmHBeMj2UqQLEbhBd6tCSIU6dQ9Qpy7vKAcFAk6PgLqXXrRY/SqswSvnhzp16g1bjaeqhaRHYMVuZx2IwL3URWXhYF8d5VSJpIFGWJXC+d/bfXa4QRckpazmH3DfqNU4gMgz9AurUkC/v++NNMINushF//tqBoR2etj6x6O8nh2yt3cBIgLsXvr9VtOuEDIQhI7+vo6NgNBVVuQFnidv+QDabA1Kj0C7l77TtCsYdMGK1/6a7hsDcSb/2zsT7VR1KAwjxgCiaJ052BZp+/6veBImwYHsDEBs93/WXesOXCR87BHY8MGMp9VGB0h3M74iAh2C/fE2mtuCB/QH+T4JV5GjDaQsDm8KQz5I2c//orD3Qzpbv9UNK/AQ7PeR3JbEa1IPSvRwEgmyrGkcz8RAFg8Kw7h+9JEC3w8BNePB00vHcVsSlen+/k7T8ZyK0t7dKuh8qa1wWd8arZMmEcC7CvDppWO4LYmA/qBEP4apsA6Zpj+zy6wLyDrJ8tFlO80Y4ohavyURiSHYg2dbBF4DPch4L6GvXxju+M0Qmgf1pyOXwUBgT8ZLDMH+HLhIfIff2b8v0d07Hg+BuNBPtk216hAJIhJDsHmROKCRSAT0+xKdnH1R68SN/ITCJ8pd/K02EAIhIjEEmzC3NVhsl3gW6T7jJeeQdAApWATBOvsBf27ntNYHImr9FkQkwsiAsV3mpv59+uKHXU8ustyKJn50kBpiZgaIoNFYEPGl9jiMkci0me8zXj98dI01gOST+AFj/vjAh1LUDBBhM57IhRF+rgaIJBIJ1oOM13/w9bqWy9pNgs0WBmSdlPIMAYEQkQgjpZEc+vVbMg/q3We86fnodAPJb3P8QAZhXsvBkykg3a3fgojMl93yk9AzEomE9z7jTc+hIwTCv1hPAzGQ3erbOJDu1m9BROoDoYXfejt89MeDSDiAm22jVUgAQNi5Pgf/xFPMLlWhcsqMAelu/RZEEukq9uPw9v5JxuZxF0AiL3xm7XeFIfNb//p8lLSjrdVpm5yIK/Wd6XK3n+9v74cPMiKPuxcPYvqUx4NKnXwNMJX0caYuJCL1nekGk8PbG6Py+fnxQYyQkbtlfBtAGI+LAwfCu4vjAOlu/eZEUuoqnsKPz8Ph/f2t0Pv7++HAAH2qWY7cQxW3GaRLw6MjBcTARaQERPAcdk4kSzSPjpAPJsbiUANicKTIyN12uW2ZMB4hkQPijAVETMSVrA8hppPbTm42jAvEXcl1+G+WxBYQAr6nbgkQQeuXE1EJ7DA/xMC856Gmy1qki5ubAEK8LOz0upYBERG5hG4cRP0QIVWsKbE8yaLlCpvbCiRJOgK6jUDERC6RUqoFpkKuVFrW8sFzNdk687YCybyugG4lEEEznt/VVU615BOzKi0rYr901X/bwvK9Y+i8GhAxkaN0D0XDh5VpmVp+fFNZ+fQYktcDImj9OuQYZt5LzIq9CSApvYRC27YRiIgIS7a0y5EhdHMTPQ1iQUC3FoiQyCU820/kpiKMQDwsBSK4PVK4LcuJ3BS5URCJEiybgQhujxREXKuBtAM6q56ECZbVQIREHPcM8QCjqX38cZCKEyy7gXSPqSmOPQytNZJ2FIxpeoHxsBiI4PZInreswqOdkaQd0F3OA3jtWAyEiIlENLQSSbtCd6nvgm3ZYiAQIq6XHC1E0rrT5nq+Cw93NgMR3R7JN/FpZB2SVsudeJkED7uBQIgwt5W5DIlF4b0V0CV5WA5E1IwvXEJGI2IRkq0OD9uBgIjkRsKQ2FGXtI6YJIkcD+uBgIgQkgUp73BZgKTlZRmPi+QxWQ8EZiNO7PG37zmSkeN7MzNU4PECQIjghlVdJQa8ueWOXJg0OyYk847SvQT7gQhvIV4z4MDnry2MmQW3EqzMC8PX+tKn0jKfA3HiJH9GaLwsuNUxyRJQv/0VgQCJ8HwrDyXOSFlwK9xlmVKK8RpA4ERIEUpGQdJ6Ntk/h0qO80WAwIlUocQhg2fBjY4J8VXclTIQrcnWvRPhpXuaX53DImk8Y3IJz6rmqQJEc7K1ckIJthEWSsqxZwMiuXZMWFKRKLtLFSC6k617J8KrElqOaRuqVqwTLBa9fE89fCkNMNOdbN2/1yqie1xdsP0XJnXHhP2Yr/Ooq+rMxUKnQYHI2Qhh0b18MGWAwqTsmDB7dLV4qAAxMdl6CBvh0T3wh0FSdEzyiKXHQymGmJhsPQyRBhLenu8NSX5Ybp5AaPIYb7K18tIlX0iNayT9pVw8oDMbvOTJhCb18SZbKxORfYu+dyRkvidl4pBS3ZeJXqYwbFyOS+nLJ6syrl6QLJaXMo9L9V/uep3CsEFkIW/RfpCUrya6pguT5byKTiZettMpDKfDFoZXA13M5b/sR1ipmPaBZD+vbM7Iy49GC8M8suTqFQi/KKVnTRD+3beyx2WwVnTTefVScGTk9WCjhWFUDTZLAtp342ip8r9FSbMw0UfCYnmdY5jhoVcYTocuDBuBRMVtFSmXuY4K20N9YZh6ff7FCsOW716qORmfepEJJLxNUj9jEgepMxqQMQvDtpGoTS26BhMNJHn+XD9jEhsb+PFyhWHbSBaKH1Kug4kikqKcqRs5LjV241XvFu7O344JxCHL+VIRSV2/yyOpbg7Xt0AM8tAEMnD7/ZHfUkdS1+9yrWC3eoi4fsbENTky6tWB6CFh9Xtcpq+wjgo3jhJefUuKeJkzKpAeJltrI1koDiUkPi1aKo0z3UHj2KjxqwTLLA81IOYnW+vGkv18rjhKlbdU6iz4OZMcRrPjUvNIzM6UUKpDephsrZ9xLVQ91xWJw8/68ei2z7B7yWEcW/2vKuE1zUOt29vHZOtRPde18chOPz/7nAtXWPz95YZRnfAa56EW1HuZbK3vt5wZ91xqJ+jaeMx3xayikOs+LoD64vEyj5JCtVX2XFELSUH4aUFa8vDMzyT6bUAKz7U3hKSbh+v1MJHo9wHhOZeqmVzb8xAeNOvh4H8jkMpMVC7fxhMRT1Q9rRfTXk7dLwVSmIlS0uVmZfnezSM11W//K0AKM1FyXfyOyZNgUt3OJxntaXjwbwZSMZG3E5J6gf/gjM/mxRCvmCZ9PQX5y4GUTBZ7aUNhwcRLb856eSffzXpyV38DCGfC4sl8KQuFpEmQNJkUz7q49UP1CGRwKC5j4vmRW7qrWf4vsrjP4/wzQLjv33Ioku6LRL4XBF7y8/2TebRtMgjElKXIxhQ3mn/7fhrF/R/fnwNCru4L/qHnxXw/1PH9OSDX5GsBzIgZjuVww1P+LBBuLFtARrwfFMffBiJOvjix/bCjhf46EOeafG3JA1SzoQ8GgTRO/3yxWC737M8y/4f9bIQDQSB17uWQ2Zax4NrvZ2PNQEMglgmBIBAUAkEgCASBIBAEgkAQCAJBIAgEgSAQFAJBICgEgkAQCAJBIA806hBMBHKnkYdgIpBbjfR1BATyzEDG+joCAnkGZKyvIyCQhxrx6wgI5KHsGIKJQK6yYwgmAmno8RBM4sblHwQyJBDCQ8jOT5KfGyQprRQgkIGzrBMN2Gl/lmT11ZFBIM+ATCfrPY8lGwRiB5CyOHxaGCKQwYEsOgtDBDK4y/pGC7EHyDrJVhzFDmOIFUD4zRCaB/X1HoHYURgWms4cBGITkMF3i0AQyG8B4vm1PLCo8Q1fZJfNs9UPkPj6C34AXgB4yz52SY3/uMQuG6er/4lD4HGRaQLdpQfdZQRucnqR8V0mKfTypYN6xV8GJEYgGrtEC0ELQSBoIWghhoG4GEPQQtBCEAhayLPzDJ0F5kYj7jKCDkgmPewydVDKIngKUCgUCoVCoVAoFAqFQqFQqEH0tQqCDeRTT+SLD0+BfXyLnJ++kN3SbkJBu5x+UcBvT8+0eC9fuKZqS+Ga6l3C16SpU7CJUvoP8GmUL77lar2F7RV08LvVvyiC7PIc/MTCDU+rdbEQ4ZrqLUVrqjeEr0lT0wn/vRPgp3YrPh/iBDzRGYVsd85fYvH3gN92xL99+pnlqxGvqdpSuKZqQ4k16Yns6Dz/sW/xpm5+8dE5xGH9O0AOfjrZwA4TBoT9cHGaAWsqtnTEayo3BK9J32MtCjsB3tb5CpaAndLlDnLw7JydaZAsIT+7ILuJ0LeRhm10r6k6z8I1VRtC16QPZFk7Lsjm9JtAzrMDOvgTpRseQ8RRfXrmg0LE25VAAGu6/lfBmooNwWsaFsiJbmYQhzWDAsnPHxX7yzyoT4RECBjI1UIEayo2hK/JlMuCOHPyFXzPQA7LgR38LkcxXW1gGwIiXctlbRyxhYjXVOwSvCZdwYM697VzyC7PQTmKaCv2bRun61Xhm8tGvKF0UBevqdgQviYzae8XJJk9wXg4bszE/FAsjjZ52gtwWafSQjYgCwGtaVJWLHPQLiXWZKYwBISGKS/imPZAy4OYNwsioFpzOsljiCDDu/AEgR+gcE3VlsI11buEr0m7EuHDzjag0FBYLax0OMEOnv84qHXC0mMq2nBSHaBwTdWWwjVNmv/9NAgQFAqFQqFQKBQKhUKhUCgUCoVCoVAoFAqFQqFQKBQKhUKhUCgUCoV6qnP5QPyk//cxUAgEgaDUtFttvmiwXiAQSzRdBf+i/D0pBGIJkHzSBv2u37EMEMi4QPjsBf5q53n9E6VRCh11g+oLyKbEgi7LOgtBIHbFEARiS5YVx3yiCQKxQWRa1CFLrEOsCuooBIJCIAgEhUKhUCgb9B+80V8vRuSR/AAAAABJRU5ErkJggg==" alt="Affinity of ionization of proteins. See [&lt;span style=&quot;color:blue&quot;&gt;demo(ionize)&lt;/span&gt;](../demo) for ionization properties calculated as a function of temperature and pH." width="100%" /> <!--
<p class="caption marginnote">-->Affinity of ionization of proteins. See <a href="../demo"><span style="color:blue">demo(ionize)</span></a> for ionization properties calculated as a function of temperature and pH.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>ip &lt;- pinfo(c(&quot;CYC_BOVIN&quot;, &quot;LYSC_CHICK&quot;, &quot;MYG_PHYCA&quot;, &quot;RNAS1_BOVIN&quot;))
basis(&quot;CHNOS+&quot;)
a_ion &lt;- affinity(pH = c(0, 14), iprotein = ip)
basis(&quot;CHNOS&quot;)
a_nonion &lt;- affinity(iprotein = ip)
plot(c(0, 14), c(50, 300), xlab = &quot;pH&quot;, ylab = axis.label(&quot;A&quot;), type = &quot;n&quot;)
for(i in 1:4) {
  A_ion &lt;- as.numeric(a_ion$values[[i]])
  A_nonion &lt;- as.numeric(a_nonion$values[[i]])
  lines(a_ion$vals[[1]], A_ion - A_nonion, col=i)
}
legend(&quot;topright&quot;, legend = a_ion$species$name,
       col = 1:4, lty = 1, bty = &quot;n&quot;, cex = 0.9)</code></pre>
<p>The affinity is always positive, showing the strong energetic drive for ionization of proteins in aqueous solution. The degrees of ionization of amino and carboxyl groups increase at low and high pH, respectively, giving rise to the U-shaped lines.</p>
<p>There, we used the indices returned by <span style="color:green"><code>pinfo()</code></span> in the <code>iprotein</code> argument of <span style="color:green"><code>affinity()</code></span> to specify the proteins in the calculation. That approach utilizes some optimizations that can be realized due to group additivity, and is useful for calculations involving many proteins. An alternative, but slower, approach is to identify the proteins to <span style="color:green"><code>species()</code></span>; this produces results that are equivalent to using the <code>iprotein</code> argument: <!-- this is needed because the figure above might be cached, preventing the call to basis() there --></p>
<pre class="r"><code>species(c(&quot;CYC_BOVIN&quot;, &quot;LYSC_CHICK&quot;, &quot;MYG_PHYCA&quot;, &quot;RNAS1_BOVIN&quot;))
a_nonion_species &lt;- affinity()</code></pre>
<pre class="r"><code>unlist(a_nonion_species$values)</code></pre>
<pre><code>##      3445      3444      3448      3450 
##   55.5242 -470.1077  228.5317 -495.8854</code></pre>
<p><label for="tufte-mn-41" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-41" class="margin-toggle"><span class="marginnote"><span style="display: block;">The <code>ispecies</code> index (top) refers to the rownumber of <code>thermo()$species</code>; that is distinct from the <code>iprotein</code> index (bottom, printed as negative integers), which refers to the rownumber of <code>thermo()$protein</code>.</span></span></p>
<pre class="r"><code>unlist(a_nonion$values)</code></pre>
<pre><code>##        -5        -6        -7        -9 
##   55.5242 -470.1077  228.5317 -495.8854</code></pre>
</div>
<div id="compositional-analysis" class="section level2">
<h2>Compositional analysis</h2>
<p>Functions in CHNOSZ make it easy to get the chemical formulas of proteins from their amino acid compositions. Calculations based on the formulas, such as the average oxidation state of carbon (<i>Z</i><sub>C</sub>), and the coefficients of basis species in formation reactions, are also available.</p>
<p>Let’s compare the <i>Z</i><sub>C</sub> of Rubisco with optimal growth temperature of organisms, as shown in Figure 6a of <span class="citation">Dick (<label for="tufte-mn-42" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-42" class="margin-toggle">2014<span class="marginnote">Dick JM. 2014. Average oxidation state of carbon in proteins. <em>Journal of the Royal Society Interface</em> <strong>11</strong>: 20131095. doi: <a href="https://doi.org/10.1098/rsif.2013.1095">10.1098/rsif.2013.1095</a></span>)</span>. First we read a CSV file with the IDs of the proteins and the optimal growth temperatures (<em>T</em><sub>opt</sub>); the midpoint of the range of <em>T</em><sub>opt</sub> is used for plotting. Then we use <span style="color:green"><code>read.fasta()</code></span> to read a FASTA file holding the amino acid sequences of the proteins; the function returns a data frame with the amino acid counts. To put the proteins in the right order, the IDs in the CSV file are matched to the names of the proteins in the FASTA file. Then, we calculate <i>Z</i><sub>C</sub> from the formulas of the proteins. Next, point symbols are assigned according to domain (Archaea, Bacteria, Eukaryota); numbers inside the symbols show the ordering of <em>T</em><sub>opt</sub> in three temperature ranges (0–35 °C, 37.5–60 °C, and 65–100 °C).</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <embed src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiCiAgICAgYmFzZVByb2ZpbGU9ImZ1bGwiCiAgICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHhtbG5zOmV2PSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL3htbC1ldmVudHMiCiAgICAgd2lkdGg9IjUwNS44OSIgaGVpZ2h0PSI1MDUuODkiCiAgICAgdmlld0JveD0iMCAwIDUwNS44OSA1MDUuODkiCiAgICAgZm9udC1mYW1pbHk9IkFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWYiCj4KPHRpdGxlPlJ1YmlzY288L3RpdGxlPgo8ZGVzYz5SIFNWRyBQbG90ITwvZGVzYz4KPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgc3R5bGU9ImZpbGw6I0ZGRkZGRiIgaWQ9J2NhbnZhcycvPgo8bGluZSB4MT0iNjUuNjQiIHkxPSI0MjguNTQiIHgyPSI0NTguNzkiIHkyPSI0MjguNTQiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8bGluZSB4MT0iNjUuNjQiIHkxPSI0MjguNTQiIHgyPSI2NS42NCIgeTI9IjQzNi4xMiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxsaW5lIHgxPSIxNDQuMjciIHkxPSI0MjguNTQiIHgyPSIxNDQuMjciIHkyPSI0MzYuMTIiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8bGluZSB4MT0iMjIyLjkwIiB5MT0iNDI4LjU0IiB4Mj0iMjIyLjkwIiB5Mj0iNDM2LjEyIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDAwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGxpbmUgeDE9IjMwMS41MyIgeTE9IjQyOC41NCIgeDI9IjMwMS41MyIgeTI9IjQzNi4xMiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxsaW5lIHgxPSIzODAuMTYiIHkxPSI0MjguNTQiIHgyPSIzODAuMTYiIHkyPSI0MzYuMTIiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8bGluZSB4MT0iNDU4Ljc5IiB5MT0iNDI4LjU0IiB4Mj0iNDU4Ljc5IiB5Mj0iNDM2LjEyIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDAwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjAuNzAsNDU4Ljg3KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE0cHQiID4wPC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQuMzksNDU4Ljg3KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE0cHQiID4yMDwvdGV4dD4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjEzLjAyLDQ1OC44NykgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxNHB0IiA+NDA8L3RleHQ+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI5MS42NSw0NTguODcpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPjYwPC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNzAuMjgsNDU4Ljg3KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE0cHQiID44MDwvdGV4dD4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQzLjk3LDQ1OC44NykgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxNHB0IiA+MTAwPC90ZXh0Pgo8bGluZSB4MT0iNjIuMTgiIHkxPSIzNzkuMDgiIHgyPSI2Mi4xOCIgeTI9Ijg3Ljc2IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDAwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGxpbmUgeDE9IjYyLjE4IiB5MT0iMzc5LjA4IiB4Mj0iNTQuNjAiIHkyPSIzNzkuMDgiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8bGluZSB4MT0iNjIuMTgiIHkxPSIzMDYuMjUiIHgyPSI1NC42MCIgeTI9IjMwNi4yNSIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxsaW5lIHgxPSI2Mi4xOCIgeTE9IjIzMy40MiIgeDI9IjU0LjYwIiB5Mj0iMjMzLjQyIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDAwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGxpbmUgeDE9IjYyLjE4IiB5MT0iMTYwLjU5IiB4Mj0iNTQuNjAiIHkyPSIxNjAuNTkiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8bGluZSB4MT0iNjIuMTgiIHkxPSI4Ny43NiIgeDI9IjU0LjYwIiB5Mj0iODcuNzYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Ny4wMiwzOTkuNzgpICByb3RhdGUoLTkwKSIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPi0wLjE4PC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Ny4wMiwzMjYuOTUpICByb3RhdGUoLTkwKSIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPi0wLjE2PC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Ny4wMiwyNTQuMTIpICByb3RhdGUoLTkwKSIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPi0wLjE0PC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Ny4wMiwxODEuMjkpICByb3RhdGUoLTkwKSIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPi0wLjEyPC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Ny4wMiwxMDguNDUpICByb3RhdGUoLTkwKSIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTRwdCIgPi0wLjEwPC90ZXh0Pgo8cG9seWxpbmUgcG9pbnRzPSI2Mi4xOCAsIDQyOC41NCA0NzQuMDQgLCA0MjguNTQgNDc0LjA0ICwgNjIuMTggNjIuMTggLCA2Mi4xOCA2Mi4xOCAsIDQyOC41NCAiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMjAuODQsNDg5LjIxKSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE0cHQiID5ULCYjMTYwOyYjMTc2O0M8L3RleHQ+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2LjY4LDI1Ny44MykgIHJvdGF0ZSgtOTApIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxNHB0IiA+WkM8L3RleHQ+CjxyZWN0IHg9IjY3LjQ4IiB5PSIyMTEuMzMiIHdpZHRoPSIxOS45MSIgaGVpZ2h0PSIxOS45MSIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwMDBGRiIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMzM1NC9hYjAwMjU2IgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MS40NCwyMzAuMzgpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjE8dGl0bGU+UGhhZW9jeXN0aXMgYW50YXJjdGljYTwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8Y2lyY2xlIGN4PSI5My4xNiIgY3k9IjE0MC4zMiIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEwMTYvUzA3MjMtMjAyMCg5Nyk4MDAwMy0zIgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4Ny4xNywxNDkuNDIpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjI8dGl0bGU+T2N0YWRlY2FiYWN0ZXIgYW50YXJjdGljdXMgMzA3PC90aXRsZT4KPC90ZXh0Pgo8L2E+Cjxwb2x5bGluZSBwb2ludHM9IjEzNi40MSAsIDI2MC44NSAxNDkuODEgLCAyODQuMDYgMTIzLjAwICwgMjg0LjA2IDEzNi40MSAsIDI2MC44NSAiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiNGRjAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTEyOC9BRU0uMDExNDYtMDgiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMC40MSwyODUuNDIpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjM8dGl0bGU+TWV0aGFub2xvYnVzIHBzeWNocm9waGlsdXM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPHBvbHlsaW5lIHBvaW50cz0iMTU2LjA3ICwgMjQyLjgzIDE2OS40NyAsIDI2Ni4wNSAxNDIuNjYgLCAyNjYuMDUgMTU2LjA3ICwgMjQyLjgzICIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iI0ZGMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L1MwNzIzLTIwMjAoMTEpODAxMTctNyIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUwLjA3LDI2Ny40MSkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+NDx0aXRsZT5NZXRoYW5vY29jY29pZGVzIGJ1cnRvbmlpPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjE3My43NiIgY3k9IjE3OC4yMyIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEwOTkvMDAyMDc3MTMtMzItMS0xMzYiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2Ny43NiwxODcuMzMpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjU8dGl0bGU+QnJhZHlyaGl6b2JpdW0gamFwb25pY3VtPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjE3OS42NSIgY3k9IjEyMi41NSIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEwODAvMDE0OTA0NTkyMDkzNzc5MjAiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3My42NiwxMzEuNjUpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjY8dGl0bGU+VGhpb2JhY2lsbHVzIGZlcnJvb3hpZGFuczwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8cmVjdCB4PSIxNzMuNjMiIHk9IjE0MC43OSIgd2lkdGg9IjE5LjkxIiBoZWlnaHQ9IjE5LjkxIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDAwMEZGIiBmaWxsPSIjRkZGRkZGIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIC8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L1MwMDY1LTIxMTMoMDgpNjAzMjItMyIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc3LjU5LDE1OS44NSkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+Nzx0aXRsZT5aZWEgbWF5czwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8Y2lyY2xlIGN4PSIxODMuNTkiIGN5PSIxMzguODkiIHI9IjEwLjY2IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDBDRDAwIiBmaWxsPSIjRkZGRkZGIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIC8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMzcxL2pvdXJuYWwucG9uZS4wMDAwNjY3IgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzcuNTksMTQ3Ljk5KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID44PHRpdGxlPk1hcmlwcm9mdW5kdXMgZmVycm9veHlkYW5zPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjIwMy4yNCIgY3k9Ijc1Ljc1IiByPSIxMC42NiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwQ0QwMCIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTA5OS9panMuMC4wMjMyMy0wIgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTcuMjUsODQuODUpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjk8dGl0bGU+RGVzdWxmb3ZpYnJpbyBoeWRyb3RoZXJtYWxpczwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8cG9seWxpbmUgcG9pbnRzPSIyMTMuMDcgLCAyMzUuMzggMjI2LjQ4ICwgMjU4LjU5IDE5OS42NyAsIDI1OC41OSAyMTMuMDcgLCAyMzUuMzggIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjRkYwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGEgeGxpbms6aHJlZj0iaHR0cDovL2FlbS5hc20ub3JnL2NvbnRlbnQvNDcvNS85NzEiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNy4wNywyNTkuOTUpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjE8dGl0bGU+TWV0aGFub3NhcmNpbmEgYWNldGl2b3JhbnM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPGNpcmNsZSBjeD0iMjQyLjU2IiBjeT0iMTA2LjQ0IiByPSIxMC42NiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwQ0QwMCIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTA5OS8xMzUwMDg3Mi0xNDAtMTItMzQ1MSIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM2LjU2LDExNS41NCkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+Mjx0aXRsZT5BY2lkaXRoaW9iYWNpbGx1cyBjYWxkdXM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPHJlY3QgeD0iMjMyLjYwIiB5PSIyOTcuNTAiIHdpZHRoPSIxOS45MSIgaGVpZ2h0PSIxOS45MSIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwMDBGRiIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwOi8vbGluay5zcHJpbmdlci5jb20vYXJ0aWNsZS8xMC4xMDA3L0JGMDA0MDkwMzEiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDIzNi41NiwzMTYuNTUpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjM8dGl0bGU+Q3lhbmlkaXVtIGNhbGRhcml1bTwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8Y2lyY2xlIGN4PSIyNTIuMzkiIGN5PSIxODAuNzAiIHI9IjEwLjY2IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDBDRDAwIiBmaWxsPSIjRkZGRkZGIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIC8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDk5LzAwMjIxMjg3LTE0Mi00LTc3NSIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQ2LjM5LDE4OS44MCkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+NDx0aXRsZT5TdWxmb2JhY2lsbHVzIGFjaWRvcGhpbHVzPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjI3MC4wOCIgY3k9IjIyNC41MiIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEyNzEvYmJiMTk2MS40MS42ODUiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2NC4wOCwyMzMuNjIpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjU8dGl0bGU+UHNldWRvbW9uYXMgaHlkcm9nZW5vdGhlcm1vcGhpbGE8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPGNpcmNsZSBjeD0iMjcyLjA0IiBjeT0iMTQ5Ljg0IiByPSIxMC42NiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwQ0QwMCIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTEyOC9BRU0uNzIuMS41NDQtNTUwLjIwMDYiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2Ni4wNSwxNTguOTQpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjY8dGl0bGU+U3luZWNob2NvY2N1cyBzcC4gKHN0cmFpbiBKQS0yLTNCJ2EoMi0xMykpPC90aXRsZT4KPC90ZXh0Pgo8L2E+Cjxwb2x5bGluZSBwb2ludHM9IjI5MS43MCAsIDExNi44OSAzMDUuMTAgLCAxNDAuMTEgMjc4LjMwICwgMTQwLjExIDI5MS43MCAsIDExNi44OSAiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiNGRjAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTA5OS8wMDIwNzcxMy00Mi0zLTQ2MyIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjg1LjcwLDE0MS40NykgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+Nzx0aXRsZT5NZXRoYW5vc2FldGEgdGhlcm1vcGhpbGE8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPGNpcmNsZSBjeD0iMjg5LjczIiBjeT0iMTc1LjE1IiByPSIxMC42NiIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iIzAwQ0QwMCIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIiAvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTA5My9veGZvcmRqb3VybmFscy5wY3AuYTA3NTY4NCIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjgzLjc0LDE4NC4yNSkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+ODx0aXRsZT5UaGVybW9zeW5lY2hvY29jY3VzIGVsb25nYXR1czwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8Y2lyY2xlIGN4PSIzMDEuNTMiIGN5PSIzODEuOTAiIHI9IjEwLjY2IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDBDRDAwIiBmaWxsPSIjRkZGRkZGIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIC8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDk5L2lqcy4wLjAwMzQ4My0wIgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyOTUuNTMsMzkxLjAwKSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID45PHRpdGxlPkNsb3N0cmlkaXVtIGNsYXJpZmxhdnVtPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjMyMS4xOSIgY3k9IjI0NS40NCIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEwOTkvMDAyMjEyODctNjctMS05IgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTUuMTksMjU0LjU0KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID4xPHRpdGxlPkJhY2lsbHVzIGFjaWRvY2FsZGFyaXVzPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjMyMS4xOSIgY3k9IjQwMy4yNiIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEwOTkvMDAyMDc3MTMtNTItNC0xMzYxIgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTUuMTksNDEyLjM2KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID4yPHRpdGxlPlRoZXJtb3RvZ2EgbGV0dGluZ2FlPC90aXRsZT4KPC90ZXh0Pgo8L2E+CjxjaXJjbGUgY3g9IjM0MC44NCIgY3k9IjIwMi41NyIgcj0iMTAuNjYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMENEMDAiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPGEgeGxpbms6aHJlZj0iaHR0cHM6Ly9kb2kub3JnLzEwLjEzNzEvam91cm5hbC5wb25lLjAwMDQyMDciCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMzNC44NSwyMTEuNjcpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjM8dGl0bGU+VGhlcm1vbWljcm9iaXVtIHJvc2V1bTwvdGl0bGU+CjwvdGV4dD4KPC9hPgo8cG9seWxpbmUgcG9pbnRzPSIzNjQuNDMgLCAyOTUuMDQgMzc3Ljg0ICwgMzE4LjI2IDM1MS4wMyAsIDMxOC4yNiAzNjQuNDMgLCAyOTUuMDQgIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjRkYwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGEgeGxpbms6aHJlZj0iaHR0cDovL2FlbS5hc20ub3JnL2NvbnRlbnQvNjAvNC8xMjI3IgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNTguNDMsMzE5LjYyKSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID40PHRpdGxlPkFyY2hhZW9nbG9idXMgZnVsZ2lkdXM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPHBvbHlsaW5lIHBvaW50cz0iMzk5LjgxICwgMzkyLjA4IDQxMy4yMiAsIDQxNS4zMCAzODYuNDEgLCA0MTUuMzAgMzk5LjgxICwgMzkyLjA4ICIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iI0ZGMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDA3L0JGMDA0MjUyMTMiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5My44Miw0MTYuNjYpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjU8dGl0bGU+TWV0aGFub2NhbGRvY29jY3VzIGphbm5hc2NoaWk8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPHBvbHlsaW5lIHBvaW50cz0iNDA5LjY0ICwgMzQ2LjAxIDQyMy4wNSAsIDM2OS4yMyAzOTYuMjQgLCAzNjkuMjMgNDA5LjY0ICwgMzQ2LjAxICIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iI0ZGMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L1MwNzIzLTIwMjAoODMpODAwMzUtNiIKIHRhcmdldD0iX2JsYW5rIj4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDAzLjY1LDM3MC41OSkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToxN3B0IiA+Njx0aXRsZT5UaGVybW9maWx1bSBwZW5kZW5zPC90aXRsZT4KPC90ZXh0Pgo8L2E+Cjxwb2x5bGluZSBwb2ludHM9IjQxMy41NyAsIDM5Ni41NCA0MjYuOTggLCA0MTkuNzYgNDAwLjE3ICwgNDE5Ljc2IDQxMy41NyAsIDM5Ni41NCAiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiNGRjAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTAxNi9TMDcyMy0yMDIwKDg2KTgwMTU3LTYiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQwNy41OCw0MjEuMTIpICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjc8dGl0bGU+U3RhcGh5bG90aGVybXVzIG1hcmludXM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPHBvbHlsaW5lIHBvaW50cz0iNDUwLjkyICwgMzQ2LjUyIDQ2NC4zMyAsIDM2OS43NCA0MzcuNTIgLCAzNjkuNzQgNDUwLjkyICwgMzQ2LjUyICIgc3Ryb2tlLXdpZHRoPSIxcHgiIHN0cm9rZT0iI0ZGMDAwMCIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjEuMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAwIi8+CjxhIHhsaW5rOmhyZWY9Imh0dHBzOi8vZG9pLm9yZy8xMC4xMDA3L3MwMDc5MjAwNTAwNTEiCiB0YXJnZXQ9Il9ibGFuayI+Cjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0NC45MywzNzEuMTApICIgZmlsbD0iIzAwMDAwMCIgIHN0eWxlPSJmb250LXNpemU6MTdwdCIgPjg8dGl0bGU+UHlyb2NvY2N1cyBob3Jpa29zaGlpPC90aXRsZT4KPC90ZXh0Pgo8L2E+Cjxwb2x5bGluZSBwb2ludHM9IjQ1OC43OSAsIDM5OS40OSA0NzIuMTkgLCA0MjIuNzEgNDQ1LjM4ICwgNDIyLjcxIDQ1OC43OSAsIDM5OS40OSAiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiNGRjAwMDAiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIvPgo8YSB4bGluazpocmVmPSJodHRwczovL2RvaS5vcmcvMTAuMTAwNy9CRjAwNDEzMDI3IgogdGFyZ2V0PSJfYmxhbmsiPgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NTIuNzksNDI0LjA3KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjE3cHQiID45PHRpdGxlPlB5cm9jb2NjdXMgZnVyaW9zdXM8L3RpdGxlPgo8L3RleHQ+CjwvYT4KPGxpbmUgeDE9IjIwNy4xNyIgeTE9IjQyOC41NCIgeDI9IjIwNy4xNyIgeTI9IjYyLjE4IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjQkVCRUJFIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIHN0cm9rZS1kYXNoYXJyYXk9IjQsIDQiLz4KPGxpbmUgeDE9IjMxMy4zMiIgeTE9IjQyOC41NCIgeDI9IjMxMy4zMiIgeTI9IjYyLjE4IiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjQkVCRUJFIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIHN0cm9rZS1kYXNoYXJyYXk9IjQsIDQiLz4KPHBvbHlsaW5lIHBvaW50cz0iMzMzLjA1ICwgNzEuNjcgMzQ0LjU0ICwgOTEuNTcgMzIxLjU2ICwgOTEuNTcgMzMzLjA1ICwgNzEuNjcgIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjRkYwMDAwIiBmaWxsPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiLz4KPGNpcmNsZSBjeD0iMzMzLjA1IiBjeT0iMTA3LjY4IiByPSI5LjgxIiBzdHJva2Utd2lkdGg9IjFweCIgc3Ryb2tlPSIjMDBDRDAwIiBmaWxsPSIjRkZGRkZGIiBzdHJva2Utb3BhY2l0eT0iMS4wMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMDAiIC8+CjxyZWN0IHg9IjMyNC41MSIgeT0iMTIxLjkwIiB3aWR0aD0iMTcuMDYiIGhlaWdodD0iMTcuMDYiIHN0cm9rZS13aWR0aD0iMXB4IiBzdHJva2U9IiMwMDAwRkYiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1vcGFjaXR5PSIxLjAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwMCIgLz4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQzLjU1LDk2LjMxKSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjIxcHQiID5BcmNoYWVhPC90ZXh0Pgo8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNDMuNTUsMTE5LjA2KSAiIGZpbGw9IiMwMDAwMDAiICBzdHlsZT0iZm9udC1zaXplOjIxcHQiID5CYWN0ZXJpYTwvdGV4dD4KPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQzLjU1LDE0MS44MSkgIiBmaWxsPSIjMDAwMDAwIiAgc3R5bGU9ImZvbnQtc2l6ZToyMXB0IiA+RXVrYXJ5b3RhPC90ZXh0Pgo8L3N2Zz4K" alt="Average oxidation state of carbon in Rubisco compared with optimal growth temperature of organisms. **This is an interactive image.** Move the mouse over the points to show the names of the organisms, and click to open a reference in a new window. (Made with [**RSVGTipsDevice**](https://cran.r-project.org/package=RSVGTipsDevice) using code that can be found in the source of this document.)" width="100%"></embed> <!--
<p class="caption marginnote">-->Average oxidation state of carbon in Rubisco compared with optimal growth temperature of organisms. <strong>This is an interactive image.</strong> Move the mouse over the points to show the names of the organisms, and click to open a reference in a new window. (Made with <a href="https://cran.r-project.org/package=RSVGTipsDevice"><strong>RSVGTipsDevice</strong></a> using code that can be found in the source of this document.)<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>datfile &lt;- system.file(&quot;extdata/cpetc/rubisco.csv&quot;, package = &quot;CHNOSZ&quot;)
fastafile &lt;- system.file(&quot;extdata/protein/rubisco.fasta&quot;, package = &quot;CHNOSZ&quot;)
dat &lt;- read.csv(datfile)
aa &lt;- read.fasta(fastafile)
Topt &lt;- (dat$T1 + dat$T2) / 2
idat &lt;- match(dat$ID, substr(aa$protein, 4, 9))
aa &lt;- aa[idat, ]
ZC &lt;- ZC(protein.formula(aa))
pch &lt;- match(dat$domain, c(&quot;E&quot;, &quot;B&quot;, &quot;A&quot;)) - 1
col &lt;- match(dat$domain, c(&quot;A&quot;, &quot;B&quot;, &quot;E&quot;)) + 1
plot(Topt, ZC, pch = pch, cex = 2, col = col,
     xlab = expression(list(italic(T)[opt], degree*C)),
     ylab = expression(italic(Z)[C]))
text(Topt, ZC, rep(1:9, 3), cex = 0.8)
abline(v = c(36, 63), lty = 2, col = &quot;grey&quot;)
legend(&quot;topright&quot;, legend = c(&quot;Archaea&quot;, &quot;Bacteria&quot;, &quot;Eukaryota&quot;),
       pch = c(2, 1, 0), col = 2:4, pt.cex = 2)</code></pre>
<p>Let’s look at the different ways of representing the chemical compositions of the proteins. <span style="color:green"><code>protein.basis()</code></span> returns the stoichiometry for the formation reaction of each proteins. Dividing by <span style="color:green"><code>protein.length()</code></span> gives the per-residue reaction coefficients (<em>n</em>̅). Using the set of basis species we have seen before (CO<sub>2</sub>, NH<sub>3</sub>, H<sub>2</sub>S, H<sub>2</sub>O, O<sub>2</sub>) there is a noticeable correlation between <em>n</em>̅<sub>O<sub>2</sub></sub> and <i>Z</i><sub>C</sub>, but even more so between <em>n</em>̅<sub>H<sub>2</sub>O</sub> and <i>Z</i><sub>C</sub> (shown in the plots on the left). <label for="tufte-mn-43" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-43" class="margin-toggle"><span class="marginnote"><span style="display: block;">The calculation of <em>Z</em><sub>C</sub>, which sums elemental ratios, is not affected by the choice of basis species.</span></span> The <code>QEC</code> keyword to <span style="color:red"><code>basis()</code></span> loads basis species including three amino acids (glutamine, glutamic acid, cysteine, H<sub>2</sub>O, O<sub>2</sub>). This basis strengthens the relationship between <i>Z</i><sub>C</sub> and <em>n</em>̅<sub>O<sub>2</sub></sub>, but weakens that between <i>Z</i><sub>C</sub> and <em>n</em>̅<sub>H<sub>2</sub>O</sub> (shown in the plots on the right).</p>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="data:image/png;base64,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" alt="Compositions of proteins projected into different sets of basis species." width="100%" /> <!--
<p class="caption marginnote">-->Compositions of proteins projected into different sets of basis species.<!--</p>--> <!--</div>--></span>
</p>
<pre class="r"><code>layout(matrix(1:4, nrow = 2))
par(mgp = c(1.8, 0.5, 0))
pl &lt;- protein.length(aa)
ZClab &lt;- axis.label(&quot;ZC&quot;)
nO2lab &lt;- expression(bar(italic(n))[O[2]])
nH2Olab &lt;- expression(bar(italic(n))[H[2]*O])
lapply(c(&quot;CHNOS&quot;, &quot;QEC&quot;), function(thisbasis) {
  basis(thisbasis)
  pb &lt;- protein.basis(aa)
  nO2 &lt;- pb[, &quot;O2&quot;] / pl
  plot(ZC, nO2, pch = pch, col = col, xlab = ZClab, ylab = nO2lab)
  nH2O &lt;- pb[, &quot;H2O&quot;] / pl
  plot(ZC, nH2O, pch = pch, col = col, xlab = ZClab, ylab = nH2Olab)
  mtext(thisbasis, font = 2)
})</code></pre>
<p>By projecting the compositions of proteins into the <code>QEC</code> set of basis species, <em>n</em>̅<sub>O<sub>2</sub></sub> emerges as a strong indicator of oxidation state, while <em>n</em>̅<sub>H<sub>2</sub>O</sub> is a relatively uncorrelated (i.e. independent) compositional variable. These independent variables make it easier to distinguish the effects of oxidation and hydration state in proteomic datasets <span class="citation">(Dick, <label for="tufte-mn-44" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-44" class="margin-toggle">2017<span class="marginnote">Dick JM. 2017. Chemical composition and the potential for proteomic transformation in cancer, hypoxia, and hyperosmotic stress. <em>PeerJ</em> <strong>5</strong>: e3421. doi: <a href="https://doi.org/10.7717/peerj.3421">10.7717/peerj.3421</a></span>)</span>.</p>
</div>
<div id="normalization-to-residues" class="section level2">
<h2>Normalization to residues</h2>
<p>As with other systems, a balance must be chosen for calculations of the metastable equilibrium distribution for proteins. Balancing on the number of backbone units (the sequence length) seems a reasonable choice given the polymeric structure of proteins. <label for="tufte-mn-45" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-45" class="margin-toggle"><span class="marginnote"><span style="display: block;">Balancing on one of the basis species remains a possibility, using the <code>balance</code> argument in <span style="color:green"><code>equilibrate()</code></span> or <span style="color:green"><code>diagram()</code></span>.</span></span> However, there is an additional consideration: owing to the large size of proteins compared to the basis species, the distribution of <em>proteins</em> in metastable equilibrium has many orders of magnitude separation between the activities of the dominant and less-dominant proteins. The metastable coexistence of the <em>residues</em> (i.e. per-residue formulas, or residue equivalents) of the same proteins spans a much smaller range of chemical activities. In CHNOSZ, the calculation of metastable equilibrium activities of the residue equivalents is referred to as <em>normalization</em>.</p>
<p>To take an example, let’s look at the metastable equilibrium distribution of selected proteins in the ER-to-Golgi location of <em>S. cerevisiae</em> (yeast). This example brings some other functions we haven’t seen yet: <span style="color:green"><code>unitize()</code></span> and <span style="color:green"><code>revisit()</code></span>. Here, we list the names and relative abundances of proteins taken from the YeastGFP study of <span class="citation">Ghaemmaghami et al. (<label for="tufte-mn-46" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-46" class="margin-toggle">2003<span class="marginnote">Ghaemmaghami S, Huh W-K, Bower K, Howson RW, Belle A, Dephoure N, O’Shea EK, Weissman JS. 2003. Global analysis of protein expression in yeast. <em>Nature</em> <strong>425</strong>(6959): 737–741. doi: <a href="https://doi.org/10.1038/nature02046">10.1038/nature02046</a></span>)</span>. There are six proteins identified in the ER-to-Golgi location; one has NA abundance, so it is excluded from the comparisons:</p>
<pre class="r"><code>protein &lt;- c(&quot;YDL195W&quot;, &quot;YHR098C&quot;, &quot;YIL109C&quot;, &quot;YLR208W&quot;, &quot;YNL049C&quot;, &quot;YPL085W&quot;)
abundance &lt;- c(1840, 12200, NA, 21400, 1720, 358)
ina &lt;- is.na(abundance)</code></pre>
<p>Next, we find the rownumbers of the proteins in <code>thermo()$protein</code>:</p>
<pre class="r"><code>ip &lt;- match(protein[!ina], thermo()$protein$protein)</code></pre>
<p>NOTE: It is more convenient to do this with functions and data that have been moved to the <a href="https://github.com/jedick/JMDplots">JMDplots</a> package:</p>
<pre class="r"><code>y &lt;- JMDplots::yeastgfp(&quot;ER.to.Golgi&quot;)
ina &lt;- is.na(y$abundance)
aa &lt;- JMDplots::yeast.aa(y$protein[!ina])
ip &lt;- add.protein(aa)</code></pre>
<p>The YeastGFP study reported absolute abundances of molecules, but the thermodynamic calculations give relative chemical activities of the proteins. In order to make a comparison between them, we use <span style="color:green"><code>unitize()</code></span> to scale the abundances or activities of proteins (in logarithmic units) such that the total abundance or activity of residue equivalents is unity. To do that, we must have the lengths of the proteins. Here, the first call to <span style="color:green"><code>unitize()</code></span> generates equal logarithms of activities of proteins for unit total activity of residues; this is used as the reference state for <span style="color:green"><code>affinity()</code></span>. The second call to <span style="color:green"><code>unitize()</code></span> scales the logarithms of experimental abundances for unit total activity of residues; this is used for comparison with the theoretical results:</p>
<pre class="r"><code>pl &lt;- protein.length(ip)
logact &lt;- unitize(numeric(5), pl)
logabundance &lt;- unitize(log10(abundance[!ina]), pl)</code></pre>
<p>Now we can load the proteins and calculate their activities in metastable equilibrium as a function of log<i>f</i><sub>O<sub>2</sub></sub>. The commented line uses <span style="color:red"><code>add.OBIGT()</code></span> to load group additivity parameters that were present in older versions of CHNOSZ (Dick et al., 2006). The default database contains newer group additivity parameters for the sidechain groups of methionine (LaRowe and Dick, 2012) and glycine and the protein backbone <span class="citation">(Kitadai, <label for="tufte-mn-47" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-47" class="margin-toggle">2014<span class="marginnote">Kitadai N. 2014. Thermodynamic prediction of glycine polymerization as a function of temperature and pH consistent with experimentally obtained results. <em>Journal of Molecular Evolution</em> <strong>78</strong>(3-4): 171–187. doi: <a href="https://doi.org/10.1007/s00239-014-9616-1">10.1007/s00239-014-9616-1</a></span>)</span>.</p>
<pre class="r"><code>par(mfrow = c(1, 3))
basis(&quot;CHNOS+&quot;)
#add.OBIGT(&quot;OldAA&quot;)
a &lt;- affinity(O2 = c(-80, -73), iprotein = ip, loga.protein = logact)
e &lt;- equilibrate(a)
diagram(e, ylim = c(-5, -2), col = 1:5, lwd = 2)</code></pre>
<p>Whoa! The proteins look very non-coexistent in metastable equilibrium. We get a different view by considering per-residue rather than per-protein reactions, through the <code>normalize</code> argument for <span style="color:green"><code>equilibrate()</code></span>: <label for="tufte-mn-48" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-48" class="margin-toggle"><span class="marginnote"><span style="display: block;">The normalization step is followed by conversion of activities of residues to activities of proteins; that conversion can be skipped using the <code>as.residue</code> argument in <span style="color:green"><code>equilibrate()</code></span>.</span></span></p>
<pre class="r"><code>e &lt;- equilibrate(a, normalize = TRUE)
diagram(e, ylim = c(-5, -2.5), col = 1:5, lwd = 2)
abline(h = logabundance, lty = 1:5, col = 1:5)</code></pre>
<p>The experimental relative abundances are plotted as thin horizontal lines with the same style and color as the thicker curved lines calculated for metastable equilibrium. With the exception of YNL049C, the overlap between the calculations and experiments looks to be greatest near the middle-left part of the figure. The <span style="color:green"><code>revisit()</code></span> function (<a href="#optimization-of-chemical-activities">see below</a>) offers some statistical and thermodynamic measures that can quantify this comparison. Here, we plot the information-theoretic free energy Δ<em>G<sub>inf</sub></em> (calculated from the relative entropy or Kullback–Leibler divergence):</p>
<pre class="r"><code>revisit(e, &quot;DGinf&quot;, logabundance)</code></pre>
<div class="figure fullwidth">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAD6CAMAAADJGzJcAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAeFBMVEX///8wLzEiICB82/Wura3y+/vd3NwLCwtGRUh1dXabnJzs7OleXGA6nOjQ+f7Gxsap7/khTZr//eEsdMGAgIGNjI6ZTSMx4uXilUb3s2H/+LtizlBeHUzzv8fqmKTR8sz82oreWG++dTaX3Ya06ax72G1MlEWfudTj8qL/AAAgAElEQVR42uxdC5OyOgylldICVXyA4+rexVnR7///w5u2gC90lSoPyZnZFcUKoYeQpGnqOAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBALRDfwSMpuojRUhCzZEybeUEDJCJgwBX7PJfDlWnS5gYzRIyWcMeTAUQFfrTl8tzN/wJP9Cug8JWzFVj/ax6njYCH0Fof5JebFJLj89fpdUNtCborKBeS/+OthlA/nHweLwWcm/qDBWzYAkv8AgJF9RZbJuhTZhSrq7VP0CVz8m9CG4PpjalGZTlJtUf8s0EOcNTjY5OW8gj0cgvKqBPoIwDcR5g/xbsqJBfgT3WcnX/5ixaoYgeTXqSU56KLnRcCfGjCvUW+rBv0SqTa7uHT+Gfx5X72UA/yKiNoVbNuBuRYNQN6Dq04heNKCR+i1aNoj9soFM1Lf4RQOiGgTmCF5FA+94hKckL6QfjuTXdK8ledw/ydff06Lzc1fVHMdV9qynDuYoSZ0oKkWP1HGZPoKrzjl0S0lOGpxsiriqgT5CLKoa6COYa3XZwHxLX6vLBuYID4teSv61KLT750tehN/mJixVvK0necD71ufOihMQWXX9itAT0atNPH77h7RqqIZWDdUwN24lzI1bDX7bWHtY9FLy+RJeJ4OQvNRp4J7DLX6h4j6/z28+2G7su7Prdngjun1VzN1aHThxa52H9SP9kyU/Db+tv0cXBuwQ+9wJqLRo3TJcSYO30L0HeKDTy3iEM1/yBTuGJ4QXhv2UmoWhZ0f3JOptl0eJBd0DEvRYcjj7J+iuCD8u3/oc4D99vZIOyF3v1Iek4+4814Leyh088lwrrZc5UxsPGTO3Efv97/MB0/3zJS9909XDrirSHeneW8l1+E1Fo4pA5J/ROKQ70h0l/xi6Jz23YBOke0OSdyaYQ20iM8T1+hufcAkGIocmecjRmKkjeZ9vdA/Ovv4TndO4t5LHnCdI9zqdLvprxiXCotNdEtUwTKJujFKElKB2R8mH4qpGFCMzKPlg6O77VpEZTpLednlCOEZmhkV3xq1yZsCO67HDFhHU7sOiu0twmAklb0DybriqIngb3Vdq0v7XbPtt6rOYAi2nM2Pmv0LMUpWHsYKP5t+jXnV6rfhERxDaPNd6PLQY8sQm6fsu3VVC0fp7lNNd/d+SqSnYYtKNVBGL5fh34ThLMjXf6A/dwWvpcfTZxmvpcepzIh9Kfa73YANqA5dP6K6m/emCLSaZdCuma0X6yfr7dwwaHo2ZD5a8E0kE6plmF5m5N8L2K8XkhO7zlak7J6b5VAFt2MA9sJ19LUzVomZ1HMXIzKBcVT2Z2zIyc+euXZOxU9AdTHc+mzqmYIuhuzJmYAuU/Xj9nRZz/XtiwSLd+0d3GTvvTADW3udRu38p5a4LthhjJp8fs1osR/NlMJsMoNOR7i2C6eozT0h+VQfXFcxMMGf5q3N8ZZrurKD7VBdoAd8VdhxdVdDuWwImz69YsNs/hXRHutsjEM9Jfl0H191sNsqaSeE1U8yE173asVM7gO6wg1NKZ1sKO7ZktOKc8oWaGSM2m6UQs8lmQwn8ND/c+aldFzvd63Eg0rOapVtnOn4QdOIWf2o6/lUd3Cu673Nu7p7ekd1r0T26J1ZT2luGb5MG29diKx5nTxdbuaiDa1vJ4DGk6Xu63ObU3cN+r+75dL/f69Pb7XeZPtmdeYWzfuS0WxqMG6AZ5/tPSH6jDq4qsdPPiueWJXbUcy3NH0pnttf+cgfcD5r/YZpWmD8tDcYNj+6MR89KfqMO7uc7bPOrZXpcmZM3zJV4weYwywy7d0btn90Hun4nqH925hC1MBjXON1bL6vkkmclv1UH9/PpbqqCOle1jx97jJj7IN0Z8+dE7e/U/dDKYNzwIjPF5LMaFYAfqYP7SmRhy3TX9/rIuapsX+upmmZanjBX+2t62GVND8YNju7aUbWUHERvIhqXvikSGT4uuq4K6pyuW2JfGDRMNe3n9LDZKLqDk0saGYyz9Fpq5YK2TXffVM62GklvKByXvYfuD4bjjJPuGGPGsjBo5Z30PcpSRffdZsMzOM4C3k1Lw+liMK79mFS9XNCW6V44qla5oA0ZM+/S7k+4qiy3YY7GzCFz2A7OS/1luxD+UtDPKXiiT+6YL/eZsz0cKGh5Os12akSOUnEAjX44LNhuI8Rh58wP4OfuDqN6x7jaMbSMyMJR7UPRPLZLW6b76tpVlaEZECj+wpSBWR7qP7sd4R58WfiQ6RDO8duvPMbQApHHKik4ee8B7V6ERywLgz58g5uHWrvpE+XS6Fr4kzyp/nV06agi3bsreZrpx1oRsWxY8pO1mfSgV5k40sO5qr7vvIbuQ02UavBGLweqmqX7cW0mPej1ZUf3Vl1Vk/prT/eGEqXec0tZJUo1+lxLM63d95uXafmn1mbSgdEyT6qHdA/ES57og4nMtHajn+mo/atyQx+60U/orga9yjypenHMVulexNr7sTZT+vJn+Sts9xZS48IsT77M7LQ8C58yZspUqZ6uzRTR1/T5oOneXve9QMs/46qaVCnLPKk2XVUZ94ruocmgRboXyjk1KfVZfSX/zNpMJlWq6TypF9LnbA3t91Ui6Ppl6HslAouIzZCGmWL5IskHXEurC52e7gzda8xdH1ASAaPRq+iOw0wdAKsRoBxQAvAxXQbpbvFc684KRU+7rlb10/qWEXlWFLIPGZFs10FXtUteSx6gfHgKu53X0q9894iyV0mOgchOud75rMC6ks8j9j7JW6O7jF/W5w0tt/gmulstt9hFMy7bP3yhqjp9/ViVg5pTs1sqq3QehXRsIzOigRnm4XvobrfcovwPABv/5a+heoVLy/5rcYenP9hl7K8WjdO9LfjydU/0pkRP3zReb2PMLH9+fhR/fhTg/P77MR+EP23v+AGj5q8W1XSP/3kfRvdi0l6dPq+otoKByA4CjJqshuTrb19QLvx/7HPoHoj6fW5TbeXT6J7opEKXhFwZpZSF3FxeQrRPJuHC+EStwhlKSknThqsp8LS79VSsNuO0MRNGiX/fpglqrc3UUlkl6l7aoE/ViHxZtRVrFMUVKWBR1CWCF/hYPYXGTM82+3e3uKJVIBKuG6NeSGl4pLtHwU6I1HUR8A3GiOcInzkeaSNBKsvL91U46ZXhuLV8yHavtzZTO5GZiyEmx3lqbaaraitwp8cNLExVFVA+Ka44X84mhu5rPwC669lmIzPb7GZxxSjwbVZhc0VEmO87IUn8I90D2E7Uh5FQr06cnCWfNmy3glGTdsWMa4fuIqgpeXW1lZhT8v5lB6sjMyfFFcuaoqYWt3rw/OazzW4WVwwkoTy26XQpQZeHxAEVXtDdVwaOBAUfCa1ZhB/INq01U62vogjbMOh+PsT0tKt6XW2lmQTg6jHyk+KKy/Ep3bV2X5jZZneLK9p1esihOdAdqF3QPdZ0D2L1GdjuQrZMd419RUGDSsnnyV9uas/oLmObPl+15KreiLufrHR2Tnew3cVykc82u1dc0VLHUU/T3ZHuuTEDPirhmuZ+UKVgGkQCpxEe6IYTSsGJyB3qiPAqyX9nMVzSdTJ5A93byIj0eGjT501XWzk6XelNt7nKmHFye+vP4oovortHC7qHFNxT5cuAdvfAhgc3VkhgmWhrLo86G0ajFM6OSVHQXQb8xjDT+lvSxTvo3gak/9o+b1f0cmG/+e+MndJ9G6t7Mp9tdq+4os0KRWIWFHQHFwboTimV4LubREllzEiq4h+tBCJPzFfjUCu6b/gmysOlggfVdAcj8K/wTG9WzQ759aCZ3arZ9ZalqtFpUlSAEyGImlxOi9f8HeVqF9U7hNlLrpuDq1pf9GAxHitisEnHFy/xtUOtaL4jh31uzPg36f53Re16cfcW5qr6FW6TaxONA9H9JpalSvibYBGInI3HiuijMWA0mk66q+PUI0bTXMS5dneiamPGD9y/6d4XV7VKuffDmBFcBJdIrt4kF/uS6+9d4AUZkZNxgWlH+a5NLkVzNSjGddWetJLu8yiRhFP5Fle1ebon1efZA7pvNu8xfp9fm6mqMOhkOlI6Xn3K4GXSUboXrqqqtBrzW5LPoyD+CLpfTFHtEd1Z63Q/ZgvdrJSoP2dKzZtbgHWJ7hE40pxIKbQJp/5Xxt3df/MfGbCPMGZuKPd+0N1tl+5OkS30V2FQ0PTaqMkt+nY5H3puEEvlkl+AElol+VIIf5YsF+/IiGzaVb2l3K3o3pCrujm84yiu/7iXXmQLlYVBE07EHdlHhUU/aoHxYeQmvolVlVAjvHHiupEXumpfdUakWiXnr1ke/agtFJAbl4ZY0b2RQCTh76B7lDxE97NsobIwaMKFvCs7A0Wv+K6jlQ0FbljkxpKckdz/n71r7VIUB6K8AoFEoBXsHadhenr3dP//f7gkAUQlEPIC7Obsh9Z11JJLUY9bt4okuINnk5HyCMCXOJ2F+5Y0GCZCuHHEKGkw2EpVzcBdZjcTxT9lC3nYYXx38hRpMzU5LGmoMsY747rHEELgINyEDy9mAY+yhMxm9MEKIaqGYKHlH+RLXswEM5ZJBBznvo/KzOpw79lCA2FQ2p4Pr3AnfjNqGe+M605bq4kD4/Rw8r5IZG8img+D4gr05pYTiAgKjFPEMgL34BlSVS/4gbuCd+/YQgNh0Gt7voe7E6GSksQY1z10EYIZY7yDPqLX2JIKk7gLXTwYJwti6nHLqxjj4svZP9z5zn0PcP/8XL8y82g547sTrozH4A6aX5kx3hnX3YmbqMIZUICBry2BDZuEswvQcbI4eRwPZmCTy5ZuH7S1A8lt00FtPtku3PnOXU14w8M22E+/f5tIiBO1aaZhe57F7hEMW8Y747oTYODylvEOUubilRLSErfRS+PSQ20Xepujdqnq/SoyNdK3VbhPOHcu3C9NtoOSmTFdO+w4M3DnsuOELPfKrG/Pt8EM8ent+J5DuO5FQa6pEcZ7TkP4XMLLg6xonbori3RuTYqtLejhfreKTHGkx6asEphw7jy4H8+fzU36ZRPcZzNw55kuZHni4eAe7g4sW8Y747oz785lvOcLvTzIukgdlplSNMThBf7jxmUZu+3c190qsv6h6oKjFZ37xFe/vFxenF9fG0lVbcJdzHJc115dVzVdUEvgXiEURhlgjHfGdY8hhTqP8Q5ySrBJDwIFm86rN9FjaM7y5obU39XuVpH1D8ly0U33mbgNVQcg7nLRC/4Tg2O8Ce/u2YW7kOV/u6Omj1H/+C+DLtHtoop1s9DIGaESTBRgtEKda/ktZ+ZuFdkWxFYEE0ooU56o0/Mpgd8Q7mKW47o9WjjXPdzZE9Xd9UDkGjk7l3OfX68BQczSUn1Q51p+y5m5W0WmmKrak1XiO/eZyswlxjO3dDuSqE5kBO4TkqjzlnNPegdZROUZ6yvce/TXI6Afr9eg1q3DYtb+smvyuq6H0Y2mGQ2pQtL1zUjbtySRLWdW9YYzc7uKTHE+2V5lpoCOHNwFch4rgteO65r4FMuC11Xd3QCq9n7QRDsDf99G8qAjzGcFG0XEgVCkPGjyxvFQ04z1djP6feMGdNBDTsiBuwhnZuNwRzOucRfjHVaDGbHsX64Ei8KqRXsf7dTV8AU+pZVlLIRxC+EPGTR5AziUAWl7u5C9qIkMiyDDo2OLJjkz1uAeY13nfHKm57vBXb3BVvX+vgt/kMM6ryeKdZgsKoDgbgYbwfJG04z2doPmlGEAIpThDCfjvEAxzkwZueV24R5Gk4EAdzfTMSDTnMFQVkpgpscU3P9YhPuI5Qbva6jq3D2N8+s69gjY8dfSMUDAmryuS6r/A00zVv0PA9YDCIoEeI43daHPUcSk+O62apd4+rIKeXz349lr/AW8E2gRm+nRHrvD0CbcRy03H8Zdazm48bD+Ym7NtevlDIMZ1tulj3HzsPkpYeBOwP0yI0aw6UJkFiGpc+4c45xUKP4MVZAfZnpiwq02X5uJIv2+oSQzbbGo5TZOehOve+7buctl2/KkOGX4Ae6sw8u8exPUEDJy6LqkdhE/69bs+UIht82UEqGuTlxxfKYncB9mZfYCd5QFHOGNO8vtnPSwoPE6zkjvr/P25aGbh1oM94GmGS1EAswWLZCplCw6HMbbTKSlekxMVGbszKoG84qcXM4MLAr40sctzuhMj50r3QTcp4KZB8sNw72tr+PbLJE2ahvE15W2mRCQUii/vr6OE4Bx49OORoIZO6mqQGWZd1871kXRePHBTz020/OEcB+xfDRh05VPBJjVYcBIGstqN7Xj+7nqx6S538D8lcZJXzwC8Pubv2O4TxF/Z+GeYHxbnRib6bGBdvD52y7cHywfCf019ZNDWmB3S76BVVVXVMhDvroBGNLJQaE8sZvpHX7NwJ1wQbcJdzTffOdrRH68JImZloME3G0WIu1ZDlgQE8/HtaQaj2hLCkhD3c+v8q380ex3152De7nR3Uzx/OoIrvoES9jwnAiDDeazIbjH0XjLQchyDXDPWBATiAIYNIFNWTaQX+Lk0w7qQOBCr1KasO40VZ3pMAlUZi6zJz200D5AZoIZHvdZ0HLV7JQwYrxymWFZE9OcetLZnFenFJxX30/FNhRd3nAiUAXabCESCsnf8GL3DxjH7mkLpqMoMvQDBStZzhw7Xu7xKDf+NBc7g5QGMP5Sy6sCurPrmbYK90BsLRC341CX5ZfzHeFu2HIg5dj76OTabh2lEncVmCYrBRIn/RjE0ERlxjiJYHJAdc7yy5ltuNjErGpoE+6ilssqJYaxpGPvzyto5bVpXf4W8X1eOj0OyFdKvJTHnerMFFD+nDvHLAvof+C7wV3QckmlxAAqOPZBTEPj8ooRKuuwL98IQJ1Cg6+U+AHd4mvySt/m1myxPFVxN5OdykzofprQ0eVVZgRxK3FDLz1aitFlQH7Iq3owHpgTrKfSF3p7uX9l5eScrpy2kGm4i+WpRFtISRLVBq8zNFOIBMgqUYpFMbFGbifbndAgPvNZ+0h8LZoKAXiLwUwgvL52+9NMoeU206jTOzMKjax0XEaiGDfRepciQTxw8r4KUyENlh/PM3nLFmWVkJc5P3DXaPovSOEuN4/PajEGdgl3qSkL5e/nAKUsvzQ3ewRWP+fLDoyd54F7FrnOynC/4H8p3GXUVlChO4ppj7TFeluXRPVN4irt3U8hcPYF9yxCluCOgA1rPBNvuyB2bzw6G1i81dISsT3EWmoxXKynbP/ZAPB/qzm7uVpa9AsHse3BFtUTuUTaVkkB2EplxhDcBSszZLClceh3cBdUSmQhuwG57vR1UIbJr4N+FPHVnN3cr35JLsWMlopcx8GkrFK84E6rtJvJVjDjmXlj4Sv9w4Vu9AKWBjOBkZCdrbT0b0qO6UCVqaqBiuVVMu3d5ToOBiszWSQeJ+5hN1MWfYJ14e506gsLUlWQUEUB3SE7CWJGn38Y80OVkVv61gqRYFnjaAep6gYqMwTuZEZfVDoO0dnTQnPIDvIJ6lea3z7+O8EVfiK4x9B5LrgHn7//Wx3uiyxHMc1PNd+T2gr7ZN+0CXK6T60eJcqeEO5LQhlluFtZKZuZgbtS2hLAkHtkrBgT6j1YJeZr5lXZ6XTqX5O1nJrHY/SkN5Ha5Q2W3eXUddSc97cmkFNUjjPFiARLFw6pVWZsrJQNPCOxu1LaEkT7PsbIceeDc3kLzoce/K3gdZwQuFuW0jITyuwimFm/zTRyoUexA8jR1kraP2nlEWbkbzB4evgn/+mR9wPXiD0f+Ydjr07BzadXdT14NX16vARLRrOJ6PXL/W4mqhr3a5NwDzxk8JyrMkeeB+7ByWf9nQOharUad3mGDy8RfnjayQ8+qxXSpxm565A2/zdva+bkveafTlspPbLfZvDpafcxg6f96U8/cYQ3jhnoRPMGy2oo3AfKcRLdFjOzqshbdAaXfnUl5ogC3OH24A7HnpOtPHJjNZAyh734TR7lx6phnWaU6U9Paa/vfgf3q3KcaD/ZQqoKl73rTD/54fpXYI48PdxpT0lvmZ1EMZIbWNnIU3oD9wGhZtTyX3Rsr4ta7oKZ7qktVWZKFxg854/MkcQrLWhEBtBA3T3MktJNtMGdgj3W+lMwVoz0RnkG+AEe2ChINXHSm4AFQ8+/S1XbYEZNOc4E3JfWIBfAncscsaAAnJgoRPIVgCXgbgzsudJb3Ec0qAc8Tz8tSK4qM91upvfml3JPispxBuCOpJaei3t3SebINuGuMZgxAPb8VXwQbxrwtxcMkWYimzAnlAiglxuoxhlIVSE2fs7f10hVE3cDJIL7m0PkxQOwa2ULtIVHLb2GxyumqpyY13Gozh5OdrLOQCZwl4D7EuaIJrhvMlVl+mmmwJ7rbKz5d5fOeH3i2Ny9k3RW8NrSclEjgfvUclGp+oSR6zjCG4S7GbA32FQN2R8voMN9TMMRzaN19VnBaympb90kgtCTOnehGt/dyl5VQ3BX3qtqAuwkR811W5o+bCge19IqiXvfhb47cGXJK0qcGfV1i+vBvVTRHAlgpj1BBeq5KRfwQOykZ2cP7gHuWDqs2D5npvS2l6oGnm6wk8qjb/R3zH0wb/kxibe/Nbtw0RPDfYuFSANgfzXn3ekxCOH3zXcPvND5gbtN08vILfYF9kHbibs72tw51ymrlEWZ88RwL+AGvbvGwRZgBezkaHkFSvWJxIsDZ81DsijDTlvsKVx3cmqwG0lVldRg9V3o9sDutESaXOlCl9vNpO9AKqKm3N1MgqbvuDLD38JmEe5Wwd5FNKmz363ZwFUDww5i9822mdTBZxns5CAFGuuW65JVAhA7P3DfMdwtg30ly3VVZjAEzw/3DcgqbeuW/l3hjl3kPDvct1iZUe4nN34drAX2RK2fvB7cY2W0K8HdTlGqhL//NZGqqhSlFNlCVNF0NbhnKmyhRMpyLXBXR3sYuMnW4V5sEe4q9zXaVcpXQ/sa9zUdjEgNvr1U3M1kKXZHWzvpKntVfW3DG98qa1GP23cSu2+gMtMq7ChKxznt9IafOs4P3NdA+08hUujoFHZUtbRyJXWB/cJddVYVQE1LHn+8u8DRKewoSselr9pHlXYCd8VUFUEIVreckAiC3cJ9AYmgV9jppeOKyIWLbc/XzlBbu6EbFbuCe+jiDVzoluhCpWek7i5IF7pR2Oml45II4sW252tnqK3dGCoRgENkGe6ZNp3pRaJ5awUzrpFCpMxuJop/ewo7WwxmrpIjtuAeRNp4iPEikXNt9Ymdwb1PUmWl41Lffxa4W09VCy9byXJd9Yml9m6ARMAUduSk42il/XvDXSFJdcOVLP+/vatdclQFokJEQR11kpiZycyPqana+/6PeAEN0QQSv1CIfarWzcq2ePQg0GL3TP4JDz0zU2567WknIPdxw/aMrMRc55/AyP4HHlbknmQIL+KfyN3wtA+/6d3cTBNTWIxcRFDFySoN3eCfwKyyH1jJityjsJqyZqbvaqF854invdNW+zC/zc00LS7oqKnq3AOZYU/3tfwTLg5m+sndxXFMX7nfpDOYGPV5jNxDzMi693yaf2K03B0Mq9SHee7C8pixzG+S1bRj+o8IjD9c7mmG536nM/jUp/gnxsvdBUfkcLkTF8cx0+UuQqJG9nMzJTibfRksiSaGRAW5m7FzcRzTn/m8g5mBYZUiiovAtXsuYmktEOv7iK3IvbIcS4u4OY7pe9NvcjMtmcIiZfGRBO7JfVys7+Fjd2aDfFQgW093QgK30c8R2c7NdE1hgSzfclLNnMBwPrkvNFVlzlF/GD+tXPE71D6YFj+Ni7+yqPgE02Llhg5y18ykkkf+GKef7RPjp5EwG6z4nmGVSIKR3SXlIPdZmbvsj5mFuczNNFjxvTwzaWVb7D7kZjp69Gm2m++VZmXeBN6QimfFfHKPWExtfz0xKUGRWPt8XEDu+PuflcPO7pmRj/Y8CF5a7i3mBcNxlqQzyD1NaMwit5nPGuV8cbmnc3tm5JKBMgi2I3fxvOTjA8TCdIrcRUdBE+I68+XWu/9z/KarKSoJNiZ3odbiiJ5J3rwiMk0yu64e3+TO4v+cWzOTHD52EiJJr8SHTHUtUaqdXP7l7rKTXHYGamcuvnO6ORDfqbFpH0hrk+/6V/5xmHvWwiVPY5xVw3p7EjLEZ76RHw19w56ZirKkFOBPdfm3WDJQ/ypLPnpvfpUk0OwM1E7CR0CqWLvz3iZXxeUTG1PlCaNW3icXSYZiTFlYPO/kiPzPvE9YuD/04enugSOSlD5MUZtztbj0mcuYUcxFnx2TsEgvYlbfqpKoCCvxPxDvChYf+k3LzVTFtpS4gNxZPJdnhgS+wfZKfxKFCcuoSD6LEaKUIiw2SOxANKvCYp1rNk3uIU3JInK3UQtJ53m6E1/cMdYm6Q8vclQUYRhmlG+KIko9Zr7YYMblBcClJ672deSu5l/Mf+ZLyd1hR6RP3keQO8h9LHP5gs2PBTJ3SO0tfTahKEDuHg9mZJJ4Tx/taySJf4V+bdueGW8WyMzdr4WRt2KftkTsUUsnsxVd5E7mrmzSCNa89nH283SKeRXTZHiNaeQE8yELgFUk1D4RpVJsPtCDz790H000ck/M0WYiZK4Mp9Nvuob5wfhon5F5gxWZD3rEPWB+jL1jriKh3nymS64t6tqs0lhbJLc46u5tFdXUu3s7cie6w0bYXFmcdht9q6i/3O+ZyymqbebNZkXmJrkPZd7I3SfmX+0IYq0gDPKRlUhJxpKa6C+iWDGp26Fcul8bxOGNwVFdK5x1DQoql4iJqWqGFRNpQKQBEzWEsWJStE5JXit5nasbg6aGcDxzGWfHNvOmhhWZm+Q+lPnRP+YqEuo1xA6NOHDIN8dM/IwLvskY34Sx+Dc9itreLCcAAALPSURBVJ9Y/EQJ3yTSIE66BkwYFNIA0xsDxI8Xf3+LY2GdQSZqSOrKLgaXU6orEz9Z1jWoa+gv95WYNzWsyFwn9zHMmV/MRUhUFQlV3fQiXgYI2Tlu4TxzWxjvBt8Uc9mTtwJMbQfbZb5RqEiorQBTwBzwoqgjoZ5/ShVRCpgDAAAAAAAAAAA+DGj/KH3Prxmr2lM7hPgYd/+H0NvdQPdSJo11RfVWWxT8ImSwur7n15hdEsLqz/E9B+bA/Km7gh/t9GbyVfCdX+8GN4YsE8baIrW9Lzr/7PZ/+qLfd2KaZu5UQljteex15wHMgXkXv7Q8n3YmTzTfJ3b/6Q4rUvhJY21RYHBt851fBn4PiuSxLglhtZXx6wnMgflTyD6hlcKnDeG0ky1dQ0KUBfoORRY1W03R53tmslLv+TVlhgeBrGZ/iod7FoH5tpiLN+t1gqo76qKo7vX4GIl2qV/LLtmtNEXBbau9Fn1ycgYr9Z5fZ3YIutTblQXDOjZgvj3mqlv4PBg6tsvhdB2bKHtopj2XU3ONH1Sm6w952b6TELZrticjVgUA8+0xbxqrftoix0bnY67romTZXUu/FukHVvURRZJLvZV6z687YhBoOjZZ9Dl2wgbMt8X86pTSvFavh0jCKWUYxmmdUs+GcWK2jQxWKterzsxAvTnH8e44YL4Z5gAAAAAAAAAAAAAAAAAAAAAA4CfuF/2cf7bhIgXm22Ouob6V7/6B+faYc+r1q7f9CWXyPe8XRm/AHJi/KvUv3o+d3niLP0vOmwlzAcy3x5xTv665ky29WeSQZa8+mgPm22N+T/1XUP46EP4HmAPzV+zY9nXHhuU4TjAWnyqeszwiwByYv9605XCdtsj10TX1z4TlwByYvyD2BWlNWJqObV/lwByYvyL1E6KtDwjktOUMzIH5dvDHkhyYA3MAAAAAAAAAAAAAAAAAAAAAAPAK/wOzDEkgTcaVkwAAAABJRU5ErkJggg==" alt="ER-to-Golgi proteins: calculations without and with length normalization, and free energy difference between experimental and calculated abundances in metastable equilibrium with normalization." width="85%" />
<p class="caption marginnote shownote">
ER-to-Golgi proteins: calculations without and with length normalization, and free energy difference between experimental and calculated abundances in metastable equilibrium with normalization.
</p>
</div>
<p>The minimum free energy difference occurs near log<i>f</i><sub>O<sub>2</sub></sub> = -78. This agrees with the assessment shown in Figure 4 of <span class="citation">Dick (<label for="tufte-mn-49" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-49" class="margin-toggle">2009<span class="marginnote">Dick JM. 2009. Calculation of the relative metastabilities of proteins in subcellular compartments of <em>Saccharomyces cerevisiae</em>. <em>BMC Systems Biology</em> <strong>3</strong>: 75. doi: <a href="https://doi.org/10.1186/1752-0509-3-75">10.1186/1752-0509-3-75</a></span>)</span> (but the updated group additivity parameters make the results slightly different).</p>
</div>
<div id="getting-amino-acid-compositions" class="section level2">
<h2>Getting amino acid compositions</h2>
<p>In the Rubisco example above, we saw the use of <span style="color:green"><code>read.fasta()</code></span> to read amino acid sequences from a FASTA file. There are several other methods for inputting amino acid compositions.</p>
<p>R’s <code>read.csv()</code> can be used to read amino acid compositions from a CSV file with the same columns that are present in <code>thermo()$protein</code>. Note the use of <code>as.is = TRUE</code> to prevent reading character data as factors. The <code>nrows</code> argument can be added to read that number of rows:</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/protein/POLG.csv&quot;, package = &quot;CHNOSZ&quot;)
aa_POLG &lt;- read.csv(file, as.is = TRUE, nrows = 5)</code></pre>
<p><span style="color:green"><code>read.fasta()</code></span> reads a FASTA file and returns the amino acid compositions of the sequences. The <code>iseq</code> argument can be used to read those sequences from the file:</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/protein/EF-Tu.aln&quot;, package = &quot;CHNOSZ&quot;)
aa_Ef &lt;- read.fasta(file, iseq = 1:2)</code></pre>
<p><span style="color:green"><code>seq2aa()</code></span> counts the amino acids in a user-supplied sequence and generates a data frame of the amino acid composition: <label for="tufte-mn-50" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-50" class="margin-toggle"><span class="marginnote"><span style="display: block;">See also <span style="color:blue"><code>?count.aa</code></span>, which can process both protein and nucleic acid sequences.</span></span></p>
<pre class="r"><code>aa_PRIO &lt;- seq2aa(&quot;PRIO_HUMAN&quot;, &quot;
MANLGCWMLVLFVATWSDLGLCKKRPKPGGWNTGGSRYPGQGSPGGNRYPPQGGGGWGQP
HGGGWGQPHGGGWGQPHGGGWGQPHGGGWGQGGGTHSQWNKPSKPKTNMKHMAGAAAAGA
VVGGLGGYMLGSAMSRPIIHFGSDYEDRYYRENMHRYPNQVYYRPMDEYSNQNNFVHDCV
NITIKQHTVTTTTKGENFTETDVKMMERVVEQMCITQYERESQAYYQRGSSMVLFSSPPV
ILLISFLIFLIVG
&quot;)</code></pre>
<p><span style="color:green"><code>uniprot.aa()</code></span> returns the amino acid composition of a single amino acid sequence downloaded from UniProt. To get sequences for many proteins, use R’s <code>lapply()</code>, <code>do.call()</code>, and <code>rbind()</code>:</p>
<pre class="r"><code>IDs &lt;- c(&quot;ALAT1_HUMAN&quot;, &quot;P02452&quot;)
aa &lt;- lapply(IDs, uniprot.aa)
## uniprot.aa: trying http://www.uniprot.org/uniprot/ALAT1_HUMAN ... accession P24298 ...
## &gt;sp|P24298|ALAT1_HUMAN Alanine aminotransferase 1 OS=Homo sapiens GN=GPT PE=1 SV=3 (length 496)
## uniprot.aa: trying http://www.uniprot.org/uniprot/P02452 ... accession P02452 ...
## &gt;sp|P02452|CO1A1_HUMAN Collagen alpha-1(I) chain OS=Homo sapiens GN=COL1A1 PE=1 SV=5 (length 1464)
aa_UniProt &lt;- do.call(rbind, aa)</code></pre>
<pre class="r"><code>aa_UniProt</code></pre>
<pre><code>##    protein organism ref abbrv chains Ala Cys Asp Glu Phe Gly His Ile Lys Leu
## 1    ALAT1    HUMAN  NA ALAT1      1  51  10  20  34  21  38   9  18  16  55
## 11   CO1A1    HUMAN  NA CO1A1      1 139  18  66  75  27 391   9  24  57  48
##    Met Asn Pro Gln Arg Ser Thr Val Trp Tyr
## 1   12  12  33  30  37  25  18  41   1  15
## 11  13  28 278  49  71  60  45  47   6  13</code></pre>
<p>These amino acid compositions can be processed using functions such as <span style="color:green"><code>protein.length()</code></span> and <span style="color:green"><code>protein.formula()</code></span>:</p>
<pre class="r"><code>myaa &lt;- rbind(aa_Ef, aa_PRIO, aa_ALAT1)
protein.length(myaa)</code></pre>
<pre><code>## [1] 394 394 253 496</code></pre>
</div>
</div>
<div id="thermodynamic-data" class="section level1">
<h1>Thermodynamic data</h1>
<div id="viewing-data-sources-thermo.refs" class="section level2">
<h2>Viewing data sources: <span style="color:green"><code>thermo.refs()</code></span></h2>
<p>The OBIGT database lists one or two sources for each entry, and citation information for the sources is listed in <code>thermo()$refs</code>. You can locate and view the references with <span style="color:green"><code>thermo.refs()</code></span>. Running the function without any arguments opens a browser window with the complete table of references. <label for="tufte-mn-51" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-51" class="margin-toggle"><span class="marginnote"><span style="display: block;">See the vignette <a href="OBIGT.html"><span style="color:blue"><em>OBIGT thermodynamic database</em></span></a> for a more nicely formatted presentation of the sources of thermodynamic data, along with notes and additional comments.</span></span> Where available, links to the web page for the articles and books are displayed:</p>
<pre class="r"><code>thermo.refs()  ## shows table in a browser</code></pre>
<p>A numeric argument to <span style="color:green"><code>thermo.refs()</code></span> gives one or more species indices for which to get the references:</p>
<pre class="r"><code>iATP &lt;- info(&quot;ATP-4&quot;)
iMgATP &lt;- info(&quot;MgATP-2&quot;)
thermo.refs(c(iATP, iMgATP))</code></pre>
<pre><code>##       key                          author year                               citation                                                    note
## 149 LH06a D. E. LaRowe and H. C. Helgeson 2006 Geochim. Cosmochim. Acta 70, 4680-4724        nucleic-acid bases, nucleosides, and nucleotides
## 151 LH06b D. E. LaRowe and H. C. Helgeson 2006           Thermochim. Acta 448, 82-106 Mg-complexed adenosine nucleotides (ATP), NAD, and NADP
##                                           URL
## 149 https://doi.org/10.1016/j.gca.2006.04.010
## 151 https://doi.org/10.1016/j.tca.2006.06.008</code></pre>
<p>A character argument gives the source key(s):</p>
<pre class="r"><code>thermo.refs(c(&quot;HDNB78&quot;, &quot;MGN03&quot;))</code></pre>
<pre><code>##        key                                    author year                 citation                                       note                                    URL
## 8   HDNB78       H. C. Helgeson, J. M. Delany et al. 1978  Am. J. Sci. 278A, 1-229    data for minerals and phase transitions https://www.worldcat.org/oclc/13594862
## 135  MGN03 J. Majzlan, K.-D. Grevel and A. Navrotsky 2003 Am. Mineral. 88, 855-859 goethite, lepidocrocite, and maghemite GHS  https://doi.org/10.2138/am-2003-5-614</code></pre>
<p>If the argument holds the result of <span style="color:green"><code>subcrt()</code></span>, references for all species in the reaction are returned: <label for="tufte-mn-52" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-52" class="margin-toggle"><span class="marginnote"><span style="display: block;">The exception is H<sub>2</sub>O. With the default settings, thermodynamic properties for H<sub>2</sub>O are derived from SUPCRT92 (Johnson et al., 1992).</span></span></p>
<pre class="r"><code>substuff &lt;- subcrt(c(&quot;C2H5OH&quot;, &quot;O2&quot;, &quot;CO2&quot;, &quot;H2O&quot;), c(-1, -3, 2, 3))
thermo.refs(substuff)</code></pre>
<pre><code>##       key                                             author year                               citation                      note                                           URL
## 126  PS01                    A. V. Plyasunov and E. L. Shock 2001 Geochim. Cosmochim. Acta 65, 3879-3900   aqueous nonelectrolytes https://doi.org/10.1016/S0016-7037(01)00678-0
## 31  SHS89   E. L. Shock, H. C. Helgeson and D. A. Sverjensky 1989 Geochim. Cosmochim. Acta 53, 2157-2183 inorganic neutral species  https://doi.org/10.1016/0016-7037(89)90341-4
## 20  HGK84         L. Haar and J. S. Gallagher and G. S. Kell 1984                   NBS/NRC Steam Tables            H&lt;sub&gt;2&lt;/sub&gt;O       https://www.worldcat.org/oclc/858456124
## 44  JOH92 J. W. Johnson and E. H. Oelkers and H. C. Helgeson 1992              Comp. Geosci. 18, 899-947            H&lt;sub&gt;2&lt;/sub&gt;O  https://doi.org/10.1016/0098-3004(92)90029-Q</code></pre>
<p>The URLs of the references can be copied to a browser, or opened using R’s <code>browseURL()</code>:</p>
<pre class="r"><code>iFo &lt;- info(&quot;forsterite&quot;)
ref &lt;- thermo.refs(iFo)
browseURL(ref$URL)  ## opens a link to worldcat.org</code></pre>
</div>
<div id="optional-data" class="section level2">
<h2>Optional data</h2>
<p>Thermodynamic properties of minerals in the default database are mostly taken from <span class="citation">Berman (<label for="tufte-mn-53" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-53" class="margin-toggle">1988<span class="marginnote">Berman RG. 1988. Internally-consistent thermodynamic data for minerals in the system Na<span class="math inline"><em></em><sub>2</sub></span>O–K<span class="math inline"><em></em><sub>2</sub></span>O–CaO–MgO–FeO–Fe<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span>–Al<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span>–SiO<span class="math inline"><em></em><sub>2</sub></span>–TiO<span class="math inline"><em></em><sub>2</sub></span>–H<span class="math inline"><em></em><sub>2</sub></span>O–CO<span class="math inline"><em></em><sub>2</sub></span>. <em>Journal of Petrology</em> <strong>29</strong>(2): 445–522. doi: <a href="https://doi.org/10.1093/petrology/29.2.445">10.1093/petrology/29.2.445</a></span>)</span> (including silicates, aluminosilicates, calcite, dolomite, hematite, and magnetite) and <span class="citation">Helgeson et al. (<label for="tufte-mn-54" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-54" class="margin-toggle">1978<span class="marginnote">Helgeson HC, Delany JM, Nesbitt HW, Bird DK. 1978. Summary and critique of the thermodynamic properties of rock-forming minerals. <em>American Journal of Science</em> <strong>278A</strong>: 1–229. Available at <a href="https://www.worldcat.org/oclc/13594862">https://www.worldcat.org/oclc/13594862</a>. </span>)</span> (native elements, sulfides, halides, sulfates, and selected carbonates and oxides that do not duplicate any in the Berman dataset). Minerals are identified by the state <code>cr</code>, and (for the Helgeson dataset) <code>cr2</code>, <code>cr3</code>, etc. for higher-temperature polymorphs.</p>
<p>Some optional datasets can be activated by using <span style="color:red"><code>add.OBIGT()</code></span>. The first three of these contain data that have been replaced by or are incompatible with later updates; the superseded data are kept here to reproduce published calculations and for comparison with the newer data:</p>
<p><span style="color:red"><code>add.OBIGT(&quot;SUPCRT92&quot;)</code></span> – This file contains data for minerals from SUPCRT92 (mostly Helgeson et al., 1978) that have been replaced by the Berman data set.</p>
<p><span style="color:red"><code>add.OBIGT(&quot;SLOP98&quot;)</code></span> – This file contains data from <code>slop98.dat</code> or later slop files, from Everett Shock’s GEOPIG group at Arizona State University, that were previously used in CHNOSZ but have been replaced by newer data. This includes updates for aqueous Al species <span class="citation">(Tagirov and Schott, <label for="tufte-mn-55" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-55" class="margin-toggle">2001<span class="marginnote">Tagirov B, Schott J. 2001. Aluminum speciation in crustal fluids revisited. <em>Geochimica et Cosmochimica Acta</em> <strong>65</strong>(21): 3965–3992. doi: <a href="https://doi.org/10.1016/S0016-7037(01)00705-0">10.1016/S0016-7037(01)00705-0</a></span>)</span>, Au species <span class="citation">(Pokrovski et al., <label for="tufte-mn-56" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-56" class="margin-toggle">2014<span class="marginnote">Pokrovski GS, Akinfiev NN, Borisova AY, Zotov AV, Kouzmanov K. 2014. Gold speciation and transport in geological fluids: Insights from experiments and physical-chemical modelling. <em>Geological Society, London, Special Publications</em> <strong>402</strong>(1): 9–70. doi: <a href="https://doi.org/10.1144/SP402.4">10.1144/SP402.4</a></span>)</span>, and arsenic-bearing aqueous species and minerals, as compiled in the SUPCRTBL package <span class="citation">(Zimmer et al., <label for="tufte-mn-57" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-57" class="margin-toggle">2016<span class="marginnote">Zimmer K, Zhang Y, Lu P, Chen Y, Zhang G, Dalkilic M, Zhu C. 2016. SUPCRTBL: A revised and extended thermodynamic dataset and software package of SUPCRT92. <em>Computers &amp; Geosciences</em> <strong>90</strong>: 97–111. doi: <a href="https://doi.org/10.1016/j.cageo.2016.02.013">10.1016/j.cageo.2016.02.013</a></span>)</span>. Some calculations using the older data are shown in <a href="#complete-equilibrium-solubility">this vignette</a>. See <a href="../demo"><span style="color:blue"><code>demo(gold)</code></span></a> for calculations that depend on the data for Au species that are now loaded by default in CHNOSZ.</p>
<p><span style="color:red"><code>add.OBIGT(&quot;OldAA&quot;)</code></span> – This file contains superseded data for amino acids (methionine and glycine) and related species, particularly the [Met], [Gly], and protein backbone groups, as well as metal-glycinate complexes. The updates for these data have been taken from various publications (<a href="https://doi.org/10.1016/j.gca.2011.11.041">LaRowe and Dick, 2012</a>; <a href="https://doi.org/10.1007/s00239-014-9616-1">Kitadai, 2014</a>; <a href="https://doi.org/10.1016/j.fluid.2018.10.002">Azadi et al., 2019</a>) A comparison of log<em>K</em> of metal-glycinate complexes using the updated data is in <a href="../demo"><span style="color:blue"><code>demo(glycinate)</code></span></a>.</p>
<p>The next three optional datasets are provided to support newer data or models:</p>
<p><span style="color:red"><code>add.OBIGT(&quot;AS04&quot;)</code></span> – This file has data for aqueous SiO<sub>2</sub> from <span class="citation">Apps and Spycher (<label for="tufte-mn-58" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-58" class="margin-toggle">2004<span class="marginnote">Apps J, Spycher N. 2004. Data qualification for thermodynamic data used to support THC calculations. Las Vegas, NV: Bechtel SAIC Company, LLC. Report No.: ANL-NBS-HS-000043 REV 00 (DOC.20041118.0004).</span>)</span> and modified HSiO<sub>3</sub><sup>-</sup>. These data are included to help transition to the “higher solubility of quartz paradigm” <span class="citation">(Wolery and Jové Colón, <label for="tufte-mn-59" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-59" class="margin-toggle">2017<span class="marginnote">Wolery TJ, Jové Colón CF. 2017. Chemical thermodynamic data. 1. The concept of links to the chemical elements and the historical development of key thermodynamic data. <em>Geochimica et Cosmochimica Acta</em> <strong>213</strong>(Supplement C): 635–676. doi: <a href="https://doi.org/10.1016/j.gca.2016.09.028">10.1016/j.gca.2016.09.028</a></span>)</span>, but are not included in the default database in order to maintain compatibility with existing data for minerals that are linked to the older aqueous SiO<sub>2</sub> data. See <a href="../demo"><span style="color:blue"><code>demo(aluminum)</code></span></a> for an example.</p>
<p><span style="color:red"><code>add.OBIGT(&quot;DEW&quot;)</code></span> – These are aqueous species, with modified parameters, that are intended for use with the <a href="http://www.dewcommunity.org/">Deep Earth Water</a> (DEW) model <span class="citation">(Sverjensky et al., <label for="tufte-mn-60" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-60" class="margin-toggle">2014<span class="marginnote">Sverjensky DA, Harrison B, Azzolini D. 2014. Water in the deep Earth: The dielectric constant and the solubilities of quartz and corundum to 60 kb and 1,200 °C. <em>Geochimica et Cosmochimica Acta</em> <strong>129</strong>: 125–145. doi: <a href="https://doi.org/10.1016/j.gca.2013.12.019">10.1016/j.gca.2013.12.019</a></span>)</span>. You should also run <span style="color:red"><code>water(&quot;DEW&quot;)</code></span> to activate the equations in the model; then, they will be used by <span style="color:green"><code>subcrt()</code></span> and <span style="color:green"><code>affinity()</code></span>. Examples are in <a href="../demo"><span style="color:blue"><code>demo(DEW)</code></span></a>.</p>
<p><span style="color:red"><code>add.OBIGT(&quot;AkDi&quot;)</code></span> – These data are used in the Akinfiev-Diamond model for aqeuous nonelectrolytes <span class="citation">(Akinfiev and Diamond, <label for="tufte-mn-61" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-61" class="margin-toggle">2003<span class="marginnote">Akinfiev NN, Diamond LW. 2003. Thermodynamic description of aqueous nonelectrolytes at infinite dilution over a wide range of state parameters. <em>Geochimica et Cosmochimica Acta</em> <strong>67</strong>(4): 613–629. doi: <a href="https://doi.org/10.1016/S0016-7037(02)01141-9">10.1016/S0016-7037(02)01141-9</a></span>)</span>.</p>
<p>Detailed references for these optional datasets are in the vignette <a href="OBIGT.html"><span style="color:blue"><em>OBIGT thermodynamic database</em></span></a> (look under <strong>Optional Data</strong>).</p>
</div>
<div id="adding-data" class="section level2">
<h2>Adding data</h2>
<p>You can also use <span style="color:red"><code>add.OBIGT()</code></span> to add data from a user-specified file to the database in the current session. The file must be a CSV (comma separated value) file with column headers that match those in the main database. To show the required format, take a look at <code>BZA10.csv</code>, which has parameters taken from <span class="citation">Bazarkina et al. (<label for="tufte-mn-62" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-62" class="margin-toggle">2010<span class="marginnote">Bazarkina EF, Zotov AV, Akinfiev NN. 2010. Pressure-dependent stability of cadmium chloride complexes: Potentiometric measurements at 1-1000 bar and 25°C. <em>Geology of Ore Deposits</em> <strong>52</strong>(2): 167–178. doi: <a href="https://doi.org/10.1134/S1075701510020054">10.1134/S1075701510020054</a></span>)</span>. Missing values are indicated by <code>NA</code>: <label for="tufte-mn-63" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-63" class="margin-toggle"><span class="marginnote"><span style="display: block;">R’s <code>read.csv()</code> has a useful option: <code>as.is = TRUE</code>. This prevents columns with character data from being read as factors (i.e. categorical data). Passing factors to functions that are designed for character data can give unexpected results or errors.</span></span></p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/adds/BZA10.csv&quot;, package = &quot;CHNOSZ&quot;)
read.csv(file, as.is = TRUE)</code></pre>
<pre><code>##      name abbrv formula state  ref1 ref2       date       G  H     S     Cp
## 1   CdCl+    NA   CdCl+    aq BZA10   NA 2010-07-03  -52629 NA  7.06  11.12
## 2   CdCl2    NA   CdCl2    aq BZA10   NA 2010-07-03  -84883 NA 25.72 116.01
## 3  CdCl3-    NA  CdCl3-    aq BZA10   NA 2010-07-03 -115399 NA 45.15  97.78
## 4 CdCl4-2    NA CdCl4-2    aq BZA10   NA 2010-07-03 -145583 NA 50.61  42.52
##       V    a1.a    a2.b    a3.c    a4.d    c1.e    c2.f omega.lambda z.T
## 1  2.20  2.2303 -2.3357  6.6681 -2.6824 16.6723 -0.7693       0.4372   1
## 2 42.21  7.5221 10.5852  1.5895 -3.2166 73.7023 20.5956      -0.0495   0
## 3 63.47 10.8045 18.5994 -1.5605 -3.5479 72.0244 16.8832       0.9378  -1
## 4 81.35 13.8329 25.9938 -4.4669 -3.8536 53.6766  5.6267       2.4766  -2</code></pre>
<p>The column names with a dot (<code>.</code>) refer to different sets of equations for calculating standard thermodynamic properties. Aqueous species use the revised Helgeson-Kirkham-Flowers (HKF) equations (symbols before the dot), and crystalline, gas and liquid species other than H<sub>2</sub>O use a polynomial equation for heat capacity (see <a href="#solids">below</a>). See <span style="color:blue"><code>?thermo</code></span> for details about what’s in the data table, and <span style="color:blue"><code>?hkf</code></span> and <span style="color:blue"><code>?cgl</code></span> for information about the equations used for thermodynamic properties.</p>
<p>Loading the data with <span style="color:red"><code>add.OBIGT()</code></span> produces a message that the new data replace existing species. We can then use <span style="color:green"><code>subcrt()</code></span> to calculate the equilibrium constant for a reaction involving the new species. This shows a decrease in the stepwise stability constant for the second cadmium chloride complex with increasing pressure (Bazarkina et al., 2010, Fig. 4).</p>
<pre class="r"><code>iCd &lt;- add.OBIGT(file)</code></pre>
<pre style="color:blue">## add.OBIGT: read 4 rows; made 4 replacements, 0 additions [energy units: cal]
</pre>
<pre class="r"><code>subcrt(c(&quot;CdCl+&quot;, &quot;Cl-&quot;, &quot;CdCl2&quot;), c(-1, -1, 1), T = 25, P = c(1, 2000))</code></pre>
<pre style="color:blue">## subcrt: 3 species at 2 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre><code>## $reaction
##     coeff  name formula state ispecies
## 392    -1 CdCl+   CdCl+    aq      392
## 29     -1   Cl-     Cl-    aq       29
## 393     1 CdCl2   CdCl2    aq      393
## 
## $out
##    T    P      rho      logK         G       H       S       V      Cp
## 1 25    1 0.997061 0.6413808 -875.0000 638.052 5.10000 22.6816 134.155
## 2 25 2000 1.071783 0.0618531  -84.3828 653.058 2.49858 12.2632 128.887</code></pre>
<p>After using <span style="color:red"><code>reset()</code></span> we can find the source of data in the default database <span class="citation">(Sverjensky et al., <label for="tufte-mn-64" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-64" class="margin-toggle">1997<span class="marginnote">Sverjensky DA, Shock EL, Helgeson HC. 1997. Prediction of the thermodynamic properties of aqueous metal complexes to 1000°C and 5 kb. <em>Geochimica et Cosmochimica Acta</em> <strong>61</strong>(7): 1359–1412. doi: <a href="https://doi.org/10.1016/S0016-7037(97)00009-4">10.1016/S0016-7037(97)00009-4</a></span>)</span>. Running the reaction now with these data, we see that the equilibrium constant is not as sensitive to pressure:</p>
<pre class="r"><code>reset()</code></pre>
<pre style="color:blue">## reset: resetting &quot;thermo&quot; object
</pre>
<pre style="color:blue">## OBIGT: loading default database with 1903 aqueous, 3443 total species
</pre>
<pre class="r"><code>thermo.refs(iCd)[, 1:3]</code></pre>
<pre><code>##      key                                           author year
## 89 SSH97 D. A. Sverjensky, E. L. Shock and H. C. Helgeson 1997</code></pre>
<pre class="r"><code>subcrt(c(&quot;CdCl+&quot;, &quot;Cl-&quot;, &quot;CdCl2&quot;), c(-1, -1, 1), T = 25, P = c(1, 2000))</code></pre>
<pre style="color:blue">## subcrt: 3 species at 2 values of T (ºC) and P (bar) (wet) [energy units: cal]
</pre>
<pre><code>## $reaction
##     coeff  name formula state ispecies
## 392    -1 CdCl+   CdCl+    aq      392
## 29     -1   Cl-     Cl-    aq       29
## 393     1 CdCl2   CdCl2    aq      393
## 
## $out
##    T    P      rho     logK        G        H      S        V      Cp
## 1 25    1 0.997061 0.619391 -845.000 -2037.00 -4.000 10.04043 51.2639
## 2 25 2000 1.071783 0.425897 -581.028 -2295.39 -5.752  2.34196 45.7496</code></pre>
</div>
<div id="modifying-data" class="section level2">
<h2>Modifying data</h2>
<p>Use <span style="color:red"><code>mod.OBIGT()</code></span> to add or modify the database in the current session. The function requires the name of a species and one or more properties to change.</p>
<div id="aqueous-species" class="section level3">
<h3>Aqueous species</h3>
<p>Let’s add data for CoCl<sub>4</sub><sup>-2</sup> from <span class="citation">Liu et al. (<label for="tufte-mn-65" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-65" class="margin-toggle">2011<span class="marginnote">Liu W, Borg SJ, Testemale D, Etschmann B, Hazemann J-L, Brugger J. 2011. Speciation and thermodynamic properties for cobalt chloride complexes in hydrothermal fluids at 35–440 °C and 600 bar: An <em>in-situ</em> XAS study. <em>Geochimica et Cosmochimica Acta</em> <strong>75</strong>(5): 1227–1248. doi: <a href="https://doi.org/10.1016/j.gca.2010.12.002">10.1016/j.gca.2010.12.002</a></span>)</span>. The values are taken from Table 5 of that paper; as is common for parameters in the HKF model, they are reported in caloric units, and some of the values have multipliers, which are kept when entering the data. The entry includes the date in ISO 8601 extended format (e.g. 2020-08-16); <code>Sys.Date()</code> is used in this example to get the current date.</p>
<pre class="r"><code>mod.OBIGT(&quot;CoCl4-2&quot;, formula = &quot;CoCl4-2&quot;, state = &quot;aq&quot;, ref1 = &quot;LBT+11&quot;,
  date = as.character(Sys.Date()), G = -134150, H = -171558, S = 19.55, Cp = 72.09, V = 27.74)</code></pre>
<pre style="color:blue">## mod.OBIGT: updated CoCl4-2(aq)
</pre>
<pre><code>## [1] 841</code></pre>
<p>The function prints a message saying that the species was added, and returns the species index of the new species. Now let’s modify the new species by adding the HKF coefficients. The <code>z</code> at the end refers to the charge of the species, and is used only for calculating the “<em>g</em> function” in the revised HKF model, not for balancing reactions.</p>
<pre class="r"><code>mod.OBIGT(&quot;CoCl4-2&quot;, a1 = 6.5467, a2 = 8.2069, a3 = 2.0130, a4 = -3.1183,
  c1 = 76.3357, c2 = 11.6389, omega = 2.9159, z = -2)</code></pre>
<pre style="color:blue">## mod.OBIGT: no change for CoCl4-2(aq)
</pre>
<pre><code>## [1] 841</code></pre>
<p>Let us now calculate the equilibrium constant for the formation of CoCl<sub>4</sub><sup>-2</sup> from Co<sup>+2</sup> and Cl<sup>-</sup>.</p>
<pre class="r"><code>T &lt;- c(25, seq(50, 350, 50))
sres &lt;- subcrt(c(&quot;Co+2&quot;, &quot;Cl-&quot;, &quot;CoCl4-2&quot;), c(-1, -4, 1), T = T)
round(sres$out$logK, 2)</code></pre>
<pre><code>## [1] -3.20 -2.96 -2.02 -0.74  0.77  2.50  4.57  7.29</code></pre>
<p>The calculated values of log<em>K</em> are identical to those in Table 9 of Liu et al. (2011), which provides a good indication that the thermodynamic parameters were entered correctly.</p>
</div>
<div id="solids" class="section level3">
<h3>Solids</h3>
<p>Let’s add data for magnesiochromite from <span class="citation">Klemme et al. (<label for="tufte-mn-66" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-66" class="margin-toggle">2000<span class="marginnote">Klemme S, O’Neill HS, Schnelle W, Gmelin E. 2000. The heat capacity of MgCr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>4</sub></span>, FeCr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>4</sub></span>, and Cr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span> at low temperatures and derived thermodynamic properties. <em>American Mineralogist</em> <strong>85</strong>(11-12): 1686–1693. doi: <a href="https://doi.org/10.2138/am-2000-11-1212">10.2138/am-2000-11-1212</a></span>)</span>. The parameters in this paper are reported in Joules, so we set the <code>E_units</code> to J. The value for volume, in cm<sup>3</sup> mol<sup>-1</sup>, is from <span class="citation">Robie and Hemingway (<label for="tufte-mn-67" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-67" class="margin-toggle">1995<span class="marginnote">Robie RA, Hemingway BS. 1995. <em>Thermodynamic Properties of Minerals and Related Substances at 298.15 K and 1 Bar (10<sup>5</sup> Pascals) Pressure and at Higher Temperatures</em>. Washington, D. C.: U. S. Geological Survey. (Bulletin 2131). doi: <a href="https://doi.org/10.3133/b2131">10.3133/b2131</a></span>)</span>.</p>
<pre class="r"><code>H &lt;- -1762000
S &lt;- 119.6
V &lt;- 43.56
mod.OBIGT(&quot;magnesiochromite&quot;, formula = &quot;MgCr2O4&quot;, state = &quot;cr&quot;, ref1 = &quot;KOSG00&quot;,
          date = as.character(Sys.Date()), E_units = &quot;J&quot;, H = H, S = S, V = V)</code></pre>
<pre style="color:blue">## mod.OBIGT: added magnesiochromite(cr) with energy units of J
</pre>
<pre><code>## [1] 3444</code></pre>
<p>Here are the heat capacity parameters for the “Haas-Fisher” polynomial equation (<span class="math inline"><em>C</em><em>p</em> = <em>a</em> + <em>b</em><em>T</em> + <em>c</em><em>T</em><sup> − 2</sup> + <em>d</em><em>T</em><sup> − 0.5</sup> + <em>e</em><em>T</em><sup>2</sup></span>). Order-of-magnitude multipliers are required for the values of <code>b</code> and <code>c</code> (and also <code>e</code> if it is present; see the description for columns 14-21 of the <code>OBIGT</code> data frame in <span style="color:blue"><code>?thermo</code></span>). Note that an additional <code>f</code> term is available, which can have any exponent given by <code>lambda</code>, but it is not needed here. 1500 K is a generic value for the high-temperature limit; experimental heat capacities were only reported up to 340 K (Klemme et al., 2000).</p>
<pre class="r"><code>a &lt;- 221.4
b &lt;- -0.00102030 * 1e3
c &lt;- -1757210 * 1e-5
d &lt;- -1247.9
mod.OBIGT(&quot;magnesiochromite&quot;, E_units = &quot;J&quot;, a = a, b = b, c = c, d = d,
          e = 0, f = 0, lambda = 0, T = 1500)</code></pre>
<pre style="color:blue">## mod.OBIGT: updated magnesiochromite(cr)
</pre>
<pre><code>## [1] 3444</code></pre>
<p>Now we can use <span style="color:green"><code>subcrt()</code></span> to calculate the heat capacity of magnesiochromite. For this calculation, we set the temperature units to K and the energy units to Joules. We also specify a pressure of 1 bar to prevent an error in the calculation of <em>P</em><sub>sat</sub> below the freezing temperature of water.</p>
<pre class="r"><code>T.units(&quot;K&quot;)</code></pre>
<pre style="color:blue">## changed temperature units to K
</pre>
<pre class="r"><code>E.units(&quot;J&quot;)</code></pre>
<pre style="color:blue">## changed energy units to J
</pre>
<pre class="r"><code>subcrt(&quot;magnesiochromite&quot;, property = &quot;Cp&quot;, T = c(250, 300, 340), P = 1)</code></pre>
<pre style="color:blue">## subcrt: 1 species at 3 values of T (K) and P (bar) [energy units: J]
</pre>
<pre><code>## $species
##                  name formula state ispecies
## 3444 magnesiochromite MgCr2O4    cr     3444
## 
## $out
## $out$magnesiochromite
##     T P      Cp
## 1 250 1 114.105
## 2 300 1 129.522
## 3 340 1 138.175</code></pre>
<p>The calculated values are with 0.1 J K<sup>-1</sup> mol<sup>-1</sup> of those shown in Fig. 1 of Klemme et al. (2000). If we wanted to restore the units setting for later calculations with <span style="color:green"><code>subcrt()</code></span>, we could use <span style="color:red"><code>reset()</code></span>. However, that also resets the thermodynamic database, so we don’t do it here, in order to run the check in the next section. Instead, we can just set the units to their defaults manually.</p>
<pre class="r"><code>T.units(&quot;C&quot;)</code></pre>
<pre style="color:blue">## changed temperature units to C
</pre>
<pre class="r"><code>E.units(&quot;cal&quot;)</code></pre>
<pre style="color:blue">## changed energy units to cal
</pre>
</div>
</div>
<div id="cross-checking-data-entries" class="section level2">
<h2>Cross-checking data entries</h2>
<p><span style="color:green"><code>info()</code></span> automatically performs some cross-checks of the thermodynamic data. <label for="tufte-mn-68" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-68" class="margin-toggle"><span class="marginnote"><span style="display: block;">This only checks the parameters for individual species, not the internal consistency of the database itself.</span></span> Given a numeric species index, it runs <span style="color:green"><code>checkEOS()</code></span>, which is a function that calculates values of <em>C</em><sub><em>P</em></sub>° and <em>V</em>° from the HKF or heat capacity parameters and indicates whether differences from the database are greater than 1 cal K<sup>-1</sup> mol<sup>-1</sup> or 1 cm<sup>3</sup> mol<sup>-1</sup>. <span style="color:green"><code>info()</code></span> also runs <span style="color:green"><code>checkGHS()</code></span>, which calculates the value of Δ<em>G</em>°<sub><em>f</em></sub> from those of Δ<em>H</em>°<sub><em>f</em></sub> and <em>S</em>° and from the entropy of the elements <span class="citation">(Cox et al., <label for="tufte-mn-69" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-69" class="margin-toggle">1989<span class="marginnote">Cox JD, Wagman DD, Medvedev VA, editors. 1989. <em>CODATA Key Values for Thermodynamics</em>. New York: Hemisphere Publishing Corporation. Available at <a href="https://www.worldcat.org/oclc/18559968">https://www.worldcat.org/oclc/18559968</a>. </span>)</span> in the chemical formula of the species. Let’s do this for the new CoCl<sub>4</sub><sup>-2</sup> species:</p>
<pre class="r"><code>inew &lt;- info(&quot;CoCl4-2&quot;)
info(inew)</code></pre>
<pre style="color:blue">## checkEOS: Cp of CoCl4-2(aq) differs by 1.33 cal K-1 mol-1 from tabulated value
</pre>
<pre style="color:blue">## checkEOS: V of CoCl4-2(aq) differs by -1.19 cm3 mol-1 from tabulated value
</pre>
<p>The messages indicate that the values of <em>C</em><sub><em>P</em></sub>° and <em>V</em>° added to the database differ slightly from those calculated using the HKF parameters.</p>
<p>Some species in the default and optional databases are known to have inconsistent parameters. For instance, we can check the data for the trisulfur radical ion (S<sub>3</sub><sup>-</sup>) from <span class="citation">Pokrovski and Dubessy (<label for="tufte-mn-70" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-70" class="margin-toggle">2015<span class="marginnote">Pokrovski GS, Dubessy J. 2015. Stability and abundance of the trisulfur radical ion in hydrothermal fluids. <em>Earth and Planetary Science Letters</em> <strong>411</strong>: 298–309. doi: <a href="https://doi.org/10.1016/j.epsl.2014.11.035">10.1016/j.epsl.2014.11.035</a></span>)</span>:</p>
<pre class="r"><code>info(info(&quot;S3-&quot;))</code></pre>
<pre style="color:blue">## checkGHS: G of S3-(aq) differs by 661 cal mol-1 from tabulated value
</pre>
<p>The calculated value of Δ<em>G</em>°<sub><em>f</em></sub> is 661 cal mol<sup>-1</sup> higher than the entered value. Because the difference between the entered and calculated values of Δ<em>G</em>°<sub><em>f</em></sub> is greater than 100 cal mol<sup>-1</sup>, <span style="color:green"><code>checkGHS()</code></span> produces a message. After checking for any typographical errors in the entries for Δ<em>G</em>°<sub><em>f</em></sub>, Δ<em>H</em>°<sub><em>f</em></sub>, <em>S</em>°, and the chemical formula, the source should be consulted for clarification.</p>
<p>All of the species with inconsistencies detected in this manner, in both OBIGT and the optional data files, are listed in the file <code>OBIGT_check.csv</code>.</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/adds/OBIGT_check.csv&quot;, package = &quot;CHNOSZ&quot;)
dat &lt;- read.csv(file, as.is = TRUE)
nrow(dat)</code></pre>
<pre><code>## [1] 369</code></pre>
<p>Without additional information, there is often no clear strategy for “fixing” these inconsistent data, and they are provided as-is. However, users are encouraged to send any corrections they find to the package maintainer.</p>
</div>
<div id="water-supcrt92-or-iapws-95-or-dew" class="section level2">
<h2>Water: SUPCRT92 or IAPWS-95 or DEW</h2>
<p>For calculations of the thermodynamic and dielectric properties of liquid and supercritical H<sub>2</sub>O, CHNOSZ uses a Fortran subroutine (<code>H2O92</code>) from SUPCRT92 (Johnson et al., 1992). Alternatively, the IAPWS-95 formulation for thermodynamic properties <span class="citation">(Wagner and Pruß, <label for="tufte-mn-71" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-71" class="margin-toggle">2002<span class="marginnote">Wagner W, Pruß A. 2002. The IAPWS formulation 1995 for the thermodynamic properties of ordinary water substance for general and scientific use. <em>Journal of Physical and Chemical Reference Data</em> <strong>31</strong>(2): 387–535. doi: <a href="https://doi.org/10.1063/1.1461829">10.1063/1.1461829</a></span>)</span> can be utilized. In part because of intrinsic thermodynamic differences between SUPCRT92 and IAPWS-95, as well as different equations used in CHNOSZ for calculating the dielectric constant when the IAPWS-95 option is active, this option could introduce inconsistencies with the data for aqueous species in the database and is not recommended for general use in CHNOSZ. However, the IAPWS-95 equations are useful for other applications, and may be extrapolated to a greater range of <em>T</em> and <em>P</em> than SUPCRT. See <span style="color:blue"><code>?water</code></span> for more information, as well as the last example in <span style="color:blue"><code>?subcrt</code></span>, where uncommenting the line for the <code>IAPWS95</code> option allows extrapolation to lower temperatures for supercooled water.</p>
<p>More recently (late 2017), an implementation of the <a href="http://www.dewcommunity.org/">Deep Earth Water</a> (DEW) model was added; see <a href="#optional-data">Optional data</a> for more information.</p>
</div>
</div>
<div id="functions-outside-the-main-workflow" class="section level1">
<h1>Functions outside the main workflow</h1>
<p>Some functions in CHNOSZ lie outside the main workflow described above.</p>
<ul>
<li><p><span style="color:green"><code>RH2OBIGT()</code></span> implements a group additivity calculation of standard molal thermodynamic properties and equations of state parameters of crystalline and liquid organic molecules from <span class="citation">Richard and Helgeson (<label for="tufte-mn-72" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-72" class="margin-toggle">1998<span class="marginnote">Richard L, Helgeson HC. 1998. Calculation of the thermodynamic properties at elevated temperatures and pressures of saturated and aromatic high molecular weight solid and liquid hydrocarbons in kerogen, bitumen, petroleum, and other organic matter of biogeochemical interest. <em>Geochimica et Cosmochimica Acta</em> <strong>62</strong>(23-24): 3591–3636. doi: <a href="https://doi.org/10.1016/S0016-7037(97)00345-1">10.1016/S0016-7037(97)00345-1</a></span>)</span>.</p></li>
<li><p><span style="color:green"><code>EOSregress()</code></span> and related functions can be used to regress “equation of state” parameters (e.g. coefficients in the HKF equations) from heat capacity and volumetric data. See <span style="color:blue"><code>?EOSregress</code></span> and the vignette <a href="eos-regress.html"><span style="color:blue"><em>Regressing thermodynamic data</em></span></a>.</p></li>
<li><p><span style="color:green"><code>eqdata()</code></span> reads data, including concentrations of aqueous species, numbers of moles of solid phases, and mineral saturation states (affinities), from an EQ6 output file <span class="citation">(Wolery, <label for="tufte-mn-73" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-73" class="margin-toggle">1992<span class="marginnote">Wolery TJ. 1992. Eq3/6, A Software Package for Geochemical Modeling of Aqueous Systems: Package Overview and Installation Guide (Version 7.0). Lawrence Livermore National Laboratory. Report No.: UCRL-MA-110662 PT I. doi: <a href="https://doi.org/10.2172/138894">10.2172/138894</a></span>)</span>.</p></li>
<li><p>Some functions are available (see <span style="color:blue"><code>?taxonomy</code></span>) to read data from <a href="ftp://ftp.ncbi.nih.gov/pub/taxonomy/">NCBI taxonomy files</a>, traverse taxonomic ranks, and get scientific names of taxonomic nodes.</p></li>
</ul>
</div>
<div id="citation-and-contact-information" class="section level1">
<h1>Citation and contact information</h1>
<p>If you use CHNOSZ for publications, please consider citing the following paper:</p>
<pre class="r"><code>cref &lt;- citation(&quot;CHNOSZ&quot;)
print(cref, style = &quot;html&quot;)</code></pre>
<p>
Dick JM (2019). “CHNOSZ: Thermodynamic calculations and diagrams for geochemistry.” <em>Frontiers in Earth Science</em>, <b>7</b>, 180. doi: <a href="https://doi.org/10.3389/feart.2019.00180">10.3389/feart.2019.00180</a>.
</p>
<p>If you found a bug or have questions that aren’t answered in the documentation please contact the maintainer:</p>
<pre class="r"><code>maintainer(&quot;CHNOSZ&quot;)</code></pre>
<pre><code>## [1] &quot;Jeffrey Dick &lt;j3ffdick@gmail.com&gt;&quot;</code></pre>
<p>Thank you for reading, and have fun!</p>
<blockquote>
<p>“The real fun of life is this perpetual testing to realize how far out you can go with any potentialities.”</p>
<footer>
— Richard P. Feynman
</footer>
</blockquote>
</div>
<div id="document-history" class="section level1">
<h1>Document history</h1>
<ul>
<li>2010-09-30 Initial version, titled “Getting started with CHNOSZ”. <!--
* 2011-08-15 Add <span style="color:green">`browse.refs()`</span>; modifying database hint changed to <span style="color:blue">`help(thermo)`</span>.
<label for="tufte-mn-74" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-74" class="margin-toggle"><span class="marginnote"><span style="display: block;"><span style="color:green"><code>browse.refs()</code></span> was renamed to <span style="color:green"><code>thermo.refs()</code></span> in 2017.</span></span>
--></li>
<li>2012-06-16 Add “More activity diagrams” (section no longer exists).</li>
<li>2015-05-14 Add warning about <a href="#thermodynamic-database">internal consistency of thermodynamic data</a>.</li>
<li>2017-02-15 Completely rewritten; switch from Sweave to <a href="https://yihui.org/knitr/">knitr</a> (<a href="https://rstudio.github.io/tufte/">Tufte style</a>).</li>
<li>2019-01-24 Add <a href="#complete-equilibrium-solubility">section on solubility calculations</a>.</li>
</ul>
<p>View the R Markdown source of this document <a href="https://r-forge.r-project.org/scm/viewvc.php/pkg/CHNOSZ/vignettes/anintro.Rmd?view=markup&amp;root=chnosz">on R-Forge</a> or in R:</p>
<pre class="r"><code>file.edit(system.file(&quot;doc/anintro.Rmd&quot;, package = &quot;CHNOSZ&quot;))</code></pre>
<p>
<pre class="r"><code>   ######    ##   ##    ##   ##    ######     #####  #####
 ##         ##===##    ## \\##   ##    ##     \\       //
 ######    ##   ##    ##   ##    ######    #####      #####</code></pre>
</p>
<!-- for finding what versions of packages are on R-Forge and winbuilder

```r
sessionInfo()
```

```
## R version 4.0.5 (2021-03-31)
## Platform: x86_64-slackware-linux-gnu (64-bit)
## Running under: Slackware 14.2 x86_64 (post 14.2 -current)
## 
## Matrix products: default
## BLAS:   /usr/lib64/R/lib/libR.so
## LAPACK: /usr/lib64/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] knitr_1.29   CHNOSZ_1.4.1
## 
## loaded via a namespace (and not attached):
##  [1] compiler_4.0.5    magrittr_1.5      tufte_0.6         htmltools_0.5.1.1
##  [5] tools_4.0.5       yaml_2.2.1        codetools_0.2-18  stringi_1.4.6    
##  [9] rmarkdown_2.3     highr_0.8         stringr_1.4.0     digest_0.6.25    
## [13] xfun_0.16         rlang_0.4.7       evaluate_0.14
```
-->
</div>



<!-- code folding -->



</body>
</html>
