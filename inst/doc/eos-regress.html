<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey M. Dick" />

<meta name="date" content="2024-02-11" />

<title>Regressing thermodynamic data</title>

<style type="text/css">body {background-color: #fffff8;}</style>
<style type="text/css">@charset "UTF-8";html { font-size: 15px; }body { width: 87.5%;margin-left: auto;margin-right: auto;padding-left: 12.5%;color: #111;max-width: 1400px;counter-reset: sidenote-counter; }h1.title { font-weight: 400;font-style: normal;margin-top: 4rem;margin-bottom: 1.5rem;font-size: 3.2rem;line-height: 1; }h1 {font-weight: 400;margin-top: 2.1rem;margin-bottom: 0;font-size: 2.2rem;line-height: 1; }h2 {font-weight: 400;font-size: 1.7rem;margin-top: 2rem;margin-bottom: 0;line-height: 1; }h3.subtitle {font-weight: 400;margin-top: 1rem;margin-bottom: 1rem;font-size: 1.8rem;display: block;line-height: 1; }h4.author, h4.date {font-size: 1.4rem;font-weight: 400;margin: 1rem auto;line-height: 1;}.danger { color: red; }article { position: relative;padding: 5rem 0rem; }section { padding-top: 1rem;padding-bottom: 1rem; }p, ol, ul { font-size: 1.4rem; }p { line-height: 2rem;margin-top: 1.4rem;margin-bottom: 1.4rem;padding-right: 0;vertical-align: baseline; }blockquote { font-size: 1.4rem; }blockquote p { width: 50%; }blockquote footer { width: 50%;font-size: 1.1rem;text-align: right; }ol, ul { width: 45%;-webkit-padding-start: 5%;-webkit-padding-end: 5%; }li { padding: 0.5rem 0; }table {border-top: 2px solid #111;border-bottom: 2px solid #111;font-size: 1.1rem;}th {border-bottom: 1px solid #111;}div.figure {padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;max-width: 55%;-webkit-margin-start: 0;-webkit-margin-end: 0;margin: 0 0 3em 0;}a:link, a:visited { color: inherit; }a:link { text-decoration: none;background: -webkit-linear-gradient(#fffff8, #fffff8), -webkit-linear-gradient(#fffff8, #fffff8), -webkit-linear-gradient(#333, #333);background: linear-gradient(#fffff8, #fffff8), linear-gradient(#fffff8, #fffff8), linear-gradient(#333, #333);-webkit-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;-moz-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;background-size: 0.05em 1px, 0.05em 1px, 1px 1px;background-repeat: no-repeat, no-repeat, repeat-x;text-shadow: 0.03em 0 #fffff8, -0.03em 0 #fffff8, 0 0.03em #fffff8, 0 -0.03em #fffff8, 0.06em 0 #fffff8, -0.06em 0 #fffff8, 0.09em 0 #fffff8, -0.09em 0 #fffff8, 0.12em 0 #fffff8, -0.12em 0 #fffff8, 0.15em 0 #fffff8, -0.15em 0 #fffff8;background-position: 0% 93%, 100% 93%, 0% 93%; }@media screen and (-webkit-min-device-pixel-ratio: 0) { a:link { background-position-y: 87%, 87%, 87%; } }a:link::selection { text-shadow: 0.03em 0 #b4d5fe, -0.03em 0 #b4d5fe, 0 0.03em #b4d5fe, 0 -0.03em #b4d5fe, 0.06em 0 #b4d5fe, -0.06em 0 #b4d5fe, 0.09em 0 #b4d5fe, -0.09em 0 #b4d5fe, 0.12em 0 #b4d5fe, -0.12em 0 #b4d5fe, 0.15em 0 #b4d5fe, -0.15em 0 #b4d5fe;background: #b4d5fe; }a:link::-moz-selection { text-shadow: 0.03em 0 #b4d5fe, -0.03em 0 #b4d5fe, 0 0.03em #b4d5fe, 0 -0.03em #b4d5fe, 0.06em 0 #b4d5fe, -0.06em 0 #b4d5fe, 0.09em 0 #b4d5fe, -0.09em 0 #b4d5fe, 0.12em 0 #b4d5fe, -0.12em 0 #b4d5fe, 0.15em 0 #b4d5fe, -0.15em 0 #b4d5fe;background: #b4d5fe; }img {max-width: 100%;}.marginnote img { display: block; }.sidenote, .marginnote { float: right;clear: right;margin-right: -60%;width: 50%;margin-top: 0;margin-bottom: 1rem;font-size: 1.1rem;line-height: 1.3;vertical-align: baseline;position: relative; }.sidenote-number {position: relative;vertical-align: baseline; }.sidenote-number { font-size: 1rem;top: -0.5rem;left: 0.1rem; }p, footer, table, hr { width: 55%; }hr { margin-left: 0; }table table, li p, li pre { width: auto; }li p, li pre {margin-top: auto; }div.fullwidth, table.fullwidth { max-width: 90%; }div.fullwidth > * { width: auto; }#TOC, h1.title { max-width: 90%; }#TOC ol, #TOC ul { width: auto; }div.fullwidth p.caption {margin-right: 0;max-width: 33%;}p.caption { text-align: left; }@media screen and (max-width: 760px) { p, footer, ol, ul, table, hr { width: 90%; }pre { width: 87.5%; }ul { width: 85%; }figure { max-width: 90%; }div.fullwidth p.caption { max-width: none; }blockquote p, blockquote footer { width: 90%; }}.sans { font-family: "Gill Sans", "Gill Sans MT", Calibri, sans-serif;letter-spacing: .03em; }code { font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 1.125rem;line-height: 1.6; }pre code { font-size: 1rem; }p code { white-space: inherit; }h1 code, h2 code, h3 code { font-size: 0.80em; }.marginnote code, .sidenote code { font-size: 1rem; }pre { width: 52.5%;overflow-x: auto; }.fullwidth { max-width: 90%;clear:both; }span.newthought { font-variant: small-caps;font-size: 1.2em; }input.margin-toggle { display: none; }label.sidenote-number { display: inline; }label.margin-toggle:not(.sidenote-number) { display: none; }@media (max-width: 760px) { label.margin-toggle:not(.sidenote-number) { display: inline; }.sidenote, .marginnote { display: none; }.shownote,.margin-toggle:checked + .sidenote,.margin-toggle:checked + .marginnote {display: block;float: left;left: 1rem;clear: both;width: 95%;margin: 1rem 2.5%;vertical-align: baseline;position: relative;}label { cursor: pointer; }div.figure { max-width: 90%; }pre { width: 90%;padding: 0; }}</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>











</head>

<body>




<h1 class="title toc-ignore">Regressing thermodynamic data</h1>
<h3 class="subtitle">EOSregress in CHNOSZ</h3>
<h4 class="author">Jeffrey M. Dick</h4>
<h4 class="date">2024-02-11</h4>


<div id="TOC">
<ul>
<li><a href="#a-note-on-the-equations">A note on the equations</a></li>
<li><a href="#a-note-on-the-algorithms">A note on the algorithms</a></li>
<li><a href="#an-example-for-neutral-species">An example for neutral species</a><ul>
<li><a href="#setting-the-value-of-omega">Setting the value of omega</a></li>
</ul></li>
<li><a href="#an-example-for-charged-species">An example for charged species</a><ul>
<li><a href="#doing-it-for-volume">Doing it for volume</a></li>
</ul></li>
<li><a href="#making-a-pseudospecies-h4sio4">Making a pseudospecies: H<sub>4</sub>SiO<sub>4</sub></a></li>
</ul>
</div>

<style>
html { 
  font-size: 14px;
}
body {
  font-family: ‘Times New Roman’, Times, serif;
}
li {
  padding: 0.25rem 0;
}
/* Zero margin around pre blocks (looks more like R console output) */
pre {
  margin-top: 0;
  margin-bottom: 0;
}
</style>
<p>This <a href="index.html">vignette</a> demonstrates <span style="color:blue"><code>EOSregress()</code></span> and related functions for the regression of heat capacity and volumetric data to obtain “equations of state” coefficients.</p>
<div id="a-note-on-the-equations" class="section level1">
<h1>A note on the equations</h1>
<p>The CHNOSZ thermodynamic database uses the revised Helgeson-Kirkham-Flowers equations of state (EOS) for aqueous species.
Different terms in these equations give the “non-solvation” and “solvation” contributions to the standard molal heat capacity (<i>C<sub>P</sub></i>°) and volume (<i>V</i>°) as a function of temperature (<em>T</em>) and pressure (<em>P</em>).</p>
<p>The equations were originally described by <span class="citation">Helgeson et al. (<label for="tufte-mn-1" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-1" class="margin-toggle">1981<span class="marginnote">Helgeson HC, Kirkham DH, Flowers GC. 1981. Theoretical prediction of the thermodynamic behavior of aqueous electrolytes at high pressures and temperatures: IV. Calculation of activity coefficients, osmotic coefficients, and apparent molal and standard and relative partial molal properties to 600°C and 5 Kb. <em>American Journal of Science</em> <strong>281</strong>(10): 1249–1516. doi: <a href="https://doi.org/10.2475/ajs.281.10.1249">10.2475/ajs.281.10.1249</a></span>)</span>; for <i>C<sub>P</sub></i>° the equation is</p>
<blockquote>
<p><i>C<sub>P</sub></i>° = <i>c</i><sub>1</sub> + <i>c</i><sub>2</sub> / (<em>T</em> - θ)<sup>2</sup> + ω<em>TX</em></p>
</blockquote>
<p>Here, <i>c</i><sub>1</sub> and <i>c</i><sub>2</sub> are the non-solvation parameters, and ω is the solvation parameter.
θ is equal to 228 K, and <em>X</em> is one of the “Born functions” that relates the solvation process to the dielectric properties of water.
For neutral species, all of the parameters, including the “effective” value of ω, are constant.
However, <strong>for charged species, ω has non-zero derivatives at <em>T</em> &gt; 100 °C, increasing with temperature</strong>, that depend on the charge and ionic radius.
Revisions by <span class="citation">Tanger and Helgeson (<label for="tufte-mn-2" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-2" class="margin-toggle">1988<span class="marginnote">Tanger JC IV, Helgeson HC. 1988. Calculation of the thermodynamic and transport properties of aqueous species at high pressures and temperatures: Revised equations of state for the standard partial molal properties of ions and electrolytes. <em>American Journal of Science</em> <strong>288</strong>(1): 19–98. doi: <a href="https://doi.org/10.2475/ajs.288.1.19">10.2475/ajs.288.1.19</a></span>)</span> and <span class="citation">Shock et al. (<label for="tufte-mn-3" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-3" class="margin-toggle">1992<span class="marginnote">Shock EL, Oelkers EH, Johnson JW, Sverjensky DA, Helgeson HC. 1992. Calculation of the thermodynamic properties of aqueous species at high pressures and temperatures: Effective electrostatic radii, dissociation constants, and standard partial molal properties to 1000 °C and 5 kbar. <em>Journal of the Chemical Society, Faraday Transactions</em> <strong>88</strong>(6): 803–826. doi: <a href="https://doi.org/10.1039/FT9928800803">10.1039/FT9928800803</a></span>)</span> refined the equations to improve their high-<em>T</em> and <em>P</em> behavior.</p>
</div>
<div id="a-note-on-the-algorithms" class="section level1">
<h1>A note on the algorithms</h1>
<p>The regression functions are essentially a wrapper around the <span style="color:green"><code>water()</code></span>-related functions in CHNOSZ and <code>lm()</code> in R.
The former provide values of the Born functions.
Accordingly, numerical values for all of the <em>variables</em> in the equations (e.g. 1/(<em>T</em> - θ)<sup>2</sup> and <em>TX</em>) can be calculated at each experimental <em>T</em> and <em>P</em>.</p>
<p>Applying a linear model (<code>lm</code>), the <em>coefficients</em> in the model can be obtained.
In this case, they correspond to the HKF parameters, e.g. <code>c1</code> (the intercept), <code>c2</code> and ω.
The coefficients <strong>in this model</strong> are constants, restricing application of the model to neutral (uncharged) species, for which the high-temperature derivatives of ω are 0.
Further below, a procedure is described to iteratively solve the equations for charged species.</p>
</div>
<div id="an-example-for-neutral-species" class="section level1">
<h1>An example for neutral species</h1>
<p>This is from the first example from <span style="color:green"><code>EOSregress()</code></span>.
<label for="tufte-mn-4" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-4" class="margin-toggle"><span class="marginnote"><span style="display: block;">The <code>?</code> indicates a documentation topic in R. To view it, type <span style="color:blue"><code>?EOSregress</code></span> or <span style="color:blue"><code>help(EOSregress)</code></span> at the R prompt.</span></span>
Here, we regress experimental heat capacities of aqueous methane (CH<sub>4</sub>) using the revised HKF equations.
First, load CHNOSZ and its database:</p>
<pre class="r"><code>library(CHNOSZ)
reset()</code></pre>
<pre style="color:blue">## reset: resetting &quot;thermo&quot; object
</pre>
<pre style="color:blue">## OBIGT: loading default database with 1940 aqueous, 3486 total species
</pre>
<p>Now, read a data file with experimental measurements from <span class="citation">Hnědkovský and Wood (<label for="tufte-mn-5" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle">1997<span class="marginnote">Hnědkovský L, Wood RH. 1997. Apparent molar heat capacities of aqueous solutions of CH4, CO2, H2S, and NH3 at temperatures from 304 K to 704 K at a pressure of 28 MPa. <em>Journal of Chemical Thermodynamics</em> <strong>29</strong>(7): 731–747. doi: <a href="https://doi.org/10.1006/jcht.1997.0192">10.1006/jcht.1997.0192</a></span>)</span> and convert pressures in MPa to bar (the values of <i>C<sub>P</sub></i>° in Joules will be used as-is):</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/cpetc/HW97_Cp.csv&quot;, package = &quot;CHNOSZ&quot;)
Cpdat &lt;- read.csv(file)
# Use data for CH4
Cpdat &lt;- Cpdat[Cpdat$species == &quot;CH4&quot;, ]
Cpdat &lt;- Cpdat[, -1]
Cpdat$P &lt;- convert(Cpdat$P, &quot;bar&quot;)</code></pre>
<p>Next, we specify the terms in the HKF equations and perform the regression using <span style="color:green"><code>EOSregress()</code></span>.
In the second call to <span style="color:green"><code>EOSregress()</code></span> below, only for <em>T</em> &lt; 600 K are included in the regression.
The coefficients here correspond to <i>c</i><sub>1</sub>, <i>c</i><sub>2</sub> and ω in the HKF equations.</p>
<pre class="r"><code>var &lt;- c(&quot;invTTheta2&quot;, &quot;TXBorn&quot;)
Cplm_high &lt;- EOSregress(Cpdat, var)
Cplm_low &lt;- EOSregress(Cpdat, var, T.max = 600)
Cplm_low$coefficients</code></pre>
<pre><code>## (Intercept)  invTTheta2      TXBorn 
##     160.103  443382.429 -121672.932</code></pre>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,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" alt="Heat capacity of aqueous methane." width="672" height="336" />
<!--
<p class="caption marginnote">-->Heat capacity of aqueous methane.<!--</p>-->
<!--</div>--></span>
</p>
<p>We can use <span style="color:green"><code>EOSplot()</code></span> to plot the data and fitted lines and show the coefficients in the legend.
The solid line shows the fit to the lower-temperature data.
The fit to all data, represented by the dotted line, doesn’t capture the low-temperature trends in the data.</p>
<pre class="r"><code>EOSplot(Cpdat, coefficients = round(Cplm_low$coefficients, 1))
EOSplot(Cpdat, coeficients = Cplm_high, add = TRUE, lty = 3)
PS01_data &lt;- convert(EOScoeffs(&quot;CH4&quot;, &quot;Cp&quot;), &quot;J&quot;)
EOSplot(Cpdat, coefficients = PS01_data, add = TRUE, lty = 2, col = &quot;blue&quot;)</code></pre>
<p><label for="tufte-mn-6" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-6" class="margin-toggle"><span class="marginnote"><span style="display: block;">Be aware that the lines shown by <span style="color:green"><code>EOSplot()</code></span> are calculated for a single pressure only, despite the temperature- and pressure-dependence of the data and regressions.</span></span></p>
<p><span style="color:green"><code>EOScoeffs()</code></span> is a small function that is used to retrieve the HKF parameters in the database in CHNOSZ.
<em>For species in the database with <code>E_units</code> set to <code>cal</code> for calories (i.e., most HKF species), the coefficients need to be converted to Joules here.</em>
The dashed blue line shows calculated values for methane using these parameters, which are from <span class="citation">Plyasunov and Shock (<label for="tufte-mn-7" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-7" class="margin-toggle">2001<span class="marginnote">Plyasunov AV, Shock EL. 2001. Correlation strategy for determining the parameters of the revised Helgeson-Kirkham-Flowers model for aqueous nonelectrolytes. <em>Geochimica et Cosmochimica Acta</em> <strong>65</strong>(21): 3879–3900. doi: <a href="https://doi.org/10.1016/S0016-7037(01)00678-0">10.1016/S0016-7037(01)00678-0</a></span>)</span>.
Compare the database values with the regressed values shown in the legend of figure above.
Some differences are expected as the values in the database are derived from different regression techniques applied to different sets of data:</p>
<pre class="r"><code>convert(EOScoeffs(&quot;CH4&quot;, &quot;Cp&quot;), &quot;J&quot;)</code></pre>
<pre><code>## (Intercept)  invTTheta2      TXBorn 
##         171      269868     -167360</code></pre>
<div id="setting-the-value-of-omega" class="section level2">
<h2>Setting the value of omega</h2>
<p>Given both high-temperature volumetric and calorimetric data for neutral species, the effective value of ω is most reliably regressed from the latter <span class="citation">(Schulte et al., <label for="tufte-mn-8" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-8" class="margin-toggle">2001<span class="marginnote">Schulte MD, Shock EL, Wood RH. 2001. The temperature dependence of the standard-state thermodynamic properties of aqueous nonelectrolytes. <em>Geochimica et Cosmochimica Acta</em> <strong>65</strong>(21): 3919–3930. doi: <a href="https://doi.org/10.1016/S0016-7037(01)00717-7">10.1016/S0016-7037(01)00717-7</a></span>)</span>.
Let’s regress volumetric data using a value of omega taken from the heat capacity regression.
First, read the data from <span class="citation">Hnědkovský et al. (<label for="tufte-mn-9" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-9" class="margin-toggle">1996<span class="marginnote">Hnědkovský L, Wood RH, Majer V. 1996. Volumes of aqueous solutions of CH4, CO2, H2S, and NH3 at temperatures from 298.15 K to 705 K and pressures to 35 MPa. <em>Journal of Chemical Thermodynamics</em> <strong>28</strong>(2): 125–142. doi: <a href="https://doi.org/10.1006/jcht.1996.0011">10.1006/jcht.1996.0011</a></span>)</span>.</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata/cpetc/HWM96_V.csv&quot;, package = &quot;CHNOSZ&quot;)
Vdat &lt;- read.csv(file)
# Use data for CH4 near 280 bar
Vdat &lt;- Vdat[Vdat$species == &quot;CH4&quot;, ]
Vdat &lt;- Vdat[abs(Vdat$P - 28) &lt; 0.1, ]
Vdat &lt;- Vdat[, -1]
Vdat$P &lt;- convert(Vdat$P, &quot;bar&quot;)</code></pre>
<p>Compressibilities of species (measured or estimated) are implied by the full set of HKF volumetric parameters (<i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>, <i>a</i><sub>3</sub>, <i>a</i><sub>4</sub>).
In this example we model volumes at nearly constant <em>P</em>.
Therefore, we can use a simpler equation for <i>V</i>° written in terms of the “isobaric fit parameters” (Tanger and Helgeson 1988, p. 35) σ and ξ, together with the solvation contribution that depends on the <em>Q</em> Born function:</p>
<blockquote>
<p><i>V</i>° = σ + ξ / (<em>T</em> - θ) - ω<em>Q</em></p>
</blockquote>
<p><label for="tufte-mn-10" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-10" class="margin-toggle"><span class="marginnote"><span style="display: block;"><span style="color:green"><code>EOSvar()</code></span> actually returns the negative of <em>Q</em>, so the omega symbol here carries no negative sign.</span></span></p>
<p>Now we calculate the <em>Q</em> Born function using <span style="color:green"><code>EOSvar()</code></span> and multiply by ω (from the heat capacity regression) to get the solvation volume at each experimental temperature and pressure.
Subtract the solvation volume from the experimental volumes and create a new data frame holding the calculated “non-solvation” volume.</p>
<p><label for="tufte-mn-11" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-11" class="margin-toggle"><span class="marginnote"><span style="display: block;">Because we are dealing with volumes, the units of ω are converted according to 1 J = 10 cm<sup>3</sup> bar.</span></span></p>
<pre class="r"><code>QBorn &lt;- EOSvar(&quot;QBorn&quot;, T = Vdat$T, P = Vdat$P)
Vomega &lt;- convert(Cplm_low$coefficients[[&quot;TXBorn&quot;]], &quot;cm3bar&quot;)
V_sol &lt;- Vomega * QBorn
V_non &lt;- Vdat$V - V_sol
Vdat_non &lt;- data.frame(T = Vdat$T, P = Vdat$P, V = V_non)</code></pre>
<p>Next, regress the non-solvation volume using the non-solvation terms in the HKF model.
As with <i>C<sub>P</sub></i>°, also get the values of the parameters from the database for comparison with the regression results.</p>
<pre class="r"><code>var &lt;- &quot;invTTheta&quot;
Vnonlm &lt;- EOSregress(Vdat_non, var, T.max = 450)
Vcoeffs &lt;- round(c(Vnonlm$coefficients, QBorn = Vomega), 1)
Vcoeffs_database &lt;- convert(EOScoeffs(&quot;CH4&quot;, &quot;V&quot;), &quot;J&quot;)</code></pre>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,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" alt="Volume of aqueous methane." width="672" height="672" />
<!--
<p class="caption marginnote">-->Volume of aqueous methane.<!--</p>-->
<!--</div>--></span>
</p>
<p>Finally, plot the data and regressions.
The first plot shows all the data, and the second the low-temperature subset (<em>T</em> &lt; 600 K).
The solid line is the two-term fit for σ and ξ (using ω from the heat capacity regression), and the dashed line shows the volumes calculated using the parameters in the database.
The plot legends give the parameters from the two-term fit (first plot), or from the database (second plot).</p>
<pre class="r"><code>par(mfrow = c(2, 1))
# plot 1
EOSplot(Vdat, coefficients = Vcoeffs)
EOSplot(Vdat, coefficients = Vcoeffs_database, add = TRUE, lty = 2)
# plot 2
EOSplot(Vdat, coefficients = Vcoeffs_database, T.plot = 600, lty = 2)
EOSplot(Vdat, coefficients = Vcoeffs, add = TRUE)</code></pre>
<p>The equation for <i>V</i>° provides a reasonable approximation of the trend of lowest-temperature data (<em>T</em> &lt; 450 K).
However, the equation does not closely reproduce the trend of higher-temperature <i>V</i>° data (<em>T</em> &lt; 600 K), nor behavior in the critical region.
Because of these issues, some researchers are exploring alternatives to the HKF model for aqueous nonelectrolytes.
(See also an example in <span style="color:blue"><code>?EOSregress</code></span>.)</p>
</div>
</div>
<div id="an-example-for-charged-species" class="section level1">
<h1>An example for charged species</h1>
<p>For this example, let’s generate synthetic data for Na<sup>+</sup> using its parameters in the database.
In the call to <span style="color:green"><code>subcrt()</code></span> below, <code>convert = FALSE</code> means to take <em>T</em> in units of K.</p>
<pre class="r"><code>T &lt;- convert(seq(0, 600, 50), &quot;K&quot;)
P &lt;- 1000
prop.PT &lt;- subcrt(&quot;Na+&quot;, T = T, P = P, grid = &quot;T&quot;, convert = FALSE)$out[[1]]
Nadat &lt;- prop.PT[, c(&quot;T&quot;, &quot;P&quot;, &quot;Cp&quot;)]</code></pre>
<p>As noted above, ω for electrolytes is not a constant.
What happens if we apply the constant-ω model anyway, knowing it’s not applicable (especially at high temperature)?</p>
<pre class="r"><code>var &lt;- c(&quot;invTTheta2&quot;, &quot;TXBorn&quot;)
Nalm &lt;- EOSregress(Nadat, var, T.max = 600)
EOSplot(Nadat, coefficients = Nalm$coefficients, fun.legend = NULL)</code></pre>
<pre style="color:blue">## EOSplot: plotting line for P = 1000 bar
</pre>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,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" alt="Heat capacity of Na&lt;sup&gt;+&lt;/sup&gt; (inapplicable: constant &amp;omega;)." width="672" height="336" />
<!--
<p class="caption marginnote">-->Heat capacity of Na<sup>+</sup> (inapplicable: constant ω).<!--</p>-->
<!--</div>--></span>
</p>
<pre class="r"><code>EOSplot(Nadat, add = TRUE, lty = 3)</code></pre>
<pre style="color:blue">## EOSplot: plotting line for P = 1000 bar
</pre>
<p>As before, the solid line is a fit to relatively low-temperature (<em>T</em> &lt; 600 K) data, and the dotted line a fit to the entire temperature range of the data.
The fits using constant ω are clearly not acceptable.</p>
<p>There is, however, a way out.
A different variable, <code>Cp_s_var</code>, can be used to specify the calculation of the “solvation” heat capacity in the HKF equations using the temperature- and pressure-dependent corrections for charged species.
To use this variable, the values of ω<sub><i>P<sub>r</sub></i>,<i>T<sub>r</sub></i></sub> (omega at the reference temperature and pressure) and <em>Z</em> (charge) must be given, in addition to <em>T</em> and <em>P</em>.
Of course, right now we <em>don’t know</em> the value of ω<sub><i>P<sub>r</sub></i>,<i>T<sub>r</sub></i></sub>—it is the purpose of the regression to find it!
But we can make a first guess using the value of ω found above.</p>
<pre class="r"><code>var1 &lt;- c(&quot;invTTheta2&quot;, &quot;Cp_s_var&quot;)
omega.guess &lt;- coef(Nalm)[3]</code></pre>
<p>Then, we can use an iterative procedure that refines successive guesses of ω<sub><i>P<sub>r</sub></i>,<i>T<sub>r</sub></i></sub>.
The convergence criterion is measured by the difference in sequential regressed values of ω.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,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" alt="Heat capacity of Na&lt;sup&gt;+&lt;/sup&gt; (variable &amp;omega;)." width="672" height="336" />
<!--
<p class="caption marginnote">-->Heat capacity of Na<sup>+</sup> (variable ω).<!--</p>-->
<!--</div>--></span>
</p>
<pre class="r"><code>diff.omega &lt;- 999
while(abs(diff.omega) &gt; 1) {
  Nalm1 &lt;- EOSregress(Nadat, var1, omega.PrTr = tail(omega.guess, 1), Z = 1)
  omega.guess &lt;- c(omega.guess, coef(Nalm1)[3])
  diff.omega &lt;- tail(diff(omega.guess), 1)
}
EOSplot(Nadat, coefficients = signif(coef(Nalm1), 6),
  omega.PrTr = tail(omega.guess, 1), Z = 1)</code></pre>
<pre style="color:blue">## EOSplot: plotting line for P = 1000 bar
</pre>
<pre class="r"><code>convert(EOScoeffs(&quot;Na+&quot;, &quot;Cp&quot;), &quot;J&quot;)</code></pre>
<pre><code>##  (Intercept)   invTTheta2       TXBorn 
##      76.0651 -124725.0400  138323.0400</code></pre>
<p>Alrighty! We managed to obtain HKF coefficients from synthetic data for Na<sup>+</sup>.
The regressed values of the HKF coefficients (shown in the plot legend) are very close to the database values (printed by the call to <span style="color:green"><code>EOScoeffs()</code></span>) used to generate the synthetic data.</p>
<div id="doing-it-for-volume" class="section level2">
<h2>Doing it for volume</h2>
<p>Just like above, but using synthetic <i>V</i>° data.
Note that the regressed value of ω has volumetric units (cm<sup>3</sup> bar/mol), while <code>omega.PrTr</code> is in energetic units (J/mol).
Compared to <i>C<sub>P</sub></i>°, the regression of <i>V</i>° is very finicky.
Given a starting guess of ω<sub><i>P<sub>r</sub></i>,<i>T<sub>r</sub></i></sub> of 1400000 cm<sup>3</sup> bar/mol, the iteration converges on 1394890 instead of the “true” database value of 1383230 (represented by dashed line in the plot).</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAAFeCAMAAAD69YcoAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAh1BMVEX///8WFyRZWVnw8fEQChAvLi7AwMB3d3cBAAF8fHtMS0zP0NBpaGg8PD3l/f8HGFc3CgXg4OD//eOMiou++P+ztbSam5uoqKcKOYX/+MT4uWYugNFVqfVaFAWYSg94MQ0PWaz73JH+7qt4yfzbjDq/bByf3/vEoXU+ZZCrfE97rNRgjrZ5enr1dxFtAAAbXklEQVR42uydi3abOBCG0RWhS1KZgHJp4iZNu5vU7/98y9UxrOMgF0mQ6O85JaYuiC9iNBqNpCSJioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKior6YhJpytNW3ZHDwUfZfYRycBqqo6fH3ybD06Nbjb41Pj26pppWsNMX6T+Sg2/thDO8O5XitiAQtHfE3Z1Ze5p3p0lXMNZ9xO0RtKdld1p1/xm0TwP7090vA3en8fA0g4MSEHW0BPuCdaDI0RLsC9ZeU+KjJeB9wep7qMwZ3ixLgG5+oqo9Q3h7xKg5FN1HWLZH1h4kaI+8aA4Itx9z2R4Vba/ZfTtLu2u39USQ9mPaPRejgxLI/GgJgByUoIRHS8DJoAQaHC2B6S6SspaBK8mq9hZfF69klXVU0hneyoby9o6o6Mq364rfHnR3murB6bxDUQxP6/ahEtOSEd0zCzE4jczwNB6WYHSrvgQqP3qrUQkyfvJW3WnaUTegsr4O8f7/xejrzmn1dee0+rrzgTrz9FFNKKd8K5/Eqn9/KCHUpXH44ngLDoRfvHTSs/av5mn1r+YHmvYtFwUrIdZ+8X4p5ZKhiNeZ0owmEa87vzRPIl534ibidShliojXnUjdC3HIgDOMy6+LF2cKY8zdNZ1S6y9ce9ku1VruonFwIo1r12Eptpcx9rnwCmDEYvCyRp8JbxsCDYu3h8re8H4WzoYHx9tRRf0PbAB63SqhXgheXHxCvFlaj4gsAS9QPWdGPg1embGwtReVbyy7HxDtTyG0cs4wx27xSm6Mft8LKzEbtmiHFbrM8crxqpxoY6DDoUyguqHW4zZBiWNuQnPGqAH7VYYcDCyUAtC7cei4nR5ZEWvHi3Ugx2wat7XjZWjReLuv4RStki5iTuIuG6Ev5sHbfA9LTsQaAxIC5POPVmweqibp8vUkXgQs3nrNSYbXaCSoanIn5sX7C7xePG0vf5/CS3DdCZ7eucSrNMKGq2JuvDfbu+rvW/z9BF6pLI2pWCXeXBLqpml7PIW3BNZN1SrxphlwE9LZ/DphHCi2T9deJV5YCjeO2XNXeZN6JI8MO24Iq3NcyMaHoKvCy3dKkQqAmrnuvuA//S9QpWl5GHZgjOPzvFhGcbYuvKQwppw9fXrzAF7f6Vb83SsuVjamD2hT3t1uXrqd3X0X7/l8QUmLFfWJXQwGPYOfiSO8Fd8VdTAQbpPAZ8X7dH+5yyq9HsH79yEasaIQcFUX0vnxctXoj4vau6ogGlXtRAd/EbO/R7MivIYXwi/e9O/JrAdvP8vFG140Q7LgemxvPwfKId7dIEMyZzPMXq7pknwFeNs+sdMMyWF+L5npRgquoXusimYsHDPuxzgUZC6PEki8/LRhQLFX2wtne6UFlstPHGaU+MSL2HwdWgMWP7qJcKF84i3nNJiSLx2vADT1iZfgOa9McrlsD61QiU+/V7N0zivrpUcf9pP6/eAt8bxL9iy9+9YvUOIJr5q5K7B0vDLv1mHxghdh9LXwcgOc45UqTbvVe+Zu6peOl9C6QjlfqqjDC1Xigu9yPQcs6sK5xfv2YmA1/9URKRfr/iLWr/Sz82B7BXYR5KJYLTV2JkCC/HkOOXaykqLkWCwT775X4QWvwm5eQQDVMvG+LRXmA6+rAG0B5DLxZqmh3vAK4OoOMF0mXlj26865x6vdBbj0Qo2vKlThB6+GGDPiavgmV6nQYnHhXyC6TptzvCRFWBlntYwoBgiWCwPMELNwzG5MJmVmrmw73gxjqRLNsiR3NTkxZ6BMEFxWB0PjdunKSUOZ/2zr5OU6wnr5anWXeiBe5kmBC3etm1KwHhoCixo87sbZElQ9/weN780Du/7TvNqi4nx9ZWkcKrw7pt3hZRpDMXXlWv9u70fG4WZ7/ZawmzxubfjWlzYqUdUv0JlxYKhZq3pZeLNUi4l4y4vNQbuxyS3xJqTOSiidNW3KJKBYmnGApcVoxfOdxZWfXjh8vTh0zDgj2JljVnXcCkMMX1bnWBX7t+l9vKiTDd7Hb5c7iO8uDi5dEOoyqaYAADO8LMcM6L5XcQLvc59OOx3v5qG2zf0MgPbSOXOcsqRLTMyS6CLW77FwCu/j9YWtcXj6Vn/36f7u4NIcO38eCMGS8FZu0r6f8z7ezctPW7y3uP4vm+2Pg0sD4vx5NFZLmjNUqGSqY9ZUdlu8D229lyrPTcGg+wdK4ZJqb5uZrik1eX56rO3xt9WFh3jbSa/Mg0uKFhU5q9wGVNfhjye9Pn8/B++2xdu8GMZLOCDnejnOgyrydJpxsMT7+K3+/s39ge3NvES8EVhQZB3rt07krHhvmkZtsFwG9JPqXKrFpKxXfhk3TvBWLm+92EsXmGg7xcTPQwG+lHE3St7c3pnxbl7qpYp+H1wae2rUS4KFWEQFLmFC0DS8lp5D0iy0dXhpxHzNgyAEEwAW4P+mh1OgHA8GUeyrv0pq40sXwJeb6XhvXuBe/17Z4y2BJ4+UgibwYEhwvIMn/jCcDkj/5/IMvOnO00OV0hCp+7UFwzoOZenDOEACofK1REvVEyWV8xAeb+U49DkkBawQTHBnc8jhnwvrziE3hvgaRqCgMgxYhzcOlePQ7QSbaGMmuIuP31gds7609SLqFwN7C7ZwqAnn4Zu2qsd20MP52DhsHprRzMcuzGiHl3nrqyKJAWPhHQdVHBqoj/He3Ldx39szmjbtc3kstAS3rK66wgbvU4f38Qy8FHt94DL8kOYoo2NC7d22wxXP1xfWeEvPgRZQhA78jiZ8THDMnvG/ZVE+4LvEGm/mOc5SqtCDxlXLVmorvE2chgFrz6y6NPS8MiECKvBaD5UnSqxsbxOnocLa7a0v7X2IMQ9cfevMU4Ys8XYpJZa3SlMEfI8hIKyCLuVZ9dkOGjeEJgQFHrdtOomt58AZZt6b8h0P2rhVffO30cVJ+b2b7WWa1yqtPQd/0d69dNhBIWUSTe0cs/uf590qy0IsuiuDjmmOf7lT/N5z8e5ogCXHdMh1qilJbPEmt9dXZ9beUgVoxmHAdNTazy8s8T5tGah0Rjg9DzF6K3C4nB1SjCrwlIgZ5hDKcwaDwuTkq2CLPejK6R7Oc5jStH0/803JYJDcg3BLldRzVoZVymXTlhHytfDysukV29ne5x8XZ+IF6kvhrW1DMtxfbkLtfbkH/JyBeKkYEV8J73h6mfgov7c1DqSVrX8GVb3baCi8IfyGkcNdL1XkcCtSGWgh45pugMksRR3LEdbdirPxwmCj4jJE16KJ1Y16xU7xBus+Cex/niZtKi9wW3sPtyLl4dYB4NI3XtTkuI1bt3nx3gy2IlXhMpIK73Zpx3vP1wav3RjFcCtSEjDhi3gehjLN3o3JeF2UU9MGyeXvZ8wsOhWjrUgJDoe35KXPaN17c/7fx3t7Wfyj+NXN1jbksN+KFASci+p10E3w99KYT0zZriD9urNccCA53IoUh0yaSbkX84toKQnOujdFW+D9UdXgnxVi29lB/VakpF6DB4BAs9W1B99MV80Lgfn+PoexXlNnlTJGThvSqi5O6QtvKG1TIQ62Ik2ZoUIHmy7JuePkVySxpIOnO9yvBGktKD0xm3FT25NNMSnScIvbgfrBVqQsaEYHdTytQwCox/ZeTDcOQ/fsozSS9t+HW5EGzrZ165sdGQU/sl7zBLwWaSTDrUhZ2EVCnK5OrY+0KUacgdcijWS0FWng2ouwdPf7He0aR/OssHPM9k3c9DSS0VakLHCyrUPfLG3eDMNJM0kQcZCmROmz8J491sYCz/Ft975xY3jrR+PECEN4vZhPTfxYgNBhGsku+CQoZ+MWTY/QNDOzETHNric5QeAc29unkQDrNBK+CLoO+Laz5+rc8MpdKqEglQ8M9LFs5ulpJNJ2KDOFlKJPibdx+VD9N2GAAIEr84D+P9amT3Yr9k3bmWkkEKuwC2C5wlvWlbcAoHEeBFRtJD2h4wBh8R97Z6KdKAwFUJYEkUUFBIoObnXp9v/fN9kBRQ0YK1reOTONoJRew0vytvi+fnXl2H5oe3jxtvvQNXXHSyJgWcTEG+gWAjt0g6iutsI9w0geXxvvHnRdAJII2hbe7sSLPLKjTGDoem1YvITubRtGMnx8bQXN1ZWHS0KIpw1kO4Ng6A0vTz5l5r0tw0iGXSj76qsuYYS+MDIfk8tAuqsjvgN4E6g4Ewtv9YL9THLxXTLzXg9328xoU3Dg8QIGateOlu2Sve7kUmQkGOyIVshaFRx4vAwUK4fUjvGaLfIVMeDz3jYFBzoggWLl4AwAiGNP0lZ/33oOXRAnUmmWREOa7/j+wFTFoCg40DQAFRpGB+pXxFBlJmFkyNczlitVtAUfaZuCA7hUURfKDuqOwseoyTJfrlTRDQUHOiGRo2752FST37fgQCckAOqcmpHhJQoZhEcDZBPKXcGrGQNlkweYNlPkVxhs8rJOCD/H0yfEa+nqHoSGux9dYzCbjDng7JDrX0+oHBRGPERGw0tdZYAjoqHjeQ60QTObWXfwRqri5P20oR1FgkEWORDo0Pl+zmUFWQuo2fbGbLwC/I19ih8vnhq3RfO4nzsy+BmYXdlMQpHTzYmaLZOkShW1vhn0ByWvhNcETqO/J0G/0vkLykEN3hbWi7+he9XgbZHr2eOVF715NszfwKupoIuuYKpmkH06DU1lO/tf9/CiFYFhKHgAVONdfLufjcJIZqCbeG+tPdtOv1zbt8KZkn/SkuUfk07iRbOqqHN4w8U/bdak7PTubc3x/viDDskPhHL382P+Hl5ts9TfGgQ4zPR3gXfYKbzScibb8D54m0mWzzWB1+iUcpCWczuZNKTrRtHAca4EoGZxo2nDDukRgdfpHF6paO4zeF3QrO9a2IYLweVF8SaXUw00K3OG09rW3RzayLJr2B5v1Cqo4BqDw0TKiJ6laWqNdnY5wbB7eF29PV6/lcX4KoPwcyLtgw9cJIfJPOho79VkrOr1eM12s2YZb8VClMeRkQ4rB6ltWerxxjC4E16SVfyxfwW8Wuve67Xbj0iSwSEHTxulo2Ript9NOVAVfJiMp38XbwDauR2kGATp0IH2S+CN41Z4Ez25B97QTQc+mtMCf5AGr6AcrtePq8XreOY98G5y24Ze0ip5yemkcrhawKgWb6sQYVyt6LJOCdFioe0fMugk3qtBYnV4rVYpeqbr3nGTkmbKQTg50CgKbf1jRBpAJzNCNHHR8eKRLgsbb4raaH1Qh3fQ1p/+0xFfW+HkwNHw8edkNSKNQ45G1BluTN5G2uIttpCMbrkts0XvbV1P8LGuzAPvhyUnxybHzqet/p6Rxgz8C5e08R4uVg+ZmAWtN6x9LN4Fz9coOTloYz2Za6TCHHpJj2T5PFw+Bm/Sukp5N/CWnRy0gfowUxX6HvVbrJKXq2z5tgTgbX/bfbl+U7wO0J4Zb8XJQcHOAMU7Q72Y4V28Zbn+jZTw+Ea+l1P+avC23xftcXjXE2oc1vdVJwce0azDhOKd4SFO4B2ZJtMbt92Y0QyvBbXnwxu6lrVY4cqeVScHtjCDcZrPCek5HdSocmDD4K0a2Ly4SDjFOxh0Ee9AVjlUnRwlDcxq1W6YNp7zWcatA9zFDfNO8ba0N2imTKmi1uLI4q06OcIDtt3vyHSXdmisFujEzJoStTzX7igneIO2UcophLrxKOVA5r1fR90Vq4md/m19IoRonoAWEbHl4mUF0sar0SYfJ1Zzy+iNeKMbqgkOfx6JV9Nq8CLda4+/RmLsW7FFMerBG2Ni6x8K6FoN8EL9txh05dK3d9FYFi/6foc93oZywadZxXtj3PUfxWuer79VwWv3eBUvLerw2n8Wb0wNjFkkH4pxiKZoTtrjlRH6lFdq4l+dpOSXIpZ75VASFjYm9iKRkosLk2cZ2mTje9FzTTvTJopIFwzTKKnMbdfDPXrXkMiXaNA5v0Enzdjgvhlyqe3JbhIxn2y40PdanMjgdW9gK1eqqK1IhXvi+BSbPqtbACHeX2udA39S3qEhy+1/vOw9mIsGXXmTsKYdMfrMIIQTG/3n1+DFNbTR2fE77b4rzT3jdKviNW7YtStIEsd7sHKY6d/EpEAtDGjZFuL93rJlaeW708WjP9P31QYxfm1y8e5ze/Cgt+Duvl6S7y3DHziTylLFC5OuKki5S2dTjeKl/5vMnDsrlOlMT7ixMiusZrRBTbHc9s6tPzWyY4/Dhg5ruLuf6b4VvK6uPTdejgQByxK8eRRzBgmbOTohbMGib/LGkDx8W+Fl3pwxVlK3KHkv6fZbG13esK7iHXrdwsuHpyaXJnjXE0P3se6lYNFgxfvd24jj3QiHEW/Qqm1FjERhlD82GM3DAxrzoumMvHdmz6VmDiDuFF4+PDXvvWviQkMTLDSFnaJj9oqrhncB7aTzspiQBXgXU673YkJCZxHRlOFdoEFvPKVap1AnF/Gmt27apRYvH55kLo2nUTRmmOFdadypqTuTN/aUEyXL8J5oXi2mlpkC765YXWwcKgbDy2/RLuF1zct4IdS6hJcPTzKXXvN64bT3Ul8P8aNhHcxdPzt9MBx64AN/ETM+WxMNNvcTygFdanpG975VdC9TDnVT8xJe8+Y9u5TiFcNTC90bLinklRaaJYIHwzEMB4xJhNmxbuAoxNB23g23A5WZw5biDWqcmiW8w5u3qlWKVwxP5NVPI91L17VbHOmEemCGYa+jaXnAEpMu0QgA10krMYKd/eb5vHdfpu15l/DelORtmmYQeGrxsuGJ3qfUpT99fwJ8f45HMzQszrETSPfphbgOYFFQJ5741BFrhmmh+8+oerZq22t8WUHHxuA83psKVyfUWqFmcwk6ThXDk/yDcSgsCBab1CEFQ6wQovdm5HjIHZ+iYURHj774RO09CptDaeJwOrgVeBVsXaBIOdBxqjQ8/YrFTEQzUZOOtFw0Xwq8gYLt/JQyKIanX8EbgNJ8W71B0lGwB7taBnx4+h28ZizXH08etbzc149DnDhe0466hlcMT7+jHMozg4bOoPIz4J7ixaOSgs6rnIHVwubwYEmgeYxX2U5kf9VTXBZnUI/X7vEq0eHuC+MNPydkESbSrETilTAn1JziqVinKxuRQ7Bqd9vPglduQbjOxxPmQGBpViLxSuP5WDv927WW5VMiFetk7cBmhY2mEpUqO+rwulHk38/XJucpnn2PShYztKoViVcaz8fKWLZFcUqkYhGSBLJZtUc0DAIe+mYZb6Kk81qeB41HKwduxgyYP7NIvOL5WHQZuC6dEqlYRH9gI+SG7WzErGlogVPSHAcfAPh9bEPCGXNE60zR28cTvjBBeGOgapuhzvjaSA9cIyqlxCuej7XVv8xsMS5OVbItMvShTOCkp7bgvbxI+w6Cz5Jrn3wF6EsbbcG3e0BKepP7kK+wEd4UpNrL4NU43p1to56UicQrkY9Fdi3C7nl+qsgVonzHueis5ANZZV124pwnJnWc90myPBfYmbca8YIK0DLhQNNer/duUjSJmBaJVyIfa0uHtr04VcXLDKFs+Ya/gq2+r8wmxl+jqs3hvciEwZm0W2H+9Xw7VagwH4eXVpYr916mcnnilcjHonoY8xCnKqlYld4bks5YHdfWHgAfJcDY0bxF38jGg7i23lz07ziKUggG2gvgpZXlRCcMSVtYyhFWkY91AP+OTq3LqVhV3YtRnYbqhIfyNBhpHezux5E7pomuVUkFh5H2CniPdO+ahTfMReKVyMdivXeyEqdEKpaYOfA9EStBPbXjJ9UH+EPUabwb74WiqBgkXwKva8XLcWy54QLnC+dIIfDEKzFS4VNI95ZP8VSsYt4bjoR+0avLje34KwgOFX2x0/E3gMZI1zLgeF8JPnktvAueXRV+8pUvS7wqJgI1p3gqVo3SWZajK+mq2wZ+ZXDb0qDMLdLkXzM4/iyPhM+C13mt+r3N5XqpolvkoaWKMs9g8n3mwP3xdqlU0Qv2Xq07pYpeFG9vTu/x9nh7vD3eHm+X8QZS4M20x9sKbyTlOHPh7zAY/HW8Dy9V1FG8XAvEzIHBUgeHbIXLkvB5nXuXeZFSephvme66uFSR0yuHE7wJc1c4NEbQZNFmDuuXPqUfMI5D1kMhxZzapYe3173PivfnSTcUMwYOZE2H/PBs+hIC8Q5ymL302d8J6GHHLh3274fXRb+K/iaP/XQM9pMdZi8Nr3LY8GsP83c77DA8OjyoXuToXc7Fa/pyN+ZU78CpvQMPlj7842q99NJLL7300ksvvfTSSy/dls0Ch4bjYkQLHBSjlRqNpdgzSKSunMthuSbZkoYH4SBXvhnGuvWuGBkJH9JoSBDZulU07kw3H6fxAsxxgP1XjMuyiEZzEXsGidSVszks1yTEF7LifDVaT97iGEcPi0bzi+EAuQX4V1Qmr0bK3U9wHC3J5SbxjJVGi79ixRpiF6FyDkvLuyPhqjggVTQaC6kjgWss0U/joEveuDNe839757abMAyDYZgqBJq0AiKjQMdhtIzy/g+4NLGNC5pE09Bp0/9dWZNWFSf1IQd7NvDHP/2hW/t7RGivXnXEd6AqnK0+NqGf1oYeat9wxkL7cacCPcnR16ix2hahB/M7q+r6WXQd5yhCgL2knkFyOv2mY0hrW25Hmg73lukrC4tQ9Y7zwv2znboiPN+3OatPKlgnFxbaD6z0DJK7FTeXLFq/WS4qKFLDwiLMONQ3SP3Y2BET4enqnZv33TC/V2+AveSeQZHUWyhj20m9tWsbVcPkN9RLX1wE48AmYh/HOPjbGjGMg401k+T8lfRvHPw+ajE8RnBtbCL2cnXl0Gwn1A6q38UebR7u2sQC9+7atk6ZJdnLjoEZ9wy6dhHSd1iCYkaargcOzILala0mRz8wfqDtg0R4snrX02xpqmT/ZsNCm03YQRUhJEWhnkFydUXfYQmJG9xTM7PcuRiChICIMb2M3E8qOJso+kkrXKbpk+KKk+IqNCm+9gySqys/32F5IAdcyBueT1oIsr2ubnjfSTEAAAAAAAAAAADAH2fNnS25jUW96OqXxVY7XmcGoXwaY+oDB8ZQXbR6zZUq7qUn2r0HXdjqNnoZtWqhcqj9bIv/Z1Zq183v9biyXH7tvsM+D/D2QG3l+L2eumoc74w0ax+C9t5Nff9+rpbpyzjTVbtAOGp+0u58OU4n043ydSAcFXxRc7HSFU7N6U9Qbxf09r6o10YOZH2h3o6eTemPjYPEvTAOMT3bnF2bP+yVLeDaOns2fVxHAjOn+PqoCQKziNzNVaQVccOIm7avSIrjTt+mJ8OSTmxP1zgniAVJAAAAAAAAAAAP8A2Qbhxj9eMA1QAAAABJRU5ErkJggg==" alt="Volume of Na&lt;sup&gt;+&lt;/sup&gt; (variable &amp;omega;)." width="672" height="336" />
<!--
<p class="caption marginnote">-->Volume of Na<sup>+</sup> (variable ω).<!--</p>-->
<!--</div>--></span>
</p>
<pre class="r"><code>T &lt;- convert(seq(0, 600, 25), &quot;K&quot;)
P &lt;- 1000
prop.PT &lt;- subcrt(&quot;Na+&quot;, T = T, P = P, grid = &quot;T&quot;, convert = FALSE)$out[[1]]
NaVdat &lt;- prop.PT[, c(&quot;T&quot;, &quot;P&quot;, &quot;V&quot;)]
var1 &lt;- c(&quot;invTTheta&quot;, &quot;V_s_var&quot;)
omega.guess &lt;- 1400000
diff.omega &lt;- 999
while(abs(diff.omega) &gt; 1) {
  NaVlm1 &lt;- EOSregress(NaVdat, var1,
    omega.PrTr = tail(convert(omega.guess, &quot;joules&quot;), 1), Z = 1)
  omega.guess &lt;- c(omega.guess, coef(NaVlm1)[3])
  diff.omega &lt;- tail(diff(omega.guess), 1)
}
EOSplot(NaVdat, coefficients = signif(coef(NaVlm1), 6),
  omega.PrTr = tail(convert(omega.guess, &quot;joules&quot;), 1), Z = 1,
  fun.legend = &quot;bottomleft&quot;)
coefficients &lt;- convert(EOScoeffs(&quot;Na+&quot;, &quot;V&quot;, P = 1000), &quot;J&quot;)
names(coefficients)[3] &lt;- &quot;V_s_var&quot;
EOSplot(NaVdat, coefficients = coefficients, Z = 1, add = TRUE, lty = 2,
  omega.PrTr = convert(coefficients[&quot;V_s_var&quot;], &quot;joules&quot;))</code></pre>
</div>
</div>
<div id="making-a-pseudospecies-h4sio4" class="section level1">
<h1>Making a pseudospecies: H<sub>4</sub>SiO<sub>4</sub></h1>
<p>Some mineral stability diagrams use the activity of H<sub>4</sub>SiO<sub>4</sub> as a variable.
However, the primary species for dissolved silica in CHNOSZ is SiO<sub>2</sub>(aq).
As recommended by <span class="citation">Wolery and Jové Colón (<label for="tufte-mn-12" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-12" class="margin-toggle">2017<span class="marginnote">Wolery TJ, Jové Colón CF. 2017. Chemical thermodynamic data. 1. The concept of links to the chemical elements and the historical development of key thermodynamic data. <em>Geochimica et Cosmochimica Acta</em> <strong>213</strong>(Supplement C): 635–676. doi: <a href="https://doi.org/10.1016/j.gca.2016.09.028">10.1016/j.gca.2016.09.028</a></span>)</span>, let us use data for SiO<sub>2</sub>(aq) from <span class="citation">Apps and Spycher (<label for="tufte-mn-13" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-13" class="margin-toggle">2004<span class="marginnote">Apps J, Spycher N. 2004. Data qualification for thermodynamic data used to support THC calculations. Las Vegas, NV: Bechtel SAIC Company, LLC. Report No.: ANL-NBS-HS-000043 REV 00 (DOC.20041118.0004).</span>)</span>, which gives a higher solubility of quartz compared to values from <span class="citation">Shock et al. (<label for="tufte-mn-14" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-14" class="margin-toggle">1989<span class="marginnote">Shock EL, Helgeson HC, Sverjensky DA. 1989. Calculation of the thermodynamic and transport properties of aqueous species at high pressures and temperatures: Standard partial molal properties of inorganic neutral species. <em>Geochimica et Cosmochimica Acta</em> <strong>53</strong>(9): 2157–2183. doi: <a href="https://doi.org/10.1016/0016-7037(89)90341-4">10.1016/0016-7037(89)90341-4</a></span>)</span> that are loaded by default in the package:</p>
<pre class="r"><code>add.OBIGT(&quot;AS04&quot;)</code></pre>
<p>The pseudo-reaction with zero properties, H<sub>4</sub>SiO<sub>4</sub> = SiO<sub>2</sub> + 2 H<sub>2</sub>O, defines the properties of the pseudospecies H<sub>4</sub>SiO<sub>4</sub>.
First we go about calculating the properties of SiO<sub>2</sub> + 2 H<sub>2</sub>O.
We do this over a range of <em>T</em> and <em>P</em>, but include many points near 25 °C to improve the fit of the regression in that region:</p>
<pre class="r"><code>s_25C &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2), T = 25)$out
s_near25 &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2), T = seq(20, 30, length.out=50))$out
s_lowT &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2), T = seq(0, 100, 10))$out
s_Psat &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2))$out
s_P500 &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2), T = seq(0, 1000, 100), P = 500)$out
s_P1000 &lt;- subcrt(c(&quot;SiO2&quot;, &quot;H2O&quot;), c(1, 2), T = seq(0, 1000, 100), P = 1000)$out</code></pre>
<p>Now we can start making the new species, with thermodynamic properties calculated at 25 °C:</p>
<pre class="r"><code>mod.OBIGT(&quot;calc-H4SiO4&quot;, formula = &quot;H4SiO4&quot;, ref1 = &quot;this_vignette&quot;,
          date = as.character(Sys.Date()), G = s_25C$G, H = s_25C$H, S = s_25C$S,
          Cp = s_25C$Cp, V = s_25C$V, z = 0)</code></pre>
<pre style="color:blue">## mod.OBIGT: added calc-H4SiO4(aq) with HKF model and energy units of J
</pre>
<pre><code>## [1] 3488</code></pre>
<p>To prepare for the regression, combine the calculated data and convert °C to K:</p>
<pre class="r"><code>substuff &lt;- rbind(s_near25, s_lowT, s_Psat, s_P500, s_P1000)
substuff$T &lt;- convert(substuff$T, &quot;K&quot;)</code></pre>
<p>Now let’s run a <i>C<sub>P</sub></i>° regression and update the new species with the regressed HKF coefficients.
Note that we apply order-of-magnitude scaling to the coefficients (see <span style="color:blue"><code>?thermo</code></span>):</p>
<pre class="r"><code>Cpdat &lt;- substuff[, c(&quot;T&quot;, &quot;P&quot;, &quot;Cp&quot;)]
var &lt;- c(&quot;invTTheta2&quot;, &quot;TXBorn&quot;)
Cplm &lt;- EOSregress(Cpdat, var) 
Cpcoeffs &lt;- Cplm$coefficients
mod.OBIGT(&quot;calc-H4SiO4&quot;, c1 = Cpcoeffs[1],
  c2 = Cpcoeffs[2]/10000, omega = Cpcoeffs[3]/100000)</code></pre>
<pre style="color:blue">## mod.OBIGT: updated calc-H4SiO4(aq)
</pre>
<p>Let’s get ready to regress <i>V</i>° data.
We use the strategy shown above to calculate non-solvation volume using ω from the <i>C<sub>P</sub></i>° regression:</p>
<pre class="r"><code>Vdat &lt;- substuff[, c(&quot;T&quot;, &quot;P&quot;, &quot;V&quot;)]
QBorn &lt;- EOSvar(&quot;QBorn&quot;, T = Vdat$T, P = Vdat$P)
Vomega &lt;- convert(Cplm$coefficients[[&quot;TXBorn&quot;]], &quot;cm3bar&quot;)
V_sol &lt;- Vomega * QBorn
V_non &lt;- Vdat$V - V_sol
Vdat$V &lt;- V_non</code></pre>
<p>Here’s the <i>V</i>° regression for the pseudospecies.
We specify the variables for the <i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>, <i>a</i><sub>3</sub>, and <i>a</i><sub>4</sub> terms in the HKF equations.</p>
<pre class="r"><code>var &lt;- c(&quot;invPPsi&quot;, &quot;invTTheta&quot;, &quot;invPPsiTTheta&quot;)
Vlm &lt;- EOSregress(Vdat, var)
Vcoeffs &lt;- convert(Vlm$coefficients, &quot;joules&quot;)
mod.OBIGT(&quot;calc-H4SiO4&quot;, a1 = Vcoeffs[1]*10, a2 = Vcoeffs[2]/100,
  a3 = Vcoeffs[3], a4 = Vcoeffs[4]/10000)</code></pre>
<pre style="color:blue">## mod.OBIGT: updated calc-H4SiO4(aq)
</pre>
<p>We just calculated the properties of the H<sub>4</sub>SiO<sub>4</sub> pseudospecies.
For comparison, the OBIGT database in CHNOSZ contains <code>H4SiO4</code> with parameters from <span class="citation">Stefánsson (<label for="tufte-mn-15" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-15" class="margin-toggle">2001<span class="marginnote">Stefánsson A. 2001. Dissolution of primary minerals of basalt in natural waters. I. Calculation of mineral solubilities from 0°C to 350°C. <em>Chemical Geology</em> <strong>172</strong>: 225–250. doi: <a href="https://doi.org/10.1016/S0009-2541(00)00263-1">10.1016/S0009-2541(00)00263-1</a></span>)</span>:</p>
<pre class="r"><code>info(info(c(&quot;calc-H4SiO4&quot;, &quot;H4SiO4&quot;)))</code></pre>
<pre><code>##             name abbrv formula state          ref1 ref2       date model E_units        G        H        S      Cp      V       a1       a2       a3       a4       c1       c2
## 3488 calc-H4SiO4  &lt;NA&gt;  H4SiO4    aq this_vignette &lt;NA&gt; 2024-02-11   HKF       J -1309238 -1459432 186.4093 57.4624 51.607 10.74930 -13762.5 -265.992 656825.4 298.4472 -1114719
## 3487      H4SiO4  &lt;NA&gt;  H4SiO4    aq         Ste01 &lt;NA&gt; 2006-08-31   HKF     cal  -312920  -348676  45.1004 15.0096 52.300  1.87299  -2126.0   18.620 -12000.5  58.0306  -207899
##          omega Z
## 3488 140091.22 0
## 3487   8690.25 0</code></pre>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,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" alt="Comparison of H&lt;sub&gt;4&lt;/sub&gt;SiO&lt;sub&gt;4&lt;/sub&gt; pseudospecies." width="100%" />
<!--
<p class="caption marginnote">-->Comparison of H<sub>4</sub>SiO<sub>4</sub> pseudospecies.<!--</p>-->
<!--</div>--></span>
</p>
<p>Let’s compare <code>H4SiO4</code> from Stefánsson (2001) and the <code>calc-H4SiO4</code> we just made with the calculated properties of SiO<sub>2</sub> + 2 H<sub>2</sub>O as a function of temperature:</p>
<pre class="r"><code>s1 &lt;- subcrt(c(&quot;calc-H4SiO4&quot;, &quot;SiO2&quot;, &quot;H2O&quot;), c(-1, 1, 2))
plot(s1$out$T, s1$out$G, type = &quot;l&quot;, ylim = c(-500, 2000),
  xlab = axis.label(&quot;T&quot;), ylab = axis.label(&quot;DG0&quot;))
s2 &lt;- subcrt(c(&quot;H4SiO4&quot;, &quot;SiO2&quot;, &quot;H2O&quot;), c(-1, 1, 2))
lines(s2$out$T, s2$out$G, lty = 2)
abline(h = 0, lty = 3)
legend(&quot;topright&quot;, legend = c(&quot;calc-H4SiO4 (this vignette)&quot;,
  &quot;H4SiO4 (Stef\u00e1nsson, 2001)&quot;), lty = c(1, 2), bty = &quot;n&quot;)
text(225, 1000, describe.reaction(s1$reaction))</code></pre>
<p>Ideally, the lines would be horizontal with a <em>y</em>-interecept of 0.
However, both the <code>calc-H4SiO4</code> we made here and the <code>H4SiO4</code> from Stefánsson (2001) show deviations that increase at higher temperatures.
While they are not quite negligible, these deviations are comparatively small.
For example, the almost 800 J/mol offset in Δ<i>G</i>° at 350 °C corresponds to a difference in log<i>K</i> of only -0.07.</p>
<p>The following example uses the <code>H4SiO4</code> from Stefánsson (2001) to make an activity diagram for the K<sub>2</sub>O-Al<sub>2</sub>O<sub>3</sub>-SiO<sub>2</sub>-H<sub>2</sub>O system.
This is similar to the diagram on p. 361 of <a href="https://www.worldcat.org/oclc/517586">Garrels and Christ, 1965</a>, but is quantitatively a closer match to the diagram in the <a href="https://wwwbrr.cr.usgs.gov/projects/GWC_coupled/phreeqc/html/final-75.html">User’s Guide to PHREEQC</a>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">-->
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAMAAAC3Ycb+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAVFBMVEXqtk45ODgBTQB4dnXuuZ/m5gAMCwjy8vIApgD///+1hzwCfABfJQZxVz0ILWiaoKNQYlmw6PnKwQBxdACrVw708NYqbLLDyMtgrOq/nIP856CRrwAFLF5FAAAW80lEQVR42uydi4KiIBSGRZtjiYWlRJf3f88F1LKxnZBAQWCb0VBnJ775z+F2INkZSfkVAVTHXUzfpsTMjyngwjblIRJxBAgtz+JnwSUWqEtAbhGISyYrp000Wc4A4UQAeh4EjRMoZSne9sWT4OyvhohZhRC22XdEEKSjpJgl86CsBwnqUXq9QaaSV/KyX2mckwGMsqpx1rsnEXpzW6Zym/J/YBDIrfUh8jsHkm5/JwyjrC3g8W3yyRROP88EP6NU16OsO6pR/isB+52To9FNOYN8fBsZZZFqfNubJ6s3T6I3T45/tcwkkLZ+Rf8PZKsGJG2fhPvfQMp3QH5GH9IRIGwBIDf4oJAtVsvCSkDup1HW6f4zkgh5U15vivXNbYSOi5UpAXlzGyVK/6dRILSRPgSO/wUyKaXwN5D/JHjzMX9/6iw3mMDkDzMKZJcXg66Tr4G8SEQdSBmBvE/fAxlKpFYGUqOPn/qd4dFPJBggr17EpM1yN7kNJK11gJQRiDUgpQ6QuopALAHZQh2azXIciJ7N8lkirgPRslknjyXiOBBNm1VGILaABOfWXQcSnFu3CgTjxdy6n0AoIZU9IAAp4GizJnXCiMFMx02Wns3yt57lvA8JrSniAZCwmiLuA9GsZ9VZBGIJiKZbj0BsAQnLrfsAJA3JZvkABIfUFPECiNZIrqc2ywcgQUnECyAhNUW8AKI5+8RLifgBJKAeRj+AbDXdOotALAEJRyKeAAmmnkUzmwNUAEs3RTyzWUSUmRcKCUcinpgsTSB3/9y6N0DgFIZEfAGyxUhLIigCsQVESyL+NUW8AfIacWgynCoC0W2tB2Gz/AESiM3ySCFh2CyPgOjZrBPQCMQOEN2mCIpALCkkDcGt+wRkq+nWIxBbQEJw614B0XXrEUgE4iIQMdiCDdssrR7G0psuX9sDVBhHiUxLjFVemSw9IB5JxDcfoj2HMQKxBGT9bt03IKWWRFAVgVgCsnqJhAHkJwKxBiRduc3yDsjaexgDAfKDsgjEFpDJMbmn+uSPRAwDue2f+4dYAjJdIicxUxuOIQK5lQdy7TcFswZEb0mzKkQghWBxyywBwSl/pYIIt0HSEP38FILOva7vrW16HrmVat8UtbizBsi4RjZZRgIC0u8cYslkYUj5P8CAgBuhQoaMNCm3SFCWkPJzSEvgBq093n8Ay57FlJusUymA0AJQxU1qMEBu5bmw6EOwiP/BAFCfeFm3QMqUl/9J+omTtGVcGxKEvPDTXbgLaiRP4Jzn/JcMBwjAmT18iIygSlNsEAhuqcCpxE+FNF10VdN5+/bYtCAElRZIDWL/OP6Rm4OjYyFVhQwv8XeDQ97vsyPXXBQ8jAPBQyBcCD/cHKV3cehGP6CvWvG7xFcPhDRyX669ozVgRkjGmYBZk7X7ew+q74GIPaugHipEOHHuQ049EGmp5OWHOiSQE5RQyRSYU7cLRHzD0P3dtwppBVGPTJa4RQDrgPxAc3C/MWK22is3+ey3XrWnkC2vaski5t/Slon03fjVqQt7VdYDIGIj0jy/knCA2G0YPhQiPLvwFWmZ1qNq7/1xFDldDUzcXd6h4dVeJKmE0nWymaHrRH81GmCxc9FSSle7IrynQPRCE3wIW/cUyHr3b/MViJ7N8kAivgLRDKdCJAJxSiJlBBLdeiBAtul9lRLxGEgdgTgFRM9m1a7bLKtALETsrFsijBBkdVOw1D0gTkuEGR6gmtVk6TZFHPci/vqQlbp1n4FounVEI5AokQgkAlkCiKbNikCiRCIQXyXiNxCsubJDFoG4JZEIxC2JuGyzPAei69YnSSSRU+to85hhx08Hk1IfE1SNBDqECaSeDoQWzxmPGzgPeigjkBcgyL7NkkAGPDrJRCAGQ0Anha2L8h/yKEDMl82vJT9cWiBURI4RDkSEIcP5yDPF5bNQFupvu8J5YSBWx6d6t15alwgHkgzLkvIMynMPjO05JwGkABE6xm9qDoSf8CPnwxpJsg0q4zko+zgUY3VFOQtrLr4DomWzJkkkgV+RokIybXycsFL8hIoSFyGMVFqtDctlDYBnPx9oFGbde7QpmGmbNWUvpAQgK4dERPl2DoPT4K/2jaQDFTk+HEvvXjadkELwIZoSmWKzRPm3NuvG/YJ8c2lPpTN5AUKvSDqYBxC6RyAfCgaI7soO2dRalvDQV0K4ADqFMJnyFyDCxQiX8QDSAGE0CQqI9S0O21ruwAc8fUhntVpnIXyItFcJHHsf0kIqTAPZZEJ4qMqYi0D09m+bCoSWDyIygxc/Y1c0qGUhOIuYPlmpkrUszoEzYayoZP3LGJBrZy6lybw4B0TPZp3UY0W6duDt4djbDFEs6PyrHSJi+qAatEM24sD5nI0BEd6rIizf7bh1HIQQugNEcxdQqz2M2hHYH4FsRHNnEIpeKBOZD4iWzTpZDaeyB6T4Xf63lyV/XACiWc+yKhF7QFj+OydnrgHBEBCQl6UzmIvV3hncuqsDVLezo0DwerYLmwLkukfZMQKJCrEVtu6kzVqHD1mRRKYA6Ts4FVsi7gNxUSKTFMIY2yDRw+nQANU3Nss5iWgMUN3Q0UWTtRqbRad2v7sKRNetM69NlstA1iKRKUDEeNkVEZ5y94Bo7oXkN5A9apN7taz12KwVDOGua971eoDo7t/G/ARCs4xwQ1VcHAZyWoNEFIF0jXQEDgPBq9jiUBFIwv14cdirD6gvAER3/zbmI5DiLL+Ss0oPZL4QkHQNbl1ZIbkAQsuPJksEGi0EZBW7gCr7kPNRyKP5CCSBBYHo2SzqYy0rgcuNvz4q5FZmywFZg81SbofIUEeA4yeDdb4tB0Sz5uuURKb1ZX0cUi8Ox2WB6KQaPAWi0BfMYTyAyJZLOt8YlbRZesmJmi+RW4J9HKDKJ4yjc4P13GBnh8SaixjPK5Ei0UjghEQoYSTLPi6CycRUa6oGJAHC2BXObCmTpQkkcahxqGCyKKkEFIUxkOZlEoRPQMA3H8IypAhlt6RT1wXikETUnXouoKDPMVR+AgE/a1m5sF7kA5C9h0ASZ2ZoTa/2Uupqb+9XQMBbIO52v38DxBkik4Dk+XqBuGK0VjL73QQQ8A6Iu/EhJoA4IpGoEMckspL4EBNAEsi8c+rd4XpcJxDwDEg30Zo2h3UCcUIikxSSCCJieH23UiDgGZDdBl0S5blyyPIeVOaBFLDw8DpTGA/5vfKJ+lQ5/4BwIplXQCilXCOU5is1WS4YrZVE4ZoCUkDllQ/ZrbodIiWCggaCof16vBldnRvI4hJRBZIzOYf6arYvC6ei2HFf/nh8dTutXvA1kAQhL4DIWYtQZaX5+JDHzK33U7hgZiBLV31VZ7/DhTWH8uNUUkUgOIUUp2lnsviZKPbHibwstcNfAFIn4oFZgCxttKbFh0yJaPsLiNi3mBe1tFJYvOHlPTzhtLqrLYj2fjwLkASBDwo57Nr4ECMK6QTRA0kloudJCq0Daa/i3pgBzANkWYkoAhGryavFh6gB2fYMuiIXZf446c3TAMjzKftAlpWIai2rgEsiltQ2AgT6An4CwT2Q1k5Jz/G4KidtK9ksI0AWlYhyO2TDaZiKwv2gkNatw4vJSsW/mRSSlOABEDkFDplx6m+BDE62T8kMTNY81d6lJaKxbi/9et1e6b6fGoDew3cn0qKlPZC0u3+bzqaQJSWyzMrW0kk8fYhodG6HJzLU5+E/+hw8G5AFJfIRyO2Ltd//H62DO0OE21N54+Nk2x/x4FQt8scQkKUGRighnzcFo3J3hOP03RHEX/lfpQipg729yxotIoLaPjt14/uHdD4EOwxksbFD1R12BDqETO2wk0LXR+UskGQP7ld7TY6HWAoGNQdkKYnEEUPHJBKBOCaRCOQPiWQRiEtAliESgfxltBYgogjk+UBQQBbQiOoQ7rNpWB3DAbKZn4jqiGEBVZbt4Uwy9/YxtAhkfiKqS/y1oSHicFMdNVwFkNmJqE5y6LrcxZh6ExSQuYmo+pCD9OZ5o7Qy6aqAzExEeaLcmeViT+RLXsAxLCCcSEWca4d01axzTlUHDNcDZJPN1iCh6lse0WuWkUlh0bNuCmYViEAyC5Epm4KJ7XVIHlhL/QFkPkeivpCyTJdQgcylEeV2iHDqdLM/HEMFMpdGJizGLyc8XIIFMpNGJoQjyIbhOVwg82gkKkQdiNAIdcyHwDFkIPzzWxdJrGVNASJEUrkBpG0YHnehA7FOJA7hTgRim4gKkA15pk8aoc/N1lcKxDIRFSCD8Vs4fw5nP1zWDcQuERUgOc1p//q7N6uBS077FZxWC8QqETUfknevD52Lbdd8v8TZeoHYJGLBqd/WD8TiCIkFIM3qTRZP170lkZgHUrxsCjbzGNVsQCyYLdIVmFkg+YOHjDH0Y1MwLSDmiTDGVGIMJ6XnTrgrN1kiWYnVNWuy8uEay6sHYqWyZRZIMuwNXj8QG0SMArmVh0ykSyhALBAxC2SPZAoHCPcjKHO9HRKQyWqbiFUE4hAQ3kY0SiQC+RqIWUcSgXwPxGiDJAIxAMSkRiIQE0AMaiQCMQLEnEYiEDNAhEZYBPJ/IFD9r5jFlZer8k3xLRBTDZIwgbwUv3jToK+BGGqQWAQCS+5B1f7ZF/Jbn9eeSCBF99VlFyUqBrdoAvmeCKsqBBYVkqaLKoSb9URusyFz5TqF2b/2zkW7URAIw6Ie3HpNTjVG3/9BlwHxFjUkgsmx/3SbJoCu8jkzDBAYTBa/UIr6kKqsVJd9E8hu114XBTuvySIeXkqawhlVdqxeNJBUvaiElHl9kR1ALFit8/qQmPd+oeSKjnztNYTJnAGILhLsALI/IDktEJYy7Tli8eiXXDuQwWTNgJQ8E2XLoTnwDpDdOnJaIMordD6EeytA4gmQbrmjXUD2+pHzaoh0CbHWg1JZom0NCfY1e3sd2YPkzHGIgKIUg5pOE5exqCFd7BLvBRI2wY6Nxc4MpJSePcvYL8/EB5alRGVZQ4T/kEWydGj3vguElIQByBSIbO6WTDh0Jqqa4j7xjmVdThp0JWKRQR9UZKiL7Aaygwg6Fy11LtoiAiBugLxNBEAcAXmXCIC4AvImEQBxBuS9gARA3AEJG/a6kgCIQyDvmC2nQPwk+eNAXiTidjzkoyOG3wLkNSKuRwxhsl63WvAhroG8SARAnAN5jQiAuAdCRAoA+SIgFCIyAPkiIC+YLQA5BogxEQA5CIgpEQA5CoghEQA5DIgZEQA5DogREQA5EIgJEQA5EohBQAIghwJ5riQAcjCQZ0ScAjl8fOqjQOJgIUH/mhGp6vricoDqPJuCmUiaLyToXy8wIVLYX3PxD5usVSBSW3JDqwUf8gyIMDhx1hseLyviQLxQRhYUo3yq+0nBRgOhEikfH7NBBECeAUmZ+OF5U3JZo7xI85TfQi/llDzki7pPGRMpo4K9lhCQoDvmskkEQJ4C4fTU85snKMjKlQniTUHJQZ+v3xRDwZEPKXN5KnGM4rUakADIUyBUlV5Xv1TZqdCGUNW6Th69kQWGv2Mg+phbtzQ2+zIgSb8HxmJbzBcZfl/KH1KTPps/TDNyBUSaHfFo0+PdV/ygB8MbSh8XnAJhmRCeb7n2TwIR4vO1xa9FxYtcXwAZL5CdcJGjYPqUP2fpEog3skKbQLyZuRoDoZ/LVmPrwyaL85UMX1a1yE4mdU5rQ5BaaBLcP85kiUqlZ38MZNlkjQs+mqwnzd9PA1ktkygsMyCdhiRrxzl06vIJz0cqIx302Kn3QEYFByBNd0wYNFtEvgeIrz3KNFvU/ciFdD7EX+sCcNfsVWxuPZC+CdvnjzRnKNgD4ewijxEN42JLR2wDaYa99QyATB7/pJOx3aJfXzmTqUE7tJWlAj/dYtVdU12Q1+erdBn/DQX7vqw4GAWGG0TsAmnlI2C+KZi/2dk1ctkzAgcDWe0cWUtcLLg6QhK4A0KbI0Qv7LCzWrEzHnNyh5qsfFhYpjADslxwnQh3txg/bQr2wh5UY4cx9yETZzJ17cc6dd09qDo95uI9AFkpuInEFRCJQu3VZgbE/7fmQzQP9XnePO7DQ/fNXu0yvCwwGwZZK2hGxCoQtWGesFmRGZBk3YX08eCiUyciRwWGh8hAxCGQ55uCbfh0v7df/vJJDus6OURIRxxsCtYD0UO4GFN/RUeqyvYQ7ss+BEAe/MhnW1kAMiFSfzwOAZCHgMQukEpE6pyffftup47Ecl9WFL7UlwUgD0QwhPtVQGioHUC+CIjQkQ8CmQ2XL2QnBjH9yYBkHwSiBtT9FSI+n3S/A8gRQLYq208SaMixQDrVWH36k4mGdMYt6bq2EkoBEDdAVgbVJxrC/WFWECFMFroWAWTnRDnZwz549fmg+kRD/PEAoyIDk2UXSKcRfmIwXKLe9sZNAkkAxDYQ8/ErhYIS/K6pDCDvfINqc0RkbnO2fUinIb4851mBNIw5/QbV9ncMH5yAiQ/hvJvjcE4gTfO5TcGehRYyZBwmWVMQKTjIYJI/zPmFydoP5EnwnUyG5Ps4hCY2+JIPgKBzEUAABEAABEAABEAABEAAxDEQqwNUcWwTSPAngXCbQLLMJhAOIHuB/ALIuuFZSkqMgCwU4ws1vcAoTU2KLQFpGiMgS8UCo6RjgSQL1br03Q/fCMjSEC5/rOkFrWFsofYXkh6rNWBGQFiw0LW+cGTzaQ0xA5IYAvHfBZJyx0CyrwTC/QcxTNpxZPYgS0lGxZhaLGaWZvYfvH2kw/GQgj0KN0oyLLbjSP61l8YKZ0Age74diCoAEAiAAAgEQAAEAiAAAjkDkDYTEfE9sni2/Grx6tLc1qU1IvS/WLm0im7y7giIuOO6jvnN2tmKJrVHpCq5LSDiHms7l1aJm6wzWnnBBRCP0yWWlm47phtuA2tAvPzX0pWpxXY8vYDFviq7SyrR9wPRSwzZU9+7rUflp6LztDaAqGVi6NlzY7Ju16ixcZ3qZLFFH1KVN2u6q+3W1QYQrSdunHrKuTUXwq0Zam0ArQIJbdxoZwZcAbHq1FvpgltrZ7v/WAXi8Vv0vUCiktMaTYNB3HmvZKrU2mi7PYm6NDJYNoCoS1PtLCtwXZmssCgKbRJ2tz4qcbK6Q7HftctLa/W3Ga1cGvGw4ygdO/Xu7Pxq72ytpTuvScq8jizZK0s8HDd7Qy58SPOtgaE9H1KRrxRiIzAsXQaGPyF1ndwii2ezycMaEG0AbTx5TrtOIHuMF6oAQCAAAiAQAAEQCIAACARAAOQkEhYRgHyTlFY7vAAEQE4JhPYxkaMdVRPUUdOPV1SjvXoB5DggVcovGXXWt+JNeunHGeVHa8NJAGIMRI6p0kQQtSmWHqqIFKwcQA4G0g29l3nVbRungTT1j5pJ0MqmWHPV6QGNjYf3zqhFAGIXSKuB1ApIb7JEbQcBffKk5y+V8RLYikakEhCPX4LsC4zanwASxTwPVHVPgHhyylcRCSAtk+Onn2+ondFkRXOT5XE1K/o6A0JzXulvfKN/UmXuAHKAU5eTbEI5c8XjARmvrt7DjDPBRNAoVcnyBiBumr0h5xemm73U6GV5zEXde3lQFMVIEcIsj0ZAoCH2RPVlhbLdRG68qPv5jjJKFCnRYLJ669Sm14nJ+rDZOnVvb/tYtz2Q5nL/8Si7ZQRkcOqUASD274tdF6feaiDtLRZNq/RSUGOY1EM2ewUVmQEgDpRDuI2FOYVdYFgHV6r3rodrFBhWKgNArEu02ZtYUZgYvZIBIM7v/P5qBoD8yecEVQAgEAABEAiAAAgEQAAEAiAAAgEQCIAACARAAAQCIAACARAAgQAIBEAABAIgAAIBEACBAAiAQAAEAiAAAgEQAIHYk//hYtsUyShLUQAAAABJRU5ErkJggg==" alt="Activity diagram for K&lt;sub&gt;2&lt;/sub&gt;O-Al&lt;sub&gt;2&lt;/sub&gt;O&lt;sub&gt;3&lt;/sub&gt;-SiO&lt;sub&gt;2&lt;/sub&gt;-H&lt;sub&gt;2&lt;/sub&gt;O." width="100%" />
<!--
<p class="caption marginnote">-->Activity diagram for K<sub>2</sub>O-Al<sub>2</sub>O<sub>3</sub>-SiO<sub>2</sub>-H<sub>2</sub>O.<!--</p>-->
<!--</div>--></span>
</p>
<pre class="r"><code>basis(c(&quot;Al+3&quot;, &quot;H4SiO4&quot;, &quot;K+&quot;, &quot;H2O&quot;, &quot;H+&quot;, &quot;O2&quot;))
species(c(&quot;gibbsite&quot;, &quot;muscovite&quot;, &quot;kaolinite&quot;, &quot;pyrophyllite&quot;, &quot;K-feldspar&quot;))
a &lt;- affinity(H4SiO4 = c(-8, 0, 300), `K+` = c(-1, 8, 300))
diagram(a, ylab = ratlab(&quot;K+&quot;), fill = &quot;terrain&quot;, yline = 1.7)
legend(&quot;bottomleft&quot;, describe.property(c(&quot;T&quot;, &quot;P&quot;), c(25, 1)), bty = &quot;n&quot;)</code></pre>
</div>



<!-- code folding -->



</body>
</html>
