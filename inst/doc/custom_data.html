<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey M. Dick" />


<title>Customizing the thermodynamic database</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Customizing the thermodynamic database</h1>
<h4 class="author">Jeffrey M. Dick</h4>


<div id="TOC">
<ul>
<li><a href="#basic-structure-of-obigt">Basic structure of OBIGT</a></li>
<li><a href="#conventions-for-data-entry-in-obigt">Conventions for data entry in OBIGT</a><ul>
<li><a href="#types-of-data">Types of data</a></li>
<li><a href="#ranges-of-hkf-and-cgl-models">Ranges of HKF and CGL models</a></li>
<li><a href="#required-and-optional-data">Required and optional data</a></li>
<li><a href="#na-or-0">NA or 0?</a></li>
<li><a href="#oom-scaling-and-info">OOM scaling and <code style="color: green;">info()</code></a></li>
</ul></li>
<li><a href="#case-study-na-and-0-in-the-default-database">Case study: NA and 0 in the default database</a></li>
<li><a href="#examples-of-adding-data-from-a-file">Examples of adding data from a file</a><ul>
<li><a href="#add.obigt-with-optional-data-files"><code style="color: red;">add.OBIGT()</code> with optional data files</a></li>
<li><a href="#add.obigt-with-other-csv-files"><code style="color: red;">add.OBIGT()</code> with other CSV files</a></li>
</ul></li>
<li><a href="#examples-of-adding-and-modifying-data-with-a-function">Examples of adding and modifying data with a function</a><ul>
<li><a href="#mod.obigt-for-aqueous-species"><code style="color: red;">mod.OBIGT()</code> for aqueous species</a></li>
<li><a href="#mod.obigt-for-minerals"><code style="color: red;">mod.OBIGT()</code> for minerals</a></li>
</ul></li>
<li><a href="#case-study-formation-constants-for-aqueous-tungsten-species">Case study: Formation constants for aqueous tungsten species</a><ul>
<li><a href="#fitting-formation-constants">Fitting formation constants</a></li>
<li><a href="#diagram-1-constant-molality-of-f-">Diagram 1: Constant molality of F<sup>-</sup></a></li>
<li><a href="#diagram-2-variable-molality-of-f-">Diagram 2: Variable molality of F<sup>-</sup></a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>This vignette was compiled on 2023-03-13 with CHNOSZ version 2.0.0.</p>
<p>This vignette will cover some topics about using custom thermodynamic data in CHNOSZ. The two main functions to remember are <code style="color: red;">add.OBIGT()</code> to add data from a CSV file and <code style="color: red;">mod.OBIGT()</code> to add or modify data through a function interface. A third function, <code style="color: red;">logB.to.OBIGT()</code>, is provided to fit thermodynamic parameters to experimental formation constants (log β).</p>
<p>Before describing the methods to add or modify data, some notes on the basic structure of the database and data entry conventions are given. Column names (or parts thereof) are formatted in blue (e.g. <tt style="color: blue;">formula</tt>), and important notes are highlighted in yellow (<span style="background-color: yellow;">NOTE</span>). Function names in CHNOSZ are colored red for functions that have side effects (including those that modify the database; e.g. <code style="color: red;">add.OBIGT()</code>) and green for functions that don’t have side effects. Note that <code style="color: green;">info()</code> is used for querying the OBIGT thermodynamic database, and <code style="color: green;">subcrt()</code> is the main function in CHNOSZ for calculating standard thermodynamic properties as a function of temperature and pressure from the parameters in the database.</p>
<!-- ######## SECTION MARKER ######## -->
<div id="basic-structure-of-obigt" class="section level2">
<h2>Basic structure of OBIGT</h2>
<p>OBIGT is the name of the thermodynamic database in CHNOSZ. The data are distributed in CSV files in the <code>inst/extdata/OBIGT</code> directory of the CHNOSZ package. When the package is installed, the files are copied to the <code>exdata/OBIGT</code> directory of the installed package location. To find out where this is on your computer, run the following command.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">system.file</span>(<span class="st">&quot;extdata/OBIGT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;CHNOSZ&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/tmp/RtmpL089Rr/Rinst29c17fae15ae/CHNOSZ/extdata/OBIGT&quot;</code></pre>
<p>The directory path on your computer will be different. Although possible, it is <strong>NOT</strong> recommended to edit the data files at that location. This is because they will be overwritten by package updates; moreover, it is good practice to keep all the files needed for your project in a project directory.</p>
<p>This lists the files in the installation directory:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">dir</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/OBIGT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;CHNOSZ&quot;</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;AD.csv&quot;            &quot;AS04.csv&quot;          &quot;Berman_cr.csv&quot;    
##  [4] &quot;DEW.csv&quot;           &quot;GEMSFIT.csv&quot;       &quot;H2O_aq.csv&quot;       
##  [7] &quot;SLOP98.csv&quot;        &quot;SUPCRT92.csv&quot;      &quot;inorganic_aq.csv&quot; 
## [10] &quot;inorganic_cr.csv&quot;  &quot;inorganic_gas.csv&quot; &quot;organic_aq.csv&quot;   
## [13] &quot;organic_cr.csv&quot;    &quot;organic_gas.csv&quot;   &quot;organic_liq.csv&quot;  
## [16] &quot;refs.csv&quot;</code></pre>
<p>Some of these files are used to build the default OBIGT database that is created when CHNOSZ starts up. There are also a number of additional data files that have optional datasets. The <a href="OBIGT.html"><span style="color:blue"><em>OBIGT thermodynamic database</em></span></a> vignette summarizes the contents of the default and optional data files. The files can also be opened by a spreadsheet program and used as templates for adding data yourself.</p>
<p><code>thermo()$OBIGT</code> (hereafter, just OBIGT) is the “live” version of the database that is assembled from the CSV data files when CHNOSZ starts up or by using the <code style="color: red;">reset()</code> or <code style="color: red;">OBIGT()</code> functions. The OBIGT data frame is stored in an environment named <code>CHNOSZ</code> that is part of the namespace of the CHNOSZ package. More specifically, it is part of a list named <code>thermo</code>, which has the OBIGT database and other parameters and settings used by CHNOSZ. <code style="color: red;">reset()</code> restores the entire <code>thermo</code> object to default values; <code style="color: red;">OBIGT()</code> restores just the OBIGT data frame. The latter is useful for seeing the effects of changing the thermodynamic database on on chemical affinities calculated with <code style="color: green;">affinity()</code>, without changing the chemical species.</p>
<p>OBIGT can be modified during an R session; if it couldn’t, some of the examples in this vignette would not be possible! When you quit R, it offers the option of saving your workspace so it can be reloaded it when R is restarted. I always say “no” here; my preference is to load data into a fresh session every time I start R. This “load saved workspace” feature means that OBIGT might not be the default database in any given R session. To ensure that this vignette is run using the default database, we start by running <code style="color: red;">reset()</code> to reset OBIGT and the other settings used by CHNOSZ.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">reset</span>()</span></code></pre></div>
<pre><code>## reset: resetting &quot;thermo&quot; object</code></pre>
<pre><code>## OBIGT: loading default database with 1904 aqueous, 3448 total species</code></pre>
<p><code style="color: green;">thermo()</code> is a convenience function to access or modify parts of the <code>thermo</code> list object. To see the first few entries in OBIGT, do this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">head</span>(<span class="kw">thermo</span>()<span class="op">$</span>OBIGT)</span></code></pre></div>
<pre><code>##    name abbrv formula state     ref1  ref2       date model E_units      G
## 1 water  &lt;NA&gt;     H2O   liq    HGK84 JOH92 2006-10-25   H2O     cal     NA
## 2    e-  &lt;NA&gt;   (Z-1)    aq electron  &lt;NA&gt; 2006-10-28   HKF     cal      0
## 3    H+    H+      H+    aq   proton  &lt;NA&gt; 1997-11-06   HKF     cal      0
## 4   Li+   Li+     Li+    aq     SH88  &lt;NA&gt; 1997-11-06   HKF     cal -69933
## 5   Na+   Na+     Na+    aq     SH88  &lt;NA&gt; 1997-11-06   HKF     cal -62591
## 6    K+    K+      K+    aq     SH88  &lt;NA&gt; 1997-11-06   HKF     cal -67510
##        H       S    Cp     V    a1.a   a2.b   a3.c    a4.d  c1.e   c2.f
## 1     NA      NA    NA    NA      NA     NA     NA      NA    NA     NA
## 2      0 15.6166  0.00  0.00  0.0000  0.000  0.000  0.0000  0.00  0.000
## 3      0  0.0000  0.00  0.00  0.0000  0.000  0.000  0.0000  0.00  0.000
## 4 -66552  2.7000 14.20 -0.87 -0.0237 -0.069 11.580 -2.7761 19.20 -0.240
## 5 -57433 13.9600  9.06 -1.11  1.8390 -2.285  3.256 -2.7260 18.18 -2.981
## 6 -60270 24.1500  1.98  9.06  3.5590 -1.473  5.435 -2.7120  7.40 -1.791
##   omega.lambda z.T
## 1           NA  NA
## 2       0.0000   0
## 3       0.0000   0
## 4       0.4862   1
## 5       0.3306   1
## 6       0.1927   1</code></pre>
<!-- ######## SECTION MARKER ######## -->
</div>
<div id="conventions-for-data-entry-in-obigt" class="section level2">
<h2>Conventions for data entry in OBIGT</h2>
<p>The format of OBIGT is described in the CHNOSZ manual: see <code style="color: green;">thermo()</code>. Next, we point out some particular conventions including types of data, required and optional data, order-of-magnitude scaling. Here are the numbered column names for reference:</p>
<pre><code>##  [1] &quot;1 name&quot;          &quot;2 abbrv&quot;         &quot;3 formula&quot;       &quot;4 state&quot;        
##  [5] &quot;5 ref1&quot;          &quot;6 ref2&quot;          &quot;7 date&quot;          &quot;8 model&quot;        
##  [9] &quot;9 E_units&quot;       &quot;10 G&quot;            &quot;11 H&quot;            &quot;12 S&quot;           
## [13] &quot;13 Cp&quot;           &quot;14 V&quot;            &quot;15 a1.a&quot;         &quot;16 a2.b&quot;        
## [17] &quot;17 a3.c&quot;         &quot;18 a4.d&quot;         &quot;19 c1.e&quot;         &quot;20 c2.f&quot;        
## [21] &quot;21 omega.lambda&quot; &quot;22 z.T&quot;</code></pre>
<div id="types-of-data" class="section level3">
<h3>Types of data</h3>
<ul>
<li>Columns 1–9 have character data.
<ul>
<li>Column 8 is named <span style="color: blue;">model</span>; here are the two models that are most frequent in the default database:
<ul>
<li><code>HKF</code>: Revised Helgeson-Kirkham-Flowers “equation-of-state” parameters for aqueous species</li>
<li><code>CGL</code>: Heat capacity coefficients for crystalline, gaseous, and liquid species. The first three terms in the CGL heat capacity equation correspond to the Maier-Kelley equation for heat capacity <span class="citation">(Maier and Kelley, 1932)</span>; the additional terms are useful for representing heat capacities of minerals <span class="citation">(Robie and Hemingway, 1995)</span> and organic gases and liquids <span class="citation">(Helgeson et al., 1998)</span>.</li>
</ul></li>
</ul></li>
<li>Columns 10–22 have numeric data.
<ul>
<li>Columns 10–14 have standard-state thermodynamic properties at 25 °C and 1 bar.</li>
<li>Columns 15–21 have parameters for calculating thermodynamic properties at other temperatures and pressures.
<ul>
<li>The columns are named by combining the the names of the HKF and CGL coefficients, separated by a dot.</li>
</ul></li>
<li>Column 22 has the charge used in the HKF EOS or the maximum temperature for CGL species.
<ul>
<li><span style="background-color: yellow;">NOTE</span>: The value of charge used in the HKF EOS (in particular, the <em>g</em> function for the temperature derivatives of the ω parameter <span class="citation">(Shock et al., 1992)</span>) is taken from this column and not from the chemical formula of the species.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="ranges-of-hkf-and-cgl-models" class="section level3">
<h3>Ranges of HKF and CGL models</h3>
<p>To a first approximation, the revised HKF equations of state are applicable within the stability region of liquid water or the supercritical fluid with a density greater than 0.35 g/cm3, and not exceeding the ranges of 0 to 1000 °C and 1 to 5000 bar <span class="citation">(see Shock et al., 1992 for details)</span>. There are two ways in which these limits are enforced in CHNOSZ:</p>
<ul>
<li>The default source of water properties (H2O92D Fortran subroutine modified from SUPCRT92) yields NA values beyonds these T and P ranges. Note that the Deep Earth Water (DEW) model is available to extend the applicable range to pressures of up to 60 kbar (6 GPa) <span class="citation">(Sverjensky et al., 2014)</span>.</li>
<li><code style="color: green;">subcrt()</code> generates NA values beyond the density limit; the <code>exceed.rhomin</code> argument can be used to enable calculations at lower density in the supercritical region.</li>
</ul>
<p>The upper temperature limit for applicability of the CGL heat-capacity equation corresponds to the temperature of phase transition or to a temperature beyond which extrapolations from experimental data becomes highly uncertain. A maximum temperature can be stored in the final column of OBIGT, and is used by <code style="color: green;">subcrt()</code> to replace computed values with NA above the maximum.</p>
</div>
<div id="required-and-optional-data" class="section level3">
<h3>Required and optional data</h3>
<p>REQUIRED:</p>
<ul>
<li>All species need a <tt style="color: blue;">name</tt> and a <tt style="color: blue;">state</tt>.
<ul>
<li>The state can be one of <code>aq</code>, <code>gas</code>, or <code>cr</code>.</li>
<li>For minerals with higher-temperature polymorphs, they are named <code>cr2</code>, <code>cr3</code>, etc.</li>
<li><span style="background-color: yellow;">NOTE</span>: <code>cr</code> stands for “crystalline”; this naming convention (which was inherited from SUPCRT92 data files) refers to any solid phases including amorphous SiO<sub>2</sub> and other minerals.</li>
</ul></li>
<li>A chemical <tt style="color: blue;">formula</tt> is required to do almost anything useful in CHNOSZ (e.g. check reaction balancing with <code style="color: green;">subcrt()</code> and add species with <code style="color: red;">basis()</code> or <code style="color: red;">species()</code>).
<ul>
<li><span style="background-color: yellow;">NOTE</span>: The <tt style="color: blue;">name</tt> of <em>inorganic</em> aqueous species <em>and CH<sub>4</sub></em> in OBIGT is the same as the chemical formula.</li>
<li>Most minerals, gases, liquids, and organic aqueous species have a <tt style="color: blue;">name</tt> that is a common name. This permits a shortcut to identify commonly used species in <code style="color: green;">subcrt()</code>.</li>
<li>For example, <code>info(&quot;O2&quot;)</code> refers to dissolved oxygen, while <code>info(&quot;oxygen&quot;)</code> or <code>info(&quot;O2&quot;, &quot;gas&quot;)</code> refers to the gas.</li>
</ul></li>
<li><code>E_units</code> needs to be defined to perform any calculations of thermodynamic properties.
<ul>
<li>The value can be <code>J</code> for Joules or <code>cal</code> for calories.</li>
</ul></li>
</ul>
<p>OPTIONAL: Everything else. Really, it depends on what you need. For instance, if you just want to use <code style="color: green;">subcrt()</code> to calculate log <i>K</i> of a reaction from Δ<i>G</i>° of species at 25 °C, then <tt style="color: blue;">G</tt> is the only parameter that is needed.</p>
<p>OPTIONAL but useful:</p>
<ul>
<li><tt style="color: blue;">abbrv</tt> <em>may be</em> an abbreviation (e.g. Qtz for quartz). It is used by <code style="color: green;">info()</code> (together with <tt style="color: blue;">name</tt> and <tt style="color: blue;">formula</tt>) to look up species in the database.</li>
<li><tt style="color: blue;">date</tt> is a timestamp for the data entry (YYYY-MM-DD format in the default OBIGT database).</li>
<li><tt style="color: blue;">ref1</tt> and <tt style="color: blue;">ref2</tt> are bibliographic reference keys. They have matching entries in <code>extdata/OBIGT/refs.csv</code>, which is used by <code style="color: green;">thermo.refs()</code> to display references, and in <code>vignettes/OBIGT.bib</code>, which is used in the <a href="OBIGT.html"><span style="color:blue"><em>OBIGT thermodynamic database</em></span></a> vignette to produce a reference list.</li>
</ul>
<p><span style="background-color: yellow;">NOTE</span>: Other functions in CHNOSZ do not depend on <tt style="color: blue;">date</tt>, <tt style="color: blue;">ref1</tt>, and <tt style="color: blue;">ref2</tt>, so you can put anything there that is convenient for you.</p>
</div>
<div id="na-or-0" class="section level3">
<h3>NA or 0?</h3>
<p>If a character value (in Columns 1–9) or thermodynamic parameter (in Columns 10–14) is unknown, use <code>NA</code>. Note that a missing (blank) value in the file is treated as NA.</p>
<ul>
<li>Unknown values for character values (usually <tt style="color: blue;">abbrv</tt>, <tt style="color: blue;">date</tt>, <tt style="color: blue;">ref1</tt>, or <tt style="color: blue;">ref2</tt>) should be NA.</li>
<li>If you have only two of <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, and <tt style="color: blue;">S</tt>, then the missing one should be NA.
<ul>
<li>Do <strong>NOT</strong> set a missing value of <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, or <tt style="color: blue;">S</tt> to 0. Zero is a numeric value that is incorrect except for very special cases.</li>
<li><span style="background-color: yellow;">NOTE</span>: <code style="color: green;">info()</code> – and, by extension, <code style="color: green;">subcrt()</code> – “know” about the equation Δ<i>G</i>°<sub><i>f</i></sub> = Δ<i>H</i>°<sub><i>f</i></sub> - <i>T</i>Δ<i>S</i>°<sub><i>f</i></sub> and the entropies of the elements needed to calculate Δ<i>S</i>°<sub><i>f</i></sub> from values of <tt style="color: blue;">S</tt> in OBIGT. This equation is used to compute a missing value of <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, or <tt style="color: blue;">S</tt> from the other two, or to cross-check the values if all three are present for any species.</li>
</ul></li>
<li>If you don’t have <tt style="color: blue;">Cp</tt> or <tt style="color: blue;">V</tt>, then set it to NA.
<ul>
<li>If HKF or CGL parameters are present, they will be used to calculate <tt style="color: blue;">Cp</tt>, so thermodynamic properties <em>can</em> be calculated at T &gt; 25 °C.</li>
<li>If HKF or CGL parameters aren’t present, thermodynamic properties <em>can’t</em> be calculated at T &gt; 25 °C (NAs will propagate to higher T).</li>
</ul></li>
</ul>
<p>If an “equation-of-state” parameter or heat capacity coefficient (Columns 15-21) is unknown, use 0.</p>
<ul>
<li>Furthermore, if you would like to assume that <tt style="color: blue;">Cp</tt> or <tt style="color: blue;">V</tt> is 0, then set it to 0.
<ul>
<li>Then, thermodynamic properties will be extrapolated to T &gt; 25 °C and P &gt; 1 bar assuming that <tt style="color: blue;">Cp</tt> and <tt style="color: blue;">V</tt> are 0.</li>
</ul></li>
</ul>
<p>More detail on the inner working of the functions: For both HKF and CGL, if at least one parameter for a species is provided, any NA values of the other parameters are taken to be zero. If all EOS parameters are NA, but values of <tt style="color: blue;">Cp</tt> and/or <tt style="color: blue;">V</tt> are present, they are assumed to be constants for extrapolating thermodynamic properties (e.g. Δ<i>G</i>°) as a function of temperature and pressure.</p>
</div>
<div id="oom-scaling-and-info" class="section level3">
<h3>OOM scaling and <code style="color: green;">info()</code></h3>
<p>HKF parameters in the the CSV files and OBIGT data frame are scaled by order-of-magnitude (OOM) factors. For these parameters, OOM scaling is nearly always used in published data tables. See <code style="color: green;">thermo()</code> for details of the OOM scaling.</p>
<p><code style="color: green;">info()</code> provides a simple user interface to the OBIGT database and is called by other functions in CHNOSZ to retrieve unscaled values from the database. This is a summary of its main features:</p>
<ul>
<li>Remove OOM scaling. This is used primarily by other functions in CHNOSZ to get a set of unscaled <span style="color: blue;">model</span> parameters for calculating thermodynamic properties as a function of T and P.</li>
<li>Extract the HKF or CGL parts of column names (only if all matching species have the same <span style="color: blue;">model</span>).</li>
<li>Calculate a missing one of <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, or <tt style="color: blue;">S</tt> if two of them are present.</li>
<li>Cross-check <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, and <tt style="color: blue;">S</tt> if all of them are present, and print a message if the difference is above a threshold (see <code style="color: green;">checkGHS()</code>).</li>
<li>Calculate a missing <tt style="color: blue;">Cp</tt> or <tt style="color: blue;">V</tt> from the <span style="color: blue;">model</span> parameters, if possible.</li>
<li>Cross-check <tt style="color: blue;">Cp</tt> or <tt style="color: blue;">V</tt> (if present) against the <span style="color: blue;">model</span> parameters, if possible, and print a message if the difference is above a threshold (see <code style="color: green;">checkEOS()</code>).</li>
</ul>
<p><span style="background-color: yellow;">NOTE</span>: <code style="color: green;">info()</code> does <strong>NOT</strong> change the units of energy; the values it displays (including possibly calculated ones) correspond to the <tt style="color: blue;">E_units</tt> for that species in OBIGT. On the other hand, <code style="color: green;">subcrt()</code> outputs values in the units previously selected with the function <code style="color: red;">E.units()</code>.</p>
<!-- ######## SECTION MARKER ######## -->
</div>
</div>
<div id="case-study-na-and-0-in-the-default-database" class="section level2">
<h2>Case study: NA and 0 in the default database</h2>
<p>Use the <code style="color: green;">info()</code> function to look at the database and <code style="color: green;">subcrt()</code> to calculate thermodynamic properties.</p>
<p>Let’s look at some minerals first. First use <code style="color: green;">info()</code> to get the species indices (i.e. rownumbers) in OBIGT, then pull out the “raw” data (including any NA values).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>icr &lt;-<span class="st"> </span><span class="kw">info</span>(<span class="kw">c</span>(<span class="st">&quot;orpiment,amorphous&quot;</span>, <span class="st">&quot;arsenic,alpha&quot;</span>, <span class="st">&quot;tin&quot;</span>))</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">thermo</span>()<span class="op">$</span>OBIGT[icr, ]</span></code></pre></div>
<pre><code>##                    name abbrv formula state ref1     ref2       date model
## 2031 orpiment,amorphous  &lt;NA&gt;   As2S3    cr NA03     &lt;NA&gt; 2017-10-16   CGL
## 2024      arsenic,alpha  &lt;NA&gt;      As    cr NA03 ZZL+16.1 2017-10-16   CGL
## 1973                tin    Sn      Sn    cr JH85     &lt;NA&gt; 1985-08-00   CGL
##      E_units      G      H      S    Cp      V a1.a   a2.b a3.c a4.d c1.e c2.f
## 2031       J -76800 -66900 200.00    NA     NA   NA     NA   NA   NA   NA   NA
## 2024       J      0      0  35.63 24.43 12.960   NA     NA   NA   NA   NA   NA
## 1973     cal      0      0  12.24    NA 16.289 4.42 0.0063    0    0    0    0
##      omega.lambda    z.T
## 2031           NA     NA
## 2024           NA     NA
## 1973            0 505.06</code></pre>
<p>Based on the values in the <tt style="color: blue;">Cp</tt> column, would you predict that thermodynamic properties at T &gt; 25 °C could be calculated for all of these minerals? Let’s see …</p>
<p>For conciseness we’ll consider a relatively small temperature range and display only the <code>out</code> part of the <code style="color: green;">subcrt()</code> output.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">subcrt</span>(<span class="st">&quot;orpiment,amorphous&quot;</span>, <span class="dt">T =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>))<span class="op">$</span>out[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## subcrt: 1 species at 3 values of T (ºC) and P (bar) [energy units: J]</code></pre>
<pre><code>##    T P    logK      G      H   S  V Cp
## 1 25 1 13.4548 -76800 -66900 200 NA NA
## 2 50 1      NA     NA     NA  NA NA NA
## 3 75 1      NA     NA     NA  NA NA NA</code></pre>
<p>That makes sense; integrating NA <tt style="color: blue;">Cp</tt> to calculate Gibbs energy and other thermodynamic properties would propagate NA, and that is what appears in the output. Now let’s run the calculation for the alpha phase of arsenic.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">subcrt</span>(<span class="st">&quot;arsenic,alpha&quot;</span>, <span class="dt">T =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>))<span class="op">$</span>out[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## subcrt: 1 species at 3 values of T (ºC) and P (bar) [energy units: J]</code></pre>
<pre><code>##    T P     logK         G       H       S     V    Cp
## 1 25 1 0.000000     0.000    0.00 35.6300 12.96 24.43
## 2 50 1 0.148008  -915.669  610.75 37.5971 12.96 24.43
## 3 75 1 0.281856 -1878.634 1221.50 39.4175 12.96 24.43</code></pre>
<p>What happened here? Even though there are no heat capacity coefficients (see above), there is a non-NA value of <tt style="color: blue;">Cp</tt>, and that value is used together with the entropy for calculating Gibbs energy at T &gt; 25 °C. Note that zero for the 25 °C values of G and H in this case is not a placeholder for unknown values (as noted above, unknown values should be represented by NA). Instaed, this is the reference state for the element, for which G and H are by convention equal to zero.</p>
<p>Let’s look at another element in its reference state, tin:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">subcrt</span>(<span class="st">&quot;tin&quot;</span>, <span class="dt">T =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>))<span class="op">$</span>out[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## info.character: found tin(cr) with 1 phase transition</code></pre>
<pre><code>## subcrt: 1 species at 3 values of T (ºC) and P (bar) [energy units: J]</code></pre>
<pre><code>## subcrt: 2 phases for tin ... phase 1 is stable</code></pre>
<pre><code>##    T P     logK        G        H       S      V      Cp polymorph
## 1 25 1 0.000000     0.00    0.000 51.2122 16.289 26.3523         1
## 2 50 1 0.211328 -1307.40  667.044 53.3602 16.289 27.0113         1
## 3 75 1 0.400149 -2667.09 1350.563 55.3973 16.289 27.6702         1</code></pre>
<p>Are you surprised? You might be if you only noticed the NA value for <tt style="color: blue;">Cp</tt> in OBIGT. However, there are non-NA values for the heat capacity coefficients, which are used to calculate <i>C<sub>p</sub></i>° as a function of temperature. When supplied with a numeric argument (a species index), <code style="color: green;">info()</code> actually does this to fill in missing 25 °C values of <tt style="color: blue;">Cp</tt>, <tt style="color: blue;">V</tt>, and <tt style="color: blue;">G</tt>, <tt style="color: blue;">H</tt>, or <tt style="color: blue;">S</tt> if possible, in addition to simplifying column names:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">info</span>(<span class="kw">info</span>(<span class="st">&quot;tin&quot;</span>))</span></code></pre></div>
<pre><code>## info.character: found tin(cr) with 1 phase transition</code></pre>
<pre><code>## info.numeric: Cp of tin(cr) is NA; set by EOS parameters to 6.3 cal K-1 mol-1</code></pre>
<pre><code>##      name abbrv formula state ref1 ref2       date model E_units G H     S
## 1973  tin    Sn      Sn    cr JH85 &lt;NA&gt; 1985-08-00   CGL     cal 0 0 12.24
##           Cp      V    a      b c d e f lambda      T
## 1973 6.29834 16.289 4.42 0.0063 0 0 0 0      0 505.06</code></pre>
</div>
<div id="examples-of-adding-data-from-a-file" class="section level2">
<h2>Examples of adding data from a file</h2>
<p>Using <code style="color: red;">add.OBIGT()</code> to add data from optional data files for OBIGT or CSV files you make yourself.</p>
<div id="add.obigt-with-optional-data-files" class="section level3">
<h3><code style="color: red;">add.OBIGT()</code> with optional data files</h3>
<p>The default database has parameters for many minerals from <span class="citation">Berman (1988)</span>; a notable exception is sulfide minerals, which are from <span class="citation">Helgeson et al. (1978)</span>. Besides the different literature sources in <tt style="color: blue;">ref1</tt>, the <span style="color: blue;">model</span> column indicates that a different model is used for these minerals (Berman equations or CGL).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">info</span>(<span class="kw">info</span>(<span class="kw">c</span>(<span class="st">&quot;quartz&quot;</span>, <span class="st">&quot;pyrite&quot;</span>)))</span></code></pre></div>
<pre><code>## info.numeric: Cp of pyrite(cr) is NA; set by EOS parameters to 14.84 cal K-1 mol-1</code></pre>
<pre><code>##        name abbrv formula state   ref1 ref2       date  model E_units       G
## 2593 quartz    Qz    SiO2    cr  Ber88 &lt;NA&gt; 2017-10-01 Berman       J -856288
## 1954 pyrite    Py    FeS2    cr HDNB78 &lt;NA&gt; 1978-05-05    CGL     cal  -38293
##            H     S      Cp     V     a       b       c  d  e  f lambda    T
## 2593 -910700 41.46 44.7423 22.69    NA      NA      NA NA NA NA     NA   NA
## 1954  -41000 12.65 14.8425 23.94 17.88 0.00132 -305000  0  0  0      0 1000</code></pre>
<p>Sometimes it is useful to load mineral data from the SUPCRT92 database, corresponding largely to the compilation by <span class="citation">Helgeson et al. (1978)</span>. This can be done with <code style="color: red;">add.OBIGT()</code>. In this example we load SUPCRT92 data for just one mineral, quartz.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">add.OBIGT</span>(<span class="st">&quot;SUPCRT92&quot;</span>, <span class="st">&quot;quartz&quot;</span>)</span></code></pre></div>
<pre><code>## add.OBIGT: read 1 rows; made 1 replacements, 0 additions [energy units: cal]</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">info</span>(<span class="kw">info</span>(<span class="st">&quot;quartz&quot;</span>))</span></code></pre></div>
<pre><code>## info.numeric: Cp of quartz(cr) is NA; set by EOS parameters to 10.63 cal K-1 mol-1</code></pre>
<pre><code>##        name abbrv formula state   ref1 ref2       date model E_units       G
## 2593 quartz   Qtz    SiO2    cr HDNB78 &lt;NA&gt; 1978-05-05   CGL     cal -204646
##            H    S      Cp      V     a      b       c d e f lambda   T
## 2593 -217650 9.88 10.6275 22.688 11.22 0.0082 -270000 0 0 0      0 848</code></pre>
<p>Here we load all minerals available in the optional SUPCRT92 data file and then list the names. <span style="background-color: yellow;">NOTE</span>: <code>suppressMessages()</code> is used to suppress messages from <code style="color: green;">info()</code> about missing parameters, and <code>unique()</code> is used to list each mineral only once (because each polymorph has a separate entry).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>iSUPCRT92 &lt;-<span class="st"> </span><span class="kw">add.OBIGT</span>(<span class="st">&quot;SUPCRT92&quot;</span>)</span></code></pre></div>
<pre><code>## add.OBIGT: read 177 rows; made 65 replacements, 112 additions [energy units: cal]</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">unique</span>(<span class="kw">suppressMessages</span>(<span class="kw">info</span>(iSUPCRT92))<span class="op">$</span>name)</span></code></pre></div>
<pre><code>##   [1] &quot;akermanite&quot;          &quot;albite&quot;              &quot;albite,high&quot;        
##   [4] &quot;albite,low&quot;          &quot;almandine&quot;           &quot;andalusite&quot;         
##   [7] &quot;andradite&quot;           &quot;annite&quot;              &quot;anorthite&quot;          
##  [10] &quot;anthophyllite&quot;       &quot;antigorite&quot;          &quot;aragonite&quot;          
##  [13] &quot;boehmite&quot;            &quot;brucite&quot;             &quot;Ca-Al-pyroxene&quot;     
##  [16] &quot;calcite&quot;             &quot;chrysotile&quot;          &quot;clinozoisite&quot;       
##  [19] &quot;coesite&quot;             &quot;corundum&quot;            &quot;cristobalite,alpha&quot; 
##  [22] &quot;cristobalite,beta&quot;   &quot;diaspore&quot;            &quot;diopside&quot;           
##  [25] &quot;dolomite&quot;            &quot;enstatite&quot;           &quot;epidote&quot;            
##  [28] &quot;fayalite&quot;            &quot;ferrosilite&quot;         &quot;fluorphlogopite&quot;    
##  [31] &quot;fluortremolite&quot;      &quot;forsterite&quot;          &quot;gehlenite&quot;          
##  [34] &quot;gibbsite&quot;            &quot;glaucophane&quot;         &quot;grossular&quot;          
##  [37] &quot;grunerite&quot;           &quot;hedenbergite&quot;        &quot;hematite&quot;           
##  [40] &quot;jadeite&quot;             &quot;K-feldspar&quot;          &quot;kaolinite&quot;          
##  [43] &quot;kyanite&quot;             &quot;lawsonite&quot;           &quot;lime&quot;               
##  [46] &quot;magnesite&quot;           &quot;magnetite&quot;           &quot;margarite&quot;          
##  [49] &quot;merwinite&quot;           &quot;monticellite&quot;        &quot;muscovite&quot;          
##  [52] &quot;paragonite&quot;          &quot;periclase&quot;           &quot;phlogopite&quot;         
##  [55] &quot;prehnite&quot;            &quot;pyrope&quot;              &quot;pyrophyllite&quot;       
##  [58] &quot;quartz&quot;              &quot;sillimanite&quot;         &quot;spinel&quot;             
##  [61] &quot;talc&quot;                &quot;tremolite&quot;           &quot;wollastonite&quot;       
##  [64] &quot;zoisite&quot;             &quot;rutile&quot;              &quot;aegerine&quot;           
##  [67] &quot;amesite,14A&quot;         &quot;amesite,7A&quot;          &quot;amorphous silica&quot;   
##  [70] &quot;analcime&quot;            &quot;analcime,dehydrated&quot; &quot;Ca-phillipsite&quot;     
##  [73] &quot;celadonite&quot;          &quot;chabazite&quot;           &quot;chalcedony&quot;         
##  [76] &quot;chloritoid&quot;          &quot;clinochlore,14A&quot;     &quot;clinochlore,7A&quot;     
##  [79] &quot;cordierite,dry&quot;      &quot;cordierite,hydrous&quot;  &quot;cristobalite&quot;       
##  [82] &quot;cronstedtite,7A&quot;     &quot;cummingtonite&quot;       &quot;daphnite,14A&quot;       
##  [85] &quot;daphnite,7A&quot;         &quot;dickite&quot;             &quot;dolomite,disordered&quot;
##  [88] &quot;dolomite,ordered&quot;    &quot;edenite&quot;             &quot;epidote,ordered&quot;    
##  [91] &quot;epistilbite&quot;         &quot;ferroedenite&quot;        &quot;ferrogedrite&quot;       
##  [94] &quot;ferropargasite&quot;      &quot;ferrotremolite&quot;      &quot;fluoredenite&quot;       
##  [97] &quot;fluorite&quot;            &quot;greenalite&quot;          &quot;halloysite&quot;         
## [100] &quot;hastingsite&quot;         &quot;heulandite&quot;          &quot;K-phillipsite&quot;      
## [103] &quot;kalsilite&quot;           &quot;larnite&quot;             &quot;laumontite&quot;         
## [106] &quot;leonhardite&quot;         &quot;magnesiohastingsite&quot; &quot;magnesioriebeckite&quot; 
## [109] &quot;microcline,maximum&quot;  &quot;minnesotaite&quot;        &quot;Na-phillipsite&quot;     
## [112] &quot;natrolite&quot;           &quot;nepheline&quot;           &quot;pargasite&quot;          
## [115] &quot;PD-oxyannite&quot;        &quot;richterite&quot;          &quot;riebeckite&quot;         
## [118] &quot;sanidine,high&quot;       &quot;sepiolite&quot;           &quot;spessartine&quot;        
## [121] &quot;staurolite&quot;          &quot;stilbite&quot;            &quot;wairakite&quot;          
## [124] &quot;titanite&quot;</code></pre>
</div>
<div id="add.obigt-with-other-csv-files" class="section level3">
<h3><code style="color: red;">add.OBIGT()</code> with other CSV files</h3>
<p><code style="color: red;">add.OBIGT()</code> can also be used to add data from a user-specified file to the OBIGT database. The file must be a CSV (comma separated value) file with column headers that match those in the default database (i.e., <code>thermo()$OBIGT</code>). As an example, here are the contents of <code>BZA10.csv</code>, which has parameters taken from <span class="citation">Bazarkina et al. (2010)</span>. Missing values are indicated by <code>NA</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/adds/BZA10.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;CHNOSZ&quot;</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="kw">read.csv</span>(file, <span class="dt">as.is =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##      name abbrv formula state  ref1 ref2       date model E_units       G  H
## 1   CdCl+    NA   CdCl+    aq BZA10   NA 2010-07-03   HKF     cal  -52629 NA
## 2   CdCl2    NA   CdCl2    aq BZA10   NA 2010-07-03   HKF     cal  -84883 NA
## 3  CdCl3-    NA  CdCl3-    aq BZA10   NA 2010-07-03   HKF     cal -115399 NA
## 4 CdCl4-2    NA CdCl4-2    aq BZA10   NA 2010-07-03   HKF     cal -145583 NA
##       S     Cp     V    a1.a    a2.b    a3.c    a4.d    c1.e    c2.f
## 1  7.06  11.12  2.20  2.2303 -2.3357  6.6681 -2.6824 16.6723 -0.7693
## 2 25.72 116.01 42.21  7.5221 10.5852  1.5895 -3.2166 73.7023 20.5956
## 3 45.15  97.78 63.47 10.8045 18.5994 -1.5605 -3.5479 72.0244 16.8832
## 4 50.61  42.52 81.35 13.8329 25.9938 -4.4669 -3.8536 53.6766  5.6267
##   omega.lambda z.T
## 1       0.4372   1
## 2      -0.0495   0
## 3       0.9378  -1
## 4       2.4766  -2</code></pre>
<p>Loading the data with <code style="color: red;">add.OBIGT()</code> produces a message that the new data replace existing species. We can then use <code style="color: green;">subcrt()</code> to calculate the equilibrium constant for a reaction involving the new species. Note the decrease in the stepwise stability constant for the second cadmium chloride complex with increasing pressure (Bazarkina et al., 2010, Fig. 4).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>iCd &lt;-<span class="st"> </span><span class="kw">add.OBIGT</span>(file)</span></code></pre></div>
<pre><code>## add.OBIGT: read 4 rows; made 4 replacements, 0 additions [energy units: cal]</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">subcrt</span>(<span class="kw">c</span>(<span class="st">&quot;CdCl+&quot;</span>, <span class="st">&quot;Cl-&quot;</span>, <span class="st">&quot;CdCl2&quot;</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>), <span class="dt">T =</span> <span class="dv">25</span>, <span class="dt">P =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## subcrt: 3 species at 2 values of T (ºC) and P (bar) (wet) [energy units: J]</code></pre>
<pre><code>## $reaction
##     coeff  name formula state ispecies model
## 392    -1 CdCl+   CdCl+    aq      392   HKF
## 29     -1   Cl-     Cl-    aq       29   HKF
## 393     1 CdCl2   CdCl2    aq      393   HKF
## 
## $out
##    T    P      rho      logK         G       H       S       V      Cp
## 1 25    1 0.997061 0.6413808 -3661.000 2669.61 21.3384 22.6816 561.306
## 2 25 2000 1.071783 0.0618531  -353.058 2732.39 10.4541 12.2632 539.264</code></pre>
<p>After running <code style="color: red;">reset()</code> we can look up the source of data in the default OBIGT database <span class="citation">(Sverjensky et al., 1997)</span>. Running the reaction with thermodynamic parameters from the default database, we now see that the equilibrium constant is not as sensitive to pressure:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">reset</span>()</span></code></pre></div>
<pre><code>## reset: resetting &quot;thermo&quot; object</code></pre>
<pre><code>## OBIGT: loading default database with 1904 aqueous, 3448 total species</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">thermo.refs</span>(iCd)[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##      key                                           author year
## 86 SSH97 D. A. Sverjensky, E. L. Shock and H. C. Helgeson 1997</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">subcrt</span>(<span class="kw">c</span>(<span class="st">&quot;CdCl+&quot;</span>, <span class="st">&quot;Cl-&quot;</span>, <span class="st">&quot;CdCl2&quot;</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>), <span class="dt">T =</span> <span class="dv">25</span>, <span class="dt">P =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## subcrt: 3 species at 2 values of T (ºC) and P (bar) (wet) [energy units: J]</code></pre>
<pre><code>## $reaction
##     coeff  name formula state ispecies model
## 392    -1 CdCl+   CdCl+    aq      392   HKF
## 29     -1   Cl-     Cl-    aq       29   HKF
## 393     1 CdCl2   CdCl2    aq      393   HKF
## 
## $out
##    T    P      rho     logK        G        H        S        V      Cp
## 1 25    1 0.997061 0.619391 -3535.48 -8522.81 -16.7360 10.04043 214.488
## 2 25 2000 1.071783 0.425897 -2431.02 -9603.90 -24.0664  2.34196 191.416</code></pre>
<!-- ######## SECTION MARKER ######## -->
</div>
</div>
<div id="examples-of-adding-and-modifying-data-with-a-function" class="section level2">
<h2>Examples of adding and modifying data with a function</h2>
<p>Use <code style="color: red;">mod.OBIGT()</code> to add or modify the database in the current session. The function requires the name of a species and one or more properties to change.</p>
<div id="mod.obigt-for-aqueous-species" class="section level3">
<h3><code style="color: red;">mod.OBIGT()</code> for aqueous species</h3>
<p>Let’s add data for CoCl<sub>4</sub><sup>-2</sup> from <span class="citation">Liu et al. (2011)</span>. The values are taken from Table 5 of that paper; note that they are reported in caloric units, which is rather common for the HKF model. The entry includes the date in ISO 8601 extended format (e.g. 2020-08-16); <code>Sys.Date()</code> is used in this example to get the current date.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">mod.OBIGT</span>(<span class="st">&quot;CoCl4-2&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;CoCl4-2&quot;</span>, <span class="dt">state =</span> <span class="st">&quot;aq&quot;</span>, <span class="dt">ref1 =</span> <span class="st">&quot;LBT+11&quot;</span>, <span class="dt">E_units =</span> <span class="st">&quot;cal&quot;</span>,</span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="dt">date =</span> <span class="kw">as.character</span>(<span class="kw">Sys.Date</span>()), <span class="dt">G =</span> <span class="dv">-134150</span>, <span class="dt">H =</span> <span class="dv">-171558</span>, <span class="dt">S =</span> <span class="fl">19.55</span>, <span class="dt">Cp =</span> <span class="fl">72.09</span>, <span class="dt">V =</span> <span class="fl">27.74</span>)</span></code></pre></div>
<pre><code>## mod.OBIGT: updated CoCl4-2(aq)</code></pre>
<pre><code>## [1] 844</code></pre>
<p>The function prints a message saying that the species was added and returns the species index of the new species. Now let’s modify the new species by adding the HKF coefficients including the OOM multipliers, as they are usually given in publications. The <code>z</code> at the end refers to the charge of the species, and is used only for calculating the “<em>g</em> function” in the revised HKF model, not for balancing reactions.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">mod.OBIGT</span>(<span class="st">&quot;CoCl4-2&quot;</span>, <span class="dt">a1 =</span> <span class="fl">6.5467</span>, <span class="dt">a2 =</span> <span class="fl">8.2069</span>, <span class="dt">a3 =</span> <span class="fl">2.0130</span>, <span class="dt">a4 =</span> <span class="fl">-3.1183</span>,</span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="dt">c1 =</span> <span class="fl">76.3357</span>, <span class="dt">c2 =</span> <span class="fl">11.6389</span>, <span class="dt">omega =</span> <span class="fl">2.9159</span>, <span class="dt">z =</span> <span class="dv">-2</span>)</span></code></pre></div>
<pre><code>## mod.OBIGT: no change for CoCl4-2(aq)</code></pre>
<pre><code>## [1] 844</code></pre>
<p>Let us now calculate the equilibrium constant for the formation of CoCl<sub>4</sub><sup>-2</sup> from Co<sup>+2</sup> and Cl<sup>-</sup>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>T &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">350</span>, <span class="dv">50</span>))</span>
<span id="cb61-2"><a href="#cb61-2"></a>sres &lt;-<span class="st"> </span><span class="kw">subcrt</span>(<span class="kw">c</span>(<span class="st">&quot;Co+2&quot;</span>, <span class="st">&quot;Cl-&quot;</span>, <span class="st">&quot;CoCl4-2&quot;</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-4</span>, <span class="dv">1</span>), <span class="dt">T =</span> T)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="kw">round</span>(sres<span class="op">$</span>out<span class="op">$</span>logK, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] -3.20 -2.96 -2.02 -0.74  0.77  2.50  4.57  7.29</code></pre>
<p>The calculated values of log<em>K</em> are identical to those in Table 9 of <span class="citation">Liu et al. (2011)</span>, which provides a good indication that the thermodynamic parameters were entered correctly. Nevertheless, this isn’t a guarantee that the thermodynamic parameters are consistent with the provided values of <em>C</em><sub><em>P</em></sub>° and <em>V</em>°. We can see this by running <code style="color: green;">info()</code> to cross-check the parameters for the new CoCl<sub>4</sub><sup>-2</sup> species:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>inew &lt;-<span class="st"> </span><span class="kw">info</span>(<span class="st">&quot;CoCl4-2&quot;</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">info</span>(inew)</span></code></pre></div>
<pre><code>## checkEOS: Cp of CoCl4-2(aq) differs by 1.33 cal K-1 mol-1 from tabulated value</code></pre>
<pre><code>## checkEOS: V of CoCl4-2(aq) differs by -1.19 cm3 mol-1 from tabulated value</code></pre>
<p>The messages indicate that the given values of <em>C</em><sub><em>P</em></sub>° and <em>V</em>° differ slightly from those calculated using the HKF parameters.</p>
</div>
<div id="mod.obigt-for-minerals" class="section level3">
<h3><code style="color: red;">mod.OBIGT()</code> for minerals</h3>
<p>Let’s add data for magnesiochromite from <span class="citation">Klemme et al. (2000)</span>. The parameters in this paper are reported in Joules, so we set the <code style="color: red;">E.units()</code> to J. The value for volume, in cm<sup>3</sup> mol<sup>-1</sup>, is from <span class="citation">Robie and Hemingway (1995)</span>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>H &lt;-<span class="st"> </span><span class="dv">-1762000</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>S &lt;-<span class="st"> </span><span class="fl">119.6</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>V &lt;-<span class="st"> </span><span class="fl">43.56</span></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="kw">mod.OBIGT</span>(<span class="st">&quot;magnesiochromite&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;MgCr2O4&quot;</span>, <span class="dt">state =</span> <span class="st">&quot;cr&quot;</span>, <span class="dt">ref1 =</span> <span class="st">&quot;KOSG00&quot;</span>,</span>
<span id="cb66-5"><a href="#cb66-5"></a>          <span class="dt">date =</span> <span class="kw">as.character</span>(<span class="kw">Sys.Date</span>()), <span class="dt">E_units =</span> <span class="st">&quot;J&quot;</span>, <span class="dt">H =</span> H, <span class="dt">S =</span> S, <span class="dt">V =</span> V)</span></code></pre></div>
<pre><code>## mod.OBIGT: added magnesiochromite(cr) with CGL model and energy units of J</code></pre>
<pre><code>## [1] 3449</code></pre>
<p>Here are the heat capacity parameters for the Haas-Fisher polynomial equation (<span class="math inline"><em>C</em><em>p</em> = <em>a</em> + <em>b</em><em>T</em> + <em>c</em><em>T</em><sup> − 2</sup> + <em>d</em><em>T</em><sup> − 0.5</sup> + <em>e</em><em>T</em><sup>2</sup></span>). As of CHNOSZ 2.0.0, OOM multipliers are not used for these coefficients. 1500 K is a generic value for the high-temperature limit; experimental heat capacities were only reported up to 340 K <span class="citation">(Klemme et al., 2000)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>a &lt;-<span class="st"> </span><span class="fl">221.4</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>b &lt;-<span class="st"> </span><span class="fl">-0.00102030</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>c &lt;-<span class="st"> </span><span class="dv">-1757210</span></span>
<span id="cb69-4"><a href="#cb69-4"></a>d &lt;-<span class="st"> </span><span class="fl">-1247.9</span></span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="kw">mod.OBIGT</span>(<span class="st">&quot;magnesiochromite&quot;</span>, <span class="dt">E_units =</span> <span class="st">&quot;J&quot;</span>, <span class="dt">a =</span> a, <span class="dt">b =</span> b, <span class="dt">c =</span> c, <span class="dt">d =</span> d,</span>
<span id="cb69-6"><a href="#cb69-6"></a>          <span class="dt">e =</span> <span class="dv">0</span>, <span class="dt">f =</span> <span class="dv">0</span>, <span class="dt">lambda =</span> <span class="dv">0</span>, <span class="dt">T =</span> <span class="dv">1500</span>)</span></code></pre></div>
<pre><code>## mod.OBIGT: updated magnesiochromite(cr)</code></pre>
<pre><code>## [1] 3449</code></pre>
<p><span style="background-color: yellow;">NOTE</span>: An additional <tt style="color: blue;">f</tt> term is available, which can have any exponent given in <tt style="color: blue;">lambda</tt>. This offers some flexibility for using heat capacity equations that are different from the Haas-Fisher polynomial.</p>
<p>Now we can use <code style="color: green;">subcrt()</code> to calculate the heat capacity of magnesiochromite. For this calculation, we set the temperature units to Kelvin. We also specify a pressure of 1 bar because the default setting of <em>P</em><sub>sat</sub> (liquid-vapor saturation) causes an error below the freezing temperature of water.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">T.units</span>(<span class="st">&quot;K&quot;</span>)</span></code></pre></div>
<pre><code>## changed temperature units to K</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>Tref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">340</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>(sres &lt;-<span class="st"> </span><span class="kw">subcrt</span>(<span class="st">&quot;magnesiochromite&quot;</span>, <span class="dt">property =</span> <span class="st">&quot;Cp&quot;</span>, <span class="dt">T =</span> Tref, <span class="dt">P =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## subcrt: 1 species at 3 values of T (K) and P (bar) [energy units: J]</code></pre>
<pre><code>## $species
##                  name formula state ispecies model
## 3449 magnesiochromite MgCr2O4    cr     3449   CGL
## 
## $out
## $out$magnesiochromite
##     T P      Cp
## 1 250 1 114.105
## 2 300 1 129.522
## 3 340 1 138.175</code></pre>
<p>Next we check that the calculated values are within 0.3 J K<sup>-1</sup> mol<sup>-1</sup> of reference values taken from Fig. 1 of <span class="citation">Klemme et al. (2000)</span>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>Cpref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">114.3</span>, <span class="fl">129.8</span>, <span class="fl">138.4</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">stopifnot</span>(<span class="kw">max</span>(<span class="kw">abs</span>(sres<span class="op">$</span>out[[<span class="dv">1</span>]]<span class="op">$</span>Cp <span class="op">-</span><span class="st"> </span>Cpref)) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>)</span></code></pre></div>
<p>Finally, let’s restore the units setting for later calculations with <code style="color: green;">subcrt()</code>. (Another way would be to run <code style="color: red;">reset()</code>, which also resets the OBIGT database.)</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">T.units</span>(<span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<pre><code>## changed temperature units to C</code></pre>
<!-- ######## SECTION MARKER ########
## Other models

Here we'll look at how to add minerals that use the Berman equations and aqueous nonelectrolytes that use the Akinfiev-Diamond model.

### Akinfiev-Diamond model

The Akinfiev-Diamond model for aqueous species [@AD03] is activated by setting \code{abbrv = "AD"} in <code style="color: green;">thermo()</code> for a given aqueous species.
The database must also include a corresponding gaseous species with the same name or chemical formula.

TODO

TODO: Add van't Hoff example?
-->
<!-- ######## SECTION MARKER ######## -->
</div>
</div>
<div id="case-study-formation-constants-for-aqueous-tungsten-species" class="section level2">
<h2>Case study: Formation constants for aqueous tungsten species</h2>
<p>Here we use <code style="color: red;">logB.to.OBIGT()</code> to fit to thermodynamic parameters to experimental formation constants. Some additional steps are shown to refine a thermodynamic model to generate a speciation diagram as a function of pH.</p>
<div id="fitting-formation-constants" class="section level3">
<h3>Fitting formation constants</h3>
<p><code style="color: red;">logB.to.OBIGT()</code> requires three things:</p>
<ul>
<li>Experimental decimal logarithms of formation constants (log β) as a function of temperature;</li>
<li>The stoichiometry of the formation reaction in terms of known species (the new species must be last);</li>
<li>The experimental temperature and pressure.</li>
</ul>
<p><code style="color: red;">logB.to.OBIGT()</code> does three things:</p>
<ul>
<li>Combines the formation constants with standard Gibbs energies (Δ<i>G</i>°) of the known species to calculate Δ<i>G</i>° of the new species;</li>
<li>Fits Δ<i>G</i>° of the new species using 25 °C thermodynamic properties and selected HKF model parameters (i.e., <tt style="color: blue;">G</tt>, <tt style="color: blue;">S</tt>, <tt style="color: blue;">c1</tt>, <tt style="color: blue;">c2</tt>, and <tt style="color: blue;">omega</tt> parameters in OBIGT);</li>
<li>Adds the parameters to OBIGT for use by other functions in CHNOSZ.</li>
</ul>
<p>First we set the pressure for all log β data.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>P &lt;-<span class="st"> &quot;Psat&quot;</span></span></code></pre></div>
<p>Add first species: HWO<sub>4</sub><sup>-</sup> <span class="citation">(Wang et al., 2019)</span>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>T &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">350</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a>logB &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.58</span>, <span class="fl">6.51</span>, <span class="fl">7.99</span>)</span>
<span id="cb81-3"><a href="#cb81-3"></a>species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WO4-2&quot;</span>, <span class="st">&quot;H+&quot;</span>, <span class="st">&quot;HWO4-&quot;</span>)</span>
<span id="cb81-4"><a href="#cb81-4"></a>coeff &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="kw">logB.to.OBIGT</span>(logB, species, coeff, T, P)</span></code></pre></div>
<pre><code>## mod.OBIGT: updated HWO4-(aq)</code></pre>
<pre><code>## logB.to.OBIGT: mean absolute difference between logB (experimental) and logK (calculated) is 0</code></pre>
<pre><code>## [1] 442</code></pre>
<p>Add second species: H<sub>3</sub>WO<sub>4</sub>F<sub>2</sub><sup>-</sup> <span class="citation">(Wang et al., 2021)</span>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>T &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">25</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>logB &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">17.00</span>, <span class="fl">17.11</span>, <span class="fl">17.46</span>, <span class="fl">17.75</span>, <span class="fl">18.17</span>, <span class="fl">18.71</span>, <span class="fl">19.23</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="co"># Species and coefficients in the formation reaction</span></span>
<span id="cb85-4"><a href="#cb85-4"></a>species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;H+&quot;</span>, <span class="st">&quot;WO4-2&quot;</span>, <span class="st">&quot;F-&quot;</span>, <span class="st">&quot;H3WO4F2-&quot;</span>)</span>
<span id="cb85-5"><a href="#cb85-5"></a>coeff &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">-2</span>, <span class="dv">1</span>)</span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="kw">logB.to.OBIGT</span>(logB, species, coeff, T, P)</span></code></pre></div>
<pre><code>## mod.OBIGT: updated H3WO4F2-(aq)</code></pre>
<pre><code>## logB.to.OBIGT: mean absolute difference between logB (experimental) and logK (calculated) is 0.0307</code></pre>
<pre><code>## [1] 3450</code></pre>
<p>Add third species: H<sub>2</sub>WO<sub>4</sub> <span class="citation">(Wang et al., 2021)</span>. Here we increase the tolerance because there is considerable scatter in the experimental values.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>logB &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">7.12</span>, <span class="fl">7.82</span>, <span class="fl">7.07</span>, <span class="fl">7.76</span>, <span class="fl">7.59</span>, <span class="fl">7.98</span>, <span class="fl">8.28</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a>species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;H+&quot;</span>, <span class="st">&quot;WO4-2&quot;</span>, <span class="st">&quot;H2WO4&quot;</span>)</span>
<span id="cb89-3"><a href="#cb89-3"></a>coeff &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="kw">logB.to.OBIGT</span>(logB, species, coeff, T, P, <span class="dt">tolerance =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>## mod.OBIGT: updated H2WO4(aq)</code></pre>
<pre><code>## logB.to.OBIGT: mean absolute difference between logB (experimental) and logK (calculated) is 0.2035</code></pre>
<pre><code>## [1] 883</code></pre>
<p>After running, <code style="color: red;">logB.to.OBIGT()</code> returns the species indices; the low values for HWO<sub>4</sub><sup>-</sup> (442) and H<sub>2</sub>WO<sub>4</sub> (883) indicate that the function replaced parameters for these species that were already present in OBIGT.</p>
</div>
<div id="diagram-1-constant-molality-of-f-" class="section level3">
<h3>Diagram 1: Constant molality of F<sup>-</sup></h3>
<p>Now we’re ready to make a speciation diagram. Our aim is to reproduce Fig. 7b of <span class="citation">Wang et al. (2021)</span>, which is made for 300 °C. A constant molality of F<sup>-</sup> is based on the assumption of complete dissociation of 0.1 m NaF (we’ll change this later). An ionic strength of 0.9 mol/kg is estimated for a solution with 1.8 m NaCl (use <code>NaCl(1.8, T = 300)</code>). <span style="background-color: yellow;">NOTE</span>: because the ionic strength is non-zero, the calculations here refer to molality instead of activity of species (see <a href="anintro.html#from-activity-to-molality">An Introduction to CHNOSZ</a>).</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">basis</span>(<span class="kw">c</span>(<span class="st">&quot;H+&quot;</span>, <span class="st">&quot;WO4-2&quot;</span>, <span class="st">&quot;F-&quot;</span>, <span class="st">&quot;H2O&quot;</span>, <span class="st">&quot;O2&quot;</span>))</span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="kw">basis</span>(<span class="st">&quot;F-&quot;</span>, <span class="kw">log10</span>(<span class="fl">0.1</span>))</span>
<span id="cb93-3"><a href="#cb93-3"></a>iaq &lt;-<span class="st"> </span><span class="kw">retrieve</span>(<span class="st">&quot;W&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;O&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;F&quot;</span>), <span class="st">&quot;aq&quot;</span>)</span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="kw">species</span>(iaq)</span>
<span id="cb93-5"><a href="#cb93-5"></a>a &lt;-<span class="st"> </span><span class="kw">affinity</span>(<span class="dt">pH =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">7</span>), <span class="dt">T =</span> <span class="dv">300</span>, <span class="dt">IS =</span> <span class="fl">0.9</span>)</span>
<span id="cb93-6"><a href="#cb93-6"></a>e &lt;-<span class="st"> </span><span class="kw">equilibrate</span>(a)</span>
<span id="cb93-7"><a href="#cb93-7"></a>col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb93-8"><a href="#cb93-8"></a><span class="kw">diagram</span>(e, <span class="dt">alpha =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> col, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">ylab =</span> <span class="st">&quot;Fraction total W&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>This isn’t quite the diagram we were looking for. The published diagram shows a broad region of coexistence of H<sub>3</sub>WO<sub>4</sub>F<sub>2</sub><sup>-</sup> and HWO<sub>4</sub><sup>-</sup> at pH &lt; 5 and increasing abundance of H<sub>2</sub>WO<sub>4</sub> at lower pH.</p>
</div>
<div id="diagram-2-variable-molality-of-f-" class="section level3">
<h3>Diagram 2: Variable molality of F<sup>-</sup></h3>
<p>In reality, the molality of F<sup>-</sup> depends strongly on pH according to the reaction H<sup>+</sup> + F<sup>-</sup> = HF. With a little algebra, we can calculate the molality of F<sup>-</sup> (<code>a_F</code> in the code below) from the equilbrium constant of this reaction for a given total F concentration (<code>F_tot</code>). <span style="background-color: yellow;">NOTE</span>: It is important to call <code style="color: green;">subcrt()</code> with a non-zero <code>IS</code> so that it returns effective equilibrium constants corrected for ionic strength (try setting <code>IS = 0</code> yourself and look at what happens to the diagram).</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>T &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>pH &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="fl">0.1</span>)</span>
<span id="cb94-3"><a href="#cb94-3"></a>logK_HF &lt;-<span class="st"> </span><span class="kw">subcrt</span>(<span class="kw">c</span>(<span class="st">&quot;H+&quot;</span>, <span class="st">&quot;F-&quot;</span>, <span class="st">&quot;HF&quot;</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>), <span class="dt">T =</span> T, <span class="dt">IS =</span> <span class="fl">0.9</span>)<span class="op">$</span>out<span class="op">$</span>logK</span></code></pre></div>
<pre><code>## info.character: found HF(aq); also available in gas</code></pre>
<pre><code>## subcrt: 3 species at 300 ºC and 85.84 bar (wet) [energy units: J]</code></pre>
<pre><code>## nonideal: calculations for F- (Bdot equation)</code></pre>
<pre><code>## nonideal: calculations for HF (Setchenow equation)</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>F_tot &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>a_F &lt;-<span class="st"> </span>F_tot <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(logK_HF <span class="op">-</span><span class="st"> </span>pH))</span></code></pre></div>
<p>Now that we have the molality of F<sup>-</sup> as a function of pH, we can provide it in the call to <code style="color: green;">affinity()</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw">basis</span>(<span class="kw">c</span>(<span class="st">&quot;H+&quot;</span>, <span class="st">&quot;WO4-2&quot;</span>, <span class="st">&quot;F-&quot;</span>, <span class="st">&quot;H2O&quot;</span>, <span class="st">&quot;O2&quot;</span>))</span>
<span id="cb100-2"><a href="#cb100-2"></a>iaq &lt;-<span class="st"> </span><span class="kw">retrieve</span>(<span class="st">&quot;W&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;O&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;F&quot;</span>), <span class="st">&quot;aq&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="kw">species</span>(iaq)</span>
<span id="cb100-4"><a href="#cb100-4"></a>a &lt;-<span class="st"> </span><span class="kw">affinity</span>(<span class="dt">pH =</span> pH, <span class="st">&quot;F-&quot;</span> =<span class="st"> </span><span class="kw">log10</span>(a_F), <span class="dt">T =</span> T, <span class="dt">IS =</span> <span class="fl">0.9</span>)</span>
<span id="cb100-5"><a href="#cb100-5"></a>e &lt;-<span class="st"> </span><span class="kw">equilibrate</span>(a)</span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="kw">diagram</span>(e, <span class="dt">alpha =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> col, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">ylab =</span> <span class="st">&quot;Fraction total W&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s more like it. We have captured the basic geometry of Fig. 7b in <span class="citation">Wang et al. (2021)</span>. For instance, in accord with the published diagram, HWO<sub>4</sub><sup>-</sup> plateaus at around 40% of total W, and H<sub>2</sub>WO<sub>4</sub> and H<sub>3</sub>WO<sub>4</sub>F<sub>2</sub><sup>-</sup> are nearly equally abundant at pH = 2.</p>
<p>The highest experimental temperature for the formation constants of H<sub>2</sub>WO<sub>4</sub> and H<sub>3</sub>WO<sub>4</sub>F<sub>2</sub><sup>-</sup> is 250 °C, but this diagram is drawn for 300 °C. <span class="citation">Wang et al. (2021)</span> used the modified Ryzhenko-Bryzgalin (MRB) model to extrapolate to 300 °C. In contrast, we used a different model but obtained quite similar results.</p>
<p><span style="background-color: yellow;">NOTE</span>: The coefficients in the model used by <code style="color: red;">logB.to.OBIGT()</code> include 25 °C values of <tt style="color: blue;">G</tt> and <tt style="color: blue;">S</tt>. These should be conservatively treated only as <em>fitting parameters</em> and should not be used to compute thermodynamic properties close to 25 °C unless they were fit to experimental data in that temperature range.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-BZA10">
<p>Bazarkina EF, Zotov AV, Akinfiev NN. 2010. Pressure-dependent stability of cadmium chloride complexes: Potentiometric measurements at 1-1000 bar and 25°C. <em>Geology of Ore Deposits</em> <strong>52</strong>(2): 167–178. doi: <a href="https://doi.org/10.1134/S1075701510020054">10.1134/S1075701510020054</a></p>
</div>
<div id="ref-Ber88">
<p>Berman RG. 1988. Internally-consistent thermodynamic data for minerals in the system Na<span class="math inline"><em></em><sub>2</sub></span>O–K<span class="math inline"><em></em><sub>2</sub></span>O–CaO–MgO–FeO–Fe<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span>–Al<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span>–SiO<span class="math inline"><em></em><sub>2</sub></span>–TiO<span class="math inline"><em></em><sub>2</sub></span>–H<span class="math inline"><em></em><sub>2</sub></span>O–CO<span class="math inline"><em></em><sub>2</sub></span>. <em>Journal of Petrology</em> <strong>29</strong>(2): 445–522. doi: <a href="https://doi.org/10.1093/petrology/29.2.445">10.1093/petrology/29.2.445</a></p>
</div>
<div id="ref-HDNB78">
<p>Helgeson HC, Delany JM, Nesbitt HW, Bird DK. 1978. Summary and critique of the thermodynamic properties of rock-forming minerals. <em>American Journal of Science</em> <strong>278A</strong>: 1–229. Available at <a href="https://www.worldcat.org/oclc/13594862">https://www.worldcat.org/oclc/13594862</a>. </p>
</div>
<div id="ref-HOKR98">
<p>Helgeson HC, Owens CE, Knox AM, Richard L. 1998. Calculation of the standard molal thermodynamic properties of crystalline, liquid, and gas organic molecules at high temperatures and pressures. <em>Geochimica et Cosmochimica Acta</em> <strong>62</strong>(6): 985–1081. doi: <a href="https://doi.org/10.1016/S0016-7037(97)00219-6">10.1016/S0016-7037(97)00219-6</a></p>
</div>
<div id="ref-KOSG00">
<p>Klemme S, O’Neill HS, Schnelle W, Gmelin E. 2000. The heat capacity of MgCr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>4</sub></span>, FeCr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>4</sub></span>, and Cr<span class="math inline"><em></em><sub>2</sub></span>O<span class="math inline"><em></em><sub>3</sub></span> at low temperatures and derived thermodynamic properties. <em>American Mineralogist</em> <strong>85</strong>(11-12): 1686–1693. doi: <a href="https://doi.org/10.2138/am-2000-11-1212">10.2138/am-2000-11-1212</a></p>
</div>
<div id="ref-LBT_11">
<p>Liu W, Borg SJ, Testemale D, Etschmann B, Hazemann J-L, Brugger J. 2011. Speciation and thermodynamic properties for cobalt chloride complexes in hydrothermal fluids at 35–440 °C and 600 bar: An <em>in-situ</em> XAS study. <em>Geochimica et Cosmochimica Acta</em> <strong>75</strong>(5): 1227–1248. doi: <a href="https://doi.org/10.1016/j.gca.2010.12.002">10.1016/j.gca.2010.12.002</a></p>
</div>
<div id="ref-MK32">
<p>Maier CG, Kelley KK. 1932. An equation for the representation of high-temperature heat content data. <em>Journal of the American Chemical Society</em> <strong>54</strong>(8): 3243–3246. doi: <a href="https://doi.org/10.1021/ja01347a029">10.1021/ja01347a029</a></p>
</div>
<div id="ref-RH95">
<p>Robie RA, Hemingway BS. 1995. <em>Thermodynamic Properties of Minerals and Related Substances at 298.15 K and 1 Bar (10<sup>5</sup> Pascals) Pressure and at Higher Temperatures</em>. Washington, D.C.: U.S. Geological Survey. (Bulletin 2131). doi: <a href="https://doi.org/10.3133/b2131">10.3133/b2131</a></p>
</div>
<div id="ref-SOJSH92">
<p>Shock EL, Oelkers EH, Johnson JW, Sverjensky DA, Helgeson HC. 1992. Calculation of the thermodynamic properties of aqueous species at high pressures and temperatures: Effective electrostatic radii, dissociation constants, and standard partial molal properties to 1000 °C and 5 kbar. <em>Journal of the Chemical Society, Faraday Transactions</em> <strong>88</strong>(6): 803–826. doi: <a href="https://doi.org/10.1039/FT9928800803">10.1039/FT9928800803</a></p>
</div>
<div id="ref-SHA14">
<p>Sverjensky DA, Harrison B, Azzolini D. 2014. Water in the deep Earth: The dielectric constant and the solubilities of quartz and corundum to 60 kb and 1,200 °C. <em>Geochimica et Cosmochimica Acta</em> <strong>129</strong>: 125–145. doi: <a href="https://doi.org/10.1016/j.gca.2013.12.019">10.1016/j.gca.2013.12.019</a></p>
</div>
<div id="ref-SSH97">
<p>Sverjensky DA, Shock EL, Helgeson HC. 1997. Prediction of the thermodynamic properties of aqueous metal complexes to 1000°C and 5 kb. <em>Geochimica et Cosmochimica Acta</em> <strong>61</strong>(7): 1359–1412. doi: <a href="https://doi.org/10.1016/S0016-7037(97)00009-4">10.1016/S0016-7037(97)00009-4</a></p>
</div>
<div id="ref-WTW_19">
<p>Wang X-S, Timofeev A, Williams-Jones AE, Shang L-B, Bi X-W. 2019. An experimental study of the solubility and speciation of tungsten in NaCl-bearing aqueous solutions at 250, 300, and 350 °C. <em>Geochimica et Cosmochimica Acta</em> <strong>265</strong>: 313–329. doi: <a href="https://doi.org/10.1016/j.gca.2019.09.013">10.1016/j.gca.2019.09.013</a></p>
</div>
<div id="ref-WWH_21">
<p>Wang X-S, Williams-Jones AE, Hu R-Z, Shang L-B, Bi X-W. 2021. The role of fluorine in granite-related hydrothermal tungsten ore genesis: Results of experiments and modeling. <em>Geochimica et Cosmochimica Acta</em> <strong>292</strong>: 170–187. doi: <a href="https://doi.org/10.1016/j.gca.2020.09.032">10.1016/j.gca.2020.09.032</a></p>
</div>
</div>
</div>



<!-- code folding -->



</body>
</html>
